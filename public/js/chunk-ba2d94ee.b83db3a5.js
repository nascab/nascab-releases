(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ba2d94ee"],{"0a2f":function(t,e,s){},"1c14":function(t,e,s){},"2e77":function(t,e,s){"use strict";s("6394")},"2eae":function(t,e,s){},3871:function(t,e,s){"use strict";s("0a2f")},"48a3":function(t,e,s){"use strict";s("1c14")},"52f2":function(t,e,s){},"535b":function(t,e,s){"use strict";s("52f2")},"605d0":function(t,e,s){},6394:function(t,e,s){},"6f95":function(t,e,s){"use strict";s("9090")},"7c04":function(t,e,s){},"7de0":function(t,e,s){"use strict";s("2eae")},9090:function(t,e,s){},"955c":function(t,e,s){},a5e8:function(t,e,s){"use strict";s("c62a")},c62a:function(t,e,s){},ce02:function(t,e,s){"use strict";s("605d0")},dcab:function(t,e,s){"use strict";s("955c")},e0df:function(t,e,s){"use strict";s.r(e);var i=s("7cfd"),o={props:{editUser:{default:null,type:Object}},data(){return{btnCanUse:!0,currentUser:!1,formValidate:{username:this.editUser?this.editUser.username:"",password:"",question:"",answer:"",type:this.editUser?"edit":"add",remark:this.editUser&&this.editUser.user_remark?this.editUser.user_remark:""},ruleValidate:{username:[{required:!0,message:this.$t("registerAdmin.placeholderUsername"),trigger:"blur"},{min:2,message:this.$t("registerAdmin.usernameLengthLimit"),trigger:"blur"}],password:[{required:!0,message:this.$t("registerAdmin.placeholderPassword"),trigger:"blur"},{min:2,message:this.$t("registerAdmin.passwordLengthLimit"),trigger:"blur"}],question:[{required:!0,message:this.$t("registerAdmin.placeholderQuestion"),trigger:"blur"}],answer:[{required:!0,message:this.$t("registerAdmin.placeholderAnswer"),trigger:"blur"}]}}},mounted(){this.currentUser=this.getCurrentUser()},methods:{handleSubmit(t){this.$refs[t].validate(t=>{t&&(this.btnCanUse=!1,this.api.post("/api/usersApi/addUser",this.formValidate).then(t=>{t.code?this.btnCanUse=!0:this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess"),()=>{this.formValidate.username="",this.formValidate.password="",this.btnCanUse=!0,this.$emit("success")})}).catch(t=>{2==t.code&&this.showVsNotification(this.$t("user.hadSameUsername")),this.btnCanUse=!0}))})}}},a=(s("e1fc"),s("2877")),o=Object(a.a)(o,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"user-add-root"},[t("Form",{ref:"formValidate",staticStyle:{width:"100%"},attrs:{model:e.formValidate,rules:e.ruleValidate}},[t("FormItem",{attrs:{label:e.$t("common.username"),prop:"username"}},[t("Input",{attrs:{autocapitalize:"off",autocorrect:"off",disabled:null!=e.editUser,placeholder:e.$t("common.username")},model:{value:e.formValidate.username,callback:function(t){e.$set(e.formValidate,"username",t)},expression:"formValidate.username"}})],1),t("FormItem",{attrs:{label:e.$t("remark"),prop:"remark"}},[t("Input",{attrs:{autocapitalize:"off",autocorrect:"off"},model:{value:e.formValidate.remark,callback:function(t){e.$set(e.formValidate,"remark",t)},expression:"formValidate.remark"}})],1),t("FormItem",{attrs:{label:e.$t("common.password"),prop:"password"}},[t("Input",{attrs:{autocapitalize:"off",autocorrect:"off",placeholder:e.$t("common.password")},model:{value:e.formValidate.password,callback:function(t){e.$set(e.formValidate,"password",t)},expression:"formValidate.password"}})],1),t("FormItem",{attrs:{label:e.$t("common.question"),prop:"question"}},[t("Input",{attrs:{autocapitalize:"off",autocorrect:"off",placeholder:e.$t("registerAdmin.placeholderQuestion")},model:{value:e.formValidate.question,callback:function(t){e.$set(e.formValidate,"question",t)},expression:"formValidate.question"}})],1),t("FormItem",{attrs:{label:e.$t("common.answer"),prop:"answer"}},[t("Input",{attrs:{autocapitalize:"off",autocorrect:"off",placeholder:e.$t("registerAdmin.placeholderAnswer")},model:{value:e.formValidate.answer,callback:function(t){e.$set(e.formValidate,"answer",t)},expression:"formValidate.answer"}})],1)],1),t("my-btn",{staticStyle:{width:"250px","margin-top":"30px"},attrs:{disabled:!e.btnCanUse,title:e.editUser?e.$t("common.update"):e.$t("common.add")},on:{click:function(t){return e.handleSubmit("formValidate")}}})],1)},[],!1,null,"8d6c79a6",null).exports,n=s("ccdb"),r=s("e86f"),l={props:{user:""},components:{fileSelectBar:r.a,fileSelect:n.default},computed:{},data(){return{initPath:"",showChooseFolder:!1,indexName:"photo",btnCanUse:!0,userPower:[],pathList:[],showSourcePathSelect:!1,showMenuList:[]}},mounted(){this.getUserPower()},methods:{onUserMenuChange(){this.apiSetUserMenu()},onSelectPath(t){this.showChooseFolder=!1,this.apiSetUserPower(t)},showChoosePath(){"photo"==this.indexName?this.initPath="sourceFolderPhoto":"movie"==this.indexName?this.initPath="sourceFolderMovie":"music"==this.indexName?this.initPath="sourceFolderMusic":"book"==this.indexName?this.initPath="sourceFolderBook":"folder"==this.indexName&&(this.initPath=""),this.showChooseFolder=!0},cancelPath(t){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("user.sureCancelPathPower"),()=>{this.api.post("/api/usersApi/cancelUserPathPower",this.userPower[t]).then(t=>{t.code||(this.getUserPower(),this.showVsNotification(this.$t("common.operationSuccess")))}).catch(t=>{this.showVsNotification(this.$t("common.operationFail"))})})},powerChange(t){this.api.post("/api/usersApi/setUserPower",this.userPower[t]).then(t=>{t.code||(this.userPower=t.userPower,this.getUserPower(),this.showVsNotification(this.$t("common.operationSuccess")))}).catch(t=>{})},apiSetUserPower(t){this.api.post("/api/usersApi/setUserPower",{username:this.user.username,path:t,server_type:this.indexName,power_get:1}).then(t=>{t.code||(this.userPower=t.userPower,this.showSourcePathSelect=!1,this.getUserPower())}).catch(t=>{this.showVsNotification(this.$t("common.operationFail"))})},apiSetUserMenu(){this.api.post("/api/usersApi/setUserMenu",{username:this.user.username,menuList:this.showMenuList}).then(t=>{t.code}).catch(t=>{this.showVsNotification(this.$t("common.operationFail"))})},selectPath(t){t=this.pathList[t];this.apiSetUserPower(t.path)},showSourcePath(){this.showSourcePathSelect=!0,this.getPathList(this.indexName)},getPathList(t){this.pathList=[],this.api.post("/api/sourceFolderApi/getPathByType",{type:t}).then(t=>{t.code||(this.pathList=t.data)}).catch(t=>{})},changeIndex(t){this.indexName=t},getUserPower(){this.userPower=[],this.api.post("/api/usersApi/getUserPower",{username:this.user.username}).then(t=>{t.code||(this.userPower=t.userPower,this.showMenuList=JSON.parse(t.userMenu))}).catch(t=>{this.showVsNotification(this.$t("common.getFail"))})}}};s("ce02");o={components:{addUser:o,powerSet:Object(a.a)(l,function(){var i=this,t=i.$createElement,o=i._self._c||t;return o("div",{staticClass:"root"},[o("div",{staticClass:"nas-mobile-none"},[o("Menu",{attrs:{mode:"horizontal",theme:"light","active-name":"photo"},on:{"on-select":i.changeIndex}},[o("MenuItem",{attrs:{name:"photo"}},[o("span",{staticClass:"nasIcons icon-timeline",staticStyle:{"font-size":"14px"}}),i._v(" "+i._s(i.$t("user.powerPhoto"))+" ")]),o("MenuItem",{attrs:{name:"movie"}},[o("span",{staticClass:"nasIcons icon-movies-library",staticStyle:{"font-size":"14px"}}),i._v(" "+i._s(i.$t("user.powerMovie"))+" ")]),o("MenuItem",{attrs:{name:"music"}},[o("span",{staticClass:"nasIcons icon-play",staticStyle:{"font-size":"14px"}}),i._v(" "+i._s(i.$t("user.powerMusic"))+" ")]),o("MenuItem",{attrs:{name:"book"}},[o("Icon",{attrs:{type:"md-bookmarks"}}),i._v(" "+i._s(i.$t("user.powerBooks"))+" ")],1),o("MenuItem",{attrs:{name:"folder"}},[o("span",{staticClass:"nasIcons icon-file-list",staticStyle:{"font-size":"14px"}}),i._v(" "+i._s(i.$t("user.powerFolder"))+" ")]),o("MenuItem",{attrs:{name:"menu"}},[o("span",{staticClass:"nasIcons icon-grid",staticStyle:{"font-size":"14px"}}),i._v(" "+i._s(i.$t("common.menu"))+" ")])],1)],1),o("div",{staticClass:"nas-mobile-show"},[o("vs-select",{staticStyle:{width:"100%"},model:{value:i.indexName,callback:function(t){i.indexName=t},expression:"indexName"}},[o("vs-option",{attrs:{label:i.$t("user.powerPhoto"),value:"photo"}},[i._v(" "+i._s(i.$t("user.powerPhoto"))+" ")]),o("vs-option",{attrs:{label:i.$t("user.powerMovie"),value:"movie"}},[i._v(" "+i._s(i.$t("user.powerMovie"))+" ")]),o("vs-option",{attrs:{label:i.$t("user.powerMusic"),value:"music"}},[i._v(" "+i._s(i.$t("user.powerMusic"))+" ")]),o("vs-option",{attrs:{label:i.$t("user.powerBooks"),value:"book"}},[i._v(" "+i._s(i.$t("user.powerBooks"))+" ")]),o("vs-option",{attrs:{label:i.$t("user.powerFolder"),value:"folder"}},[i._v(" "+i._s(i.$t("user.powerFolder"))+" ")]),o("vs-option",{attrs:{label:i.$t("common.menu"),value:"menu"}},[i._v(" "+i._s(i.$t("common.menu"))+" ")])],1)],1),i._l(i.userPower,function(e,s){return"photo"==i.indexName&&"photo"==e.server_type||"movie"==i.indexName&&"movie"==e.server_type||"music"==i.indexName&&"music"==e.server_type||"book"==i.indexName&&"book"==e.server_type||"folder"==i.indexName&&"folder"==e.server_type?o("div",[o("div",{staticClass:"path-item-root"},[o("span",{staticClass:"item-icon-folder nasIcons icon-img-folder"}),o("div",{staticClass:"path-item-right"},[o("div",{staticClass:"max-line-three",staticStyle:{"text-align":"left"}},[i._v(i._s(e.path))]),o("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","margin-top":"20px"}},[o("Checkbox",{attrs:{"true-value":1,"false-value":0},on:{"on-change":function(t){return i.powerChange(s)}},model:{value:e.power_get,callback:function(t){i.$set(e,"power_get",t)},expression:"power.power_get"}},[i._v(i._s(i.$t("common.check")))]),"photo"==i.indexName?o("Checkbox",{attrs:{"true-value":1,"false-value":0},on:{"on-change":function(t){return i.powerChange(s)}},model:{value:e.power_add,callback:function(t){i.$set(e,"power_add",t)},expression:"power.power_add"}},[i._v(i._s(i.$t("common.add"))+i._s(i.$t("photo.album")))]):i._e(),"folder"==i.indexName?o("Checkbox",{attrs:{"true-value":1,"false-value":0},on:{"on-change":function(t){return i.powerChange(s)}},model:{value:e.power_add,callback:function(t){i.$set(e,"power_add",t)},expression:"power.power_add"}},[i._v(i._s(i.$t("common.upload"))+" ")]):i._e(),"music"!=i.indexName?o("Checkbox",{attrs:{"true-value":1,"false-value":0},on:{"on-change":function(t){return i.powerChange(s)}},model:{value:e.power_change,callback:function(t){i.$set(e,"power_change",t)},expression:"power.power_change"}},[i._v(i._s(i.$t("common.change"))+" ")]):i._e(),o("Checkbox",{attrs:{"true-value":1,"false-value":0},on:{"on-change":function(t){return i.powerChange(s)}},model:{value:e.power_delete,callback:function(t){i.$set(e,"power_delete",t)},expression:"power.power_delete"}},[i._v(i._s(i.$t("common.delete")))])],1),o("Button",{staticStyle:{"border-radius":"10px","margin-top":"20px"},attrs:{size:"small",type:"error"},on:{click:function(t){return i.cancelPath(s)}}},[i._v(i._s(i.$t("user.cancelPathPower")))])],1)]),o("Divider")],1):i._e()}),"photo"==i.indexName?o("div",[o("div",{staticClass:"btn-root"},[o("my-btn",{staticStyle:{width:"250px","margin-top":"30px"},attrs:{title:i.$t("user.addPhotoPowerPath")},on:{click:i.showChoosePath}})],1)]):i._e(),"movie"==i.indexName?o("div",[o("div",{staticClass:"btn-root"},[o("my-btn",{staticStyle:{width:"250px","margin-top":"30px"},attrs:{title:i.$t("user.addMoviePowerPath")},on:{click:i.showChoosePath}})],1)]):i._e(),"music"==i.indexName?o("div",[o("div",{staticClass:"btn-root"},[o("my-btn",{staticStyle:{width:"250px","margin-top":"30px"},attrs:{title:i.$t("user.addMusicPowerPath")},on:{click:i.showChoosePath}})],1)]):i._e(),"book"==i.indexName?o("div",[o("div",{staticClass:"btn-root"},[o("my-btn",{staticStyle:{width:"250px","margin-top":"30px"},attrs:{title:i.$t("user.addBookPowerPath")},on:{click:i.showChoosePath}})],1)]):i._e(),"folder"==i.indexName?o("div",[o("div",{staticClass:"btn-root"},[o("my-btn",{staticStyle:{width:"250px","margin-top":"30px"},attrs:{title:i.$t("user.addFolderPowerPath")},on:{click:i.showChoosePath}})],1)]):i._e(),"menu"==i.indexName?o("div",{staticStyle:{"margin-top":"10px"}},[o("div",{staticStyle:{"text-align":"left"}},[o("b",[i._v(i._s(i.$t("whatModelWillYouUseSubuser")))]),i._v(" ("+i._s(i.$t("setting.noSetShowAllMenu"))+")")]),o("CheckboxGroup",{staticClass:"option-root",on:{"on-change":i.onUserMenuChange},model:{value:i.showMenuList,callback:function(t){i.showMenuList=t},expression:"showMenuList"}},[o("Checkbox",{staticClass:"ckItem",attrs:{label:"photoManage",border:""}},[i._v(i._s(i.$t("home.photoManage")))]),o("Checkbox",{staticClass:"ckItem",attrs:{label:"movieManage",border:""}},[i._v(i._s(i.$t("home.movieManage")))]),o("Checkbox",{staticClass:"ckItem",attrs:{label:"musicManage",border:""}},[i._v(i._s(i.$t("home.musicManage")))]),o("Checkbox",{staticClass:"ckItem",attrs:{label:"filesBrower",border:""}},[i._v(i._s(i.$t("home.fileBrower")))]),o("Checkbox",{staticClass:"ckItem",attrs:{label:"privateSpace",border:""}},[i._v(i._s(i.$t("photo.privateSpace")))]),o("Checkbox",{staticClass:"ckItem",attrs:{label:"books",border:""}},[i._v(i._s(i.$t("book.library")))])],1)],1):i._e(),o("vs-dialog",{attrs:{blur:""},scopedSlots:i._u([{key:"header",fn:function(){return[o("h4",{staticStyle:{"font-size":"16px"}},[i._v(" "+i._s(i.$t("user.selectImpowerPath"))+" ")])]},proxy:!0}]),model:{value:i.showSourcePathSelect,callback:function(t){i.showSourcePathSelect=t},expression:"showSourcePathSelect"}},[i._l(i.pathList,function(t,e){return o("div",[o("div",{staticClass:"option-item max-line-three",on:{click:function(t){return i.selectPath(e)}}},[i._v(i._s(t.path))])])}),i.pathList.length<1?o("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center"}},[o("my-btn",{staticStyle:{"margin-top":"30px","margin-bottom":"30px"},attrs:{type:"white",title:i.$t("user.goToSetSourcePath")}})],1):i._e()],2),o("vs-dialog",{attrs:{"prevent-close":"",scroll:"","full-screen":i.isMobile},scopedSlots:i._u([{key:"header",fn:function(){return[o("h4",{staticStyle:{"font-size":"16px"}},[i._v(" "+i._s(i.$t("file.chooseFolder")+"["+i.$t("file.doubleClickFolderEnter")+"]")+" ")])]},proxy:!0},{key:"footer",fn:function(){return[o("file-select-bar",{on:{back:function(t){return i.$refs.fileSelector.goBack()},select:function(t){return i.$refs.fileSelector.onSelect()},create:function(t){return i.$refs.fileSelector.createNewFolder(t)}}})]},proxy:!0}]),model:{value:i.showChooseFolder,callback:function(t){i.showChooseFolder=t},expression:"showChooseFolder"}},[i.showChooseFolder?o("file-select",{ref:"fileSelector",attrs:{parent:"root",type:2,initPath:i.initPath},on:{onSelect:i.onSelectPath,onCancel:function(t){i.showChooseFolder=!1}}}):i._e()],1)],2)},[],!1,null,"5f029c9d",null).exports},data(){return{searchKey:"",sortType:"asc",sortField:"id",itemBaseWidth:220,itemWidth:220,itemMargin:10,editUser:null,btnCanUse:!0,showAddUser:!1,showPowerSet:!1,userList:[],selectedUser:""}},mounted(){localStorage.cacheUserListSortField&&(this.sortField=localStorage.cacheUserListSortField),localStorage.cacheUserListSortType&&(this.sortType=localStorage.cacheUserListSortType),this.getAllUser(),window.addEventListener("resize",this.calImageWidth)},beforeDestroy(){window.removeEventListener("resize",this.calImageWidth)},methods:{showUpdateRemark(t){this.selectedUser=t,this.$nextTick(()=>{this.$refs.addRemarkDialog.setShow(!0)})},updateUserRemark(t){this.api.post("/api/usersApi/remarkUser",{username:this.selectedUser.username,remark:t}).then(t=>{t.code||(this.selectedUser=null,this.showVsNotification(this.$t("common.operationSuccess")),this.getAllUser())}).catch(t=>{this.showVsNotification(this.$t("common.operationFail"))})},onSearch(t){this.searchKey=t,this.getAllUser()},clickOrder(){localStorage.cacheUserListSortField=this.sortField,localStorage.cacheUserListSortType=this.sortType,this.getAllUser()},calImageWidth(){var t=this.$refs.listWrapper.getBoundingClientRect(),t=this.utils.calItemWidth(t,this.itemBaseWidth,this.itemMargin);t&&(this.itemWidth=t)},showAddDialog(){this.editUser=null,this.showAddUser=!0},powerSetSuccess(){},powerSet(t){this.selectedUser=this.userList[t],this.showPowerSet=!0},editUserFun(t){this.editUser=this.userList[t],this.$nextTick(()=>{this.showAddUser=!0})},deleteUser(t){let e=this.userList[t].id;this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("user.sureDeleteUser"),()=>{this.api.post("/api/usersApi/removeUser",{uid:e}).then(t=>{t.code||(this.showVsNotification(this.$t("common.operationSuccess")),this.getAllUser())}).catch(t=>{this.showVsNotification(this.$t("common.operationFail"))})})},addUserSuccess(){this.showAddUser=!1,this.getAllUser()},getAllUser(){var t={orderType:this.sortType,orderField:this.sortField};this.searchKey&&(t.searchKey=this.searchKey),this.api.post("/api/usersApi/getAllUser",t).then(t=>{t.code||(this.userList=t.userList,this.calImageWidth())}).catch(t=>{102==t.code&&(this.btnCanUse=!1)})}}};s("48a3");l=Object(a.a)(o,function(){var i=this,t=i.$createElement,o=i._self._c||t;return o("div",{staticStyle:{height:"100%"}},[o("div",{staticClass:"header-root"},[o("Poptip",{attrs:{placement:"bottom"},scopedSlots:i._u([{key:"content",fn:function(){return[o("div",{staticClass:"sort-root"},[o("div",[i._v(i._s(i.$t("common.sortField")))]),o("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":i.clickOrder},model:{value:i.sortField,callback:function(t){i.sortField=t},expression:"sortField"}},[o("Radio",{attrs:{label:"id"}},[o("span",[i._v(i._s(i.$t("movie.createTime")))])]),o("Radio",{attrs:{label:"username"}},[o("span",[i._v(i._s(i.$t("common.username")))])]),o("Radio",{attrs:{label:"user_remark"}},[o("span",[i._v(i._s(i.$t("remark")))])])],1),o("div",{staticStyle:{"margin-top":"15px"}},[i._v(i._s(i.$t("common.sortType")))]),o("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":i.clickOrder},model:{value:i.sortType,callback:function(t){i.sortType=t},expression:"sortType"}},[o("Radio",{attrs:{label:"asc"}},[o("span",[i._v(i._s(i.$t("common.asc")))])]),o("Radio",{attrs:{label:"desc"}},[o("span",[i._v(i._s(i.$t("common.desc")))])])],1)],1)]},proxy:!0}])},["asc"==i.sortType?o("span",{staticClass:"nasIcons icon-sort-alpha-up operation-icon"}):i._e(),"desc"==i.sortType?o("span",{staticClass:"nasIcons icon-sort-alpha-down-alt operation-icon"}):i._e()]),o("my-search",{ref:"mySearch",staticStyle:{"max-width":"350px"},attrs:{shrinkModeTh:200,placeholder:i.$t("userRemarkPh")},on:{onSearch:i.onSearch}})],1),o("div",{ref:"listWrapper",staticClass:"user-list"},[i._l(i.userList,function(e,s){return o("div",{key:e.id,staticClass:"user-item",style:{margin:i.itemMargin+"px",width:i.itemWidth+"px"}},[o("div",{staticStyle:{position:"relative"}},[o("span",{staticClass:"item-avatar nasIcons icon-avatar"}),1==e.is_admin?o("div",{staticClass:"item-admin-bg",style:{right:i.itemWidth/10+"px"}},[o("span",{staticClass:" nasIcons icon-bg-admin",staticStyle:{"font-size":"20px"}}),o("span",{staticStyle:{"font-size":"12px",position:"absolute",left:"8px",color:"white",top:"5px"}},[i._v(i._s(i.$t("user.admin")))])]):i._e()]),o("div",{staticClass:"username",staticStyle:{"font-size":"18px"}},[i._v(" "+i._s(e.username)),o("a",{staticStyle:{"font-size":"12px","margin-left":"5px"},on:{click:function(t){return i.showUpdateRemark(e)}}},[i._v("("+i._s(e.user_remark||i.$t("remark"))+")")])]),1==e.is_admin?o("div",{staticClass:"item-power"},[i._v(i._s(i.$t("user.haveAllPower")))]):i._e(),1!=e.is_admin?o("div",{staticStyle:{"margin-top":"10px",display:"flex","flex-direction":"row","justify-content":"space-between",width:"100%","flex-wrap":"nowrap","align-items":"center"}},[o("a",{staticStyle:{"text-decoration":"underline"},on:{click:function(t){return i.powerSet(s)}}},[i._v(i._s(i.$t("user.powerSet")))]),o("a",{staticStyle:{"text-decoration":"underline"},on:{click:function(t){return i.editUserFun(s)}}},[i._v(i._s(i.$t("common.edit")))]),o("div",{staticStyle:{height:"14px",width:"1px","background-color":"#e8e8e8"}}),o("a",{staticStyle:{"text-decoration":"underline"},on:{click:function(t){return i.deleteUser(s)}}},[i._v(i._s(i.$t("common.delete")))])]):i._e()])}),o("div",{staticStyle:{"background-color":"white","border-radius":"10px",display:"flex","flex-direction":"column","justify-content":"center",cursor:"pointer"},style:{margin:i.itemMargin+"px",width:i.itemWidth+"px"},on:{click:i.showAddDialog}},[o("span",{staticClass:"nasIcons icon-add-album icon-add"}),o("div",{staticStyle:{"font-size":"20px","font-weight":"bold","margin-bottom":"60px"}},[i._v(i._s(i.$t("user.addNewUser"))+" ")])])],2),o("vs-dialog",{attrs:{"prevent-close":"",scroll:""},scopedSlots:i._u([{key:"header",fn:function(){return[o("h4",{staticStyle:{"font-size":"16px"}},[i._v(" "+i._s(i.editUser?i.$t("user.updateUserInfo"):i.$t("user.addNewUser"))+" ")])]},proxy:!0}]),model:{value:i.showAddUser,callback:function(t){i.showAddUser=t},expression:"showAddUser"}},[i.showAddUser?o("add-user",{attrs:{editUser:i.editUser},on:{success:i.addUserSuccess}}):i._e()],1),o("vs-dialog",{attrs:{"prevent-close":"",scroll:""},scopedSlots:i._u([{key:"header",fn:function(){return[o("h4",{staticStyle:{"font-size":"16px"}},[i._v(" "+i._s(i.$t("user.powerSet")+":"+i.selectedUser.username)+" ")])]},proxy:!0}]),model:{value:i.showPowerSet,callback:function(t){i.showPowerSet=t},expression:"showPowerSet"}},[i.showPowerSet?o("power-set",{attrs:{user:i.selectedUser},on:{success:i.powerSetSuccess}}):i._e()],1),i.selectedUser?o("my-dialog-input",{ref:"addRemarkDialog",attrs:{placeholder:i.$t("remark"),showCloseBtn:!0,content:i.selectedUser.username,title:i.$t("addUserRemark"),initValue:i.selectedUser.user_remark||""},on:{onOkClick:i.updateUserRemark}}):i._e()],1)},[],!1,null,"49f7148d",null).exports,o={mounted(){this.getAllConfig()},components:{myScrollBar:s("c220").a,fileSelectBar:r.a,fileSelect:n.default},data(){return{returnData:null,settingData:{httpsCert:"",httpsKey:"",autoLoginClient:!0,language:"zh-CN",autoLaunch:!1,autoShowWindow:!0,apiPort:null,apiPortHttps:null,webDavPort:null,webDavPortHttps:null,FTPPort:null,tokenKeepHour:24,autoScanSource:!1}}},computed:{},methods:{onPageScroll(t){"setting-wrapper"==t.target.id&&this.$refs.scrollBar&&this.$refs.scrollBar.onScroll(t)},resetConfig(){this.returnData&&(this.settingData.apiPort=this.returnData.defaultApiPort,this.settingData.apiPortHttps=this.returnData.defaultApiPortHttps,this.settingData.webDavPort=this.returnData.defaultWebDavPort,this.settingData.webDavPortHttps=this.returnData.defaultWebDavPortHttps,this.settingData.FTPPort=this.returnData.defaultFTPPort,this.settingData.autoLaunch=!1,this.settingData.autoLoginClient=!0,this.settingData.autoShowWindow=!0,this.settingData.autoScanSource=!0)},onLanguageChange(t){},saveConfig(){var t={...this.settingData};720<t.tokenKeepHour&&(t.tokenKeepHour=720),t.tokenKeepHour<0&&(t.tokenKeepHour=1),t.autoLaunch=t.autoLaunch?"1":"0",t.autoLoginClient=t.autoLoginClient?"1":"0",t.autoShowWindow=t.autoShowWindow?"1":"0",t.autoScanSource=t.autoScanSource?"1":"0",this.api.post("/api/commonApi/saveConfig",t).then(t=>{this.showVsNotification(this.$t("setting.saveSuccessRestartValid")),this.$i18n.locale=this.settingData.language,this.$store.state.language=this.settingData.language}).catch(t=>{})},getAllConfig(){this.api.post("/api/commonApi/getAllConfig",{}).then(e=>{for(let t=0;t<e.data.allConfig.length;t++){var s=e.data.allConfig[t];"apiPort"==s.title?this.settingData.apiPort=s.value:"apiPortHttps"==s.title?this.settingData.apiPortHttps=s.value:"webDavPort"==s.title?this.settingData.webDavPort=s.value:"webDavPortHttps"==s.title?this.settingData.webDavPortHttps=s.value:"FTPPort"==s.title?this.settingData.FTPPort=s.value:"language"==s.title?this.settingData.language=s.value:"threadCount"==s.title?this.settingData.threadCount=s.value:"autoLaunch"==s.title?this.settingData.autoLaunch="1"==s.value:"autoLoginClient"==s.title?this.settingData.autoLoginClient="1"==s.value:"autoShowWindow"==s.title?this.settingData.autoShowWindow="1"==s.value:"autoScanSource"==s.title?this.settingData.autoScanSource="1"==s.value:"httpsCert"==s.title?this.settingData.httpsCert=s.value:"httpsKey"==s.title?this.settingData.httpsKey=s.value:"tokenKeepHour"==s.title&&(this.settingData.tokenKeepHour=s.value)}this.settingData.apiPort||(this.settingData.apiPort=e.data.defaultApiPort),this.settingData.apiPortHttps||(this.settingData.apiPortHttps=e.data.defaultApiPortHttps),this.settingData.webDavPort||(this.settingData.webDavPort=e.data.defaultWebDavPort),this.settingData.webDavPortHttps||(this.settingData.webDavPortHttps=e.data.defaultWebDavPortHttps),this.settingData.FTPPort||(this.settingData.FTPPort=e.data.defaultFTPPort),this.settingData.threadCount||(this.settingData.threadCount=e.data.defaultThreadCount),this.returnData=e.data}).catch(t=>{})}}};s("535b");r=Object(a.a)(o,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"setting-root-wrapper"},[t("div",{staticClass:"common-setting-root",attrs:{id:"setting-wrapper"},on:{scroll:e.onPageScroll}},[t("div",{staticStyle:{width:"100%",display:"flex","justify-content":"left","align-items":"center"}},[t("div",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(e.$t("setting.language"))+":")]),t("Select",{staticStyle:{width:"120px"},model:{value:e.settingData.language,callback:function(t){e.$set(e.settingData,"language",t)},expression:"settingData.language"}},[t("Option",{key:"zh-CN",attrs:{value:"zh-CN"}},[e._v("中文[简体]")]),t("Option",{key:"zh-TW",attrs:{value:"zh-TW"}},[e._v("中文[繁體]")]),t("Option",{key:"en-US",attrs:{value:"en-US"}},[e._v("English")])],1)],1),t("Divider",{staticStyle:{"margin-top":"30px","margin-bottom":"20px"}},[e._v(e._s(e.$t("setting.commonSetting")))]),t("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"column","align-items":"center"}},[t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","margin-top":"20px","justify-content":"flex-start",width:"100%"}},[t("div",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(e.$t("setting.autoLaunch")))]),t("i-switch",{model:{value:e.settingData.autoLaunch,callback:function(t){e.$set(e.settingData,"autoLaunch",t)},expression:"settingData.autoLaunch"}})],1)]),t("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"column","align-items":"center"}},[t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","margin-top":"20px","justify-content":"flex-start",width:"100%"}},[t("div",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(e.$t("setting.autoLoginClient")))]),t("i-switch",{model:{value:e.settingData.autoLoginClient,callback:function(t){e.$set(e.settingData,"autoLoginClient",t)},expression:"settingData.autoLoginClient"}})],1)]),t("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"column","align-items":"center"}},[t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","margin-top":"20px","justify-content":"flex-start",width:"100%"}},[t("div",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(e.$t("setting.autoShowWindow")))]),t("i-switch",{model:{value:e.settingData.autoShowWindow,callback:function(t){e.$set(e.settingData,"autoShowWindow",t)},expression:"settingData.autoShowWindow"}})],1)]),t("Divider",{staticStyle:{"margin-top":"30px","margin-bottom":"20px"}},[e._v(e._s(e.$t("setting.portSetting")))]),t("p",{staticStyle:{"margin-bottom":"10px"}},[e._v(e._s(e.$t("setting.ifPortInUserWillAdd")))]),t("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"column","align-items":"center"}},[t("vs-input",{staticClass:"item-input",staticStyle:{"margin-top":"20px"},attrs:{autocapitalize:"off",autocorrect:"off",type:"number",label:e.$t("setting.basePort"),placeholder:"256-65535"},model:{value:e.settingData.apiPort,callback:function(t){e.$set(e.settingData,"apiPort",t)},expression:"settingData.apiPort"}}),t("vs-input",{staticClass:"item-input",attrs:{autocapitalize:"off",autocorrect:"off",type:"number",label:e.$t("setting.basePortHttps"),placeholder:"256-65535"},model:{value:e.settingData.apiPortHttps,callback:function(t){e.$set(e.settingData,"apiPortHttps",t)},expression:"settingData.apiPortHttps"}})],1),t("Divider",{staticStyle:{"margin-top":"30px","margin-bottom":"20px"}},[e._v("HTTPS["+e._s(e.$t("setting.defaultCert"))+"]")]),t("div",{staticStyle:{"text-align":"left",width:"100%","margin-top":"10px","margin-bottom":"10px"}},[e._v(e._s(e.$t("setting.httpsCert"))+" ")]),t("Input",{attrs:{autocapitalize:"off",autocorrect:"off",type:"textarea",placeholder:"[-----BEGIN CERTIFICATE-----]..."},model:{value:e.settingData.httpsCert,callback:function(t){e.$set(e.settingData,"httpsCert",t)},expression:"settingData.httpsCert"}}),t("div",{staticStyle:{"text-align":"left",width:"100%","margin-top":"10px","margin-bottom":"10px"}},[e._v(e._s(e.$t("setting.httpsKey"))+" ")]),t("Input",{attrs:{autocapitalize:"off",autocorrect:"off",type:"textarea",label:e.$t("setting.httpsKey"),placeholder:"[-----BEGIN RSA PRIVATE KEY-----]..."},model:{value:e.settingData.httpsKey,callback:function(t){e.$set(e.settingData,"httpsKey",t)},expression:"settingData.httpsKey"}}),t("Divider",{staticStyle:{"margin-top":"30px","margin-bottom":"20px"}},[e._v(e._s(e.$t("setting.proSetting")))]),t("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"column","align-items":"center","margin-bottom":"120px"}},[t("vs-input",{staticClass:"item-input",staticStyle:{"margin-top":"20px"},attrs:{autocapitalize:"off",autocorrect:"off",type:"number",label:e.$t("setting.threadCount")+"["+e.$t("setting.threadCountHint")+"]"},model:{value:e.settingData.threadCount,callback:function(t){e.$set(e.settingData,"threadCount",t)},expression:"settingData.threadCount"}}),t("vs-input",{staticClass:"item-input",staticStyle:{"margin-top":"30px"},attrs:{autocapitalize:"off",autocorrect:"off",type:"number",label:e.$t("setting.tokenKeepTime")},model:{value:e.settingData.tokenKeepHour,callback:function(t){e.$set(e.settingData,"tokenKeepHour",t)},expression:"settingData.tokenKeepHour"}})],1),t("div",{staticClass:"bottom-btns-root-wrapper"},[t("div",{staticClass:"bottom-btns-root"},[t("my-btn",{staticStyle:{"margin-right":"20px"},attrs:{title:e.$t("common.resetDefault"),type:"white"},on:{click:e.resetConfig}}),t("my-btn",{attrs:{title:e.$t("common.commit")},on:{click:e.saveConfig}})],1)])],1),t("my-scroll-bar",{ref:"scrollBar"})],1)},[],!1,null,"3ec49d06",null).exports;s("14d9");o={mounted(){this.getSystemInfo(),this.getVersionInfo()},components:{},data(){return{showTerminal:!1,showChangeCachePath:!1,updateIsShow:!1,showUpdateLogDialog:!1,iframeUrl:"",versionInfo:"",currentVersion:"",systemInfo:null}},computed:{},methods:{showHowToBackup(){this.showVsAlertDialog(this.$t("common.alert"),this.$t("setting.howToBackupContent",{path:this.systemInfo.databaseFolder.replace("/database","")}))},showCacheChangeDialog(){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("setting.changeCachePathAlert"),()=>{this.showChangeCachePath=!0})},onVacuumDb(){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("setting.vacuumDbAlert"),()=>{this.api.post("/api/commonApi/vaccumDb",{}).then(t=>{t.code||this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess"))}).catch(t=>{})})},onSelectCachePath(t){this.showChangeCachePath=!1,this.api.post("/api/commonApi/changeCachePath",{cachePath:t}).then(t=>{t.code||this.showVsAlertDialog(this.$t("common.alert"),this.$t("setting.saveSuccessRestart"))}).catch(t=>{})},showUpdateLog(){this.iframeUrl="https://www.nascab.cn/updateLog.html",this.showUpdateLogDialog=!0},restartNascab(){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("setting.reLaunchNasCabAlert"),()=>{this.api.post("/api/commonApi/relaunch",{}).then(t=>{this.showVsAlertDialog(this.$t("common.alert"),this.$t("setting.reLaunchNasCabConfirm"))})})},showUpdate(){this.showVsConfirmDialog(this.$t("system.updateTo")+"V"+this.versionInfo.version,this.versionInfo.message,()=>{this.api.post("/api/commonApi/updateNewVersion",{}).then(t=>{this.showVsAlertDialog(this.$t("common.alert"),this.$t("system.updateSent")),this.updateIsShow=!1}).catch(t=>{})},null,this.$t("system.update"))},resetSystemApi(t){this.api.post("/api/usersApi/resetSystem",{password:t}).then(t=>{t.code||this.showVsAlertDialog(this.$t("common.alert"),this.$t("system.systemResetSuc"),()=>{localStorage.removeItem("token"),localStorage.removeItem("currentUser"),this.$router.push({path:"/login"})})}).catch(t=>{})},handleClickCache(){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("setting.clearCacheAlert"),()=>{this.doClearCache()},null,this.$t("setting.clearCache"))},getVersionInfo(){this.api.post("/api/commonApi/getVersionInfo",{}).then(t=>{t.currentVersion&&(this.versionInfo=t.versionInfo,this.currentVersion=t.currentVersion,this.currentVersion!=this.versionInfo.version)&&(this.updateIsShow=!0)}).catch(t=>{})},doClearCache(){this.api.post("/api/commonApi/clearCache",{}).then(t=>{this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess")),this.getSystemInfo()}).catch(t=>{})},getSystemInfo(){this.api.post("/api/commonApi/getSystemInfo",{}).then(t=>{this.systemInfo=t.data}).catch(t=>{})}}};s("3871");var o=Object(a.a)(o,function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.systemInfo?s("div",{staticClass:"system-root"},[s("Divider",[e._v(e._s(e.$t("system.sysUpdate")))]),s("div",{staticClass:"item-root"},[s("div",{staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.$t("system.currentSystemVersion"))+":")]),s("span",{staticStyle:{"margin-right":"10px"}},[e._v("V"+e._s(e.currentVersion))]),e.updateIsShow?s("a",{on:{click:e.showUpdate}},[e._v(e._s(e.$t("system.update")))]):e._e()]),e.versionInfo?s("div",{staticClass:"item-root"},[s("div",{staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.$t("system.lastestVersion"))+":")]),s("span",{staticStyle:{"margin-right":"10px"}},[e._v("V"+e._s(e.versionInfo.version))]),s("a",{staticStyle:{"flex-shrink":"0"},on:{click:e.showUpdateLog}},[e._v(e._s(e.$t("system.updateLog")))])]):e._e(),s("Divider",[e._v(e._s(e.$t("state.systemInfo")))]),s("div",{staticClass:"item-root"},[s("div",{staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.$t("state.appRootPath"))+":")]),s("span",{staticClass:" enable-text-select",staticStyle:{"margin-right":"20px","text-align":"left","word-break":"break-all"},on:{click:function(t){return e.copyText(e.systemInfo.appRootPath)}}},[e._v(e._s(e.systemInfo.appRootPath))])]),s("Divider",[e._v(e._s(e.$t("setting.cacheInfo")))]),s("div",{staticClass:"item-root"},[s("div",{staticStyle:{"flex-shrink":"0","margin-right":"10px"}},[e._v(e._s(e.$t("setting.databasePath"))+":")]),s("span",{staticClass:"enable-text-select",staticStyle:{"word-break":"break-all","text-align":"left"},on:{click:function(t){return e.copyText(e.systemInfo.databaseFolder)}}},[e._v(e._s(e.systemInfo.databaseFolder))]),s("a",{staticStyle:{"margin-left":"10px","flex-shrink":"0"},on:{click:function(t){return e.onVacuumDb()}}},[e._v(e._s(e.$t("setting.vacuumDb")))])]),s("div",{staticClass:"item-root"},[s("a",{on:{click:e.showHowToBackup}},[e._v(e._s(e.$t("setting.howToBackup")))])]),s("div",{staticClass:"divider"}),s("div",{staticClass:"item-root"},[s("div",{staticStyle:{"flex-shrink":"0","margin-right":"10px"}},[e._v(e._s(e.$t("setting.cachePath"))+":")]),s("span",{staticClass:"enable-text-select",staticStyle:{"word-break":"break-all","text-align":"left"},on:{click:function(t){return e.copyText(e.systemInfo.imgFolder)}}},[e._v(e._s(e.systemInfo.imgFolder))]),1==this.systemInfo.imgFolderUsable?s("span",{staticClass:"icon-main-color",staticStyle:{"flex-shrink":"0"}},[e._v("("+e._s(e.$t("common.available"))+")")]):e._e(),1!=this.systemInfo.imgFolderUsable?s("span",{staticClass:"icon-red-color",staticStyle:{"flex-shrink":"0"}},[e._v("("+e._s(e.$t("common.unavailable"))+")")]):e._e(),s("a",{staticStyle:{"margin-left":"10px","flex-shrink":"0"},on:{click:function(t){return e.onSelectCachePath("")}}},[e._v(" "+e._s(e.$t("Reset")))]),s("a",{staticStyle:{"margin-left":"10px","flex-shrink":"0"},on:{click:function(t){return e.showCacheChangeDialog()}}},[e._v(" "+e._s(e.$t("common.change")))])]),s("div",{staticClass:"divider"}),e.systemInfo.cacheImageInfo?s("div",{staticClass:"item-root"},[s("span",[e._v(e._s(e.$t("setting.cacheSize"))+":"+e._s(e.utils.getSizeStr(e.systemInfo.cacheImageInfo.totalSize)))]),s("a",{staticStyle:{"margin-left":"10px","flex-shrink":"0"},on:{click:e.handleClickCache}},[e._v(" "+e._s(e.$t("setting.clearCache")))])]):e._e(),s("div",{staticClass:"divider"}),s("div",{staticStyle:{display:"flex","justify-content":"center"}},[s("vs-button",{staticStyle:{width:"200px","margin-top":"50px","border-radius":"20px"},on:{click:function(t){return e.restartNascab()}}},[e._v(" "+e._s(e.$t("setting.reLaunchNasCab"))+" ")]),s("vs-button",{staticStyle:{width:"200px","margin-top":"50px","border-radius":"20px"},attrs:{border:""},on:{click:function(t){return e.$refs.resetDialog.setShow(!0)}}},[e._v(" "+e._s(e.$t("setting.resetSystem"))+" ")])],1),s("my-dialog-input",{ref:"resetDialog",attrs:{placeholder:e.$t("registerAdmin.placeholderPassword"),showCloseBtn:!0,content:e.$t("setting.resetSystemAlert"),title:e.$t("setting.resetSystem")},on:{onOkClick:e.resetSystemApi}}),s("Modal",{attrs:{"footer-hide":""},model:{value:e.showUpdateLogDialog,callback:function(t){e.showUpdateLogDialog=t},expression:"showUpdateLogDialog"}},[e.showUpdateLogDialog?s("iframe",{staticStyle:{width:"100%",height:"80vh",border:"none"},attrs:{src:e.iframeUrl}}):e._e()]),s("vs-dialog",{attrs:{"prevent-close":"",scroll:"","full-screen":e.isMobile},scopedSlots:e._u([{key:"header",fn:function(){return[s("h4",{staticStyle:{"font-size":"16px"}},[e._v(" "+e._s(e.$t("setting.changeCachePath"))+" ")])]},proxy:!0},{key:"footer",fn:function(){return[s("file-select-bar",{on:{back:function(t){return e.$refs.fileSelector.goBack()},select:function(t){return e.$refs.fileSelector.onSelect()},create:function(t){return e.$refs.fileSelector.createNewFolder(t)}}})]},proxy:!0}],null,!1,2216711454),model:{value:e.showChangeCachePath,callback:function(t){e.showChangeCachePath=t},expression:"showChangeCachePath"}},[e.showChangeCachePath?s("file-select",{ref:"fileSelector",attrs:{parent:"root",type:2},on:{onSelect:e.onSelectCachePath,onCancel:function(t){e.showChangeCachePath=!1}}}):e._e()],1)],1):e._e()},[],!1,null,"61a53186",null).exports,c=s("044b"),h=s("c7f3"),u=s("be3b");s("d930"),u.a.nasCabBaseUrl;let p=(v=u.a.nasCabBaseUrl+"/userCenter/#/")+"?iframeMode=1",m=v+"pages/vip/vip?iframeMode=1",d=v+"pages/contactUs/contactUs",g=v+"pages/marketing/marketing",f=v+"pages/addUser/addUser";var v={data(){return{showAddUserDiaolog:!1,marketingUrl:g,loadUrl:p,showUserLoginDialog:!1,showBuyVipDialog:!1,userToken:"",currentNasUserInfo:"",currentVipInfo:"",proxyState:""}},mounted(){window.addEventListener("message",this.dealIframeMessage),this.getNasAccountInfo()},beforeDestroy(){window.removeEventListener("message",this.dealIframeMessage)},methods:{reconnect(){},showContactUs(){this.loadUrl=d,this.showUserLoginDialog=!0},showAddUser(){this.loadUrl=f+"?token="+this.userToken,this.$store.state.language&&(this.loadUrl+="&language="+this.$store.state.language),this.showUserLoginDialog=!0},toNasUserInfo(){var t=encodeURIComponent(window.location.href);this.loadUrl=p+`&target=userInfo&token=${this.userToken}&returnUrl=`+t,this.$store.state.language&&(this.loadUrl+="&language="+this.$store.state.language),this.showUserLoginDialog=!0},toNasLogin(){var t=encodeURIComponent(window.location.href);this.loadUrl=p+"&returnUrl="+t,this.$store.state.language&&(this.loadUrl+="&language="+this.$store.state.language),this.showUserLoginDialog=!0},toBuyVip(){return 1==localStorage.ios?this.showVsNotification(this.$t("common.buyVipInPc")):this.currentNasUserInfo?(this.loadUrl=m+"&token="+this.userToken,this.$store.state.language&&(this.loadUrl+="&language="+this.$store.state.language),void(this.showBuyVipDialog=!0)):this.showVsNotification(this.$t("nascab.loginFirst"))},dealIframeMessage(t){var e;t.data&&"loginSuccess"==t.data.type?(this.showUserLoginDialog=!1,e=JSON.parse(t.data.data),this.userToken=e.token,this.tokenLogin()):t.data&&"payDone"==t.data.type&&(this.showBuyVipDialog=!1,this.tokenLogin())},nasCabLogout(){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("header.okLogout"),()=>{this.api.post("/api/nasAccountApi/nasCabLogout",{}).then(t=>{t.code||(this.showVsNotification(this.$t("header.logoutSuccess")),this.getNasAccountInfo())}).catch(t=>{})})},tokenLogin(){this.api.post("/api/nasAccountApi/nasCabLoginByToken",{nascabToken:this.userToken}).then(t=>{t.code||this.showVsNotification(this.$t("login.success")),this.getNasAccountInfo()}).catch(t=>{this.getNasAccountInfo()})},getNasAccountInfo(){this.api.post("/api/nasAccountApi/getNasAccountInfo",{hideLoading:!0}).then(t=>{t.code||(this.currentNasUserInfo=t.data.userInfo,this.currentVipInfo=t.data.vipInfo,this.currentNasUserInfo&&this.currentNasUserInfo.token&&0<this.currentNasUserInfo.token.length&&(this.userToken=this.currentNasUserInfo.token[this.currentNasUserInfo.token.length-1]),this.proxyState=t.proxyState)}).catch(t=>{})}},components:{MyBtn:c.a,Divider:h.a}};s("dcab");v=Object(a.a)(v,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"nas-account-root"},[t("h3",[e._v(e._s(e.$t("nascab.account")))]),t("Divider"),t("div",{staticClass:"list-root"},[t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v(e._s(e.$t("common.username"))+":")]),t("span",{staticClass:"enable-text-select"},[e._v(e._s(e.currentNasUserInfo?e.currentNasUserInfo.nickname:e.$t("nascab.notLogin")))]),t("a",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.toNasLogin()}}},[e._v(" "+e._s(e.currentNasUserInfo?e.$t("nascab.switchAccount"):e.$t("login.goLogin")))]),this.currentNasUserInfo?t("a",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.tokenLogin()}}},[e._v(" "+e._s(e.$t("common.refresh")))]):e._e()]),e.currentVipInfo?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v("NasCab ID:")]),t("span",{staticClass:"enable-text-select"},[e._v(e._s(e.currentNasUserInfo._id))])]):e._e(),e.currentVipInfo&&e.currentVipInfo.type<2?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v(e._s(e.$t("user.subCountNum"))+":")]),t("span",[e._v(e._s(e.currentVipInfo.sub_account_num))])]):e._e(),t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v(e._s(e.$t("nascab.version"))+":")]),e.currentVipInfo?e._e():t("span",[e._v(e._s(e.$t("nascab.versionFree")))]),e.currentVipInfo&&1==e.currentVipInfo.type?t("span",[e._v(e._s(e.$t("nascab.versionPro"))+" ")]):e._e(),e.currentVipInfo&&2==e.currentVipInfo.type?t("span",[e._v(e._s(e.$t("nascab.versionTeam"))+" ")]):e._e(),!e.currentVipInfo||e.currentVipInfo&&1==e.currentVipInfo.type?t("a",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.toBuyVip()}}},[e._v(" "+e._s(e.$t("nascab.upgrade")))]):e._e()]),e.currentVipInfo?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v(e._s(e.$t("nascab.validUntil"))+":")]),e._v(" "+e._s(e.utils.formatTimeStamp(e.currentVipInfo.end_date))+" "),t("a",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.toBuyVip()}}},[e._v(" "+e._s(e.$t("nascab.renewal")))])]):e._e(),e.currentNasUserInfo&&e.currentNasUserInfo.mobile?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left",staticStyle:{"margin-right":"10px"}},[e._v(e._s(e.$t("nascab.phone"))+":")]),t("span",[e._v(e._s(e.currentNasUserInfo.mobile))])]):e._e(),e.currentNasUserInfo&&e.currentNasUserInfo.email?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left",staticStyle:{"margin-right":"10px"}},[e._v(e._s(e.$t("nascab.email"))+":")]),t("span",[e._v(e._s(e.currentNasUserInfo.email))])]):e._e(),t("a",{staticStyle:{"margin-top":"10px"},on:{click:e.showContactUs}},[e._v(e._s(e.$t("nascab.contactServe")))]),e.currentNasUserInfo?t("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center","margin-top":"20px","flex-direction":"column","align-items":"center"}},[t("my-btn",{staticStyle:{width:"300px"},attrs:{title:e.$t("nascab.exitAccount"),type:"white"},on:{click:e.nasCabLogout}})],1):e._e()]),t("Modal",{attrs:{"footer-hide":""},model:{value:e.showUserLoginDialog,callback:function(t){e.showUserLoginDialog=t},expression:"showUserLoginDialog"}},[e.showUserLoginDialog?t("iframe",{staticStyle:{width:"100%",height:"550px",border:"none"},attrs:{src:e.loadUrl,scrolling:"no"}}):e._e()]),t("Modal",{attrs:{"footer-hide":"",fullscreen:""},model:{value:e.showBuyVipDialog,callback:function(t){e.showBuyVipDialog=t},expression:"showBuyVipDialog"}},[e.showBuyVipDialog?t("iframe",{staticStyle:{width:"100%",height:"100%",border:"none"},attrs:{src:e.loadUrl}}):e._e()]),e.marketingUrl&&e.currentNasUserInfo?t("iframe",{staticStyle:{width:"100%",height:"600px",border:"none"},attrs:{src:e.marketingUrl}}):e._e()],1)},[],!1,null,"b558fa4e",null).exports;u.a.nasCabBaseUrl;let _=(x=u.a.nasCabBaseUrl+"/userCenter/#/")+"?iframeMode=1",w=x+"pages/proxy/proxy?iframeMode=1&isProxyDomain=1";var x={data(){return{showSwitchRoute:!1,pluginPath:"",pluginExists:!0,remoteEnable:!0,loadUrl:_,showIframeDialog:!1,userToken:"",currentNasUserInfo:"",currentVipInfo:"",proxyState:"",timer:null,proxyServerList:[],selectedServer:null}},mounted(){window.addEventListener("message",this.dealIframeMessage),this.getNasAccountInfo(),this.getProxyState(),this.timer=setInterval(()=>{this.getProxyState()},5e3)},beforeDestroy(){window.removeEventListener("message",this.dealIframeMessage),this.timer&&clearInterval(this.timer)},methods:{getServerStateRate(t){try{return t.server_bandwidth&&t.user_count?parseInt(t.user_count)/parseInt(t.server_bandwidth):1}catch(t){return 1}},doSwitchRoute(t){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("proxy.switchAlert"),()=>{this.switchServer(t)},()=>{})},switchServer(t){this.reconnect(t._id)},remoteEnableSwitch(t){t?this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("nascab.sureEnableRemote"),()=>{this.switchApi(1)},()=>{this.remoteEnable=!1}):this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("nascab.sureDisableRemote"),()=>{this.switchApi(0)},()=>{this.remoteEnable=!0})},switchApi(t){this.api.post("/api/nasAccountApi/setRemoteEnable",{nasRemoteEnable:t}).then(t=>{t.code?this.showVsNotification(this.$t("common.operationFail")):this.showVsNotification(this.$t("common.operationSuccess"))})},installFrpc(){var t=this.$t("proxy.firewallAlert")+","+this.$t("proxy.frpcGithub");this.showVsConfirmDialog(this.$t("common.confirm"),t,()=>{this.api.post("/api/nasAccountApi/downloadFrpc",{}).then(t=>{t.code||this.showVsNotification(this.$t("proxy.installMsgSent"))})},null,this.$t("proxy.downloadFrp"))},goPath(t){this.$router.push({path:t})},lanIpClick(t){var e=navigator.clipboard;e&&(e.writeText(t+this.currentVipInfo.proxy_subdomain+this.currentVipInfo.proxyDomain),this.showVsNotification(this.$t("system.copied")))},reconnect(t){this.api.post("/api/nasAccountApi/reconnectRemote",{serverId:t}).then(t=>{this.showVsAlertDialog(this.$t("common.alert"),this.$t("nascab.reconnectSent"),()=>{})}).catch(t=>{})},getProxyState(){this.api.post("/api/nasAccountApi/getProxyState",{hideLoading:!0}).then(t=>{if(!t.code&&(this.proxyState=t.proxyState,this.pluginExists=t.pluginExists,this.pluginPath=t.pluginPath,t.proxyServerList)&&(this.proxyServerList=JSON.parse(t.proxyServerList),this.proxyServerList))for(var e of this.proxyServerList)e.netRate=this.getServerStateRate(e),e.selected&&(this.selectedServer=e)}).catch(t=>{})},toSetDomain(){return this.currentVipInfo?this.currentNasUserInfo?(this.loadUrl=w+"&token="+this.userToken,this.$store.state.language&&(this.loadUrl+="&language="+this.$store.state.language),void(this.showIframeDialog=!0)):this.showVsAlertDialog(this.$t("common.alert"),this.$t("nascab.loginFirst"),()=>{this.$emit("onToLogin")}):this.showVsAlertDialog(this.$t("common.alert"),this.$t("nascab.needUpgrade"),()=>{this.$emit("onToLogin")})},dealIframeMessage(t){t.data&&"setSubdomainDone"==t.data.type&&(this.showIframeDialog=!1,this.tokenLogin())},tokenLogin(){this.api.post("/api/nasAccountApi/nasCabLoginByToken",{nascabToken:this.userToken}).then(t=>{t.code||this.showVsNotification(this.$t("login.success")),this.getNasAccountInfo()}).catch(t=>{this.getNasAccountInfo()})},getNasAccountInfo(){this.api.post("/api/nasAccountApi/getNasAccountInfo",{hideLoading:!1}).then(t=>{t.code||(this.currentNasUserInfo=t.data.userInfo,this.currentVipInfo=t.data.vipInfo,this.currentNasUserInfo&&this.currentNasUserInfo.token&&0<this.currentNasUserInfo.token.length&&(this.userToken=this.currentNasUserInfo.token[this.currentNasUserInfo.token.length-1]),this.proxyState=t.proxyState,this.remoteEnable=t.nasRemoteEnable&&1==parseInt(t.nasRemoteEnable))}).catch(t=>{})}},components:{MyBtn:c.a,Divider:h.a}};s("6f95");x=Object(a.a)(x,function(){var s=this,t=s.$createElement,i=s._self._c||t;return i("div",{staticClass:"remote-root"},[i("div",{staticClass:"nas-account-root"},[i("Divider",[s._v(s._s(s.$t("nascab.remoteAccessMenu")))]),i("div",{staticClass:"list-root"},[i("div",{staticClass:"item-root"},[i("span",{staticClass:"item-text-left"},[s._v(s._s(s.$t("nascab.remoteAccess"))+":")]),s.currentVipInfo&&s.currentVipInfo.proxy_subdomain?i("vs-tooltip",{scopedSlots:s._u([{key:"tooltip",fn:function(){return[s._v(" "+s._s(s.$t("nascab.pleaseOpenTwoStepsLogin"))+" ")]},proxy:!0}],null,!1,2965150514)},[s.currentVipInfo&&s.currentVipInfo.proxy_subdomain?i("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[i("a",{staticClass:"enable-text-select",on:{click:function(t){return s.lanIpClick("https://")}}},[s._v("https://"+s._s(s.currentVipInfo.proxy_subdomain)+s._s(s.currentVipInfo.proxyDomain))])]):s._e()]):i("a",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return s.toSetDomain()}}},[s._v(" "+s._s(s.$t("photo.goToSet")))])],1),s.currentVipInfo&&s.currentVipInfo.proxy_subdomain?i("div",{staticClass:"item-root"},[i("span",{staticClass:"item-text-left",staticStyle:{"flex-shrink":"0"}},[s._v(s._s(s.$t("proxy.pluginState"))+":")]),i("div",{staticClass:"link-state-root"},[i("div",{staticStyle:{"margin-right":"10px","text-align":"left"}},[s.currentVipInfo&&s.currentVipInfo.proxy_subdomain?i("vs-tooltip",{scopedSlots:s._u([{key:"tooltip",fn:function(){return[i("p",{staticStyle:{"word-break":"break-all"}},[s._v(" "+s._s(s.$t("proxy.pluginPath"))+":"+s._s(s.pluginPath))])]},proxy:!0}],null,!1,3154080897)},[s.pluginExists?i("span",{staticClass:"icon-main-color",staticStyle:{"flex-shrink":"0","text-align":"left"}},[s._v(s._s(s.$t("proxy.installed")))]):i("span",{staticStyle:{color:"red","flex-shrink":"0","max-width":"600px","text-align":"left"}},[s._v(s._s(s.$t("proxy.uninstalled")))])]):s._e()],1),i("div",{staticStyle:{display:"flex","align-items":"center"}},[s.currentVipInfo&&s.currentVipInfo.proxy_subdomain?i("vs-tooltip",{scopedSlots:s._u([{key:"tooltip",fn:function(){return[s._v(" "+s._s(s.$t("proxy.firewallAlert"))+" ")]},proxy:!0}],null,!1,4166999734)},[s.pluginExists?s._e():i("vs-button",{staticStyle:{height:"25px","line-height":"25px","flex-shrink":"0","min-width":"60px"},attrs:{flat:"",border:""},on:{click:function(t){return s.installFrpc()}}},[s._v(" "+s._s(s.$t("proxy.installPlugin")))])],1):s._e()],1)])]):s._e(),s.currentVipInfo&&s.currentVipInfo.proxy_subdomain&&s.pluginExists&&s.remoteEnable?i("div",{staticClass:"item-root"},[i("span",{staticClass:"item-text-left",staticStyle:{"flex-shrink":"0"}},[s._v(s._s(s.$t("nascab.connectState"))+":")]),i("div",{staticClass:"link-state-root"},[i("div",{staticStyle:{"margin-right":"10px","text-align":"left"}},[s.proxyState&&"success"==s.proxyState.status?i("span",{staticClass:"icon-main-color",staticStyle:{"flex-shrink":"0","text-align":"left"}},[s._v(s._s(s.$t("nascab.online")))]):s.proxyState&&s.proxyState.error?i("span",{staticStyle:{color:"red","flex-shrink":"0","max-width":"600px","text-align":"left"}},[s._v(s._s(s.proxyState.error))]):s._e()]),s.remoteEnable?i("div",{staticStyle:{display:"flex","align-items":"center"}},[s.currentVipInfo&&s.currentVipInfo.proxy_subdomain&&s.pluginExists?i("vs-tooltip",{scopedSlots:s._u([{key:"tooltip",fn:function(){return[s._v(" "+s._s(s.$t("nascab.sameAccountLogin"))+" ")]},proxy:!0}],null,!1,3802518558)},[i("vs-button",{staticStyle:{height:"25px","line-height":"25px","flex-shrink":"0","min-width":"60px"},attrs:{flat:"",border:""},on:{click:function(t){return s.getNasAccountInfo()}}},[s._v(" "+s._s(s.$t("common.refresh")))])],1):s._e(),s.currentVipInfo&&s.currentVipInfo.proxy_subdomain&&s.pluginExists?i("vs-tooltip",{scopedSlots:s._u([{key:"tooltip",fn:function(){return[s._v(" "+s._s(s.$t("nascab.proxyDelay"))+" ")]},proxy:!0}],null,!1,408433343)},[i("vs-button",{staticStyle:{height:"25px","line-height":"25px","flex-shrink":"0","min-width":"60px"},attrs:{flat:"",border:""},on:{click:function(t){return s.reconnect()}}},[s._v(s._s(s.$t("reconnect")))])],1):s._e()],1):s._e()])]):s._e(),s.currentVipInfo&&s.currentVipInfo.proxy_subdomain&&s.pluginExists&&s.proxyServerList&&0<s.proxyServerList.length&&s.selectedServer&&s.remoteEnable?i("div",{staticClass:"item-root"},[i("span",{staticClass:"item-text-left",staticStyle:{"flex-shrink":"0"}},[s._v(s._s(s.$t("nascab.connectLine"))+":")]),i("div",{staticClass:"link-state-root"},[i("div",{staticStyle:{"margin-right":"10px","text-align":"left"}},[i("span",{staticStyle:{"flex-shrink":"0","max-width":"600px","text-align":"left"}},[s._v(s._s(s.selectedServer.show_name)+" ("+s._s(s.selectedServer.ping_time)+" ms)")]),s.selectedServer&&s.selectedServer.netRate<1.3?i("span",{staticStyle:{"margin-left":"5px",color:"green"}},[s._v("("+s._s(s.$t("proxy.smooth"))+")")]):s._e(),s.selectedServer&&1.3<=s.selectedServer.netRate&&s.selectedServer.netRate<=2.3?i("span",{staticStyle:{"margin-left":"5px",color:"blue"}},[s._v("("+s._s(s.$t("proxy.normal"))+")")]):s._e(),s.selectedServer&&2.3<s.selectedServer.netRate?i("span",{staticStyle:{"margin-left":"5px",color:"red"}},[s._v("("+s._s(s.$t("proxy.busy"))+")")]):s._e()]),s.remoteEnable?i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("vs-button",{staticClass:"switch-btn",attrs:{flat:"",border:""},on:{click:function(t){s.showSwitchRoute=!0}}},[s._v(" "+s._s(s.$t("switch")))])],1):s._e()])]):s._e(),s.currentVipInfo&&s.currentVipInfo.proxy_subdomain&&s.pluginExists?i("div",{staticClass:"item-root"},[i("span",{staticClass:"item-text-left"},[s._v(s._s(s.$t("nascab.isEnable"))+":")]),i("i-switch",{on:{"on-change":s.remoteEnableSwitch},model:{value:s.remoteEnable,callback:function(t){s.remoteEnable=t},expression:"remoteEnable"}})],1):s._e(),i("div",{staticStyle:{color:"#999"}},[s._v(" "+s._s(s.$t("proxy.cannotLoginMulti")))]),i("Divider",[s._v(s._s(s.$t("common.faq")))]),i("div",{staticClass:"faqItem"},[s._v(s._s(s.$t("proxy.faqContent1")))]),i("div",{staticClass:"faqItem"},[s._v(s._s(s.$t("proxy.faqContent2")))]),i("div",{staticClass:"faqItem"},[s._v(s._s(s.$t("proxy.faqContent3")))]),i("div",{staticClass:"faqItem"},[s._v(s._s(s.$t("proxy.faqContent4")))]),i("div",{staticClass:"faqItem"},[s._v(s._s(s.$t("proxy.faqContent5")))])],1),i("vs-dialog",{attrs:{"overflow-hidden":"","full-screen":""},model:{value:s.showIframeDialog,callback:function(t){s.showIframeDialog=t},expression:"showIframeDialog"}},[s.showIframeDialog?i("iframe",{staticClass:"iframe",attrs:{scrolling:"auto",src:s.loadUrl}}):s._e()]),i("vs-dialog",{attrs:{scroll:""},scopedSlots:s._u([{key:"header",fn:function(){return[i("h4",{staticClass:"not-margin"},[s._v(" "+s._s(s.$t("proxy.routeList"))+" ")])]},proxy:!0}]),model:{value:s.showSwitchRoute,callback:function(t){s.showSwitchRoute=t},expression:"showSwitchRoute"}},s._l(s.proxyServerList,function(e,t){return s.proxyServerList&&s.showSwitchRoute&&e.alive?i("div",[i("div",{staticClass:"server-root"},[i("p",[s._v(s._s(e.show_name)+" ("+s._s(e.ping_time)+"ms)")]),e&&e.netRate<1.5?i("span",{staticStyle:{"margin-left":"5px",color:"green"}},[s._v("("+s._s(s.$t("proxy.smooth"))+")")]):s._e(),e&&1.5<=e.netRate&&e.netRate<=3?i("span",{staticStyle:{"margin-left":"5px",color:"blue"}},[s._v("("+s._s(s.$t("proxy.normal"))+")")]):s._e(),e&&3<e.netRate?i("span",{staticStyle:{"margin-left":"5px",color:"red"}},[s._v("("+s._s(s.$t("proxy.busy"))+")")]):s._e(),s.selectedServer._id==e._id?i("vs-button",{staticClass:"switch-btn",attrs:{flat:"",border:"",disabled:""}},[s._v(" "+s._s(s.$t("proxy.currentRoute"))+" ")]):s._e(),s.selectedServer._id!=e._id?i("vs-button",{staticClass:"switch-btn",attrs:{flat:"",border:""},on:{click:function(t){return s.doSwitchRoute(e)}}},[s._v(" "+s._s(s.$t("switch"))+" ")]):s._e()],1)]):s._e()}),0)],1)])},[],!1,null,"9838720c",null).exports;u.a.nasCabBaseUrl;let y=(S=u.a.nasCabBaseUrl+"/userCenter/#/")+"?iframeMode=1",b=S+"pages/proxy/proxy?iframeMode=1";var S={data(){return{ddnsIp:"",useNasCabCerts:!1,ddnsType:"ipv4",ddnsEnable:!0,loadUrl:y,showIframeDialog:!1,userToken:"",currentNasUserInfo:"",currentVipInfo:"",ddnsState:"",timer:null,customProxIp:"",customProxPort:""}},mounted(){window.addEventListener("message",this.dealIframeMessage),this.getNasAccountInfo(),null==this.timer&&(this.timer=setInterval(this.getDDNSState,5e3)),this.getDDNSState(),this.getDDNSType()},beforeDestroy(){window.removeEventListener("message",this.dealIframeMessage),this.timer&&(clearInterval(this.timer),this.timer=null)},methods:{getDDNSType(){this.api.post("/api/commonApi/getAllConfig",{keys:"('ddnsType','useNasCabCerts')"}).then(e=>{for(let t=0;t<e.data.allConfig.length;t++){var s=e.data.allConfig[t];"ddnsType"==s.title?this.ddnsType=s.value:"useNasCabCerts"==s.title&&(this.useNasCabCerts=1==s.value)}}).catch(t=>{})},setDdnsType(t){this.api.post("/api/nasAccountApi/setDdnsType",{ddnsType:t}).then(t=>{t.code?this.showVsNotification(this.$t("common.operationFail")):this.showVsNotification(this.$t("common.operationSuccess"))})},switchHttpsCertApi(t){this.api.post("/api/nasAccountApi/setUseNasCabCert",{useNasCabCerts:t}).then(t=>{t.code?this.showVsNotification(this.$t("common.operationFail")):this.showVsNotification(this.$t("common.operationSuccess"))})},httpsCertSwitch(t){t?this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("nascab.useNasCabCertAlert"),()=>{this.switchHttpsCertApi(1)},()=>{this.useNasCabCerts=!1}):this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("nascab.useNasCabCertCloseAlert"),()=>{this.switchHttpsCertApi(0)},()=>{this.useNasCabCerts=!0})},ddnsEnableSwitch(t,e){t?e?this.switchApi(1):this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("nascab.sureEnableDDNS"),()=>{this.switchApi(1)},()=>{this.ddnsEnable=!1}):this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("nascab.sureDisableDDNS"),()=>{this.switchApi(0)},()=>{this.ddnsEnable=!0})},switchApi(t){this.api.post("/api/nasAccountApi/setDdnsEnable",{nasDdnsEnable:t}).then(t=>{t.code?this.showVsNotification(this.$t("common.operationFail")):this.showVsNotification(this.$t("common.operationSuccess"))})},goPath(t){this.$router.push({path:t})},lanIpClick(t){var e=navigator.clipboard;e&&(e.writeText(t+this.currentVipInfo.subdomain+this.currentVipInfo.proxyDomain),this.showVsNotification(this.$t("system.copied")))},getDDNSState(){this.api.post("/api/nasAccountApi/getDDNSState",{hideLoading:!0}).then(t=>{t.code||(this.ddnsState=t.ddnsState,this.ddnsIp=this.ddnsState.ddnsIp||"")}).catch(t=>{})},toSetDomain(){return this.currentVipInfo?this.currentNasUserInfo?(this.loadUrl=b+"&token="+this.userToken,this.$store.state.language&&(this.loadUrl+="&language="+this.$store.state.language),void(this.showIframeDialog=!0)):this.showVsAlertDialog(this.$t("common.alert"),this.$t("nascab.loginFirst"),()=>{this.$emit("onToLogin")}):this.showVsAlertDialog(this.$t("common.alert"),this.$t("nascab.needUpgrade"),()=>{this.$emit("onToLogin")})},dealIframeMessage(t){t.data&&"setSubdomainDone"==t.data.type&&(this.showIframeDialog=!1,this.tokenLogin())},tokenLogin(){this.api.post("/api/nasAccountApi/nasCabLoginByToken",{nascabToken:this.userToken}).then(t=>{t.code||this.showVsNotification(this.$t("login.success")),this.getNasAccountInfo()}).catch(t=>{this.getNasAccountInfo()})},getNasAccountInfo(){this.api.post("/api/nasAccountApi/getNasAccountInfo",{hideLoading:!1}).then(t=>{t.code||(this.currentNasUserInfo=t.data.userInfo,this.currentVipInfo=t.data.vipInfo,this.currentNasUserInfo&&this.currentNasUserInfo.token&&0<this.currentNasUserInfo.token.length&&(this.userToken=this.currentNasUserInfo.token[this.currentNasUserInfo.token.length-1]),this.ddnsState=t.ddnsState,this.ddnsEnable=t.nasDdnsEnable&&1==parseInt(t.nasDdnsEnable))}).catch(t=>{})}},components:{MyBtn:c.a,Divider:h.a}};s("a5e8");c=Object(a.a)(S,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"remote-root"},[t("div",{staticClass:"nas-account-root"},[t("Divider",[e._v("DDNS"),t("Icon",{staticStyle:{"margin-left":"10px"},attrs:{type:"ios-help-circle-outline"},on:{click:function(t){e.showVsAlertDialog(e.$t("common.alert"),e.$t("setting.ddnsExplain"))}}})],1),t("div",{staticClass:"list-root"},[t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v(e._s(e.$t("nascab.ddnsDomain"))+":")]),e.currentVipInfo&&e.currentVipInfo.subdomain?t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[t("a",{staticClass:" enable-text-select",on:{click:function(t){return e.lanIpClick("https://")}}},[e._v(e._s(e.currentVipInfo.subdomain)+e._s(e.currentVipInfo.proxyDomain))])]):t("a",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.toSetDomain()}}},[e._v(" "+e._s(e.$t("photo.goToSet")))])]),e.currentVipInfo&&e.currentVipInfo.subdomain?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left",staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.$t("nascab.ddnsIp"))+":")]),t("div",{staticClass:"link-state-root"},[t("div",{staticClass:"flex-row",staticStyle:{"margin-right":"10px","text-align":"left","flex-wrap":"wrap"}},[e.ddnsIp?t("span",{staticClass:"icon-main-color enable-text-select",staticStyle:{"flex-shrink":"0","text-align":"left"}},[e._v(" "+e._s(e.ddnsIp))]):t("span",{staticStyle:{color:"red","flex-shrink":"0","max-width":"600px","text-align":"left"}},[e._v(e._s(e.ddnsState?e.ddnsState.error:""))]),e.ddnsEnable?t("vs-button",{staticStyle:{height:"25px","line-height":"25px","flex-shrink":"0","min-width":"60px","margin-left":"10px"},attrs:{flat:"",border:""},on:{click:function(t){return e.ddnsEnableSwitch(!0,!0)}}},[e._v(e._s(e.$t("common.refresh")))]):e._e()],1)])]):e._e(),e.currentVipInfo&&e.currentVipInfo.subdomain?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v(e._s(e.$t("nascab.ddnsType"))+":")]),t("RadioGroup",{on:{"on-change":e.setDdnsType},model:{value:e.ddnsType,callback:function(t){e.ddnsType=t},expression:"ddnsType"}},[t("Radio",{attrs:{label:"ipv4"}},[t("span",[e._v("IPV4")])]),t("Radio",{attrs:{label:"ipv6"}},[t("span",[e._v("IPV6")])])],1)],1):e._e(),e.currentVipInfo&&e.currentVipInfo.subdomain?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v(e._s(e.$t("nascab.isEnable"))+" DDNS:")]),t("i-switch",{on:{"on-change":e.ddnsEnableSwitch},model:{value:e.ddnsEnable,callback:function(t){e.ddnsEnable=t},expression:"ddnsEnable"}})],1):e._e(),e.currentVipInfo&&e.currentVipInfo.subdomain?t("div",{staticClass:"item-root"},[t("span",{staticClass:"item-text-left"},[e._v(e._s(e.$t("nascab.useNasCabCert"))+":")]),t("i-switch",{on:{"on-change":e.httpsCertSwitch},model:{value:e.useNasCabCerts,callback:function(t){e.useNasCabCerts=t},expression:"useNasCabCerts"}})],1):e._e(),t("Divider",[e._v(e._s(e.$t("common.faq")))]),t("div",{staticClass:"faqItem"},[e._v(e._s(e.$t("ddns.faqContent1")))]),t("div",{staticClass:"faqItem"},[e._v(e._s(e.$t("ddns.faqContent2")))]),t("div",{staticClass:"faqItem"},[e._v(e._s(e.$t("ddns.faqContent3")))]),t("div",{staticClass:"faqItem"},[e._v(e._s(e.$t("ddns.faqContent4")))]),t("div",{staticClass:"faqItem"},[e._v(e._s(e.$t("ddns.faqContent5")))])],1),t("vs-dialog",{attrs:{"overflow-hidden":"","full-screen":""},model:{value:e.showIframeDialog,callback:function(t){e.showIframeDialog=t},expression:"showIframeDialog"}},[e.showIframeDialog?t("iframe",{staticClass:"iframe",attrs:{scrolling:"auto",src:e.loadUrl}}):e._e()])],1)])},[],!1,null,"3e0b3563",null).exports,h={mounted(){this.getAllConfig();var t=localStorage.getItem("bgIndex");t&&(t=parseInt(t),this.bgIndex=t),this.setImageUrls()},computed:{},components:{},data(){return{chooseFileTitle:"",showChooseFile:!1,chooseFileType:"",shareUrl:"",shareProtocol:"http://",showMenuList:["photoManage","musicManage","movieManage","filesBrower","backup","sharing","privateSpace","security","books"],customLoginTitle:"",customLoginImage:"",customHomeBgImage:"",customLogoImage:"",bgIndex:1,loginImageUrl:"",logoImageUrl:"",bgUrl:""}},methods:{setImageUrls(){this.loginImageUrl=this.getLoginImageUrl(),this.logoImageUrl=this.getLogoImageUrl(),this.bgUrl=this.getBgUrl()},getLoginImageUrl(){return localStorage.customLoginImage?u.a.getCustomFileUrl(localStorage.customLoginImage)+"&time="+(new Date).getTime():s("952d")},getLogoImageUrl(){return localStorage.customLogoImage?u.a.getCustomFileUrl(localStorage.customLogoImage)+"&time="+(new Date).getTime():s("9743")},getBgUrl:function(){return localStorage.customHomeBgImage?u.a.getCustomFileUrl(localStorage.customHomeBgImage)+"&time="+(new Date).getTime():s("341e")("./"+this.bgIndex+".jpg")},onSelectFileSuc(t){var e;t&&(0<=(e=t.lastIndexOf("."))&&(e=t.substring(e).replace(".","").toLowerCase(),["jpg","jpeg","webp","png"].includes(e))?((e={})[this.chooseFileType]=t,this.saveConfigCustom(e),this.showChooseFile=!1):this.showVsAlertDialog(this.$t("common.alert"),this.$t("onlySupportCustomImageFormat")))},onClickChangeWelcomeMassage(t){var e;15<t.length?this.showVsAlertDialog(this.$t("common.alert"),this.$t("yourInputTooLong",{count:"15"})):t&&((e={}).customLoginTitle=t,this.saveConfigCustom(e))},onClickChooseLoginImage(){this.chooseFileType="customLoginImage",this.chooseFileTitle=this.$t("loginImg"),this.showChooseFile=!0},onClickChooseHomeImage(){this.chooseFileType="customHomeBgImage",this.chooseFileTitle=this.$t("homeBg"),this.showChooseFile=!0},onClickChooseLogo(){this.chooseFileType="customLogoImage",this.chooseFileTitle=this.$t("logoLeft"),this.showChooseFile=!0},clearConfig(t){var e={};e[t]="-",this.saveConfigCustom(e)},onMenuChange(t){this.saveConfig(t)},saveShareUrl(){if(!this.shareUrl)return this.showVsNotification(this.$t("cannotBeEmpty",{content:"URL"}));this.saveConfig(null,this.shareProtocol+this.shareUrl)},saveConfig(t,e){var s={};e&&(s.customShareUrl=e),t&&(s.showMenuArr=t),this.api.post("/api/commonApi/saveConfig",s).then(t=>{this.showVsNotification(this.$t("setting.saveSuccess")),this.getAllConfig()}).catch(t=>{})},saveConfigCustom(t){this.api.post("/api/commonApi/saveConfigCustom",t).then(t=>{this.showVsNotification(this.$t("setting.saveSuccess")),this.getAllConfig()}).catch(t=>{})},getAllConfig(){this.api.post("/api/commonApi/getAllConfig",{keys:"('showMenuArr','customShareUrl','customLogoImage','customLoginTitle','customLoginImage','customHomeBgImage')"}).then(e=>{this.customLoginTitle="",localStorage.removeItem("customHomeBgImage"),localStorage.removeItem("customLoginImage"),localStorage.removeItem("customLoginTitle"),localStorage.removeItem("customLogoImage");for(let t=0;t<e.data.allConfig.length;t++){var s=e.data.allConfig[t];"showMenuArr"==s.title?this.showMenuList=JSON.parse(s.value):"customShareUrl"==s.title?(-1!=s.value.indexOf("http://")?this.shareProtocol="http://":this.shareProtocol="https://",this.shareUrl=s.value.replace("http://","").replace("https://","")):"customLogoImage"==s.title&&"-"!=s.value?(this.customLogoImage=s.value,localStorage.customLogoImage=s.value):"customLoginTitle"==s.title&&"-"!=s.value?(this.customLoginTitle=s.value,localStorage.customLoginTitle=s.value):"customLoginImage"==s.title&&"-"!=s.value?(this.customLoginImage=s.value,localStorage.customLoginImage=s.value):"customHomeBgImage"==s.title&&"-"!=s.value&&(this.customHomeBgImage=s.value,localStorage.customHomeBgImage=s.value)}this.setImageUrls()}).catch(t=>{})}}};s("2e77");S={mounted(){this.$route.query&&this.$route.query.pageName&&this.$nextTick(()=>{this.$refs.sidebar.setSelectById(this.$route.query.pageName),this.$refs.sidebarMobile.setSelectById(this.$route.query.pageName),this.leftIndex=this.$route.query.index}),this.$route.query.newToken&&0<this.$route.query.newToken.length&&(this.$refs.sidebar.setSelectById("nasAccount"),this.$refs.sidebarMobile.setSelectById("nasAccount"),this.leftIndex="nasAccount",this.$nextTick(()=>{this.$refs.nasAccount.userToken=this.$route.query.newToken,this.$refs.nasAccount.tokenLogin()}))},beforeDestroy(){},components:{custom:Object(a.a)(h,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"setting-root-wrapper"},[s("b",[e._v(e._s(e.$t("shareDomainSetting")))]),s("p",{staticClass:"text-grey",staticStyle:{"text-align":"left"}},[e._v(e._s(e.$t("shareDomainAlert")))]),s("Input",{staticStyle:{"margin-top":"10px","max-width":"600px"},attrs:{search:"","enter-button":e.$t("common.save"),placeholder:"xxxxxx.nas-cab.com:80"},on:{"on-search":e.saveShareUrl},scopedSlots:e._u([{key:"prepend",fn:function(){return[s("Select",{staticStyle:{width:"80px"},model:{value:e.shareProtocol,callback:function(t){e.shareProtocol=t},expression:"shareProtocol"}},[s("Option",{attrs:{value:"http://"}},[e._v("http://")]),s("Option",{attrs:{value:"https://"}},[e._v("https://")])],1)]},proxy:!0}]),model:{value:e.shareUrl,callback:function(t){e.shareUrl=t},expression:"shareUrl"}}),s("div",{staticStyle:{"margin-top":"10px"}}),s("Divider"),s("b",[e._v(e._s(e.$t("whatModelWillYouUse")))]),s("div",{staticStyle:{"margin-top":"10px"}},[s("CheckboxGroup",{staticClass:"option-root",on:{"on-change":e.onMenuChange},model:{value:e.showMenuList,callback:function(t){e.showMenuList=t},expression:"showMenuList"}},[s("Checkbox",{staticClass:"ckItem",attrs:{label:"photoManage",border:""}},[e._v(e._s(e.$t("home.photoManage")))]),s("Checkbox",{staticClass:"ckItem",attrs:{label:"movieManage",border:""}},[e._v(e._s(e.$t("home.movieManage")))]),s("Checkbox",{staticClass:"ckItem",attrs:{label:"musicManage",border:""}},[e._v(e._s(e.$t("home.musicManage")))]),s("Checkbox",{staticClass:"ckItem",attrs:{label:"filesBrower",border:""}},[e._v(e._s(e.$t("home.fileBrower")))]),s("Checkbox",{staticClass:"ckItem",attrs:{label:"backup",border:""}},[e._v(e._s(e.$t("home.backup")))]),s("Checkbox",{staticClass:"ckItem",attrs:{label:"sharing",border:""}},[e._v(e._s(e.$t("home.sharing")))]),s("Checkbox",{staticClass:"ckItem",attrs:{label:"privateSpace",border:""}},[e._v(e._s(e.$t("photo.privateSpace")))]),s("Checkbox",{staticClass:"ckItem",attrs:{label:"security",border:""}},[e._v(e._s(e.$t("home.securityCenter")))]),s("Checkbox",{staticClass:"ckItem",attrs:{label:"books",border:""}},[e._v(e._s(e.$t("book.library")))])],1)],1),s("Divider"),s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("b",[e._v(e._s(e.$t("loginWelMsg")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$refs.customTitleDialog.setShow(!0)}}},[e._v(e._s(e.$t("common.change")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(t){return e.clearConfig("customLoginTitle")}}},[e._v(e._s(e.$t("Reset")))])],1),s("div",{staticStyle:{width:"100%","margin-top":"20px","text-align":"left"}},[e._v(" "+e._s(e.customLoginTitle||e.$t("common.welcomeToNasCab"))+" ")]),s("Divider"),s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("b",[e._v(e._s(e.$t("logoLeft")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.onClickChooseLogo}},[e._v(e._s(e.$t("common.change")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(t){return e.clearConfig("customLogoImage")}}},[e._v(e._s(e.$t("Reset")))])],1),s("p",{staticStyle:{"font-size":"12px","margin-top":"10px"}},[e._v(e._s(e.$t("bestSize"))+"5:1 "+e._s(e.$t("whiteBg")))]),s("div",{staticStyle:{width:"150px","margin-top":"20px"}},[e.logoImageUrl?s("img",{staticStyle:{width:"150px"},attrs:{src:e.logoImageUrl}}):e._e()]),s("Divider"),s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("b",[e._v(e._s(e.$t("loginImg")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.onClickChooseLoginImage}},[e._v(e._s(e.$t("common.change")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(t){return e.clearConfig("customLoginImage")}}},[e._v(e._s(e.$t("Reset")))])],1),s("p",{staticStyle:{"font-size":"12px","margin-top":"10px"}},[e._v(e._s(e.$t("bestSize"))+"1:1 "+e._s(e.$t("whiteBg")))]),s("div",{staticStyle:{width:"150px","margin-top":"20px"}},[e.loginImageUrl?s("img",{staticStyle:{width:"150px"},attrs:{src:e.loginImageUrl}}):e._e()]),s("Divider"),s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("b",[e._v(e._s(e.$t("homeBg")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.onClickChooseHomeImage}},[e._v(e._s(e.$t("common.change")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(t){return e.clearConfig("customHomeBgImage")}}},[e._v(e._s(e.$t("Reset")))])],1),s("p",{staticStyle:{"font-size":"12px","margin-top":"10px"}},[e._v(e._s(e.$t("bestBg")))]),s("div",{staticStyle:{width:"150px","margin-top":"20px"}},[e.bgUrl?s("img",{staticStyle:{width:"150px"},attrs:{src:e.bgUrl}}):e._e()]),s("vs-dialog",{attrs:{scroll:"","full-screen":e.isMobile},scopedSlots:e._u([{key:"header",fn:function(){return[s("h4",{staticStyle:{"font-size":"16px"}},[e._v(" "+e._s(e.$t("common.select")+":"+e.chooseFileTitle)+" ")])]},proxy:!0},{key:"footer",fn:function(){return[s("file-select-bar",{on:{back:function(t){return e.$refs.fileSelector.goBack()},select:function(t){return e.$refs.fileSelector.onSelect()},create:function(t){return e.$refs.fileSelector.createNewFolder(t)}}})]},proxy:!0}]),model:{value:e.showChooseFile,callback:function(t){e.showChooseFile=t},expression:"showChooseFile"}},[e.showChooseFile?s("file-select",{ref:"fileSelector",attrs:{parent:"root",fileType:0},on:{onSelect:e.onSelectFileSuc,onCancel:function(t){e.showChooseFile=!1}}}):e._e()],1),s("my-dialog-input",{ref:"customTitleDialog",attrs:{showCloseBtn:!0,title:e.$t("loginWelMsg"),content:e.$t("loginWelMsg")},on:{onOkClick:e.onClickChangeWelcomeMassage}})],1)},[],!1,null,"474f8db2",null).exports,ddns:c,myHeader:i.a,userManage:l,fileSelect:n.default,commonSet:r,systemSet:o,nascabAccount:v,remoteAccess:x},data(){return{sideOptionList:[{id:"commonSetting",title:this.$t("setting.commonSetting"),font:"nasIcons icon-setting-common"},{id:"userManage",title:this.$t("setting.userManage"),font:"nasIcons icon-setting-user"},{id:"systemSetting",title:this.$t("setting.systemSetting"),font:"nasIcons icon-setting-system"},{id:"custom",title:this.$t("setting.custom"),font:"nasIcons icon-custome"},{id:"remoteAccess",title:this.$t("nascab.remoteAccessMenu"),font:"nasIcons icon-network"},{id:"ddns",title:"DDNS",font:"nasIcons icon-link"},{id:"nasAccount",title:this.$t("nascab.account"),font:"nasIcons icon-vip"}],leftIndex:"commonSetting"}},computed:{},methods:{switchToNasLogin(){this.$refs.sidebar.setSelectById("nasAccount"),this.$refs.sidebarMobile.setSelectById("nasAccount"),this.leftIndex="nasAccount"},setLeftMenuId(t){this.leftIndex=t.id}}},s("7de0"),h=Object(a.a)(S,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"setting-root"},[e("my-bg"),t._m(0),e("div",{staticClass:"nas-mobile-none"},[e("my-header")],1),e("div",{staticClass:"main-layout nas-padding-right-zero"},[e("div",{staticClass:"sidebar-root"},[e("my-sidebar",{ref:"sidebar",attrs:{name:"setting",optionList:t.sideOptionList},on:{onItemClick:t.setLeftMenuId}})],1),e("div",{staticClass:"sidebar-mobile-root"},[e("my-sidebar-mobile",{ref:"sidebarMobile",attrs:{name:"setting",optionList:t.sideOptionList},on:{onItemClick:t.setLeftMenuId}})],1),e("div",{staticClass:"setting-list-root"},["commonSetting"==t.leftIndex?e("common-set"):t._e(),"userManage"==t.leftIndex?e("user-manage"):t._e(),"systemSetting"==t.leftIndex?e("system-set"):t._e(),"custom"==t.leftIndex?e("custom",{on:{onToLogin:t.switchToNasLogin}}):t._e(),"ddns"==t.leftIndex?e("ddns",{on:{onToLogin:t.switchToNasLogin}}):t._e(),"remoteAccess"==t.leftIndex?e("remote-access",{on:{onToLogin:t.switchToNasLogin}}):t._e(),"nasAccount"==t.leftIndex?e("nascab-account"):t._e()],1)])],1)},[function(){var t=this.$createElement,t=this._self._c||t;return t("div",{staticClass:"nas-mobile-none"},[t("p",{staticClass:"my-header-position"})])}],!1,null,"6795ff80",null);e.default=h.exports},e1fc:function(t,e,s){"use strict";s("7c04")}}]);