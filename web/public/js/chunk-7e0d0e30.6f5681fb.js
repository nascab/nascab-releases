(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e0d0e30"],{"0302":function(t,e,i){i("c1b2")},"0b73":function(t,e,i){i.r(e);var a=i("7cfd"),o=i("ade3"),r=(i("b0c0"),i("b85c")),n=(i("a434"),i("3c65"),i("d3b7"),i("e25e"),i("be3b")),s=i("ccdb"),l=i("e86f"),c={props:{},components:{fileSelect:s.default,fileSelectBar:l.a},computed:{},data:function(){return{showSettings:!1,withMeta:"1",uploadType:"files",uploadUrl:"",uploadList:[],targetPath:"",lastUsePath:"",uploadSucCount:0,isLoading:!1,zipQuality:0,totalSaveSize:0,qulityList:[{value:0,label:this.$t("tools.defaultQulity")},{value:95,label:"95%"},{value:90,label:"90%"},{value:80,label:"80%"},{value:70,label:"70%"},{value:60,label:"60%"},{value:50,label:"50%"}],format:"auto",formatList:[{value:"auto",label:this.$t("tools.defaultFormat")},{value:"png",label:"png"},{value:"jpeg",label:"jpeg"},{value:"webp",label:"webp"}],withMetaList:[{value:"1",label:this.$t("withMeta")},{value:"0",label:this.$t("withoutMeta")}],outSizeType:"RAW",outSize:100,outSizeList:[{value:"RAW",label:this.$t("rawSize")},{value:"CUSTOM",label:this.$t("Custom")}],taskType:"MEDIA_TOOL_IMG_ZIP"}},created:function(){},mounted:function(){this.lastUsePath=localStorage.getItem("lastUsePath")},destroyed:function(){this.tmout&&clearTimeout(this.tmout)},methods:{calculateTotalSaveSize:function(){var t,e=0,i=Object(r.a)(this.uploadList);try{for(i.s();!(t=i.n()).done;){var a=t.value;"finished"==a.status&&a.saveSize&&(e+=parseInt(a.saveSize))}}catch(t){i.e(t)}finally{i.f()}this.totalSaveSize=e},onCloseUpload:function(){this.switchUpload()},clearRecord:function(){this.uploadList=[]},downloadZipImage:function(t,e){var i,a,s=t?t.outputFullPath:"",o=0,n=Object(r.a)(this.uploadList);try{for(n.s();!(i=n.n()).done;){var l=i.value;l.uploadStartTime&&(0==o||l.uploadStartTime<o)&&(o=l.uploadStartTime)}}catch(t){n.e(t)}finally{n.f()}0!=o&&(a=e?"all-image.zip":"compressImage",t&&t.name&&(a=t.name),t=this.axios.getImageCompressFileUrl(s,o,e,a),this.downloadFile([t]))},onBeforeUpload:function(a){var s=this;return new Promise(function(t,e){var i;return s.$store.state.token?120<a.name.length?(s.uploadList.unshift({status:"error",name:s.$t("upload.filenameTooLong")}),e()):(i=n.a.uploadUrl()+"&imgZip=1",i+="&encodeFilename=".concat(n.a.encodePath(a.name)),50<s.zipQuality&&s.zipQuality<=100&&(i+="&zipQuality="+s.zipQuality),"auto"!=s.format&&(i+="&zipFormat="+s.format),i+="&withMeta="+s.withMeta,"CUSTOM"==s.outSizeType&&0<s.outSize&&s.outSize<99999&&(i+="&outSize="+s.outSize),s.uploadUrl=i,a.uploadUrl=i,t(a)):(s.uploadList.unshift({status:"error",name:s.$t("common.tokenExpire")}),e())})},handleRemove:function(t,e){var i=!1;if(t.uid&&"uploading"==t.status&&t.percentage<95)for(var a in this.$refs.upload.fileList)this.$refs.upload.fileList[a].uid==t.uid&&this.$refs.upload.fileList[a].xhr&&(this.$refs.upload.fileList[a].xhr.abort(),i=!0);this.uploadList.splice(e,1),i&&(e=this.$t("common.cancelled"),t.name&&(e+=":"+t.name),this.uploadList.unshift({status:"error",name:e}))},onUploadSuccess:function(t,e,i,a){for(var s in this.uploadList)if(this.uploadList[s].uid==e.uid){this.uploadList.splice(s,1);break}var o;t.code?(t.message,this.uploadList.unshift({status:"error",name:e.name+":"+t.message,uploadFile:a})):(this.$emit("fileUploaded",e),e.outputFormat=t.outputFormat,e.outputFullPath=t.outputFullPath,t.outputSize&&(e.outputSize=t.outputSize),t.inputSize&&(e.inputSize=t.inputSize),e.uploadStartTime=t.uploadStartTime,e.saveSize=e.inputSize-e.outputSize,e.outputSize&&e.inputSize&&(a=parseInt(e.outputSize),o=parseInt(e.inputSize),a=Math.round((a-o)/o*1e3)/10,e.zipPercent=a),e.outputSize&&parseInt(e.outputSize)<153600&&(e.previewUrl=this.axios.getImageCompressFileUrl(t.outputFullPath)),this.uploadList.unshift(e),this.calculateTotalSaveSize())},onUploadProgress:function(t,e,i){for(var a in this.uploadList)if(this.uploadList[a].uid==e.uid)return this.uploadList[a].percentage=e.percentage,void(this.uploadList[a].file=e);this.uploadList.unshift({status:"uploading",name:e.name,percentage:1,uid:e.uid,file:e})},onUploadError:function(t,e,i){for(var a in this.uploadList)if(this.uploadList[a].uid==i.uid){this.uploadList.splice(a,1);break}this.uploadList.unshift({status:"error",name:i?i.name+":"+this.$t("upload.uploadFail"):this.$t("upload.uploadFail"),uploadFile:i})}}},u=(i("41b6"),i("2877")),c={props:{},computed:{},components:{compressUpload:Object(u.a)(c,function(){var a=this,s=a._self._c;return s("div",{staticClass:"app-upload-root"},[s("div",{staticClass:"upload-root"},[s("div",{staticStyle:{"justify-content":"space-between",height:"40px",padding:"10px 10px","background-color":"white","border-top-left-radius":"15px","border-top-right-radius":"15px",width:"100%",display:"flex","align-items":"center"}},[s("div",{staticStyle:{display:"flex"}},["auto"==a.format?s("Button",{staticClass:"zip-btn",attrs:{size:"small"},on:{click:function(t){a.showSettings=!0}}},[a._v(a._s(a.$t("tools.defaultFormat")))]):a._e(),"auto"!=a.format?s("Button",{staticClass:"zip-btn",attrs:{size:"small"},on:{click:function(t){a.showSettings=!0}}},[a._v(a._s(a.format))]):a._e(),0==a.zipQuality?s("Button",{staticClass:"zip-btn",attrs:{size:"small"},on:{click:function(t){a.showSettings=!0}}},[a._v(a._s(a.$t("tools.defaultQulity")))]):a._e(),0<a.zipQuality?s("Button",{staticClass:"zip-btn",attrs:{size:"small"},on:{click:function(t){a.showSettings=!0}}},[a._v(a._s(a.zipQuality)+"%")]):a._e(),"RAW"==a.outSizeType?s("Button",{staticClass:"zip-btn",attrs:{size:"small"},on:{click:function(t){a.showSettings=!0}}},[a._v(a._s(a.$t("rawSize")))]):a._e(),"CUSTOM"==a.outSizeType?s("Button",{staticClass:"zip-btn",attrs:{size:"small"},on:{click:function(t){a.showSettings=!0}}},[a._v(a._s(a.outSize)+a._s(a.$t("pixel")))]):a._e(),"1"==a.withMeta?s("Button",{staticClass:"zip-btn",attrs:{size:"small"},on:{click:function(t){a.showSettings=!0}}},[a._v(a._s(a.$t("withMeta")))]):a._e(),"0"==a.withMeta?s("Button",{staticClass:"zip-btn",attrs:{size:"small"},on:{click:function(t){a.showSettings=!0}}},[a._v(a._s(a.$t("withoutMeta")))]):a._e()],1),s("Icon",{staticStyle:{color:"grey","font-size":"20px",cursor:"pointer"},attrs:{type:"md-help-circle"},on:{click:function(t){a.showVsAlertDialog(a.$t("help.howToWork"),a.$t("zipImgAlert"))}}})],1),"files"==a.uploadType?s("Upload",{ref:"upload",attrs:{action:a.uploadUrl,"show-upload-list":!1,"on-error":a.onUploadError,"on-success":a.onUploadSuccess,"before-upload":a.onBeforeUpload,"on-progress":a.onUploadProgress,multiple:"",type:"drag",webkitdirectory:!1,accept:".jpeg,.jpg,.png,.heic,.heif,.hif,.gif,.webp,.tiff,.svg,.bmp,.dng,.cr2,.nef,.orf,.raf,.raw,.x3f,.rw2,.nrw,.arw"}},[s("div",{staticStyle:{padding:"20px 0",position:"relative"}},[s("img",{staticStyle:{width:"35px"},attrs:{src:i("c8af")}}),s("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center",cursor:"pointer"}},[s("p",[a._v(a._s(this.$t("tools.zipUploadAlert")))])])])]):a._e(),a.uploadList&&0<a.uploadList.length?s("div",{staticClass:"operation-root"},[s("div",{staticStyle:{"margin-left":"10px"}},[a._v(" "+a._s(a.$t("file.fileCount",{count:a.uploadList.length}))+" "),a.totalSaveSize?s("span",{staticStyle:{"margin-left":"5px"}},[a._v(" "+a._s(a.utils.getSizeStr(a.totalSaveSize))+" "+a._s(a.$t("optimized")))]):a._e()]),s("div",{staticStyle:{display:"flex"}},[s("my-btn",{attrs:{title:a.$t("upload.clearRecord"),type:"white"},on:{click:a.clearRecord}}),s("my-btn",{attrs:{title:a.$t("downloadAll")},on:{click:function(t){return a.downloadZipImage(null,!0)}}})],1)]):a._e()],1),s("div",{staticStyle:{height:"200px",width:"100%","margin-bottom":"6px"}}),s("div",{staticClass:"bottom-root"},[a._l(a.uploadList,function(e,i){return s("div",{staticClass:"item-upload"},[s("div",{staticStyle:{display:"flex",width:"100%","align-items":"center","justify-content":"space-between"}},["finished"==e.status?s("Icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"md-checkmark-circle",size:"20",color:"green"}}):a._e(),"error"==e.status?s("Icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"ios-close-circle",size:"20",color:"red"}}):a._e(),s("div",{class:{uploadError:"error"==e.status},staticStyle:{"text-align":"left",flex:"1","word-break":"break-all"}},[a._v(a._s(e.name))]),"finished"==e.status?s("div",{staticClass:"download-root",on:{click:function(t){return a.downloadZipImage(e)}}},[s("Icon",{staticStyle:{"flex-shrink":"0",cursor:"pointer","margin-right":"5px"},attrs:{type:"md-download",size:"20"}}),e.outputFormat?s("div",[a._v(" "+a._s(e.outputFormat.toUpperCase()))]):a._e()],1):a._e()],1),s("div",{staticStyle:{display:"flex",width:"100%","align-items":"center","justify-content":"space-between","margin-top":"5px"}},[s("div"),"finished"==e.status&&e.inputSize&&0<e.inputSize?s("div",{staticClass:"text-item-bottom",staticStyle:{"text-align":"left",flex:"1","word-break":"break-all"}},[a._v(a._s(a.utils.getSizeStr(e.inputSize)))]):a._e(),e.zipPercent?s("div",{staticClass:"text-item-bottom"},[a._v(a._s(a.utils.getSizeStr(e.outputSize))),s("span",{staticClass:"text-zip-percent"},[a._v(a._s(e.zipPercent)+"%")])]):a._e(),"finished"!=e.status?s("Icon",{staticStyle:{"flex-shrink":"0",cursor:"pointer"},attrs:{type:"md-trash",size:"20"},on:{click:function(t){return a.handleRemove(e,i)}}}):a._e()],1),"uploading"==e.status?s("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):a._e()],1)}),s("div",{staticStyle:{height:"250px",width:"100%","margin-bottom":"6px"}})],2),s("Modal",{attrs:{title:a.$t("setting"),"show-cancel":!1,"footer-hide":""},model:{value:a.showSettings,callback:function(t){a.showSettings=t},expression:"showSettings"}},[s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("p",{staticClass:"max-line-one"},[a._v(a._s(a.$t("outFormat"))+" :")]),s("Select",{staticStyle:{width:"120px","max-width":"45%","margin-left":"5px"},attrs:{size:"small"},model:{value:a.format,callback:function(t){a.format=t},expression:"format"}},a._l(a.formatList,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[a._v(" "+a._s(t.label))])}),1)],1),s("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"15px"}},[s("p",{staticClass:"max-line-one"},[a._v(a._s(a.$t("outQuality"))+" :")]),s("Select",{staticStyle:{width:"120px","max-width":"45%","margin-left":"5px"},attrs:{size:"small"},model:{value:a.zipQuality,callback:function(t){a.zipQuality=t},expression:"zipQuality"}},a._l(a.qulityList,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[a._v(" "+a._s(t.label))])}),1)],1),s("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"15px"}},[s("p",{staticClass:"max-line-one"},[a._v(a._s(a.$t("withMetaTitle"))+" :")]),s("Select",{staticStyle:{width:"150px","max-width":"60%","margin-left":"5px"},attrs:{size:"small"},model:{value:a.withMeta,callback:function(t){a.withMeta=t},expression:"withMeta"}},a._l(a.withMetaList,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[a._v(" "+a._s(t.label))])}),1),"1"==a.withMeta?s("span",{staticStyle:{"margin-left":"5px","font-size":"10px"}},[a._v(a._s(a.$t("onlySupport"))+" JPEG")]):a._e()],1),s("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"15px"}},[s("p",{staticClass:"max-line-one"},[a._v(a._s(a.$t("outputSize"))+" :")]),s("Select",{staticStyle:{width:"150px","max-width":"60%","margin-left":"5px"},attrs:{size:"small"},model:{value:a.outSizeType,callback:function(t){a.outSizeType=t},expression:"outSizeType"}},a._l(a.outSizeList,function(t){return s("Option",{key:t.value,attrs:{value:t.value}},[a._v(" "+a._s(t.label))])}),1)],1),"CUSTOM"==a.outSizeType?s("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"15px"}},[s("p",{staticClass:"max-line-one"},[a._v(a._s(a.$t("longSideMaxPx"))+" :")]),s("Input",{staticStyle:{width:"100px","margin-left":"5px"},attrs:Object(o.a)({min:"10",max:"99999",size:"small",number:!0,type:"number"},"min",10),model:{value:a.outSize,callback:function(t){a.outSize=t},expression:"outSize"}})],1):a._e()])],1)},[],!1,null,"7d3ee884",null).exports,myHeader:a.a},data:function(){return{}},created:function(){},beforeDestroy:function(){},mounted:function(){},unmounted:function(){},methods:{}};i("0302");var c=Object(u.a)(c,function(){var t=this._self._c;return t("div",{staticClass:"root-wraper"},[t("compressUpload",{ref:"uploadComponent"})],1)},[],!1,null,"25104e8f",null).exports,d=(i("b64b"),i("5530"));i("8a79");var p={props:{},components:{fileSelect:s.default,fileSelectBar:l.a},data:function(){return{taskType:"MEDIA_ARRANGE",selectPathType:"source",showChooseFolder:!1,taskData:{sourcePath:"",targetPath:""}}},mounted:function(){},methods:{onCreateTask:function(){var t,e=this;return this.taskData.targetPath?this.taskData.sourcePath==this.taskData.targetPath?this.showVsNotification(this.$t("sourceTargetPathCannotSame")):(t=Object(d.a)({taskType:this.taskType},this.taskData),void this.api.post("/api/mediaToolsApi/createTask",t).then(function(t){t.code||(e.showVsNotification(e.$t("common.operationSuccess")),e.$emit("onClose"))}).catch(function(t){})):this.showVsNotification(this.$t("backup.chooseTargetPath"))},choosePath:function(t){this.selectPathType=t,this.showChooseFolder=!0},onSelectPath:function(t){if((3==t.length||4==t.length)&&t.endsWith("\\"))return this.showVsNotification(this.$t("backup.cannotUseRoot"));"source"==this.selectPathType?this.taskData.sourcePath=t:"target"==this.selectPathType&&(this.taskData.targetPath=t),this.showChooseFolder=!1}}},p=Object(u.a)(p,function(){var e=this,t=e._self._c;return t("div",[t("Form",{ref:"taskData",attrs:{prop:"taskName",model:e.taskData}},[t("a",{staticStyle:{"margin-bottom":"10px"},on:{click:function(t){return e.choosePath("source")}}},[e._v(e._s(e.$t("selectMRsourcePath")))]),t("div",[e.taskData.sourcePath?t("Tag",{staticStyle:{"margin-top":"5px"}},[e._v(" "+e._s(e.taskData.sourcePath))]):e._e()],1),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("a",{staticStyle:{"margin-bottom":"10px"},on:{click:function(t){return e.choosePath("target")}}},[e._v(e._s(e.$t("selectMRtargetPath")))]),t("div",[e.taskData.targetPath?t("Tag",{staticStyle:{"margin-top":"5px"}},[e._v(" "+e._s(e.taskData.targetPath))]):e._e()],1),t("Divider",{staticStyle:{margin:"10px 0px"}})],1),t("vs-dialog",{attrs:{"prevent-close":"",scroll:"","full-screen":e.isMobile},scopedSlots:e._u([{key:"header",fn:function(){return[t("h4",[e._v(" "+e._s(e.$t("file.chooseFolder")+"["+e.$t("file.doubleClickFolderEnter")+"]")+" ")])]},proxy:!0},{key:"footer",fn:function(){return[t("file-select-bar",{on:{back:function(t){return e.$refs.fileSelector.goBack()},select:function(t){return e.$refs.fileSelector.onSelect()},create:function(t){return e.$refs.fileSelector.createNewFolder(t)}}})]},proxy:!0}]),model:{value:e.showChooseFolder,callback:function(t){e.showChooseFolder=t},expression:"showChooseFolder"}},[e.showChooseFolder?t("file-select",{ref:"fileSelector",attrs:{parent:"root",type:2},on:{onSelect:e.onSelectPath,onCancel:function(t){e.showChooseFolder=!1}}}):e._e()],1)],1)},[],!1,null,null,null).exports,h=i("25e9"),p={props:{},computed:{},components:{myHeader:a.a,mediaArrangeAddTask:p,backupRecords:h.a},data:function(){return{taskType:"MEDIA_ARRANGE",intervalGetRunningTask:null,loading:!1,selectedTask:null,showRecords:!1,getListInterval:null,selectId:null,operationType:"create",showAdd:!1,taskList:[],timeout:null}},created:function(){},beforeDestroy:function(){this.intervalGetRunningTask&&clearInterval(this.intervalGetRunningTask),this.timeout&&clearTimeout(this.timeout)},mounted:function(){this.getAllTask()},unmounted:function(){},methods:{showRecordsModal:function(t){this.selectedTask=t,this.showRecords=!0},onAddFinish:function(){this.showAdd=!1,this.getAllTask()},createTask:function(){this.operationType="create",this.showAdd=!0},onCreateTask:function(){this.$refs.addTask.onCreateTask("create")},getAllTask:function(){var t,i=this;!this.loading&&(this.timeout&&clearTimeout(this.timeout),this.$store.state.token)&&(this.loading=!0,t={taskType:this.taskType,hideLoading:!0},this.api.post("/api/mediaToolsApi/getTaskList",t).then(function(t){if(i.loading=!1,!t.code&&t.data)for(var e in i.taskList=t.data,i.taskList){e=i.taskList[e];try{e.taskObj=JSON.parse(e.task_json),e.task_result&&(e.taskResult=JSON.parse(e.task_result))}catch(t){}}}).catch(function(t){i.loading=!1}).finally(function(){i.loading=!1,i.timeout=setTimeout(function(){i.getAllTask()},3e3)}))},clearRecord:function(){var e=this;this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),function(){e.api.post("/api/mediaToolsApi/deleteTask",{taskType:e.taskType}).then(function(t){e.showVsNotification(e.$t("common.operationSuccess")),e.taskList=[]}).catch(function(t){e.showVsNotification(e.$t("common.operationFail"))})})},deleteTask:function(i){var a=this;this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),function(){a.api.post("/api/mediaToolsApi/deleteTask",{id:i.id}).then(function(t){a.showVsNotification(a.$t("common.operationSuccess"));for(var e=0;e<a.taskList.length;e++)a.taskList[e].id==i.id&&a.taskList.splice(e,1)}).catch(function(t){a.showVsNotification(a.$t("common.operationFail"))})})}}};i("74dc");p=Object(u.a)(p,function(){var i=this,t=i._self._c;return t("div",{staticClass:"root-wraper"},[i.taskList.length<1?t("my-nodata",{staticStyle:{position:"absolute",width:"100%","margin-top":"150px"},attrs:{title:i.$t("mediaArrangeAlert"),btnTitle:i.$t("addMediaArrangeTask")},on:{onBtnClick:i.createTask}}):i._e(),0<i.taskList.length?t("div",{staticClass:"top-root",staticStyle:{"margin-right":"10px"}},[t("div",{staticClass:"nas-flex-row-center"},[t("my-btn",{staticStyle:{"margin-right":"5px"},attrs:{title:i.$t("addMediaArrangeTask")},on:{click:function(t){return i.createTask()}}}),t("my-btn",{attrs:{type:"red",title:i.$t("common.clear")},on:{click:function(t){return i.clearRecord()}}})],1),t("Icon",{staticStyle:{color:"grey","font-size":"20px",cursor:"pointer"},attrs:{type:"md-help-circle"},on:{click:function(t){i.showVsAlertDialog(i.$t("help.howToWork"),i.$t("mediaArrangeAlert"))}}})],1):i._e(),t("div",{staticStyle:{width:"100%",height:"100%",display:"flex","flex-direction":"row",overflow:"hidden","padding-top":"60px","padding-left":"10px","padding-right":"10px"}},[t("div",{ref:"listWrapper",staticClass:"task-list"},i._l(i.taskList,function(e){return t("Card",{staticClass:"card-root",attrs:{shadow:"",border:!1}},[t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[t("div",{staticClass:"card-item"},[t("h4",[i._v(i._s(i.$t("movie.createTime"))+":")]),t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(e.create_time))])]),t("div",{staticStyle:{"flex-shrink":"0"}},[t("a",{on:{click:function(t){return i.deleteTask(e)}}},[i._v(i._s(i.$t("common.delete")))])])]),t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[t("div",{staticClass:"card-item"},[t("h4",[i._v(i._s(i.$t("mediaSourcePath"))+":")]),t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(e.taskObj.source_path))])])]),t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[t("div",{staticClass:"card-item"},[t("h4",[i._v(i._s(i.$t("backup.targetPath"))+":")]),t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(e.taskObj.target_path))])])]),t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[t("div",{staticClass:"card-item"},[t("h4",[i._v(i._s(i.$t("home.status"))+":")]),"0"==e.task_state?t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(i.$t("upload.waiting")))]):i._e(),"2"==e.task_state?t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(i.$t("common.succesed")))]):i._e(),"3"==e.task_state?t("p",{staticStyle:{"margin-left":"10px",color:"red"}},[i._v(i._s(i.$t("common.faild")))]):i._e(),"1"==e.task_state?t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(i.$t("state.run")))]):i._e(),e.taskResult?t("p",{staticStyle:{"margin-left":"10px"}},[e.taskResult.copy_size?t("span",[i._v(i._s(i.utils.getSizeStr(e.taskResult.copy_size))+" "),e.taskResult.copy_count?t("span",[i._v("("+i._s(i.$t("file.fileCount",{count:e.taskResult.copy_count}))+")")]):i._e(),i._v(" "+i._s(i.$t("system.copied"))+" ")]):i._e()]):i._e()])])])}),1)]),t("Modal",{attrs:{"footer-hide":""},scopedSlots:i._u([{key:"header",fn:function(){return[t("h4",{staticStyle:{"font-size":"16px"}},[i._v(" "+i._s(i.$t("addMediaArrangeTask"))+" ")])]},proxy:!0}]),model:{value:i.showAdd,callback:function(t){i.showAdd=t},expression:"showAdd"}},[i.showAdd?t("mediaArrangeAddTask",{ref:"addTask",attrs:{type:i.operationType,taskId:i.selectId},on:{onClose:i.onAddFinish}}):i._e(),t("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center"}},[t("Button",{staticStyle:{"border-radius":"20px"},attrs:{type:"primary"},on:{click:i.onCreateTask}},[i._v(" "+i._s(i.$t("addMediaArrangeTask"))+" ")])],1)],1)],1)},[],!1,null,"5d08b7f2",null).exports;i("14d9");s={props:{},components:{fileSelect:s.default,fileSelectBar:l.a},data:function(){return{videoFormat:["mp4","avi","mkv"],audioFormat:["mp3","aac","wav"],taskType:"VIDEO_TRANS",selectPathType:"source",showChooseFolder:!1,selectFileType:0,taskData:{sourcePath:[],targetPath:""}}},mounted:function(){},methods:{removeSourcePath:function(t){for(var e=0;e<this.taskData.sourcePath.length;e++)this.taskData.sourcePath[e]==t&&this.taskData.sourcePath.splice(e,1)},onCreateTask:function(){var e=this;if(!this.taskData.targetPath)return this.showVsNotification(this.$t("backup.chooseTargetPath"));var t=Object(d.a)({taskType:this.taskType},this.taskData);this.api.post("/api/mediaToolsApi/createTask",t).then(function(t){t.code||(e.showVsNotification(e.$t("common.operationSuccess")),e.$emit("onClose"))}).catch(function(t){})},choosePath:function(t){this.selectPathType=t,"source"==this.selectPathType?this.selectFileType=0:"target"==this.selectPathType&&(this.selectFileType=2),this.showChooseFolder=!0},onSelectPath:function(t){if((3==t.length||4==t.length)&&t.endsWith("\\"))return this.showVsNotification(this.$t("backup.cannotUseRoot"));"source"==this.selectPathType?this.taskData.sourcePath.push(t):"target"==this.selectPathType&&(this.taskData.targetPath=t),this.showChooseFolder=!1}}},l=Object(u.a)(s,function(){var i=this,t=i._self._c;return t("div",[t("Form",{ref:"taskData",attrs:{prop:"taskName",model:i.taskData}},[t("a",{staticStyle:{"margin-bottom":"10px"},on:{click:function(t){return i.choosePath("source")}}},[i._v(i._s(i.$t("selectTransFolder")))]),i._l(i.taskData.sourcePath,function(e){return t("div",[t("Tag",{staticStyle:{"margin-top":"5px"},attrs:{closable:""},on:{"on-close":function(t){return i.removeSourcePath(e)}}},[i._v(" "+i._s(e))])],1)}),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("a",{staticStyle:{"margin-bottom":"10px"},on:{click:function(t){return i.choosePath("target")}}},[i._v(i._s(i.$t("selectTransTarget")))]),t("div",[i.taskData.targetPath?t("Tag",{staticStyle:{"margin-top":"5px"}},[i._v(" "+i._s(i.taskData.targetPath))]):i._e()],1),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("Divider",{staticStyle:{margin:"10px 0px"}}),t("Divider",{staticStyle:{margin:"10px 0px"}})],2),t("vs-dialog",{attrs:{"prevent-close":"",scroll:"","full-screen":i.isMobile},scopedSlots:i._u([{key:"header",fn:function(){return[t("h4",[i._v(" "+i._s(i.$t("file.chooseFolder")+"["+i.$t("file.doubleClickFolderEnter")+"]")+" ")])]},proxy:!0},{key:"footer",fn:function(){return[t("file-select-bar",{on:{back:function(t){return i.$refs.fileSelector.goBack()},select:function(t){return i.$refs.fileSelector.onSelect()},create:function(t){return i.$refs.fileSelector.createNewFolder(t)}}})]},proxy:!0}]),model:{value:i.showChooseFolder,callback:function(t){i.showChooseFolder=t},expression:"showChooseFolder"}},[i.showChooseFolder?t("file-select",{ref:"fileSelector",attrs:{parent:"root",fileType:i.selectFileType},on:{onSelect:i.onSelectPath,onCancel:function(t){i.showChooseFolder=!1}}}):i._e()],1)],1)},[],!1,null,null,null).exports,s={props:{},computed:{},components:{myHeader:a.a,videoTransAddTask:l,backupRecords:h.a},data:function(){return{taskType:"VIDEO_TRANS",intervalGetRunningTask:null,loading:!1,selectedTask:null,showRecords:!1,getListInterval:null,selectId:null,operationType:"create",showAdd:!1,taskList:[],timeout:null}},created:function(){},beforeDestroy:function(){this.intervalGetRunningTask&&clearInterval(this.intervalGetRunningTask),this.timeout&&clearTimeout(this.timeout)},mounted:function(){this.getAllTask()},unmounted:function(){},methods:{showRecordsModal:function(t){this.selectedTask=t,this.showRecords=!0},onAddFinish:function(){this.showAdd=!1,this.getAllTask()},createTask:function(){this.operationType="create",this.showAdd=!0},onCreateTask:function(){this.$refs.addTask.onCreateTask("create")},getAllTask:function(){var t,i=this;!this.loading&&(this.timeout&&clearTimeout(this.timeout),this.$store.state.token)&&(this.loading=!0,t={taskType:this.taskType,hideLoading:!0},this.api.post("/api/mediaToolsApi/getTaskList",t).then(function(t){if(i.loading=!1,!t.code&&t.data)for(var e in i.taskList=t.data,i.taskList){e=i.taskList[e];try{e.taskObj=JSON.parse(e.task_json),e.task_result&&(e.taskResult=JSON.parse(e.task_result))}catch(t){}}}).catch(function(t){i.loading=!1}).finally(function(){i.loading=!1,i.timeout=setTimeout(function(){i.getAllTask()},3e3)}))},clearRecord:function(){var e=this;this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),function(){e.api.post("/api/mediaToolsApi/deleteTask",{taskType:e.taskType}).then(function(t){e.showVsNotification(e.$t("common.operationSuccess")),e.taskList=[]}).catch(function(t){e.showVsNotification(e.$t("common.operationFail"))})})},deleteTask:function(i){var a=this;this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),function(){a.api.post("/api/mediaToolsApi/deleteTask",{id:i.id}).then(function(t){a.showVsNotification(a.$t("common.operationSuccess"));for(var e=0;e<a.taskList.length;e++)a.taskList[e].id==i.id&&a.taskList.splice(e,1)}).catch(function(t){a.showVsNotification(a.$t("common.operationFail"))})})}}};i("83b2");l={components:{vidTrans:Object(u.a)(s,function(){var i=this,t=i._self._c;return t("div",{staticClass:"root-wraper"},[i.taskList.length<1?t("my-nodata",{staticStyle:{position:"absolute",width:"100%","margin-top":"150px"},attrs:{title:i.$t("tools.vidTransAlert"),btnTitle:i.$t("tools.createTransTaskVideo")},on:{onBtnClick:i.createTask}}):i._e(),0<i.taskList.length?t("div",{staticClass:"top-root"},[t("my-btn",{staticStyle:{"margin-right":"10px"},attrs:{title:i.$t("tools.createTransTaskVideo")},on:{click:function(t){return i.createTask()}}}),t("Icon",{staticStyle:{color:"grey","font-size":"20px",cursor:"pointer"},attrs:{type:"md-help-circle"},on:{click:function(t){i.showVsAlertDialog(i.$t("help.howToWork"),i.$t("tools.vidTransAlert"))}}})],1):i._e(),t("div",{staticStyle:{width:"100%",height:"100%",display:"flex","flex-direction":"row",overflow:"hidden","padding-top":"60px","padding-left":"10px","padding-right":"10px"}},[t("div",{ref:"listWrapper",staticClass:"task-list"},i._l(i.taskList,function(e){return t("Card",{staticClass:"card-root",attrs:{shadow:"",border:!1}},[t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[t("div",{staticClass:"card-item"},[t("h4",[i._v(i._s(i.$t("movie.createTime"))+":")]),t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(e.create_time))])]),t("div",{staticStyle:{"flex-shrink":"0"}},[t("a",{on:{click:function(t){return i.deleteTask(e)}}},[i._v(i._s(i.$t("common.delete")))])])]),t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[t("div",{staticClass:"card-item"},[t("h4",[i._v(i._s(i.$t("mediaSourcePath"))+":")]),t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(e.taskObj.source_path))])])]),t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[t("div",{staticClass:"card-item"},[t("h4",[i._v(i._s(i.$t("backup.targetPath"))+":")]),t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(e.taskObj.target_path))])])]),t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[t("div",{staticClass:"card-item"},[t("h4",[i._v(i._s(i.$t("home.status"))+":")]),"0"==e.task_state?t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(i.$t("upload.waiting")))]):i._e(),"2"==e.task_state?t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(i.$t("common.succesed")))]):i._e(),"3"==e.task_state?t("p",{staticStyle:{"margin-left":"10px",color:"red"}},[i._v(i._s(i.$t("common.faild")))]):i._e(),"1"==e.task_state?t("p",{staticStyle:{"margin-left":"10px"}},[i._v(i._s(i.$t("state.run")))]):i._e(),e.taskResult?t("p",{staticStyle:{"margin-left":"10px"}},[e.taskResult.copy_size?t("span",[i._v(i._s(i.utils.getSizeStr(e.taskResult.copy_size))+" "),e.taskResult.copy_count?t("span",[i._v("("+i._s(i.$t("file.fileCount",{count:e.taskResult.copy_count}))+")")]):i._e(),i._v(" "+i._s(i.$t("system.copied"))+" ")]):i._e()]):i._e()])])])}),1)]),t("Modal",{attrs:{"footer-hide":""},scopedSlots:i._u([{key:"header",fn:function(){return[t("h4",{staticStyle:{"font-size":"16px"}},[i._v(" "+i._s(i.$t("tools.createTransTaskVideo"))+" ")])]},proxy:!0}]),model:{value:i.showAdd,callback:function(t){i.showAdd=t},expression:"showAdd"}},[i.showAdd?t("videoTransAddTask",{ref:"addTask",attrs:{type:i.operationType,taskId:i.selectId},on:{onClose:i.onAddFinish}}):i._e(),t("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center"}},[t("Button",{staticStyle:{"border-radius":"20px"},attrs:{type:"primary"},on:{click:i.onCreateTask}},[i._v(" "+i._s(i.$t("tools.createTransTaskVideo"))+" ")])],1)],1)],1)},[],!1,null,"28689208",null).exports,myHeader:a.a,imgCompress:c,mediaArrange:p},data:function(){return{sideOptionList:[{id:"imgZip",title:this.$t("tools.imgZip"),font:"nasIcons icon-imageCompress"},{id:"arrange",title:this.$t("tools.arrange"),font:"nasIcons icon-arrange",onlyAdmin:!0}],selectMenu:"imgZip"}},mounted:function(){},beforeDestroy:function(){},methods:{setLeftMenuId:function(t){this.selectMenu=t.id}}},i("6032"),h=Object(u.a)(l,function(){var t=this,e=t._self._c;return e("div",{staticClass:"tools-root"},[e("my-bg"),t._m(0),e("div",{staticClass:"nas-mobile-none"},[e("my-header")],1),e("div",{staticClass:"main-layout nas-padding-right-zero"},[e("div",{staticClass:"sidebar-root"},[e("my-sidebar",{ref:"sidebar",attrs:{name:"tools",optionList:t.sideOptionList},on:{onItemClick:t.setLeftMenuId}})],1),e("div",{staticClass:"sidebar-mobile-root"},[e("my-sidebar-mobile",{ref:"sidebarMobile",attrs:{name:"tools",optionList:t.sideOptionList},on:{onItemClick:t.setLeftMenuId}})],1),e("div",{staticClass:"right-root"},["imgZip"==t.selectMenu?e("imgCompress"):t._e(),"arrange"==t.selectMenu?e("mediaArrange"):t._e()],1)])],1)},[function(){var t=this._self._c;return t("div",{staticClass:"nas-mobile-none"},[t("p",{staticClass:"my-header-position"})])}],!1,null,"4c1ea739",null);e.default=h.exports},"0c1e":function(t,e,i){i("aeef")},"25e9":function(t,e,i){i("acd8"),i("e25e");var a={props:{taskObj:{default:null,type:Object}},computed:{},components:{},data:function(){return{loading:!1,showMsg:!1,recordList:[]}},mounted:function(){this.getAllTaskRecords()},methods:{getRecordMsg:function(t,e){var i=this;this.api.post("/api/backupApi/getTaskRecordMsg",{recordId:t.id}).then(function(t){i.recordList[e].errorList=t.data,i.$forceUpdate()}).catch(function(t){})},getAllTaskRecords:function(){var e=this;this.loading=!0,this.api.post("/api/backupApi/getTaskRecords",{id:this.taskObj.id}).then(function(t){e.recordList=t.data,e.loading=!1}).catch(function(t){e.loading=!1})}}},i=(i("0c1e"),i("2877")),i=Object(i.a)(a,function(){var a=this,s=a._self._c;return s("div",[a.recordList.length<1&&!a.loading?s("p",[a._v(a._s(a.$t("bakcup.noRecords")))]):a._e(),s("div",{staticClass:"root"},a._l(a.recordList,function(e,i){return s("Card",{staticClass:"card-root",attrs:{shadow:"",border:!1}},[s("div",{staticStyle:{width:"100%",height:"100%",display:"flex","flex-direction":"column","align-items":"flex-start"}},[s("div",{staticClass:"card-item"},[s("h4",[a._v(a._s(a.$t("backup.startTime"))+": "+a._s(e.start_time))])]),s("div",{staticClass:"card-item"},[s("h4",[a._v(a._s(a.$t("backup.endTime"))+": "+a._s(e.end_time))])]),s("div",{staticClass:"card-item"},[s("h4",[a._v(a._s(a.$t("backup.copySize"))+": "),e.copy_size/1024<=1024?s("span",[a._v(a._s(parseInt(e.copy_size/1024))+"KB")]):e.copy_size/1024/1024<=1024?s("span",[a._v(a._s(parseInt(e.copy_size/1024/1024))+"MB")]):1024<e.copy_size/1024/1024?s("span",[a._v(" "+a._s(parseFloat(parseInt(e.copy_size/1024/1024/1024*100)/100))+"GB ")]):a._e()])]),s("div",{staticClass:"card-item"},[s("h4",[a._v(a._s(a.$t("backup.copyCount"))+": "+a._s(e.copy_count))])]),s("div",{staticClass:"card-item"},[s("h4",[a._v(a._s(a.$t("backup.excludeCount"))+": "+a._s(e.exclude_count))])]),s("div",{staticClass:"card-item",on:{click:function(t){return a.getRecordMsg(e,i)}}},[e.fail_count?s("a",{staticStyle:{color:"red"}},[a._v(a._s(a.$t("backup.failCount"))+": "+a._s(e.fail_count))]):s("h4",[a._v(a._s(a.$t("backup.failCount"))+": "+a._s(e.fail_count))])]),a._l(e.errorList,function(t){return e.errorList&&0<e.errorList.length?s("div",{staticClass:"card-item",staticStyle:{width:"100%"}},[s("div",{staticStyle:{width:"100%",height:"1px","background-color":"#d8d8d8"}}),s("p",{staticStyle:{color:"red","word-break":"break-all","margin-top":"5px","margin-bottom":"5px"}},[a._v(" "+a._s(t.content)+" ")])]):a._e()})],2)])}),1)])},[],!1,null,"a8bcb004",null);e.a=i.exports},"2b33":function(t,e,i){},"41b6":function(t,e,i){i("2b33")},"49b7":function(t,e,i){},6032:function(t,e,i){i("49b7")},"6a05":function(t,e,i){},"74dc":function(t,e,i){i("6a05")},7526:function(t,e,i){},"83b2":function(t,e,i){i("7526")},aeef:function(t,e,i){},c1b2:function(t,e,i){}}]);