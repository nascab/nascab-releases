(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-56916f66"],{"1eab":function(e,t,i){},"4dd8":function(e,t,o){"use strict";o.r(t);o("14d9");var i=o("1bb5"),l=o("be3b"),a=o("19cb"),r=o.n(a),a=o("d3ac");o("d930");var a={components:{photoDetail:a.default},computed:{getLogoImageUrl(){return localStorage.customLogoImage?l.a.getCustomFileUrl(localStorage.customLogoImage):o("9743")}},data(){return{showUrlDialog:!1,showUrl:"",gotCustomConfig:!1,imgWidth:60,showPhotoDetail:!1,isRoot:!0,parent:"",shareToken:"",fileTree:[],pathSep:"/",platform:"",password:"",selectedFile:null,typeData:i.a,searchStr:""}},mounted(){var e=this.$route.query;this.shareToken=e.shareToken||e.st,this.getFileTree(""),history.pushState(null,null,document.URL),window.addEventListener("popstate",function(){history.pushState(null,null,document.URL)})},beforeDestroy(){},methods:{isWindowsDiskSign(e){return!!e&&!(!(e=e.name||e.fileFullPath)||3!=e.length||":"!=e[1]||"\\"!=e[2]&&"/"!=e[2])},showCopyDialog(e){this.showUrlDialog=!0;let t=this.getRawUrl(e);t.startsWith("http")||(t=l.a.getBaseByLocation()+t),this.showUrl=t},lanIpClick(e){var t=navigator.clipboard;t&&(t.writeText(e),this.showVsNotification(this.$t("linkCopied")))},onSearch(e){this.searchStr=e},onClickDownload(e,t){1==e.type?this.downloadShareFile(e,t):this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("folderDownloadAlert")+`(${e.name||e.fileFullPath})`,()=>{this.downloadShareFile(e,t)})},downloadShareFile(e,t){t=this.getRawUrl(t);this.downloadFile([t])},goPreviewPdf(e){e=l.a.getViewerUrl("pdf",e);this.isMobile?window.location.href=e:window.open(e,"_blank")},goPreviewImage(t){let i=[],a=0;for(let e=0;e<this.fileTree.length;e++)"image"==this.fileTree[e].fileType&&i.push({title:this.fileTree[e].name,type:1,url:this.fileTree[e].url});for(let e=0;e<i.length;e++)if(this.fileTree[t].name==i[e].title){a=e;break}this.showPhotoDetail=!0,this.$nextTick(()=>{this.$refs.photoDetail.showImg(i,a)})},getRawUrl(e){return 1==this.fileTree[e].type?l.a.getRawFileUrl(this.fileTree[e].fileFullPath,this.fileTree[e].name,"",!0)+"&st="+this.shareToken+"&sp="+r.a.encode(this.password):l.a.getRawFileZipUrl(this.fileTree[e].fileFullPath,this.fileTree[e].name)+"&st="+this.shareToken+"&sp="+r.a.encode(this.password)},getDealedPath(e){e=encodeURIComponent(e);return r.a.encode(e)},goBack(){let e=0<this.parent.lastIndexOf(this.pathSep)?this.parent.lastIndexOf(this.pathSep):1,t=this.parent.substring(0,e);"win32"==this.platform&&2==t.length&&":"==t[1]&&(t+=this.pathSep),"win32"==this.platform&&this.parent.length<=4&&":"==this.parent[1]&&(t=""),this.getFileTree(t)},getFileType(e){switch(this.typeData[e]){case 1:return"image";case 2:return"video";case 3:return"text";case 4:return"pdf";case 5:return"music";case 6:return"word";case 7:return"ppt";case 8:return"excel";case 9:return"book";default:return"file"}},onItemClick(e,t){2==(this.selectedFile=e).type?this.enterPath(e):"image"==e.fileType?this.goPreviewImage(t):"pdf"==e.fileType?this.goPreviewPdf(this.getRawUrl(t)):"book"==e.fileType?this.goBookReader(this.getRawUrl(t),e):window.open(this.getRawUrl(t),"_blank")},goBookReader(e,t){localStorage.currentReadBook=JSON.stringify({path:t.parent,filename:t.name});e=l.a.getBookReadUrl(e);this.goUrl(e,t)},goUrl(e,t){this.isFromApp?window.android?window.android.onOpenNewWebViewByPath(e,t.name):window.webkit&&window.webkit.messageHandlers?(t=JSON.stringify({func:"onOpenNewWebViewByPath",path:e,title:t.name}),window.webkit.messageHandlers.bridge.postMessage(t)):window.open(e,"_blank"):window.open(e,"_blank")},enterPath(e){this.getFileTree(e.fileFullPath)},getFileTree(e,t){t&&(this.password=t),this.api.post("/api/file/getTempShareFiles",{parent:e,shareToken:this.shareToken,password:this.password}).then(e=>{if(!e.code){for(var t in this.parent=e.data.parent,this.isRoot=""==this.parent,this.platform=e.data.platform,this.pathSep=e.data.sep,e.data.children.sort((e,t)=>t.type-e.type),this.fileTree=e.data.children,this.fileTree){var i,a;1==this.fileTree[t].type&&(0<=(i=(a=this.fileTree[t].name).lastIndexOf("."))?(a=a.substring(i).toLowerCase(),this.fileTree[t].ext=a,this.fileTree[t].fileType=this.getFileType(a),this.fileTree[t].fileType):this.fileTree[t].fileType="file",this.fileTree[t].url=l.a.getTinyUrlByFilePath(this.fileTree[t].fileFullPath,!0,this.fileTree[t].name)+"&st="+this.shareToken+"&sp="+r.a.encode(this.password),this.fileTree)}if(this.$refs.pwdDialog.setShow(!1),this.$refs.listRoot.scrollTop=0,!this.gotCustomConfig&&e.data.customConfig&&0<e.data.customConfig.length){localStorage.removeItem("customHomeBgImage"),localStorage.removeItem("customLogoImage");for(var s of e.data.customConfig)"customHomeBgImage"==s.title&&"-"!=s.value?localStorage.customHomeBgImage=s.value:"customLogoImage"==s.title&&"-"!=s.value&&(localStorage.customLogoImage=s.value)}this.gotCustomConfig=!0}}).catch(e=>{2==e.code&&(this.$refs.pwdDialog.setShow(!0),e.message)&&this.showVsNotification(e.message)})}}},s=(o("ec4c"),o("2877")),s=Object(s.a)(a,function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("div",{staticClass:"brower-root"},[a.gotCustomConfig?s("my-bg"):a._e(),s("div",{staticClass:"main-layout temp-share-padding"},[a.gotCustomConfig?s("img",{staticStyle:{position:"fixed",left:"30px",top:"15px",height:"30px","object-fit":"contain"},attrs:{src:a.getLogoImageUrl,mode:"widthFix"}}):a._e(),s("div",{staticClass:"content-root"},[s("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"20px","justify-content":"space-between"}},[s("div",{staticStyle:{display:"flex"}},[s("my-btn-icon",{attrs:{disabled:a.isRoot,iIcon:"md-arrow-round-back"},on:{click:function(e){return a.goBack()}}}),s("Slider",{staticStyle:{width:"60px","margin-left":"20px"},attrs:{"show-tip":"never",min:30,max:200,step:10},model:{value:a.imgWidth,callback:function(e){a.imgWidth=e},expression:"imgWidth"}})],1),s("div",[s("my-search",{staticStyle:{"max-width":"220px"},attrs:{placeholder:a.$t("movie.searchPlaceHolder")},on:{onSearch:a.onSearch}})],1)]),s("div",{ref:"listRoot",staticClass:"list-root"},a._l(a.fileTree,function(t,i){return!a.searchStr||a.searchStr&&t.name&&t.name.toLowerCase().includes(a.searchStr.toLowerCase())?s("div",{attrs:{id:"file_"+i}},[s("div",{staticClass:"list-item-list",on:{click:function(e){a.onItemClick(t,i)}}},[s("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",margin:"5px"},style:{width:a.imgWidth+"px",height:a.imgWidth+"px"}},[2==t.type?s("img",{staticStyle:{width:"100%"},attrs:{src:o("60b7")}}):a._e(),1!=t.type||"image"!=t.fileType&&"video"!=t.fileType?a._e():s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.url,expression:"file.url"}],staticClass:"item-img",on:{dragstart:function(e){e.preventDefault()}}}),1==t.type&&"video"==t.fileType?s("span",{staticClass:"play-icon nasIcons icon-play"}):a._e(),1==t.type&&"text"==t.fileType?s("img",{staticClass:"item-img",attrs:{src:o("a481")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"file"==t.fileType?s("img",{staticClass:"item-img",attrs:{src:o("8b5e")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"pdf"==t.fileType?s("img",{staticClass:"item-img",attrs:{src:o("218f")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"music"==t.fileType?s("img",{staticClass:"item-img",attrs:{src:o("1e28")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"word"==t.fileType?s("img",{staticClass:"item-img",attrs:{src:o("9b66")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"excel"==t.fileType?s("img",{staticClass:"item-img",attrs:{src:o("c0ed")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"ppt"==t.fileType?s("img",{staticClass:"item-img",attrs:{src:o("25d4")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"book"==t.fileType?s("div",{staticStyle:{position:"relative",width:"100%",height:"100%"}},[s("img",{staticClass:"item-img",attrs:{src:o("d69a")},on:{dragstart:function(e){e.preventDefault()}}}),t.ext?s("div",{staticStyle:{position:"absolute",left:"0",top:"0",display:"flex","align-items":"center","justify-content":"center",width:"100%",height:"100%"}},[s("div",{staticStyle:{color:"white","font-weight":"bold"}},[a._v(" "+a._s(t.ext.replace(".","").toUpperCase()))])]):a._e()]):a._e()]),s("div",{staticStyle:{flex:"1","padding-top":"5px","padding-bottom":"5px"}},[s("p",{staticClass:"filename"},[a._v(a._s(t.name||t.fileFullPath))]),t.size?s("p",{staticClass:"size"},[a._v(a._s(a.$t("file.size"))+":"+a._s(a.utils.getSizeStr(t.size)))]):a._e(),t.createTime?s("p",{staticClass:"size"},[a._v(a._s(a.$t("movie.createTime"))+":"+a._s(a.utils.formatTimeStamp(t.createTime))+" ")]):a._e()]),s("Tooltip",{attrs:{disabled:a.isMobile,place:"",content:a.$t("copyLink"),placement:"left-start"}},[a.isWindowsDiskSign(t)?a._e():s("Icon",{staticStyle:{"flex-shrink":"0","margin-left":"10px","font-size":"16px"},attrs:{type:"ios-link"},on:{click:function(e){return e.stopPropagation(),a.showCopyDialog(i)}}})],1),a.isWindowsDiskSign(t)?a._e():s("Icon",{staticStyle:{"flex-shrink":"0","margin-left":"10px","font-size":"16px"},attrs:{type:"md-download"},on:{click:function(e){return e.stopPropagation(),a.onClickDownload(t,i)}}})],1),s("div",{staticStyle:{width:"100%",height:"0.5px",background:"lightgrey"}})]):a._e()}),0)]),a.fileTree.length<1?s("my-nodata",{staticStyle:{position:"absolute",width:"100%","margin-top":"150px"},attrs:{title:a.$t("file.withoutSharedFile")}}):a._e()],1),s("my-dialog-input",{ref:"pwdDialog",attrs:{showCloseBtn:!0,title:a.$t("file.accessPwd"),content:""},on:{onOkClick:function(e){return a.getFileTree("",e)}}}),a.showPhotoDetail?s("photo-detail",{ref:"photoDetail",attrs:{enableExif:!1,fromFolderBrower:!0},on:{onClose:function(e){a.showPhotoDetail=!1}}}):a._e(),s("vs-dialog",{scopedSlots:a._u([{key:"header",fn:function(){return[a._v(" "+a._s(a.$t("copyLink"))+" ")]},proxy:!0}]),model:{value:a.showUrlDialog,callback:function(e){a.showUrlDialog=e},expression:"showUrlDialog"}},[s("div",{staticStyle:{"max-width":"400px",display:"flex","justify-content":"center"},on:{click:function(e){return a.lanIpClick(a.showUrl)}}},[s("a",{staticClass:"enable-text-select",staticStyle:{"word-break":"break-all","text-align":"center"}},[a._v(" "+a._s(a.showUrl))])])])],1)},[],!1,null,"74fc742b",null);t.default=s.exports},ec4c:function(e,t,i){"use strict";i("1eab")}}]);