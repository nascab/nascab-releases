(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5c918488","chunk-31f9f2c4","chunk-ac240062","chunk-2d0e48df"],{"0636":function(e,t,i){"use strict";i("3352")},"0d83":function(e,t,i){"use strict";i("b1d0")},"102c":function(e,t,i){"use strict";i("4115")},"11a3":function(e,t,r){"use strict";r("14d9");var a=r("be3b"),i=r("d3ac"),s=r("5d55"),l=r("2cc5"),o=r("c220"),n=r("9453"),n=(r("d930"),{props:{serverType:{type:String,default:"photo"}},components:{photoBottomSelect:n.a,myScrollBar:o.a,movieCollectionList:()=>r.e("chunk-5a283fea").then(r.bind(null,"e54c")),photoDetail:i.default,videoDetail:s.default},data(){return{platform:"",parentPathList:[],dragStartIndex:0,dragEndIndex:0,dragSelectMode:!0,editMode:!1,showFilterDialog:!1,orderField:"photo"==this.serverType?"original_time":"create_time",orderType:"desc",showType:"grid",showCollectionSelectDialog:!1,typeMenuOptionList:[{title:this.$t("photo.all"),id:"0"},{title:this.$t("photo.photo"),id:"1"},{title:this.$t("photo.video"),id:"2"},{title:this.$t("common.folder"),id:"3"}],sliderMin:70,sliderMax:280,sliderValue:100,itemBaseWidth:100,itemWidth:100,itemMargin:5,indexFileList:[],showFileType:"0",systemSep:"/",selectedIndex:null,selectedFile:null,showPhotoDetail:!1,showVideoDetail:!1,scrollTop:0,currentParentPath:"",loading:!1,hasMore:!0,sourcePathList:[],searchStr:"",rightMenuList:[{text:this.$t("file.check"),type:"CHECK"}],mouseX:0,mouseY:0,tipX:0,tipY:0,showTipTimer:null,hoveredFile:null}},created(){this.getFileTree(""),window.addEventListener("resize",this.calImageWidth);var e=localStorage.getItem("folderImageSize"),e=(e&&100<=parseInt(e)&&(this.sliderValue=parseInt(e),this.onSizeChange()),window.addEventListener("popstate",this.onPopstate),localStorage.getItem("folder_view_order_field_"+this.serverType)),e=(e&&(this.orderField=e),localStorage.getItem("folder_view_order_type_"+this.serverType));e&&(this.orderType=e),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("mousemove",this.onMouseMove)},beforeDestroy(){window.removeEventListener("resize",this.calImageWidth),window.removeEventListener("popstate",this.onPopstate),this.sliderValue&&localStorage.setItem("folderImageSize",this.sliderValue),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("mousemove",this.onMouseMove)},methods:{onMouseMove(e){this.mouseX=e.pageX,this.mouseY=e.pageY},onKeyDown(i){if(!this.isShowingDialog()){let e,t=i.key;"="==t?this.sliderValue<this.sliderMax&&(e=this.sliderValue+20):"-"==t?this.sliderValue>this.sliderMin&&(e=this.sliderValue-20):t&&"c"==t.toLowerCase()&&("grid"==this.showType?this.showType="list":this.showType="grid"),e&&(this.sliderValue=e,this.onSizeChange())}},clickBottomPath(e,t){let i="";for(var s in this.parentPathList){if(!(s<=t))break;s=this.parentPathList[s];i+=s}this.hasMore=!0;let o=this.loading=!1;for(var r of this.sourcePathList)if(r,r.startsWith(i)){o=!0;break}i.endsWith(this.systemSep)&&(i=i.substring(0,i.length-1)),this.getFileTree(o?"":i,!1,!1)},parseParentPath(){this.parentPathList=[];var t,i=this.currentParentPath.split(this.systemSep);for(t in i)if("win32"==this.platform){let e=i[t];if(!e)continue;t!=i.length-1&&(e+=this.systemSep),this.parentPathList.push(e)}else i[t]&&this.parentPathList.push(this.systemSep+i[t])},onDeleteSuc(e){for(var t of e)for(let e=this.indexFileList.length-1;0<=e;e--)if(this.indexFileList[e].id==t){this.indexFileList.splice(e,1);break}},onMouseDown(e,t){e&&1==e.buttons&&(this.isInDragSelectMode=!0,this.dragSelectMode=!this.indexFileList[t].selected,this.dragStartIndex=t)},onMouseUp(e){this.isInDragSelectMode=!1},onMouseLeaveRoot(){this.isInDragSelectMode=!1},setDragRange(){var t=this.dragStartIndex>this.dragEndIndex?this.dragEndIndex:this.dragStartIndex,i=this.dragStartIndex>this.dragEndIndex?this.dragStartIndex:this.dragEndIndex;for(let e=t;e<=i;e++)this.dragSelectMode?this.indexFileList[e].selected||this.onHoverSelected(e):this.indexFileList[e].selected&&this.onHoverSelected(e)},mouseEnterImg(e){this.isInDragSelectMode?(this.dragEndIndex=e,this.setDragRange(),this.hoveredFile=null):this.isMobile||(this.indexFileList[e].hover=!0,this.$forceUpdate(),this.$refs.folderViewEasyCm&&this.$refs.folderViewEasyCm.show)||(this.showTipTimer=setTimeout(()=>{this.tipX=this.mouseX,this.tipY=this.mouseY,this.hoveredFile=this.indexFileList[e]},500))},mouseLeaveImg(e){this.isMobile||(this.indexFileList[e].hover=!1,this.showTipTimer&&clearTimeout(this.showTipTimer),this.hoveredFile=null)},onHoverSelected(e){this.editMode=!0,this.onItemClick(e)},onClickOrder(){this.hasMore=!0,this.loading=!1,this.getFileTree(this.currentParentPath),this.clearSelectedList(),localStorage.setItem("folder_view_order_field_"+this.serverType,this.orderField),localStorage.setItem("folder_view_order_type_"+this.serverType,this.orderType)},showRightMenu(e,t,i,s){this.selectedFile=i,this.selectedIndex=s,this.initRightMenu(i),this.$easycm(e,t,"folderView")},showRightMenuBg(e,t){this.initRightMenuBg(),this.$easycm(e,t,"folderView")},initRightMenuBg(){this.rightMenuList=[{text:this.$t("common.refresh"),type:"REFRESH"}]},initRightMenu(e){this.rightMenuList=[{text:this.$t("file.check"),type:"CHECK"}],this.rightMenuList.push({text:this.$t("setting.scan"),type:"SCAN"}),e.root||(this.rightMenuList.push({text:this.$t("common.delete"),type:"DELETE"}),this.rightMenuList.push({text:this.$t("common.download"),type:"DOWNLOAD"})),"photo"==this.serverType&&1!=this.selectedFile.is_file&&this.rightMenuList.push({text:this.$t("photo.createAlbumByFolder"),type:"CREATE_ALBUM"}),this.serverType,this.selectedFile,"movie"==this.serverType&&(1==this.selectedFile.is_file&&2==this.selectedFile.type||0==this.selectedFile.is_file)&&this.rightMenuList.push({text:this.$t("movie.addToCollection"),type:"ADD_TO_COLLECTION"}),this.showOpenInSystem&&(this.rightMenuList.push({text:this.$t("openInSystem"),type:"OPEN_IN_SYSTEM"}),this.rightMenuList.push({text:this.$t("selectedInSystem"),type:"SELECT_IN_SYSTEM"}))},rightMenuClick(e,t){t=t||this.rightMenuList[e[0]].type;"CHECK"==t?this.onItemClick(this.selectedIndex):"CREATE_ALBUM"==t?this.$refs.addAlbumDialog.setShow(!0):"DOWNLOAD"==t?this.selectedFile.selected?this.$bus.$emit("onDownloadSelectedListMsg"):(e=this.indexFileList[this.selectedIndex]).is_file&&e.rawUrl?this.downloadFile([e.rawUrl]):e.path&&e.filename&&(e=a.a.getRawFileZipUrl(e.path+this.systemSep+e.filename,e.filename),this.downloadFile([e])):"DELETE"==t?(this.selectedFile.selected||this.onHoverSelected(this.selectedIndex),this.$bus.$emit("onDeleteFromDiskMsg")):"ADD_TO_COLLECTION"==t?this.showChooseCollection():"OPEN_IN_SYSTEM"==t?1!=this.selectedFile.is_file&&this.selectedFile.root?this.openInSystem(null,null,this.selectedFile.path):this.openInSystem(this.selectedFile.path,this.selectedFile.filename):"SELECT_IN_SYSTEM"==t?1!=this.selectedFile.is_file&&this.selectedFile.root?this.openInSystem(null,null,this.selectedFile.path,"showItemInFolder"):this.openInSystem(this.selectedFile.path,this.selectedFile.filename,null,"showItemInFolder"):"REFRESH"==t?this.onClickOrder():"SCAN"==t&&(e="",e=1==this.selectedFile.is_file||this.selectedFile.root?this.selectedFile.path:this.selectedFile.path+this.systemSep+this.selectedFile.filename,this.scanPath(this.serverType,e))},showChooseCollection(){this.showCollectionSelectDialog=!0},onSelectCollectionApi(){var e;this.$refs.movieCollectionList&&(e=this.$refs.movieCollectionList.getSelectedCollectionId())&&(e={collectionId:e},this.selectedFile.id?e.indexId=this.selectedFile.id:(e.filepath=this.selectedFile.path,e.filename=this.selectedFile.filename),this.api.post("/api/movieApi/addIndexToCollection",e).then(e=>{e.code||(this.showCollectionSelectDialog=!1,this.showVsNotification(this.$t("common.operationSuccess")),this.removeSelectedFileFromList())}).catch(e=>{}))},onSelectCollection(e){1!=this.selectedFile.is_file?this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("movie.addToCollectionFolderAlert"),()=>{this.onSelectCollectionApi(e)}):this.onSelectCollectionApi(e)},createAlbumByFolderApi(t){if(t){let e=this.selectedFile.path;this.selectedFile.root||(e=this.selectedFile.path+this.systemSep+this.selectedFile.filename),this.api.post("/api/ordinaryAlbumApi/addAlbum",{name:t,parentPath:e}).then(e=>{e.code||this.showVsNotification(this.$t("common.operationSuccess"))})}},onPopstate(){this.showPhotoDetail?(this.$refs.photoDetail.closeGallery(),this.showPhotoDetail=!1):this.showVideoDetail?this.showVideoDetail=!1:this.currentParentPath?this.returnLast():this.$router.go(-1)},onSearch(e){this.searchStr=e,this.onChooseFileType(this.showFileType)},onSizeChange(){this.itemBaseWidth!=this.sliderValue&&(this.itemBaseWidth=this.sliderValue,this.calImageWidth())},calImageWidth(){var e;this.$refs.photoWrapper&&(e=this.$refs.photoWrapper.getBoundingClientRect(),e=this.utils.calItemWidth(e,this.itemBaseWidth,this.itemMargin))&&(this.itemWidth=e)},onChooseFileType(e){this.hasMore=!0,this.loading=!1,this.indexFileList=[],this.showFileType=e,this.getFileTree(this.currentParentPath)},onPageScroll(e){this.showPhotoDetail||this.showVideoDetail||this.loading||(this.$refs.folderViewEasyCm&&this.$refs.folderViewEasyCm.show&&this.$refs.folderViewEasyCm.hide(),this.$refs.scrollBar&&this.$refs.scrollBar.onScroll(e),this.dealOnPageScroll(e,()=>{this.loadNextPage()},e=>{}))},returnLast(){this.clearSelectedList(),this.hasMore=!0,this.loading=!1,this.indexFileList=[];let t=!(this.showFileType="0");for(let e=0;e<this.sourcePathList.length;e++)if(this.currentParentPath==this.sourcePathList[e]){t=!0;break}var e;t?this.getFileTree("",!1,!0):(e=this.currentParentPath.lastIndexOf(this.systemSep),e=this.currentParentPath.substr(0,e),this.getFileTree(e,!1,!0))},loadNextPage(){this.getFileTree(this.currentParentPath,!0)},clearSelectedList(){this.$refs.selectView.clearSelected();for(var e of this.indexFileList)e.selected=!1;this.editMode=!1,this.dragSelectMode=!1},onItemClick(e){if(this.$refs.folderViewEasyCm&&this.$refs.folderViewEasyCm.show)return this.$refs.folderViewEasyCm.hide();this.indexFileList[e],this.selectedFile=this.indexFileList[e],this.selectedIndex=e,this.editMode&&!this.selectedFile.root?(this.indexFileList[e].selected?(this.indexFileList[e].selected=!1,this.$refs.selectView.removeSelected(this.indexFileList[e].id),this.$refs.selectView.selectedList.length<1&&(this.editMode=!1)):(this.$refs.selectView.addSelected(this.indexFileList[e]),this.indexFileList[e].selected=!0),this.$forceUpdate()):1==this.selectedFile.is_file?this.clickFile(e):this.clickFolder(e)},clickFolder(e){this.selectedFile=this.indexFileList[e],this.hasMore=!0,this.loading=!1,this.indexFileList=[],this.showFileType="0",this.searchStr="",this.selectedFile.root?this.getFileTree(this.selectedFile.path):this.getFileTree(this.selectedFile.path+this.systemSep+this.selectedFile.filename)},clickFile(e){e=parseInt(e);let t=this.indexFileList[e],i=e,s=[];for(var o of this.indexFileList)1!=o.is_file||1!=o.type&&2!=o.type||s.push(o);for(var r in s)if(s[r].id==t.id){i=r;break}1==s[i].type?(this.showPhotoDetail=!0,this.$nextTick(()=>{this.$refs.photoDetail.showImg(s,i)}),this.pushState()):2==s[i].type&&("1"==localStorage.getItem("rawPlayer")||this.isIosSupportRawPlayer()?l.a.playVideo({playIndex:i,playList:s,token:this.$store.state.token,fromFileBrower:!1,serverType:this.serverType}):(this.showVideoDetail=!0,this.$nextTick(()=>{this.$refs.folderViewVideoPlayer.playVideo(s,i)}),this.pushState()))},getFileTree(s,o,r){if(this.hoveredFile=null,!this.loading&&this.hasMore){this.loading=!0;let e=0;o&&0<this.indexFileList.length&&(e=this.indexFileList.length);var t={parent:s,serveType:this.serverType,count:100,offset:e,orderField:this.orderField,orderType:this.orderType,showFileType:this.showFileType};this.searchStr&&(t.searchStr=this.searchStr),this.api.post("/api/photoApi/getFileTreePhoto",t).then(t=>{if(!t.code){if(!s){this.sourcePathList=[];for(let e=0;e<t.data.length;e++)this.sourcePathList.push(t.data[e].path)}this.currentParentPath=s,t.data.length<100&&(this.hasMore=!1),this.systemSep=t.sep,this.platform=t.platform;for(let e=0;e<t.data.length;e++){var i=t.data[e];i.root?t.data[e].tipName=i.path:i.path.endsWith(this.systemSep)?t.data[e].tipName=i.path+i.filename:t.data[e].tipName=i.path+this.systemSep+i.filename,!i.is_file||1!=i.type&&2!=i.type||(i.url=a.a.getImgFullPath(t.data[e].id,!0,t.data[e].filename,this.serverType),i.rawUrl=a.a.getImgFullPath(t.data[e].id,!1,t.data[e].filename,this.serverType))}if(o)for(var e=0;e<t.data.length;e++)t.data[e],this.indexFileList.push(t.data[e]);else this.indexFileList=t.data;this.parseParentPath(),this.$refs.folderViewEasyCm&&this.$refs.folderViewEasyCm.show&&this.$refs.folderViewEasyCm.hide()}this.loading=!1,this.$nextTick(()=>{this.calImageWidth()}),r||this.pushState(),this.hasMore}).catch(e=>{this.loading=!1})}}}}),o=(r("406f"),r("2877")),i=Object(o.a)(n,function(){var s=this,e=s.$createElement,o=s._self._c||e;return o("div",{staticClass:"folder-root",on:{contextmenu:function(e){return e.stopPropagation(),s.showRightMenuBg(e,s.$root)}}},[o("div",{staticClass:"folder-header"},[o("div",{staticClass:"top-operation"},[o("my-btn-icon",{staticStyle:{"margin-right":"15px"},attrs:{disabled:!s.currentParentPath,iIcon:"md-arrow-round-back"},on:{click:function(e){return s.returnLast()}}}),o("span",{staticClass:"nasIcons icon-filter  operation-icon",on:{click:function(e){s.showFilterDialog=!0}}}),o("Poptip",{attrs:{placement:"bottom"},scopedSlots:s._u([{key:"content",fn:function(){return[o("div",{staticClass:"sort-root"},[o("div",[s._v(s._s(s.$t("common.sortField")))]),o("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":s.onClickOrder},model:{value:s.orderField,callback:function(e){s.orderField=e},expression:"orderField"}},[o("Radio",{attrs:{label:"filename"}},[o("span",[s._v(s._s(s.$t("movie.filename")))])]),"photo"==s.serverType?o("Radio",{attrs:{label:"original_time"}},[o("span",[s._v(s._s(s.$t("private.shootTime")))])]):s._e(),o("Radio",{attrs:{label:"create_time"}},[o("span",[s._v(s._s(s.$t("movie.createTime")))])]),o("Radio",{attrs:{label:"size"}},[o("span",[s._v(s._s(s.$t("file.size")))])]),"movie"==s.serverType?o("Radio",{attrs:{label:"filename_number"}},[o("span",[s._v(s._s(s.$t("number")))])]):s._e()],1),o("div",{staticStyle:{"margin-top":"15px"}},[s._v(s._s(s.$t("common.sortType")))]),o("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":s.onClickOrder},model:{value:s.orderType,callback:function(e){s.orderType=e},expression:"orderType"}},[o("Radio",{attrs:{label:"asc"}},[o("span",[s._v(s._s(s.$t("common.asc")))])]),o("Radio",{attrs:{label:"desc"}},[o("span",[s._v(s._s(s.$t("common.desc")))])])],1)],1)]},proxy:!0}])},["asc"==s.orderType?o("span",{staticClass:"nasIcons icon-sort-alpha-up operation-icon"}):s._e(),"desc"==s.orderType?o("span",{staticClass:"nasIcons icon-sort-alpha-down-alt operation-icon"}):s._e()]),s.currentParentPath?o("my-menu-select",{staticStyle:{"margin-right":"20px"},attrs:{optionList:s.typeMenuOptionList},on:{onItemClick:s.onChooseFileType}}):s._e(),o("div",{staticClass:"search-root"},[o("my-search",{staticStyle:{width:"200px"},attrs:{placeholder:s.$t("common.pleaseInputSearchContent")},on:{onSearch:s.onSearch}})],1)],1)]),o("div",{staticStyle:{width:"100%",height:"100%",display:"flex","flex-direction":"column",overflow:"hidden","padding-top":"60px"}},[o("div",{ref:"photoWrapper",staticClass:"file-list",on:{scroll:s.onPageScroll}},[s._l(s.indexFileList,function(t,i){return o("div",{key:t.id,staticStyle:{cursor:"pointer",position:"relative"},style:{margin:s.itemMargin+"px",width:"grid"==s.showType?s.itemWidth+"px":"100%"},on:{mouseenter:function(e){return s.mouseEnterImg(i)},mouseleave:function(e){return s.mouseLeaveImg(i)},contextmenu:function(e){return s.showRightMenu(e,s.$root,t,i)},mousedown:function(e){return s.onMouseDown(e,i)},mouseup:function(e){return s.onMouseUp(i)},click:function(e){return s.onItemClick(i)}}},[0==parseInt(t.is_file)?o("div",{class:{"item-folder":"grid"==s.showType,"item-folder-list":"list"==s.showType}},[o("img",{style:{width:s.itemWidth+"px"},attrs:{src:r("60b7")}}),o("p",{class:{filename:"grid"==s.showType,"filename-list":"list"==s.showType}},[s._v(s._s(t.root?t.path:t.filename))])]):s._e(),1==parseInt(t.is_file)?o("div",{class:{"item-folder":"grid"==s.showType,"item-folder-list":"list"==s.showType}},[o("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[o("div",{staticStyle:{position:"relative",display:"flex","align-items":"center","justify-content":"center"},style:{width:s.itemWidth+"px"}},[o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.url,expression:"file.url"}],staticStyle:{"object-fit":"cover","border-radius":"6px"},style:{width:s.itemWidth+"px",height:s.itemWidth+"px"},on:{dragstart:function(e){e.preventDefault()}}}),2==t.type?o("div",{staticClass:"icon-play-root"},[o("Button",{staticStyle:{height:"25px"},attrs:{type:"text",ghost:""}},[o("span",{staticClass:"nasIcons icon-play",staticStyle:{"font-size":"20px","line-height":"25px"}})]),o("p",{staticClass:"icon-duration"},[s._v(s._s(s.utils.formatSeconds(t.duration)))])],1):s._e()])]),o("div",[o("div",{class:{filename:"grid"==s.showType,"filename-list":"list"==s.showType}},[s._v(" "+s._s(t.filename)+" ")]),t.size&&"list"==s.showType?o("div",{staticClass:"size-list"},[s._v(" "+s._s(s.utils.getSizeStr(t.size))+" ")]):s._e()])]):s._e(),t.root?s._e():o("div",{directives:[{name:"show",rawName:"v-show",value:t.hover&&!t.selected,expression:"file.hover && !file.selected"}],staticClass:"photo-hover-mask"},[o("span",{staticClass:"photo-select-icon-hover nasIcons icon-radio-unchecked",style:{right:s.itemMargin+.02*s.itemWidth+"px",top:.05*s.itemWidth+"px"},on:{click:function(e){return e.stopPropagation(),s.onHoverSelected(i)}}})]),t.selected&&!t.root?o("div",{staticClass:"photo-select-mask"},[o("span",{staticClass:"photo-select-icon-hover nasIcons icon-radio-checked",style:{right:s.itemMargin+.02*s.itemWidth+"px",top:.05*s.itemWidth+"px"}})]):s._e(),s.isMobile&&!t.selected?o("i",{staticClass:"nasIcons icon-shenglve more",style:{left:s.itemMargin+.02*s.itemWidth+"px",top:.05*s.itemWidth+"px"},on:{click:function(e){return e.stopPropagation(),s.showRightMenu(e,s.$root,t,i)}}}):s._e()])}),o("div",{staticStyle:{display:"flex","justify-content":"center",width:"100%","flex-direction":"column","align-items":"center"}},[s.hasMore&&0<s.indexFileList.length?o("Button",{staticStyle:{width:"250px","margin-top":"30px",height:"45px","border-radius":"20px"},attrs:{type:"default"},on:{click:function(e){return s.loadNextPage()}}},[s._v(s._s(s.$t("common.loadmore")))]):s._e(),s.loading?o("Spin",{staticStyle:{"margin-top":"30px"},attrs:{size:"large"}}):s._e(),s.loading||s.hasMore?s._e():o("span",{staticStyle:{"margin-top":"30px"}},[s._v(s._s(s.$t("common.noMore")))]),o("div",{staticStyle:{height:"50px"}})],1)],2),o("div",{directives:[{name:"show",rawName:"v-show",value:s.editMode,expression:"editMode"}],staticClass:"bottom-select-root"},[o("photo-bottom-select",{ref:"selectView",attrs:{pathSep:s.systemSep,ignoreLivephoto:1,serverType:s.serverType,editMode:s.editMode,showAddToAlbum:!1,isInFolderView:!0},on:{onUnSelect:function(e){return s.clearSelectedList()},onDeleteSuc:s.onDeleteSuc}})],1),o("div",{directives:[{name:"show",rawName:"v-show",value:!s.editMode,expression:"!editMode"}],staticClass:"path-root"},[s._l(s.parentPathList,function(t,i){return o("a",{staticStyle:{"font-size":"14px","flex-shrink":"0","margin-left":"5px"},style:{color:i==s.parentPathList.length-1?"#386DF2":"#999999"},on:{click:function(e){return s.clickBottomPath(t,i)}}},[s._v(" "+s._s(t))])}),s.parentPathList.length<1?o("a",[s._v(s._s(s.$t("file.rootPath")))]):s._e()],2)]),o("my-dialog-input",{ref:"addAlbumDialog",attrs:{placeholder:s.$t("album.albumName"),showCloseBtn:!0,content:s.$t("album.albumName"),title:s.$t("album.addAOrdinaryAlbum")},on:{onOkClick:s.createAlbumByFolderApi}}),o("vs-dialog",{attrs:{scroll:""},scopedSlots:s._u([{key:"footer",fn:function(){return[o("vs-button",{attrs:{block:""},on:{click:s.onSelectCollection}},[s._v(" "+s._s(s.$t("common.select"))+" ")])]},proxy:!0}]),model:{value:s.showCollectionSelectDialog,callback:function(e){s.showCollectionSelectDialog=e},expression:"showCollectionSelectDialog"}},[o("movie-collection-list",{ref:"movieCollectionList",staticStyle:{"margin-top":"10px"},attrs:{selectMode:!0}})],1),s.showCollectionSelectDialog||s.showPhotoDetail||s.showVideoDetail?s._e():o("my-scroll-bar",{ref:"scrollBar"}),s.showPhotoDetail?o("photo-detail",{ref:"photoDetail",attrs:{serverType:s.serverType,enableRemove:!0},on:{onClose:function(e){s.showPhotoDetail=!1}}}):s._e(),o("Modal",{attrs:{fullscreen:"","footer-hide":"",closable:!1},model:{value:s.showVideoDetail,callback:function(e){s.showVideoDetail=e},expression:"showVideoDetail"}},[s.showVideoDetail?o("video-detail",{ref:"folderViewVideoPlayer",attrs:{propsServerType:s.serverType},on:{onClose:function(e){s.showVideoDetail=!1}}}):s._e()],1),o("vs-dialog",{attrs:{scroll:""},model:{value:s.showFilterDialog,callback:function(e){s.showFilterDialog=e},expression:"showFilterDialog"}},[o("div",[o("div",{staticStyle:{height:"10px"}}),o("div",{staticClass:"nas-mobile-none slider-root"},[o("p",{staticStyle:{"text-align":"left","flex-shrink":"0","font-weight":"bold"}},[s._v(s._s(s.$t("imageSize"))+":")]),o("div",[o("Slider",{staticClass:"zoom-slider",attrs:{"show-tip":"never",min:s.sliderMin,max:s.sliderMax,step:10},on:{"on-input":s.onSizeChange},model:{value:s.sliderValue,callback:function(e){s.sliderValue=e},expression:"sliderValue"}})],1)]),o("Divider"),o("div",{staticStyle:{display:"flex","align-items":"center"}},[o("p",{staticStyle:{"text-align":"left","flex-shrink":"0","font-weight":"bold"}},[s._v(s._s(s.$t("file.showType"))+":")]),o("RadioGroup",{staticStyle:{"text-align":"left","margin-left":"10px"},model:{value:s.showType,callback:function(e){s.showType=e},expression:"showType"}},[o("Radio",{attrs:{label:"grid"}},[o("Icon",{attrs:{type:"md-grid"}}),o("span",[s._v(s._s(this.$t("movie.gridView")))])],1),o("Radio",{attrs:{label:"list"}},[o("Icon",{attrs:{type:"md-list"}}),o("span",[s._v(s._s(this.$t("movie.listView")))])],1)],1)],1)],1)]),o("easy-cm",{ref:"folderViewEasyCm",attrs:{list:s.rightMenuList,tag:"folderView"},on:{ecmcb:s.rightMenuClick}}),s.hoveredFile&&"grid"==s.showType?o("div",{staticClass:"file-tip",style:{top:s.tipY+"px",left:s.tipX+"px"}},[s.hoveredFile?o("p",{staticClass:"size"},[o("span",{staticStyle:{"font-weight":"bold"}},[s._v(s._s(s.$t("common.name")))]),s._v(":"+s._s(s.hoveredFile.filename))]):s._e(),s.hoveredFile.original_time?o("p",{staticClass:"size"},[o("span",{staticStyle:{"font-weight":"bold"}},[s._v(s._s(s.$t("movie.createTime")))]),s._v(":"+s._s(s.utils.formatTimeStamp(s.hoveredFile.original_time))+" ")]):s._e(),s.hoveredFile.size?o("p",{staticClass:"size"},[o("span",{staticStyle:{"font-weight":"bold"}},[s._v(s._s(s.$t("file.size")))]),s._v(":"+s._s(s.utils.getSizeStr(s.hoveredFile.size)))]):s._e()]):s._e()],1)},[],!1,null,"11975fab",null);t.a=i.exports},"135d":function(e,t,i){"use strict";i("c161")},1768:function(e,t,i){"use strict";i("3791")},"1b11":function(e,t,i){"use strict";i("377e")},2895:function(e,t,i){"use strict";i("4bcf")},3016:function(e,t,i){},3352:function(e,t,i){},"377e":function(e,t,i){},3791:function(e,t,i){},"3af5":function(e,t,i){"use strict";i("3b13")},"3b13":function(e,t,i){},"3cb8":function(e,t,i){},"3f29":function(e,t,i){"use strict";i("96db")},"406f":function(e,t,i){"use strict";i("96da")},4115:function(e,t,i){},"4bcf":function(e,t,i){},"644c":function(e,t,i){"use strict";var s={props:{itemWidth:{default:140,type:Number},itemMargin:{default:0,type:Number},movie:{default:"",type:Object},isHistoryItem:{default:!1,type:Boolean}},created(){},mounted(){},beforeDestroy(){},computed:{},components:{},data(){return{}},methods:{onMoreClick(e,t){this.$bus.$emit("eventOnShowRightMenu",this.isHistoryItem?"movieItemHistory":"movieItem",this.movie,null,e,t)}}},i=(i("2895"),i("2877")),i=Object(i.a)(s,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticStyle:{"padding-right":"10px"}},[e("div",{staticClass:"movie-item-root-list",style:{height:t.itemWidth/3*4+"px"}},[e("div",{staticClass:"cover-root"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.movie.url,expression:"movie.url"}],staticClass:"movie-cover-list",style:{height:t.itemWidth/3*4+"px",width:t.itemWidth+"px"}}),t.movie.hover?e("div",{staticClass:"hover-root"},[e("Button",{staticStyle:{height:"40px"},attrs:{type:"text",ghost:""},on:{click:function(e){return e.stopPropagation(),t.$emit("playClick")}}},[e("span",{staticClass:"nasIcons icon-play",staticStyle:{"font-size":"40px","line-height":"40px"}})])],1):t._e(),t.movie.movie_douban_score&&0<t.movie.movie_douban_score?e("div",{staticClass:"movie-score-bg"},[e("i-Circle",{attrs:{"trail-width":8,"stroke-width":8,"trail-color":"#fff","stroke-color":"#a9d06b",size:30,percent:parseInt(10*t.movie.movie_douban_score)}},[e("span",{staticClass:"movie-score"},[t._v(" "+t._s(parseInt(10*t.movie.movie_douban_score)/10)+" ")])])],1):t._e(),t.movie.history?e("span",{staticStyle:{"font-size":"10px",color:"#ccc",position:"absolute",left:"5px",bottom:"5px"}},[t._v(t._s(t.$t("watched")))]):t._e(),t.movie.hover||!t.movie.is_tvplay||t.isHistoryItem?t._e():e("div",[t.movie.seasonCount&&1<t.movie.seasonCount?e("div",{staticClass:"video-type-sign",staticStyle:{background:"#DA3232"}},[e("span",[t._v(t._s(t.movie.seasonCount)+" "+t._s(t.$t("season"))+" ")])]):e("div",{staticClass:"video-type-sign",staticStyle:{background:"#386DF2"}},[e("span",[t._v(t._s(t.movie.tvCount)+" "+t._s(t.$t("episode"))+" ")])])]),t.movie.hover?e("div",{staticClass:"favorite-root"},[e("span",{staticClass:"nasIcons icon-xihuan-shi",style:{color:t.movie.favorite?"#DE4545":"white"},on:{click:function(e){return e.stopPropagation(),t.$bus.$emit("eventOnFavoriteMovie",t.movie)}}})]):t._e()]),e("div",{staticClass:"right-root"},[e("p",{staticClass:"filename max-line-two"},[t._v(" "+t._s(t.isHistoryItem?t.movie.filename:t.movie.show_name)+" "),t.movie.movie_year?e("span",[t._v("["+t._s(parseInt(t.movie.movie_year))+"]")]):t._e()]),e("div",{staticClass:"list-item-line max-line-one"},[e("span",{staticClass:"item-title"},[t._v(t._s(t.$t("common.folder"))+":")]),e("span",{staticClass:"item-content"},[t._v(t._s(t.movie.path))])]),e("p",{staticClass:"list-item-line max-line-one"},[e("span",{staticClass:"item-title"},[t._v(t._s(t.$t("movie.filename"))+":")]),e("span",{staticClass:"item-content"},[t._v(t._s(t.movie.filename))])]),t.movie.is_tvplay?t._e():e("p",{staticClass:"list-item-line"},[e("span",{staticClass:"item-title"},[t._v(t._s(t.$t("video.duration"))+":")]),e("span",{staticClass:"item-content"},[t._v(t._s(t.utils.formatSeconds(t.movie.duration))+" "),e("span",{staticStyle:{"margin-left":"5px"}},[t._v("["+t._s(t.movie.sizeStr)+"]")])])])])]),t.isMobile?e("i",{staticClass:"nasIcons icon-shenglve more",on:{click:function(e){return e.stopPropagation(),t.onMoreClick(e,t.$root)}}}):t._e()])},[],!1,null,"d36998bc",null);t.a=i.exports},"66af":function(e,t,i){"use strict";var s=i("9ea7"),o=i("644c"),o={props:{itemWidth:{default:140,type:Number},itemMargin:{default:6,type:Number},showType:{default:"grid",type:String},movie:{default:"",type:Object},movieIndex:{default:0,type:Number},isHistoryItem:{default:!1,type:Boolean}},created(){this.useMovieIndex=this.movie},mounted(){this.$bus.$on("eventOnMovieObjRefresh",this.onMovieObjRefresh)},beforeDestroy(){this.$bus.$off("eventOnMovieObjRefresh",this.onMovieObjRefresh)},computed:{},components:{movieListItemList:o.a,movieListItemGrid:s.a},data(){return{useMovieIndex:null}},methods:{onMovieObjRefresh(e){this.useMovieIndex.id==e.id&&(e.filename,e.hidden,this.useMovieIndex=e)},mouseEnterImg(){this.isMobile||this.$set(this.useMovieIndex,"hover",!0)},mouseLeaveImg(){this.isMobile||this.$set(this.useMovieIndex,"hover",!1)},onFavoriteChange(e,t){e==this.useMovieIndex.id&&(this.useMovieIndex.favorite=t)}}},s=(i("102c"),i("2877")),i=Object(s.a)(o,function(){var t=this,e=t.$createElement,e=t._self._c||e;return t.useMovieIndex&&1!=t.useMovieIndex.hidden?e("div",{staticStyle:{position:"relative"},on:{click:function(e){return t.$emit("movieClick",t.movieIndex)},contextmenu:function(e){return t.$bus.$emit("eventOnShowRightMenu","movieItem",t.movie,null,e,t.$root)},mouseenter:t.mouseEnterImg,mouseleave:t.mouseLeaveImg}},["grid"==t.showType?e("div",{staticClass:"movie-item-root",staticStyle:{"padding-bottom":"10px",cursor:"pointer"},style:{margin:t.itemMargin+"px",width:t.itemWidth+"px"}},[e("movie-list-item-grid",{attrs:{movie:t.useMovieIndex,itemWidth:t.itemWidth,isHistoryItem:t.isHistoryItem},on:{playClick:function(e){return t.$emit("playClick",t.movieIndex)},favoriteMovie:function(e){return t.$emit("favoriteMovie",t.movieIndex)}}})],1):t._e(),"list"==t.showType?e("div",{staticStyle:{display:"flex","flex-direction":"column",width:"100%",cursor:"pointer"}},[e("movie-list-item-list",{attrs:{movie:t.useMovieIndex,itemWidth:t.itemWidth,itemMargin:t.itemMargin,isHistoryItem:t.isHistoryItem},on:{playClick:function(e){return t.$emit("playClick",t.movieIndex)},favoriteMovie:function(e){return t.$emit("favoriteMovie",t.movieIndex)}}})],1):t._e()]):t._e()},[],!1,null,"207711cc",null);t.a=i.exports},"7ddb":function(e,t,i){"use strict";i("14d9");var s={props:{hideAdmin:{default:!1,type:Boolean}},components:{},data(){return{userList:[],selectedUser:""}},mounted(){this.getAllUser()},methods:{onSelect(e){this.$emit("onSelect",this.userList[e])},getAllUser(){this.api.post("/api/usersApi/getAllUser",{}).then(e=>{if(!e.code)for(var t of e.userList)this.hideAdmin&&t.is_admin||this.userList.push(t)}).catch(e=>{102==e.code&&(this.btnCanUse=!1)})}}},i=(i("3af5"),i("2877")),i=Object(i.a)(s,function(){var i=this,e=i.$createElement,s=i._self._c||e;return s("div",{staticStyle:{height:"100%",padding:"20px"}},[i._l(i.userList,function(e,t){return s("div",{key:e.id},[s("div",{staticClass:"user-item"},[s("Avatar",{attrs:{icon:"ios-person",size:"large"}}),s("p",{staticClass:"username",staticStyle:{"margin-left":"10px","max-width":"150px"}},[i._v(i._s(e.username))]),1==e.is_admin?s("Tag",{staticClass:"usertype",staticStyle:{"margin-left":"10px"},attrs:{color:"geekblue"}},[i._v(" "+i._s(i.$t("user.admin")))]):s("Tag",{staticClass:"usertype",staticStyle:{"margin-left":"10px"},attrs:{color:"default"}},[i._v(i._s(i.$t("user.commonUser")))]),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"error"},on:{click:function(e){return i.onSelect(t)}}},[i._v(i._s(i.$t("common.select")))])],1),t!=i.userList.length-1?s("Divider"):i._e()],1)}),i.userList.length<1?s("div",{staticClass:"text-no-user"},[i._v(i._s(i.$t("user.noUserToChoose")))]):i._e()],2)},[],!1,null,"97e9d38e",null);t.a=i.exports},"896a":function(e,t,i){"use strict";i("cfff")},"8fad":function(e,t,i){"use strict";i.r(t);var s={props:{propsGeoHash:{default:"",type:String},propsOrdinaryAlbumId:{default:"",type:String},propsAlbumId:{default:"",type:String},propsLibraryId:{default:"",type:String},propsNearMode:{default:!1,type:Boolean},propsShowRemoveFromAlbum:{default:!1,type:Boolean},propsShowAddToAlbum:{default:!1,type:Boolean},propsShowSearchBtn:{default:!1,type:Boolean},propsTitle:{default:"",type:String},propsShowModeSwitch:{default:!1,type:Boolean},propsShowDelete:{default:!1,type:Boolean},propsFaceId:{default:"",type:String},propsAiClassId:{default:"",type:String}},components:{photoTimelineContent:()=>Promise.all([i.e("chunk-1e8b375e"),i.e("chunk-31f9f2c4")]).then(i.bind(null,"cd79")),photoMap:()=>i.e("chunk-ddb87040").then(i.bind(null,"0bd4"))},data(){return{aiClassId:"",faceId:"",ordinaryAlbumId:"",showAddToAlbum:!1,dataMode:"list",showDelete:!1,showModeSwitch:!1,title:"",geoHash:"",albumId:"",nearMode:!1,showSearchBtn:!1,openAsPage:!1,showRemoveFromAlbum:!1,libraryId:""}},mounted(){var e=this.$route.params;this.propsAiClassId||this.propsFaceId||this.propsGeoHash||this.propsAlbumId||this.propsOrdinaryAlbumId||this.propsLibraryId?(this.title=this.propsTitle,this.geoHash=this.propsGeoHash,this.albumId=this.propsAlbumId,this.libraryId=this.propsLibraryId,this.nearMode=this.propsNearMode,this.showSearchBtn=this.propsShowSearchBtn,this.showModeSwitch=this.propsShowModeSwitch,this.showDelete=this.propsShowDelete,this.showAddToAlbum=this.propsShowAddToAlbum,this.ordinaryAlbumId=this.propsOrdinaryAlbumId,this.faceId=this.propsFaceId,this.aiClassId=this.propsAiClassId,this.showRemoveFromAlbum=this.propsShowRemoveFromAlbum):(this.openAsPage=!0,this.title=e.title,this.geoHash=e.geoHash,this.albumId=e.albumId,this.nearMode=e.nearMode,this.showSearchBtn=e.showSearchBtn,this.showModeSwitch=e.showModeSwitch,this.showDelete=e.showDelete,this.showAddToAlbum=e.showAddToAlbum,this.ordinaryAlbumId=e.ordinaryAlbumId,this.faceId=e.faceId,this.aiClassId=e.aiClassId,this.libraryId=e.propsLibraryId,this.showRemoveFromAlbum=e.showRemoveFromAlbum)},beforeDestroy(){},methods:{onClickAlbum(){this.openAsPage?this.deleteAlbum():this.$emit("onDelete")},deleteAlbum(){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),()=>{let e="",t={};this.albumId?(e="/api/photoApi/deleteAlbum",t.id=this.albumId):this.ordinaryAlbumId&&(e="/api/ordinaryAlbumApi/deleteAlbum",t.id=this.ordinaryAlbumId),this.api.post(e,t).then(e=>{e.code||(this.showVsNotification(this.$t("common.deleteSuccess")),this.albumId?sessionStorage.setItem("albumDelete",this.albumId):this.ordinaryAlbumId&&sessionStorage.setItem("ordinaryAlbumDelete",this.ordinaryAlbumId),this.$router.go(-1))}).catch(e=>{})})},goBack(){this.openAsPage,this.openAsPage?this.$router.go(-1):this.$emit("onClose")}}},o=(i("896a"),i("2877")),o=Object(o.a)(s,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"album-detail-root"},[e("my-bg"),e("div",{staticStyle:{overflow:"hidden",width:"100%",height:"100%"}},[e("div",{staticClass:"album-detail-header"},[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("Button",{attrs:{type:"primary",shape:"circle",icon:"ios-arrow-back"},on:{click:t.goBack}}),!t.isMobile&&t.showModeSwitch?e("div",{staticStyle:{"margin-left":"15px","flex-shrink":"0"}},["list"==t.dataMode?e("Button",{attrs:{type:"primary",shape:"circle",icon:"md-map"},on:{click:function(e){t.dataMode="map"}}}):t._e(),"map"==t.dataMode?e("Button",{attrs:{type:"primary",shape:"circle",icon:"md-grid"},on:{click:function(e){t.dataMode="list"}}}):t._e()],1):t._e(),e("div",{staticClass:"max-line-one",staticStyle:{"font-size":"18px","font-weight":"bold",height:"100%","margin-left":"20px"}},[t._v(" "+t._s(t.title))])],1),t.showDelete?e("vs-button",{attrs:{danger:""},on:{click:t.deleteAlbum}},[t._v(" "+t._s(t.$t("photo.deleteAlbum"))+" ")]):t._e()],1),e("div",{staticClass:"album-detail-content"},[t.isMobile||"map"!=t.dataMode?t._e():e("photo-map",{attrs:{albumDetailInner:!0,ordinaryAlbumId:t.ordinaryAlbumId?t.ordinaryAlbumId+"":"",libraryId:t.libraryId?t.libraryId+"":"",albumId:t.albumId?t.albumId+"":""}}),"list"==t.dataMode?e("photo-timeline-content",{attrs:{nearMode:t.nearMode,showSearchBtn:t.showSearchBtn,showAddToAlbum:t.showAddToAlbum,geohash:t.geoHash||"",ordinaryAlbumId:t.ordinaryAlbumId?t.ordinaryAlbumId+"":"",libraryId:t.libraryId?t.libraryId+"":"",albumId:t.albumId?t.albumId+"":"",faceId:t.faceId?t.faceId+"":"",aiClassId:t.aiClassId?t.aiClassId+"":"",showRemoveFromAlbum:t.showRemoveFromAlbum}}):t._e()],1)])],1)},[],!1,null,"7a13f339",null);t.default=o.exports},"915f":function(e,t){e.exports="data:image/png;base64,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"},9453:function(e,t,i){"use strict";i("14d9");var r=i("be3b"),s={name:"photo-bottom-select",props:{ignoreLivephoto:{default:0,type:Number},isInFolderView:{default:!1,type:Boolean},serverType:{default:"photo",type:String},showAddToAlbum:{default:!0,type:Boolean},showRemoveFromAlbum:{default:!1,type:Boolean},editMode:{default:!1,type:Boolean},ordinaryAlbumId:{default:"",type:String},faceId:{default:"",type:String},pathSep:{default:"\\",type:String},photoList:{type:Array,default:()=>[]},trashMode:!1},components:{ordinaryAlbumContent:()=>Promise.all([i.e("chunk-4e886eb8"),i.e("chunk-2d0e48df")]).then(i.bind(null,"a95d"))},data(){return{showSelectAlbum:!1,selectedItemList:[],selectedList:[]}},mounted(){this.$bus.$on("onTrashMsg",e=>{this.inOutTrashApi(1,!1,[e],()=>{this.$bus.$emit("removeIndexById",e)})}),this.$bus.$on("onTrashAllMsg",()=>{this.trashPhotos(1)}),this.$bus.$on("onDownloadSelectedListMsg",()=>{this.downloadSelectedList()}),this.$bus.$on("onAddToAlbumMsg",()=>{this.onAddToAlbum()}),this.$bus.$on("onRemoveFromAlbumMsg",()=>{this.removeFromAlbum()}),this.$bus.$on("onDeleteFromDiskMsg",()=>{this.deleteFromDisk()})},beforeDestroy(){this.$bus.$off("onTrashMsg"),this.$bus.$off("onTrashAllMsg"),this.$bus.$off("onDownloadSelectedListMsg"),this.$bus.$off("onAddToAlbumMsg"),this.$bus.$off("onRemoveFromAlbumMsg"),this.$bus.$off("onDeleteFromDiskMsg")},methods:{onClickDelete(){this.isInFolderView?this.deleteFromDisk():this.trashPhotos(1)},onAddToAlbum(){this.showSelectAlbum=!0},onSwitchToOtherPeople(){this.selectedList.length<1||this.$bus.$emit("onSwitchToOtherPeople",this.selectedList)},downloadSelectedList(){if(!(this.selectedItemList.length<1)){let e=[];for(var i in this.selectedItemList,this.selectedItemList){var s=this.selectedItemList[i];this.selectedItemList[i].rawUrl?1==s.is_livephoto&&s.livephotoIndex&&s.livephotoIndex.videoIndex&&s.livephotoIndex.photoIndex?(e.push(s.livephotoIndex.videoIndex.rawUrl),e.push(s.livephotoIndex.photoIndex.rawUrl)):e.push(s.rawUrl):0==this.selectedItemList[i].is_file&&(s=r.a.getRawFileZipUrl(this.selectedItemList[i].path+this.pathSep+this.selectedItemList[i].filename,this.selectedItemList[i].filename),e.push(s))}e;let t=this;function o(){t.downloadFile(e),t.$emit("onUnSelect")}1<this.selectedItemList.length?this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("file.multiDownloadAlert"),()=>{o()}):o()}},removeFromAlbum(){this.selectedList.length<1||(this.albumId,this.faceId?this.$bus.$emit("onRemoveFromFace",this.selectedList):this.ordinaryAlbumId&&this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("photo.removeFromAlbum")+"?",()=>{this.api.post("/api/ordinaryAlbumApi/deleteFromAlbum",{indexIdArr:this.selectedList,albumId:this.ordinaryAlbumId}).then(e=>{e.code||(this.showVsNotification(this.$t("photo.removeFromAlbumSuc")),this.$emit("onRemoveFromAlbum"),this.$emit("onUnSelect"))}).catch(e=>{})}))},onAddToAlbumSelect(){var e;!this.$refs.ordinaryAlbum||!(e=this.$refs.ordinaryAlbum.getSelectedAlbumId())||this.selectedList.length<1||this.api.post("/api/ordinaryAlbumApi/addToAlbum",{indexIdArr:this.selectedList,albumId:e}).then(e=>{e.code||(this.$emit("onUnSelect"),this.showSelectAlbum=!1,this.showVsNotification(this.$t("photo.addAlbumSuc")))}).catch(e=>{})},onUnSelect(){this.$emit("onUnSelect")},inOutApi(e,t){this.inOutTrashApi(e,t,this.selectedList,()=>{this.selectedList=[],this.selectedItemList=[],1==e?(this.$emit("onTrashInSuc"),this.showVsNotification(this.$t("file.putInTrashSuc")),this.$emit("onUnSelect")):(this.$emit("onTrashOutSuc"),this.showVsNotification(this.$t("file.putOutTrashSuc"))),t&&this.$emit("onNeedRefresh")})},inOutTrashApi(e,t,i,s){this.api.post("/api/fileApi/inOutTrash",{ids:i,trash:e}).then(e=>{e.code||s&&s()}).catch(e=>{})},restoreAll(e){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("file.doAllRestore"),()=>{this.api.post("/api/photoApi/restoreTrashBinFiles",{}).then(e=>{e.code||this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess")+":"+this.$t("common.checkAfter"),()=>{this.$emit("onNeedRefresh")})}).catch(e=>{})})},deleteAll(e){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("file.doAllDelete"),function(e){this.api.post("/api/photoApi/clearTrashBin",{putInSystemTrash:e}).then(e=>{e.code||this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess")+":"+this.$t("common.checkAfter"),()=>{this.$emit("onNeedRefresh")})}).catch(e=>{})},null,null,null,null,null,"linux"==localStorage.platform?null:{checkBoxContent:this.$t("putInSystemTrash"),isCheck:!0})},trashPhotos(e){this.selectedList.length<1&&this.trashMode?this.$emit("restoreAll"):this.inOutApi(e)},deleteApi(t,e){this.ignoreLivephoto,this.api.post("/api/fileApi/deleteFromDisk",{serverType:this.serverType,ids:this.selectedList,putInSystemTrash:e?1:0,ignoreLivephoto:this.ignoreLivephoto}).then(e=>{e.code||(e=e.deletedIds,this.selectedList=[],this.selectedItemList=[],this.showVsNotification(e.length+this.$t("file.fileDeleteSuc")),this.$emit("onDeleteSuc",e),t&&this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess")+":"+this.$t("common.checkAfter"),()=>{this.$emit("onNeedRefresh")}))}).catch(e=>{})},deleteFromDisk(){this.selectedList.length<1&&this.trashMode?this.$emit("deleteAll"):this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),e=>{this.deleteApi(!0,e)},null,null,null,null,null,"linux"==localStorage.platform?null:{checkBoxContent:this.$t("putInSystemTrash"),isCheck:!0})},addSelected(e){this.selectedList.push(e.id),this.selectedItemList.push(e)},removeSelected(t){for(let e=this.selectedList.length;0<=e;e--)if(this.selectedList[e]==t){this.selectedList.splice(e,1),this.selectedItemList.splice(e,1);break}},clearSelected(){this.selectedList=[],this.selectedItemList=[]}}},o=(i("1768"),i("2877")),o=Object(o.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bottom-select-root"},[t.trashMode?t._e():i("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("span",{staticClass:"select-text"},[t._v(t._s(t.$t("common.selected"))+"ï¼š"+t._s(t.selectedList.length)+t._s(t.$t("photo.fileCount")))])]),i("div",{staticClass:"bottom-root"},[i("Tooltip",{attrs:{content:t.$t("common.delete"),disabled:t.isMobile}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"red",iIcon:"md-trash"},on:{click:function(e){return t.onClickDelete()}}})],1),i("Tooltip",{attrs:{content:t.$t("photo.addToAlbum"),disabled:t.isMobile}},[t.showAddToAlbum?i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{iIcon:"md-add"},on:{click:t.onAddToAlbum}}):t._e()],1),i("Tooltip",{attrs:{content:t.$t("photo.changePeople"),disabled:t.isMobile}},[t.faceId?i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{iIcon:"md-swap"},on:{click:t.onSwitchToOtherPeople}}):t._e()],1),i("Tooltip",{attrs:{content:t.$t("photo.removeFromAlbum"),disabled:t.isMobile}},[t.showRemoveFromAlbum?i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{iIcon:"md-remove"},on:{click:t.removeFromAlbum}}):t._e()],1),i("Tooltip",{attrs:{content:t.$t("common.download"),disabled:t.isMobile}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"whtie",iIcon:"md-download"},on:{click:function(e){return t.downloadSelectedList()}}})],1),i("Tooltip",{attrs:{content:t.$t("common.cancel"),disabled:t.isMobile}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"white",iIcon:"md-close"},on:{click:t.onUnSelect}})],1)],1)]),t.trashMode?i("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-between",width:"100%"}},[i("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[i("div",{staticClass:"left-root",on:{click:function(e){return t.trashPhotos(0)}}},[i("Tooltip",{attrs:{disabled:t.isMobile,content:t.selectedList.length<1?t.$t("file.restoreAll"):t.$t("file.restore")+":"+t.selectedList.length}},[i("my-btn-icon",{attrs:{type:"primary",iIcon:"md-refresh"}})],1)],1),i("div",{staticClass:"right-root",on:{click:function(e){return t.deleteFromDisk()}}},[i("Tooltip",{attrs:{disabled:t.isMobile,content:t.selectedList.length<1?t.$t("file.deleteAll"):t.$t("file.delete")+":"+t.selectedList.length}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"red",iIcon:"md-trash"}})],1)],1)]),i("Tooltip",{attrs:{disabled:t.isMobile,content:t.$t("common.cancel")}},[0<t.selectedList.length?i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"white",iIcon:"md-close"},on:{click:t.onUnSelect}}):t._e()],1)],1):t._e(),i("vs-dialog",{attrs:{scroll:""},scopedSlots:t._u([{key:"header",fn:function(){return[i("h4",{staticStyle:{"font-size":"16px"}},[t._v(" "+t._s(t.$t("photo.whichAlbumWanToAdd"))+" ")])]},proxy:!0},{key:"footer",fn:function(){return[i("vs-button",{attrs:{block:""},on:{click:t.onAddToAlbumSelect}},[t._v(" "+t._s(t.$t("common.select"))+" ")])]},proxy:!0}]),model:{value:t.showSelectAlbum,callback:function(e){t.showSelectAlbum=e},expression:"showSelectAlbum"}},[i("ordinary-album-content",{ref:"ordinaryAlbum",attrs:{selectMode:!0}})],1)],1)},[],!1,null,"0ded6d86",null);t.a=o.exports},"96da":function(e,t,i){},"96db":function(e,t,i){},"9ea7":function(e,t,i){"use strict";var s={props:{itemWidth:{default:0,type:Number},movie:{default:"",type:Object},isHistoryItem:{default:!1,type:Boolean}},created(){},mounted(){},beforeDestroy(){},computed:{},components:{},data(){return{}},methods:{onMoreClick(e,t){this.$bus.$emit("eventOnShowRightMenu",this.isHistoryItem?"movieItemHistory":"movieItem",this.movie,null,e,t)}}},i=(i("a97b"),i("2877")),i=Object(i.a)(s,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"movie-item-root"},[e("div",{staticClass:"cover-root",staticStyle:{width:"100%"}},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.movie.url,expression:"movie.url"}],staticClass:"movie-cover",style:{height:t.itemWidth/3*4+"px",width:t.itemWidth+"px"}}),t.movie.hover?t._e():e("div",{staticClass:"hover-half-root"}),t.movie.hover?e("div",{staticClass:"hover-root"},[e("Button",{staticStyle:{height:"40px"},attrs:{type:"text",ghost:""},on:{click:function(e){return e.stopPropagation(),t.$emit("playClick")}}},[e("span",{staticClass:"nasIcons icon-play",staticStyle:{"font-size":"40px","line-height":"40px"}})])],1):t._e(),t.movie.hover||t.movie.is_tvplay?t._e():e("div",{staticClass:"icon-duration"},[t.movie.history?e("span",{staticStyle:{"font-size":"10px",color:"#ccc"}},[t._v(t._s(t.$t("watched")))]):t._e(),e("span",[t._v(t._s(t.utils.formatSeconds(t.movie.duration)))])]),t.movie.hover?e("div",{staticClass:"favorite-root"},[e("span",{staticClass:"nasIcons icon-xihuan-shi",style:{color:t.movie.favorite?"#DE4545":"rgba(255,255,255,0.8)"},on:{click:function(e){return e.stopPropagation(),t.$bus.$emit("eventOnFavoriteMovie",t.movie)}}})]):t._e()]),e("div",{staticClass:"bottom-root"},[e("p",{staticClass:"filename max-line-two"},[t._v(" "+t._s(t.isHistoryItem?t.movie.filename:t.movie.show_name)+" ")]),e("div",{staticStyle:{display:"flex",width:"100%","margin-top":"5px"}},[t.movie.is_tvplay&&!t.isHistoryItem?e("div",[t.movie.seasonCount&&1<t.movie.seasonCount?e("span",{staticClass:"video-type-sign"},[t._v(" "+t._s(t.movie.seasonCount)+" "+t._s(t.$t("season"))+" ")]):e("span",{staticClass:"video-type-sign"},[t._v(" "+t._s(t.movie.tvCount)+t._s(t.$t("episode"))+" ")]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.movie.movie_year&&1e3<t.movie.movie_year,expression:"movie.movie_year && movie.movie_year > 1000"}],staticClass:"movie-year"},[t._v(t._s(parseInt(t.movie.movie_year)))])]):t._e(),0==t.movie.is_tvplay?e("span",{directives:[{name:"show",rawName:"v-show",value:t.movie.movie_year&&1e3<t.movie.movie_year,expression:"movie.movie_year && movie.movie_year > 1000"}],staticClass:"movie-year"},[t._v(t._s(parseInt(t.movie.movie_year)))]):t._e()]),t.movie.movie_douban_score&&0<t.movie.movie_douban_score?e("div",{staticClass:"movie-score-bg"},[e("i-Circle",{attrs:{"trail-width":8,"stroke-width":8,"trail-color":"#fff",percent:parseInt(10*t.movie.movie_douban_score),"stroke-color":"#a9d06b",size:30}},[e("span",{staticClass:"movie-score"},[t._v(" "+t._s(parseInt(10*t.movie.movie_douban_score)/10)+" ")])])],1):t._e()]),t.isMobile?e("i",{staticClass:"nasIcons icon-shenglve more",on:{click:function(e){return e.stopPropagation(),t.onMoreClick(e,t.$root)}}}):t._e()])},[],!1,null,"62881925",null);t.a=i.exports},"9fc6":function(e,t,i){"use strict";var s={props:{initTitle:{default:"",type:String},initSourcePath:{default:"",type:String},initGenres:{default:"",type:String},initRegion:{default:"",type:String},initSourceType:{default:"",type:String},initActor:{default:"",type:String},initDirector:{default:"",type:String}},components:{movieList:()=>Promise.resolve().then(i.bind(null,"a133"))},data(){return{}},mounted(){},beforeDestroy(){},methods:{goBack(){this.$emit("onClose")}}},o=(i("0636"),i("2877")),o=Object(o.a)(s,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"album-detail-root"},[t("my-bg"),t("div",{staticStyle:{overflow:"hidden",width:"100%",height:"100%"}},[t("div",{staticClass:"album-detail-header"},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("Button",{attrs:{type:"primary",shape:"circle",icon:"ios-arrow-back"},on:{click:e.goBack}}),t("div",{staticClass:"max-line-one",staticStyle:{"font-size":"18px","font-weight":"bold",height:"100%","margin-left":"20px"}},[e.initTitle?t("span",[e._v(e._s(e.initTitle))]):e.initRegion?t("span",[e._v(e._s(e.$t("movie.regions"))+":"+e._s(e.initRegion))]):e.initGenres?t("span",[e._v(e._s(e.$t("movie.genres"))+":"+e._s(e.initGenres))]):e.initActor?t("span",[e._v(e._s(e.$t("movie.actors"))+":"+e._s(e.initActor))]):e.initDirector?t("span",[e._v(e._s(e.$t("movie.director"))+":"+e._s(e.initDirector))]):e._e()])],1)]),t("div",{staticClass:"album-detail-content"},[t("movie-list",{attrs:{initGenres:e.initGenres,initActor:e.initActor,initDirector:e.initDirector,initRegion:e.initRegion,initSourcePath:e.initSourcePath,initSourceType:e.initSourceType}})],1)])],1)},[],!1,null,"bca58dc6",null);t.a=o.exports},a133:function(e,t,i){"use strict";i.r(t);i("14d9");var s={data(){return{currentLetter:null,letterList:["#","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]}},mounted(){},methods:{onLetterClick(e){this.currentLetter==e?this.currentLetter="":this.currentLetter=e,this.$emit("onLetterClick",this.currentLetter)}}},o=(i("1b11"),i("2877")),s=Object(o.a)(s,function(){var i=this,e=i.$createElement,s=i._self._c||e;return s("div",{staticClass:"root"},i._l(i.letterList,function(t){return s("p",{style:{color:i.currentLetter==t?"#c5c8ce":"#515a6e"},on:{click:function(e){return i.onLetterClick(t)}}},[i._v(i._s(t))])}),0)},[],!1,null,"3b7de2cc",null).exports,r=i("66af"),a=i("1f2e"),l=i("c220"),l={props:{isAiCollection:{default:!1,type:Boolean},collectionPwd:{default:"",type:String},collectionId:{default:0,type:Number},libraryId:{default:0,type:Number},sliderValue:{default:140,type:Number},sortField:{default:"check_time",type:String},sortType:{default:"desc",type:String},searchStr:{default:"",type:String},showType:{default:"grid",type:String},listType:{default:"ALL",type:String},firstLetter:{default:"",type:String},sourceFolderList:{default:()=>[],type:Array},selectedSourceType:{default:"",type:String},selectedSourceFolder:{default:()=>[],type:Array},selectedLanguage:{default:()=>[],type:Array},selectedRegion:{default:()=>[],type:Array},selectedGenres:{default:()=>[],type:Array},selectedActors:{default:()=>[],type:Array},selectedDirectors:{default:()=>[],type:Array}},created(){},mounted(){window.addEventListener("resize",this.onWindowResize),this.$bus.$on("eventOnRefreshMovieListContent",this.loadFirstPage)},beforeDestroy(){window.removeEventListener("resize",this.onWindowResize),this.$bus.$off("eventOnRefreshMovieListContent",this.loadFirstPage),this.sliderValue&&localStorage.setItem("MovieImageSize",this.sliderValue)},computed:{filterConditionCount:function(){return this.selectedSourceFolder.length+this.selectedLanguage.length+this.selectedRegion.length+this.selectedGenres.length}},components:{myScrollBar:l.a,movieListItem:r.a},data(){return{showFilterDialog:!1,itemBaseWidth:140,itemWidth:140,itemMargin:6,count:50,movieList:[],nextHasMore:!0,nextLoading:!1,showMovieInfoName:!1}},methods:{scrollToTop(){this.$nextTick(()=>{this.$refs.listWrapper.scrollTo({top:0,behavior:"smooth"})})},loadFirstPage(){this.nextHasMore=!0,this.nextLoading=!1,this.getMovies()},calImageWidth(){var e;this.$refs.listWrapper&&(e=this.$refs.listWrapper.getBoundingClientRect(),e=this.utils.calItemWidth(e,this.itemBaseWidth,this.itemMargin))&&(this.itemWidth=e)},onSizeChange(){this.$nextTick(()=>{this.itemBaseWidth!=this.sliderValue&&(this.itemBaseWidth=this.sliderValue,this.calImageWidth())})},onWindowResize(){this.calImageWidth()},onPageScroll(e){"movie-list-wrapper"==e.target.id&&(this.$bus.$emit("eventOnCloseEasycm"),this.$refs.scrollBar&&this.$refs.scrollBar.onScroll(e),this.dealOnPageScroll(e,()=>{this.loadNextPage()},e=>{}))},loadNextPage(){this.getMovies(!0)},movieClick(e){this.$bus.$emit("eventOnShowMovieDetail",this.movieList,e)},playClick(e){this.$bus.$emit("eventOnPlayVideo",this.movieList,e)},getMovies(i){!this.nextLoading&&this.nextHasMore&&(i||(this.movieList=[]),this.$nextTick(()=>{this.nextLoading=!0;var e={useTvSeriesInfo:1,collectionPwd:this.collectionPwd,libraryId:this.libraryId,collectionId:this.collectionId,hideLoading:!0,count:this.count,excludeIds:[],sortField:this.sortField,sortType:this.sortType,searchStr:this.searchStr,offset:this.movieList.length,listType:this.listType,firstLetter:this.firstLetter};this.selectedSourceFolder&&0<this.selectedSourceFolder.length&&(e.sourceFolderList=JSON.stringify(this.selectedSourceFolder)),this.selectedSourceType&&(e.sourceType=this.selectedSourceType),this.selectedSourceType,this.selectedGenres&&0<this.selectedGenres.length&&(e.movieGenres=JSON.stringify(this.selectedGenres)),this.selectedActors&&0<this.selectedActors.length&&""!=this.selectedActors[0]&&(e.movieActors=JSON.stringify(this.selectedActors)),this.selectedDirectors&&0<this.selectedDirectors.length&&""!=this.selectedDirectors[0]&&(e.movieDirectors=JSON.stringify(this.selectedDirectors)),this.selectedLanguage&&0<this.selectedLanguage.length&&(e.movieLanguage=JSON.stringify(this.selectedLanguage)),this.selectedRegion&&0<this.selectedRegion.length&&(e.movieRegion=JSON.stringify(this.selectedRegion)),this.api.post("/api/movieApi/getMovies",e).then(e=>{var t;e.code||(e.data.length<this.count?this.nextHasMore=!1:this.nextHasMore=!0,this.showMovieInfoName=1==e.movieShowMatchName,a.a.dealMovieList(this.showMovieInfoName,e.data),t=[],t=i?this.movieList.concat(e.data):e.data,e=a.a.mergeTvSeasons(t),this.movieList=e,this.movieList,this.nextLoading=!1,this.$nextTick(()=>{this.calImageWidth(),setTimeout(()=>{this.calImageWidth()},300)}))}).catch(e=>{this.nextLoading=!1})}))}}};i("e106");var r=Object(o.a)(l,function(){var i=this,e=i.$createElement,s=i._self._c||e;return s("div",{staticStyle:{width:"100%"}},[s("div",{ref:"listWrapper",staticClass:"movie-list",attrs:{id:"movie-list-wrapper"},on:{scroll:i.onPageScroll}},[i._l(i.movieList,function(e,t){return s("div",{key:e.id,class:{"movie-list-column":"list"==i.showType}},[s("movie-list-item",{attrs:{movie:e,movieIndex:t,showType:i.showType,itemWidth:i.itemWidth,itemMargin:i.itemMargin},on:{movieClick:i.movieClick,playClick:i.playClick}})],1)}),s("div",{staticStyle:{display:"flex","justify-content":"center",width:"100%","flex-direction":"column","align-items":"center"}},[i.nextHasMore&&0<i.movieList.length?s("Button",{staticStyle:{width:"250px","margin-top":"30px",height:"45px","border-radius":"20px"},attrs:{type:"default"},on:{click:function(e){return i.loadNextPage()}}},[i._v(i._s(i.$t("common.loadmore")))]):i._e(),i.nextLoading?s("Spin",{staticStyle:{"margin-top":"30px"},attrs:{size:"large"}}):i._e(),i.nextLoading||i.nextHasMore?i._e():s("span",{staticStyle:{"margin-top":"30px"}},[i._v(i._s(i.$t("common.noMore")))]),s("div",{staticStyle:{height:"50px"}})],1)],2),s("my-scroll-bar",{ref:"scrollBar"})],1)},[],!1,null,"e14a07c2",null).exports,l=i("5d55"),n=i("4696"),h=i("9ea7"),c=i("644c"),d=i("9fc6"),d={props:{sliderValue:{default:120,type:Number},genresType:{default:"movie_genres",type:String},selectedSourceType:{default:"",type:String}},created(){},mounted(){this.loadFirstPage(),window.addEventListener("resize",this.onWindowResize)},beforeDestroy(){window.removeEventListener("resize",this.onWindowResize),this.sliderValue&&localStorage.setItem("MovieImageSize",this.sliderValue)},computed:{},components:{movieCollectionList:()=>i.e("chunk-5a283fea").then(i.bind(null,"e54c")),movieGenresDetail:d.a,movieListItemList:c.a,movieListItemGrid:h.a,videoDetail:l.default,MovieInfoDetail:n.default},data(){return{showCollectionSelectDialog:!1,showFilterDialog:!1,itemBaseWidth:300,itemWidth:300,itemMargin:6,count:50,genresList:[],nextHasMore:!0,nextLoading:!1,showMovieInfoName:!1}},methods:{onSizeChange(){},onGenresTitleClick(e){"movie_genres"==e.genresType?this.$bus.$emit("eventOnShowGenreDetail",e.genresValue,""):"movie_regions"==e.genresType&&this.$bus.$emit("eventOnShowGenreDetail","",e.genresValue)},loadFirstPage(){this.nextHasMore=!0,this.nextLoading=!1,this.getMovies()},calImageWidth(){var e;this.$refs.listWrapper&&(e=this.$refs.listWrapper.getBoundingClientRect(),e=this.utils.calItemWidth(e,this.itemBaseWidth,this.itemMargin))&&(this.itemWidth=e)},onWindowResize(){this.calImageWidth()},getMovies(){!this.nextLoading&&this.nextHasMore&&this.$nextTick(()=>{this.nextLoading=!0;var e={genresType:this.genresType,pageCount:4};this.initSourcePath&&(e.sourceFolderList=JSON.stringify([this.initSourcePath])),this.selectedSourceType&&(e.sourceType=this.selectedSourceType),this.api.post("/api/movieApi/getMoviesByGenres",e).then(e=>{this.showMovieInfoName=1==e.movieShowMatchName,this.genresList=e.data;for(var t of this.genresList)a.a.dealMovieList(this.showMovieInfoName,t.movieList);this.$nextTick(()=>{this.calImageWidth()})}).catch(e=>{this.nextLoading=!1})})}}};i("0d83");c=Object(o.a)(d,function(){var i=this,e=i.$createElement,s=i._self._c||e;return s("div",{staticStyle:{width:"100%"}},[i.genresList.length<1?s("my-nodata",{staticStyle:{position:"absolute",width:"100%","margin-top":"150px"},attrs:{title:i.$t("common.noMore")}}):i._e(),s("div",{ref:"listWrapper",staticClass:"movie-list"},[i._l(i.genresList,function(t,e){return t.movieList&&0<t.movieList.length?s("vs-card",{style:{width:i.itemWidth+"px",margin:i.itemMargin+"px"},attrs:{type:"2"},on:{click:function(e){return i.onGenresTitleClick(t)}},scopedSlots:i._u([{key:"img",fn:function(){return[s("div",{staticStyle:{width:"100%",display:"flex",height:"160px"}},[i._l(t.movieList,function(e,t){return s("div",{staticStyle:{flex:"1",position:"relative",background:"#bbb","padding-right":"0.5px","padding-left":"0.5px"}},[s("img",{staticStyle:{width:"100%","object-fit":"cover",height:"120px","border-radius":"0px !important"},attrs:{src:e.url}}),s("img",{staticStyle:{width:"100%","object-fit":"fill",height:"40px",transform:"scaleY(-1)","border-radius":"0px !important"},attrs:{src:e.url}})])}),s("div",{staticStyle:{background:"linear-gradient(to top, #111, rgba(51,51,51,0.6))",position:"absolute",bottom:"0",left:"0",height:"40px",width:"100%",display:"flex","align-items":"center","justify-content":"center"}},[s("p",{staticClass:"max-line-one",staticStyle:{color:"white","text-align":"center","padding-left":"15px","padding-right":"15px","word-break":"break-all"}},[i._v(i._s(t.genresValue)+"["+i._s(t.indexCount)+"]")])])],2)]},proxy:!0}],null,!0)}):i._e()}),s("div",{staticStyle:{height:"50px",width:"100%"}})],2)],1)},[],!1,null,"00164382",null).exports,h={props:{restoreFilter:{default:!1,type:Boolean},isAiCollection:{default:!1,type:Boolean},collectionPwd:{default:"",type:String},collectionId:{default:0,type:Number},libraryId:{default:0,type:Number},initGenres:{default:"",type:String},initRegion:{default:"",type:String},initActor:{default:"",type:String},initDirector:{default:"",type:String},initSourcePath:{default:"",type:String},initSourceType:{default:"",type:String}},data(){return{showFilterDialog:!1,sourceFolderList:[],selectedSourceType:"0",selectedSourceFolder:[],selectedLanguage:[],selectedRegion:[],selectedGenres:[],lockGenres:!1,lockRegion:!1,typeMenuOptionList:[{title:this.$t("common.all"),id:"ALL"},{title:this.$t("movie.favorite"),id:"FAVORITE"}],mediaTypeMenuOptionList:[{title:this.$t("mix"),id:"0"},{title:this.$t("movie.movie"),id:"1"},{title:this.$t("movie.tvdrama"),id:"2"}],sliderMin:140,sliderMax:280,sliderValue:140,itemMargin:6,sortField:"check_time",sortType:"desc",searchStr:"",showType:"grid",firstLetter:"",listType:"ALL",genresList:[],languageList:[],regionList:[]}},created(){var e=localStorage.getItem("movie-list-show-type");e&&(this.showType=e)},mounted(){this.collectionId||this.initGenres||this.initRegion||this.libraryId||(this.typeMenuOptionList.push({title:this.$t("movie.genres"),id:"GENRES"}),this.typeMenuOptionList.push({title:this.$t("movie.regions"),id:"REGIONS"}),localStorage.MovieListType&&(this.listType=localStorage.MovieListType,this.$refs.listTypeMenu)&&this.$refs.listTypeMenu.setSelectedId(this.listType)),this.initGenres&&(this.selectedGenres=[this.initGenres],this.lockGenres=!0),this.initRegion&&(this.selectedRegion=[this.initRegion],this.lockRegion=!0),this.initSourcePath&&(this.selectedSourceFolder.push(this.initSourcePath),this.sourceFolderList.push(this.initSourcePath)),this.initSourceType?this.setSourceType(this.initSourceType):localStorage.cacheMovieSelectedSourceType2&&this.setSourceType(localStorage.cacheMovieSelectedSourceType2);var e=localStorage.getItem("MovieImageSize");e&&100<=parseInt(e)&&(this.sliderValue=parseInt(e),this.onSizeChange()),localStorage.cacheMovieSortField&&(this.sortField=localStorage.cacheMovieSortField),localStorage.cacheMovieSortType&&(this.sortType=localStorage.cacheMovieSortType),this.initSourcePath?this.loadFirstPage(!0):this.getSourceFolder(),this.getMovieKeys(),window.addEventListener("keydown",this.onKeyDown)},beforeDestroy(){window.removeEventListener("keydown",this.onKeyDown)},computed:{isMovieListPage:function(){return"ALL"==this.listType||"FAVORITE"==this.listType},filterConditionCount:function(){if("ALL"!=this.listType&&"FAVORITE"!=this.listType)return 0;{let e=this.selectedLanguage.length+this.selectedRegion.length+this.selectedGenres.length;return 1<this.sourceFolderList.length&&(e+=this.selectedSourceFolder.length),e}}},components:{movieListRegions:c,movieListGenres:c,movieListContent:r,letterIndex:s},methods:{onKeyDown(i){if(!this.isShowingDialog()){let e,t=i.key;"="==t?this.sliderValue<this.sliderMax&&(e=this.sliderValue+50):"-"==t?this.sliderValue>this.sliderMin&&(e=this.sliderValue-50):t&&"c"==t.toLowerCase()&&("grid"==this.showType?(this.showType="list",this.onSelectShowType()):(this.showType="grid",this.onSelectShowType("contain"))),e&&(this.sliderValue=e,this.onSizeChange())}},loadFirstPage(e){e&&"ALL"!=this.listType&&"FAVORITE"!=this.listType&&(this.listType="ALL",this.$refs.listTypeMenu)&&this.$refs.listTypeMenu.setSelectedId(this.listType),this.restoreFilter&&(this.selectedSourceFolder=function(e,t,i){if(e=window.localStorage.getItem(e)){var s=JSON.parse(e);if(s instanceof Array)for(var o in s)for(var r in i)s[o]==i[r]&&t.push(s[o]);else for(var a in i)s==i[a]&&(t=s)}return t}("cacheMovieSelectedSourceFolder",[],this.sourceFolderList)),this.$nextTick(()=>{this.$refs.movieListContent&&this.$refs.movieListContent.loadFirstPage()})},onSizeChange(){this.$nextTick(()=>{this.$refs.movieListContent?this.$refs.movieListContent.onSizeChange():this.$refs.movieListGenres?this.$refs.movieListGenres.onSizeChange():this.$refs.movieListRegions&&this.$refs.movieListRegions.onSizeChange(),this.sliderValue&&localStorage.setItem("MovieImageSize",this.sliderValue)})},onLetterClick(e){this.firstLetter=e,this.onFilterFinish()},onChooseDataType(e){this.listType=e,localStorage.setItem("MovieListType",this.listType),this.isMovieListPage&&this.onFilterFinish(!0),this.onSizeChange()},setSourceType(e){this.selectedSourceType=e,this.$refs.refSourceTypeMenu&&this.$refs.refSourceTypeMenu.setSelectedId(e)},onChooseMediaType(e){this.selectedSourceType=e,localStorage.cacheMovieSelectedSourceType2=this.selectedSourceType,this.onFilterFinish(!0)},getMovieKeys(){this.api.post("/api/movieApi/getMovieKeys",{hideLoading:!0}).then(t=>{if(!t.code&&t.data&&0<t.data.length)for(let e=0;e<t.data.length;e++){var i=t.data[e];"movie_language"==i.key_type?this.languageList.push(i.key_value):"movie_regions"==i.key_type?this.regionList.push(i.key_value):"movie_genres"==i.key_type&&this.genresList.push(i.key_value)}}).catch(e=>{})},resetFilterData(){this.selectedSourceFolder=[],this.selectedGenres=[],this.selectedLanguage=[],this.selectedRegion=[],this.onFilterFinish(!0)},cacheFilterOperation(){if(this.restoreFilter){var e,t="cacheMovieSelectedSourceFolder",i=this.selectedSourceFolder;try{i?(e=JSON.stringify(i),window.localStorage.setItem(t,e)):window.localStorage.removeItem(t)}catch(e){window.localStorage.removeItem(t)}}},onFilterFinish(e){e&&(this.firstLetter="",this.$refs.letterIndex)&&(this.$refs.letterIndex.currentLetter=""),this.searchStr="",this.$refs.mySearch.clearSearchValue(),this.cacheFilterOperation(),this.$nextTick(()=>{this.loadFirstPage(!0)})},getSourceFolder(){this.api.post("/api/sourceFolderApi/getPathByType",{type:"movie"}).then(e=>{if(!e.code){if(1==this.$store.state.currentUser.is_admin&&0==this.collectionId)if(e.data.length<1)this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("movie.noSourceSetAlert"),()=>{this.$emit("setViewType","sourceSet")},null,this.$t("photo.goToSet"));else if(!sessionStorage.MovieSourcePathUnusableAlert)for(var t in e.data)if(0==e.data[t].exist){sessionStorage.MovieSourcePathUnusableAlert=1,this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("photo.sourcePathUnusable",{path:e.data[t].path}),()=>{this.$emit("setViewType","sourceSet")},null,this.$t("photo.goToSet"));break}for(var i in e.data)this.sourceFolderList.push(e.data[i].path)}this.loadFirstPage(!0)}).catch(e=>{})},scrollToTop(){this.$nextTick(()=>{this.$refs.listWrapper.scrollTo({top:0,behavior:"smooth"})})},onSelectShowType(){localStorage.setItem("movie-list-show-type",this.showType),this.onFilterFinish()},clickOrder(){localStorage.cacheMovieSortField=this.sortField,localStorage.cacheMovieSortType=this.sortType,this.loadFirstPage(!0)},onSearch(e){this.searchStr=e,this.loadFirstPage(!0)},onSearchClear(){this.searchStr="",this.loadFirstPage(!0)}}},i("dbcb"),l=Object(o.a)(h,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"movie-list-root"},[i("div",{staticClass:"movie-header"},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("Badge",{staticClass:"operation-icon",style:{"margin-left":t.itemMargin+"px"},attrs:{count:t.filterConditionCount}},[i("span",{staticClass:"nasIcons icon-filter ",on:{click:function(e){t.showFilterDialog=!0}}})]),i("Poptip",{attrs:{placement:"bottom"},scopedSlots:t._u([{key:"content",fn:function(){return[i("div",{staticClass:"sort-root"},[i("div",[t._v(t._s(t.$t("common.sortField")))]),i("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":t.clickOrder},model:{value:t.sortField,callback:function(e){t.sortField=e},expression:"sortField"}},[i("Radio",{attrs:{label:"check_time"}},[i("span",[t._v(t._s(t.$t("checkTime")))])]),i("Radio",{attrs:{label:"movie_info_name_fl"}},[i("span",[t._v(t._s(t.$t("movie.matchName")))])]),i("Radio",{attrs:{label:"filename"}},[i("span",[t._v(t._s(t.$t("movie.filename")))])]),i("Radio",{attrs:{label:"movie_douban_score"}},[i("span",[t._v(t._s(t.$t("movie.score")))])]),i("Radio",{attrs:{label:"create_time"}},[i("span",[t._v(t._s(t.$t("movie.createTime")))])])],1),i("div",{staticStyle:{"margin-top":"15px"}},[t._v(t._s(t.$t("common.sortType")))]),i("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":t.clickOrder},model:{value:t.sortType,callback:function(e){t.sortType=e},expression:"sortType"}},[i("Radio",{attrs:{label:"asc"}},[i("span",[t._v(t._s(t.$t("common.asc")))])]),i("Radio",{attrs:{label:"desc"}},[i("span",[t._v(t._s(t.$t("common.desc")))])])],1)],1)]},proxy:!0}])},["asc"==t.sortType?i("span",{staticClass:"nasIcons icon-sort-alpha-up operation-icon"}):t._e(),"desc"==t.sortType?i("span",{staticClass:"nasIcons icon-sort-alpha-down-alt operation-icon"}):t._e()]),i("my-menu-select",{ref:"listTypeMenu",staticStyle:{"margin-right":"10px"},attrs:{shrinkModeTh:750,optionList:t.typeMenuOptionList,initValue:t.listType},on:{onItemClick:t.onChooseDataType}}),t.initSourceType?t._e():i("my-menu-select",{ref:"refSourceTypeMenu",attrs:{shrinkModeTh:450,optionList:t.mediaTypeMenuOptionList,initValue:t.selectedSourceType},on:{onItemClick:t.onChooseMediaType}})],1),i("my-search",{ref:"mySearch",staticStyle:{"max-width":"250px"},attrs:{shrinkModeTh:880,placeholder:t.$t("movie.searchPlaceHolder")},on:{onSearch:t.onSearch}})],1),i("div",{staticStyle:{width:"100%",height:"100%",display:"flex","flex-direction":"row",overflow:"hidden","padding-top":"60px"}},[t.isMovieListPage?i("movie-list-content",{ref:"movieListContent",attrs:{sliderValue:t.sliderValue,sortField:t.sortField,sortType:t.sortType,searchStr:t.searchStr,showType:t.showType,listType:t.listType,firstLetter:t.firstLetter,sourceFolderList:t.sourceFolderList,selectedSourceType:t.selectedSourceType,selectedSourceFolder:t.selectedSourceFolder,selectedLanguage:t.selectedLanguage,libraryId:t.libraryId,selectedActors:[t.initActor],selectedDirectors:[t.initDirector],collectionId:t.collectionId,collectionPwd:t.collectionPwd,selectedRegion:t.selectedRegion,selectedGenres:t.selectedGenres,isAiCollection:t.isAiCollection}}):t._e(),t.isMovieListPage?i("letter-index",{ref:"letterIndex",staticStyle:{"flex-shrink":"0"},on:{onLetterClick:t.onLetterClick}}):t._e(),"GENRES"==t.listType?i("movie-list-genres",{ref:"movieListGenres",attrs:{genresType:"movie_genres",sliderValue:t.sliderValue,initSourcePath:t.initSourcePath,selectedSourceType:t.selectedSourceType}}):t._e(),"REGIONS"==t.listType?i("movie-list-regions",{ref:"movieListRegions",attrs:{genresType:"movie_regions",sliderValue:t.sliderValue,initSourcePath:t.initSourcePath,selectedSourceType:t.selectedSourceType}}):t._e()],1),i("vs-dialog",{attrs:{scroll:"",title:t.$t("movie.movieFilter"),scroll:""},scopedSlots:t._u([{key:"footer",fn:function(){return[i("Divider"),i("div",[i("my-btn",{attrs:{type:"white",title:t.$t("common.close")},on:{click:function(e){t.showFilterDialog=!1}}}),i("my-btn",{attrs:{type:"primary",title:t.$t("common.resetDefault")},on:{click:function(e){return t.resetFilterData()}}})],1)]},proxy:!0}]),model:{value:t.showFilterDialog,callback:function(e){t.showFilterDialog=e},expression:"showFilterDialog"}},[i("div",[i("div",{staticStyle:{height:"10px"}}),t.isMovieListPage?i("div",{staticClass:"slider-root"},[i("p",{staticClass:"title-style-a"},[t._v(t._s(t.$t("movie.posterSize"))+":")]),i("Slider",{staticClass:"zoom-slider",attrs:{"show-tip":"never",min:t.sliderMin,max:t.sliderMax,step:10},on:{"on-input":t.onSizeChange},model:{value:t.sliderValue,callback:function(e){t.sliderValue=e},expression:"sliderValue"}}),i("a",{on:{click:function(e){t.showVsAlertDialog(t.$t("quickKey"),t.$t("photoKeyAlert"))}}},[i("Icon",{staticStyle:{"font-weight":"bold",cursor:"pointer"},attrs:{type:"ios-help-circle-outline"}})],1)],1):t._e(),t.isMovieListPage?i("Divider"):t._e(),t.isMovieListPage?i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("p",{staticClass:"title-style-a"},[t._v(t._s(t.$t("file.showType"))+":")]),i("RadioGroup",{staticStyle:{"text-align":"left","margin-left":"10px"},on:{"on-change":t.onSelectShowType},model:{value:t.showType,callback:function(e){t.showType=e},expression:"showType"}},[i("Radio",{attrs:{label:"grid"}},[i("Icon",{attrs:{type:"md-grid"}}),i("span",{staticClass:"option-title"},[t._v(t._s(this.$t("movie.gridView")))])],1),i("Radio",{attrs:{label:"list"}},[i("Icon",{attrs:{type:"md-list"}}),i("span",{staticClass:"option-title"},[t._v(t._s(this.$t("movie.listView")))])],1)],1)],1):t._e(),t.sourceFolderList&&1<t.sourceFolderList.length?i("div",[i("Divider"),i("p",{staticClass:"dialog-filter-title"},[t._v(t._s(t.$t("movie.selectSourceFolder"))+":")]),i("CheckboxGroup",{on:{"on-change":t.onFilterFinish},model:{value:t.selectedSourceFolder,callback:function(e){t.selectedSourceFolder=e},expression:"selectedSourceFolder"}},t._l(t.sourceFolderList,function(e){return i("Checkbox",{staticClass:"option-title",attrs:{label:e}},[t._v(t._s(" "+e))])}),1)],1):t._e(),t.genresList&&0<t.genresList.length?i("div",[i("Divider"),i("p",{staticClass:"dialog-filter-title"},[t._v(t._s(t.$t("movie.selectGenres"))+": ")]),t.lockGenres&&0<t.selectedGenres.length?i("div",{staticStyle:{"text-align":"left"}},[t._v(" "+t._s(t.selectedGenres[0])+" ")]):i("CheckboxGroup",{on:{"on-change":function(e){return t.onFilterFinish(!0)}},model:{value:t.selectedGenres,callback:function(e){t.selectedGenres=e},expression:"selectedGenres"}},t._l(t.genresList,function(e){return i("Checkbox",{staticClass:"option-title",attrs:{label:e}},[t._v(t._s(" "+e))])}),1)],1):t._e(),t.regionList&&0<t.regionList.length?i("div",[i("Divider"),i("p",{staticClass:"dialog-filter-title"},[t._v(t._s(t.$t("movie.selectRegion"))+": ")]),t.lockRegion&&0<t.selectedRegion.length?i("div",{staticStyle:{"text-align":"left"}},[t._v(" "+t._s(t.selectedRegion[0])+" ")]):i("CheckboxGroup",{on:{"on-change":function(e){return t.onFilterFinish(!0)}},model:{value:t.selectedRegion,callback:function(e){t.selectedRegion=e},expression:"selectedRegion"}},t._l(t.regionList,function(e){return i("Checkbox",{staticClass:"option-title",attrs:{label:e}},[t._v(t._s(" "+e))])}),1)],1):t._e(),t.languageList&&0<t.languageList.length?i("div",[i("Divider"),i("p",{staticClass:"dialog-filter-title"},[t._v(t._s(t.$t("movie.selectLanguage"))+":")]),i("CheckboxGroup",{on:{"on-change":function(e){return t.onFilterFinish(!0)}},model:{value:t.selectedLanguage,callback:function(e){t.selectedLanguage=e},expression:"selectedLanguage"}},t._l(t.languageList,function(e){return i("Checkbox",{staticClass:"option-title",attrs:{label:e}},[t._v(t._s(" "+e))])}),1)],1):t._e()],1)])],1)},[],!1,null,"cd46cd6e",null);t.default=l.exports},a732:function(e,t,r){"use strict";r("14d9");var i=r("cdf0"),l=r("be3b"),s=r("7ddb"),n=r("1f2e"),o=r("8fad"),o={props:{isPhotoLibrary:{default:!1,type:Boolean}},created(){},mounted(){window.addEventListener("resize",this.calImageWidth),window.addEventListener("popstate",this.onPopstate);var e="cacheLibrarySortField"+(this.isPhotoLibrary?"_photo":"_movie"),e=(localStorage.getItem(e)&&(this.orderField=localStorage.getItem(e)),"cacheLibrarySortType"+(this.isPhotoLibrary?"_photo":"_movie"));localStorage.getItem(e)&&(this.orderType=localStorage.getItem(e)),this.loadFirstPage()},beforeDestroy(){window.removeEventListener("resize",this.calImageWidth),window.removeEventListener("popstate",this.onPopstate)},components:{albumDetail:o.default,userSelect:s.a,libraryDetail:i.a},data(){return{nextHasMore:!0,nextLoading:!1,searchStr:"",orderField:"create_time",orderType:"desc",pageSize:15,itemHeight:200,operation:"ADD",showChooseUser:!1,userList:[],libraryPathList:[],showChooseFolder:!1,rightMenuList:[{text:this.$t("file.check"),type:"CHECK"},{text:this.$t("common.delete"),type:"DELETE"}],showChooseCover:!1,showDetail:!1,dialogTitle:"",selectedLibrary:"",itemBaseWidth:340,itemWidth:340,itemMargin:10,dataList:[],showAddDialog:!1,shareForSubUser:!0,inputLibraryName:"",selectedIndex:!1}},methods:{onSearch(e){this.searchStr=e,this.loadFirstPage()},loadFirstPage(){this.dataList=[],this.nextHasMore=!0,this.nextLoading=!1,this.operationLibrary("GET")},loadNextPage(){this.operationLibrary("GET")},clickOrder(){var e="cacheLibrarySortField"+(this.isPhotoLibrary?"_photo":"_movie"),t="cacheLibrarySortType"+(this.isPhotoLibrary?"_photo":"_movie");localStorage.setItem(e,this.orderField),localStorage.setItem(t,this.orderType),this.loadFirstPage()},showAdd(e){if(this.selectedLibrary=e,this.shareForSubUser=!0,this.userList=[],this.libraryPathList=[],e){if(this.dialogTitle=this.$t("common.edit"),this.inputLibraryName=e.title,this.shareForSubUser=1==e.share_for_subuser,e.path_list)try{var t;for(t of JSON.parse(e.path_list))this.onSelectPath(t)}catch(e){}if(e.user_list)try{for(var i of e.user_list)this.onSelectUser(i)}catch(e){}}else this.dialogTitle=this.$t("movie.addLibrary"),this.inputLibraryName="";this.showAddDialog=!0},onSelectUser(t){if(t.is_admin)this.showVsNotification(this.$t("share.adminHasPowerDefault"));else{let e=!1;for(var i of this.userList)i.username==t.username&&(e=!0);e||this.userList.push(t),this.showChooseUser=!1}},onDeleteUser(e){if(e)for(var t in this.userList)if(this.userList[t].username==e.username){this.userList.splice(t,1);break}},onDeletePath(e){if(e)for(var t in this.libraryPathList)if(this.libraryPathList[t].path==e.path){this.libraryPathList.splice(t,1);break}},onPageScroll(e){"movie-library-wrapper"==e.target.id&&this.dealOnPageScroll(e,()=>{this.loadNextPage()},e=>{})},onSelectPath(t){if(t){let e=t;41<t.length&&(e="..."+t.substring(t.length-41));for(var i of this.libraryPathList)if(i.path==t)return void this.showVsNotification(this.$t("common.pathExist"));this.libraryPathList.push({showPath:e,path:t}),this.showChooseFolder=!1}},onSelectedCover(e){e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".JPG")||e.endsWith(".JPEG")||e.endsWith(".png")||e.endsWith(".PNG")?(this.showChooseCover=!1,this.coverPath=e):this.showVsAlertDialog(this.$t("common.alert"),this.$t("movie.coverFileNoSupport"))},onPopstate(){this.showDetail?(this.showDetail=!1,this.$bus.$emit("closePhotoGallery")):this.$router.go(-1)},onLibraryClick(e){this.selectedLibrary=this.dataList[e],this.showDetail=!0,this.pushState()},calImageWidth(){var e=this.$refs.wrapper.getBoundingClientRect(),e=this.utils.calItemWidth(e,this.itemBaseWidth,this.itemMargin);e&&(this.itemWidth=e)},deleteLibrary(e){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),()=>{this.selectedLibrary=e,this.operationLibrary("DELETE")})},operationLibrary(s){var e={operation:s,title:this.inputLibraryName,libraryId:this.selectedLibrary?this.selectedLibrary.id:"",shareForSubUser:this.shareForSubUser?"1":"0",count:this.pageSize,offset:this.dataList.length,orderField:this.orderField,orderType:this.orderType};if(this.searchStr&&(e.search=this.searchStr),"ADD"==s||"EDIT"==s){if(!this.inputLibraryName)return this.showVsNotification(this.$t("movie.pleaseInputCollectionName"));if(!this.libraryPathList||this.libraryPathList.length<1)return this.showVsNotification(this.$t("movie.atleastOnePath"));var t,i=[];for(t of this.libraryPathList)i.push(t.path);var o,r=[];for(o of this.userList)r.push(o.id);e.pathList=i,e.shareUidList=r}else if("GET"==s){if(this.nextLoading||!this.nextHasMore)return;this.nextLoading=!0}let a="/api/movieApi/operationLibrary";this.isPhotoLibrary&&(a="/api/photoApi/operationLibrary"),this.api.post(a,e).then(e=>{if(!e.code)if(this.showAddDialog=!1,"GET"==s){for(var t in e.data){t=e.data[t];if(this.dataList.push(t),this.isPhotoLibrary){if(t.dataPreview&&0<t.dataPreview.length)for(var i of t.dataPreview)i.url=l.a.getImgFullPath(i.id,!0,i.filename)}else n.a.dealMovieList(!1,t.dataPreview)}e.data.length<this.pageSize&&(this.nextHasMore=!1),this.$nextTick(()=>{this.calImageWidth()})}else this.showVsNotification(this.$t("common.operationSuccess")),this.loadFirstPage();this.nextLoading=!1}).catch(e=>{this.nextLoading=!1})}}},s=(r("135d"),r("2877")),i=Object(s.a)(o,function(){var s=this,e=s.$createElement,o=s._self._c||e;return o("div",{staticClass:"list-root"},[!s.nextLoading&&s.dataList.length<1?o("my-nodata",{staticStyle:{position:"absolute",width:"100%","margin-top":"150px"},attrs:{title:s.$t("movie.addLibraryAlert"),btnTitle:1==s.$store.state.currentUser.is_admin?s.$t("movie.addLibrary"):null},on:{onBtnClick:s.showAdd}}):s._e(),o("div",{staticStyle:{overflow:"hidden",width:"100%"},style:{height:"100%"}},[o("div",{staticClass:"top-root"},[o("div",{staticClass:"nas-padding-left",staticStyle:{flex:"1",display:"flex","justify-content":"flex-start"}},[o("span",{staticClass:"nasIcons icon-add operation-icon",on:{click:function(e){return s.showAdd()}}}),o("Poptip",{attrs:{placement:"bottom"},scopedSlots:s._u([{key:"content",fn:function(){return[o("div",{staticClass:"sort-root"},[o("div",[s._v(s._s(s.$t("common.sortField")))]),o("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":s.clickOrder},model:{value:s.orderField,callback:function(e){s.orderField=e},expression:"orderField"}},[o("Radio",{attrs:{label:"title"}},[o("span",[s._v(s._s(s.$t("common.name")))])]),o("Radio",{attrs:{label:"create_time"}},[o("span",[s._v(s._s(s.$t("movie.createTime")))])])],1),o("div",{staticStyle:{"margin-top":"15px"}},[s._v(s._s(s.$t("common.sortType")))]),o("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":s.clickOrder},model:{value:s.orderType,callback:function(e){s.orderType=e},expression:"orderType"}},[o("Radio",{attrs:{label:"asc"}},[o("span",[s._v(s._s(s.$t("common.asc")))])]),o("Radio",{attrs:{label:"desc"}},[o("span",[s._v(s._s(s.$t("common.desc")))])])],1)],1)]},proxy:!0}])},["asc"==s.orderType?o("span",{staticClass:"nasIcons icon-sort-alpha-up operation-icon"}):s._e(),"desc"==s.orderType?o("span",{staticClass:"nasIcons icon-sort-alpha-down-alt operation-icon"}):s._e()])],1),o("div",{staticClass:"list-title",staticStyle:{flex:"1"}},[o("span",{staticClass:"max-line-one"},[s._v(s._s(s.$t("movie.library")))]),o("Icon",{staticStyle:{cursor:"pointer"},attrs:{size:"16",type:"ios-help-circle-outline"},on:{click:function(e){e.stopPropagation(),s.showVsAlertDialog(s.$t("common.alert"),s.$t("movie.addLibraryAlert"))}}})],1),o("div",{staticClass:"nas-padding-right",staticStyle:{flex:"1",display:"flex","justify-content":"flex-end"}},[o("my-search",{ref:"mySearch",staticStyle:{"max-width":"200px"},attrs:{placeholder:s.$t("common.pleaseInputSearchContent")},on:{onSearch:s.onSearch}})],1)]),o("div",{ref:"wrapper",staticClass:"album-list-root",attrs:{id:"movie-library-wrapper"},on:{scroll:s.onPageScroll}},[s._l(s.dataList,function(t,i){return o("vs-card",{style:{margin:s.itemMargin+"px",width:s.itemWidth+"px"},attrs:{type:"2"},on:{click:function(e){return s.onLibraryClick(i)}},scopedSlots:s._u([{key:"img",fn:function(){return[o("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center",background:"#eee"},style:{height:s.itemHeight+"px"}},[s._l(t.dataPreview,function(e,t){return o("div",{staticStyle:{flex:"1",position:"relative",background:"#bbb","padding-right":"0.5px","padding-left":"0.5px"}},[o("img",{staticStyle:{width:"100%","object-fit":"cover",height:"100%","border-radius":"0px !important"},style:{height:s.itemHeight/4*3+"px"},attrs:{src:e.url}}),o("img",{staticStyle:{width:"100%","object-fit":"fill",height:"100%",transform:"scaleY(-1)","border-radius":"0px !important"},style:{height:s.itemHeight/4+"px"},attrs:{src:e.url}})])}),!t.dataPreview||t.dataPreview.length<1?o("img",{staticStyle:{"object-fit":"contain"},style:{width:s.itemWidth/3+"px"},attrs:{src:r("c6c5")}}):s._e(),o("div",{staticStyle:{background:"linear-gradient(to top, rgb(50, 50, 50), rgba(100, 100, 100, 0.4))",position:"absolute",bottom:"0",left:"0",height:"40px",width:"100%",display:"flex","align-items":"center","justify-content":"center"}},[o("p",{staticStyle:{color:"white","text-align":"center"}}),o("p",{staticClass:"max-line-one",staticStyle:{color:"white","text-align":"center","padding-left":"15px","padding-right":"15px","word-break":"break-all"}},[1==t.share_for_subuser?o("Icon",{attrs:{type:"ios-people"}}):s._e(),s._v(s._s(t.title))],1),o("p")])],2)]},proxy:!0},{key:"interactions",fn:function(){return[1==s.$store.state.currentUser.is_admin?o("vs-button",{staticClass:"btn-chat",attrs:{icon:"",shadow:"",primary:""},on:{click:function(e){return e.stopPropagation(),s.showAdd(t)}}},[o("Icon",{attrs:{type:"md-settings",size:"20"}})],1):s._e(),1==s.$store.state.currentUser.is_admin?o("vs-button",{staticClass:"btn-chat",attrs:{shadow:"",primary:"",icon:""},on:{click:function(e){return e.stopPropagation(),s.deleteLibrary(t)}}},[o("Icon",{attrs:{type:"md-trash",size:"20"}})],1):s._e()]},proxy:!0}],null,!0)})}),o("div",{staticStyle:{display:"flex","justify-content":"center",width:"100%","flex-direction":"column","align-items":"center"}},[s.nextHasMore&&0<s.dataList.length?o("Button",{staticStyle:{width:"250px","margin-top":"30px",height:"45px","border-radius":"20px"},attrs:{type:"default"},on:{click:function(e){return s.loadNextPage()}}},[s._v(s._s(s.$t("common.loadmore")))]):s._e(),s.nextLoading?o("Spin",{staticStyle:{"margin-top":"30px"},attrs:{size:"large"}}):s._e(),!s.nextLoading&&!s.nextHasMore&&0<s.dataList.length?o("span",{staticStyle:{"margin-top":"30px"}},[s._v(s._s(s.$t("common.noMore")))]):s._e(),o("div",{staticStyle:{height:"50px"}})],1),o("div",{staticStyle:{height:"50px",width:"100%"}})],2)]),o("vs-dialog",{attrs:{scroll:""},scopedSlots:s._u([{key:"header",fn:function(){return[o("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"20px"}},[o("img",{staticStyle:{width:"22px",height:"22px","margin-right":"10px"},attrs:{src:r("135a")}}),o("p",{staticStyle:{color:"#333333","font-size":"22px","text-align":"center"}},[s._v(" "+s._s(s.dialogTitle)+" ")])])]},proxy:!0},{key:"footer",fn:function(){return[o("div",{staticStyle:{"margin-bottom":"10px"}},[o("my-btn",{staticStyle:{width:"100%"},attrs:{block:"",title:s.dialogTitle},on:{click:function(e){return s.operationLibrary(s.selectedLibrary?"EDIT":"ADD")}}})],1)]},proxy:!0}]),model:{value:s.showAddDialog,callback:function(e){s.showAddDialog=e},expression:"showAddDialog"}},[o("div",{staticStyle:{"word-break":"break-all","text-align":"left","max-width":"100%"}}),o("vs-input",{attrs:{autocapitalize:"off",autocorrect:"off",type:"text",placeholder:s.$t("movie.addLibraryPlaceholder")},scopedSlots:s._u([{key:"icon",fn:function(){return[o("Icon",{attrs:{color:"#99AABF",type:"ios-bookmarks"}})]},proxy:!0}]),model:{value:s.inputLibraryName,callback:function(e){s.inputLibraryName=e},expression:"inputLibraryName"}}),o("Divider"),o("div",[o("div",{staticClass:"flex-row"},[o("p",{staticStyle:{"margin-right":"20px"}},[s._v(s._s(s.$t("movie.libraryIncludePath")))])]),o("div",{staticClass:"flex-row",staticStyle:{"margin-top":"5px","flex-wrap":"wrap"}},[s._l(s.libraryPathList,function(t){return o("Tag",{attrs:{type:"border",closable:"",color:"primary"},on:{"on-close":function(e){return s.onDeletePath(t)}}},[s._v(" "+s._s(t.showPath))])}),o("Button",{attrs:{icon:"ios-add",type:"dashed",size:"small"},on:{click:function(e){s.showChooseFolder=!0}}},[s._v(s._s(s.$t("common.addPath")))])],2)]),o("Divider"),o("div",{staticStyle:{display:"flex","align-items":"center"}},[o("p",{staticStyle:{"margin-right":"20px"}},[s._v(s._s(s.$t("shareForSubUser")))]),o("i-switch",{model:{value:s.shareForSubUser,callback:function(e){s.shareForSubUser=e},expression:"shareForSubUser"}})],1),s.shareForSubUser?o("div",{staticStyle:{"margin-top":"5px"}},[o("p",{staticClass:"text-user-alert"},[s._v(s._s(s.$t("movie.libraryUserAlert")))])]):s._e(),o("Divider")],1),o("Modal",{attrs:{fullscreen:"","footer-hide":"",closable:!1,"class-name":"modal-style-nopadding"},model:{value:s.showDetail,callback:function(e){s.showDetail=e},expression:"showDetail"}},[s.showDetail&&s.isPhotoLibrary?o("album-detail",{attrs:{propsShowSearchBtn:!1,propsTitle:s.$t("movie.library")+":"+s.selectedLibrary.title,propsShowAddToAlbum:!0,propsShowDelete:!1,propsShowModeSwitch:!0,propsLibraryId:s.selectedLibrary.id+""},on:{onClose:function(e){s.showDetail=!1}}}):s._e(),s.showDetail&&!s.isPhotoLibrary?o("library-detail",{attrs:{title:s.$t("movie.library")+":"+s.selectedLibrary.title,libraryId:s.selectedLibrary.id,isPhotoLibrary:s.isPhotoLibrary},on:{onClose:function(e){s.showDetail=!1}}}):s._e()],1),o("vs-dialog",{attrs:{"prevent-close":"",scroll:"","full-screen":s.isMobile},scopedSlots:s._u([{key:"header",fn:function(){return[o("h4",{staticStyle:{"font-size":"16px"}},[s._v(" "+s._s(s.$t("file.chooseFolder")+"["+s.$t("file.doubleClickFolderEnter")+"]")+" ")])]},proxy:!0},{key:"footer",fn:function(){return[o("file-select-bar",{on:{back:function(e){return s.$refs.fileSelector.goBack()},select:function(e){return s.$refs.fileSelector.onSelect()},create:function(e){return s.$refs.fileSelector.createNewFolder(e)}}})]},proxy:!0}]),model:{value:s.showChooseFolder,callback:function(e){s.showChooseFolder=e},expression:"showChooseFolder"}},[s.showChooseFolder?o("file-select",{ref:"fileSelector",attrs:{parent:"root",type:2,initPath:s.isPhotoLibrary?"sourceFolderPhoto":"sourceFolderMovie"},on:{onSelect:s.onSelectPath,onCancel:function(e){s.showChooseFolder=!1}}}):s._e()],1),o("vs-dialog",{scopedSlots:s._u([{key:"header",fn:function(){return[o("h4",{staticStyle:{"font-size":"16px"}},[s._v(" "+s._s(s.$t("common.chooseUser"))+" ")])]},proxy:!0}]),model:{value:s.showChooseUser,callback:function(e){s.showChooseUser=e},expression:"showChooseUser"}},[s.showChooseUser?o("user-select",{attrs:{hideAdmin:!0,parent:"root",type:2},on:{onSelect:s.onSelectUser}}):s._e()],1)],1)},[],!1,null,"7e53aa69",null);t.a=i.exports},a97b:function(e,t,i){"use strict";i("3016")},b1d0:function(e,t,i){},c161:function(e,t,i){},c5b4:function(e,t,i){},c6c5:function(e,t,i){e.exports=i.p+"img/ic_empty.c7c4e960.png"},cdf0:function(e,t,i){"use strict";var s=i("a133"),s={props:{libraryId:{default:0,type:Number},title:{default:"",type:String}},components:{movieList:s.default},data(){return{}},mounted(){},beforeDestroy(){},methods:{goBack(){this.$emit("onClose")}}},i=(i("3f29"),i("2877")),i=Object(i.a)(s,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"album-detail-root"},[t("my-bg"),t("div",{staticStyle:{overflow:"hidden",width:"100%",height:"100%"}},[t("div",{staticClass:"album-detail-header"},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("Button",{attrs:{type:"primary",shape:"circle",icon:"ios-arrow-back"},on:{click:e.goBack}}),t("div",{staticClass:"max-line-one",staticStyle:{"font-size":"18px","font-weight":"bold",height:"100%","margin-left":"20px"}},[e._v(" "+e._s(e.title))])],1)]),t("div",{staticClass:"album-detail-content"},[t("movie-list",{attrs:{libraryId:e.libraryId}})],1)])],1)},[],!1,null,"e58314a8",null);t.a=i.exports},cfff:function(e,t,i){},dbcb:function(e,t,i){"use strict";i("c5b4")},e106:function(e,t,i){"use strict";i("3cb8")}}]);