(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8a245596"],{"48c3":function(e,t,i){},"4dd8":function(e,t,o){o.r(t),o("caad"),o("b0c0"),o("ac1f"),o("2532"),o("5319");var r=o("b85c"),i=(o("baa5"),o("14d9"),o("4e82"),o("e9c4"),o("2ca0"),o("1bb5")),c=o("be3b"),a=o("19cb"),p=o.n(a),a=o("d3ac");o("d930");var a={components:{photoDetail:a.default},computed:{getLogoImageUrl:function(){return localStorage.customLogoImage?c.a.getCustomFileUrl(localStorage.customLogoImage):o("9743")}},data:function(){return{showUrlDialog:!1,showUrl:"",gotCustomConfig:!1,imgWidth:60,showPhotoDetail:!1,isRoot:!0,parent:"",shareToken:"",fileTree:[],pathSep:"/",platform:"",password:"",selectedFile:null,typeData:i.a,searchStr:""}},mounted:function(){var e=this.$route.query;this.shareToken=e.shareToken||e.st,this.getFileTree(""),this.$bus.$on("onDispatchPopstate",this.onDispatchPopstate)},beforeDestroy:function(){this.$bus.$off("onDispatchPopstate",this.onDispatchPopstate)},methods:{onDispatchPopstate:function(){this.goBack()},isWindowsDiskSign:function(e){return!!e&&!(!(e=e.name||e.fileFullPath)||3!=e.length||":"!=e[1]||"\\"!=e[2]&&"/"!=e[2])},showCopyDialog:function(e){this.showUrlDialog=!0;e=this.getRawUrl(e);e.startsWith("http")||(e=c.a.getBaseByLocation()+e),this.showUrl=e},lanIpClick:function(e){var t=navigator.clipboard;t&&(t.writeText(e),this.showVsNotification(this.$t("linkCopied")))},onSearch:function(e){this.searchStr=e},onClickDownload:function(e,t){var i=this;1==e.type?this.downloadShareFile(e,t):this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("folderDownloadAlert")+"(".concat(e.name||e.fileFullPath,")"),function(){i.downloadShareFile(e,t)})},downloadShareFile:function(e,t){t=this.getRawUrl(t);this.downloadFile([t])},goPreviewPdf:function(e){e=c.a.getViewerUrl("pdf",e);this.isMobile?window.location.href=e:window.open(e,"_blank")},goPreviewImage:function(e){for(var t=this,i=[],a=0,o=0;o<this.fileTree.length;o++)"image"==this.fileTree[o].fileType&&i.push({title:this.fileTree[o].name,type:1,url:this.fileTree[o].url});for(var s=0;s<i.length;s++)if(this.fileTree[e].name==i[s].title){a=s;break}this.showPhotoDetail=!0,this.$nextTick(function(){t.$refs.photoDetail.showImg(i,a)})},getRawUrl:function(e){return 1==this.fileTree[e].type?c.a.getRawFileUrl(this.fileTree[e].fileFullPath,this.fileTree[e].name,"",!0)+"&st="+this.shareToken+"&sp="+p.a.encode(this.password):c.a.getRawFileZipUrl(this.fileTree[e].fileFullPath,this.fileTree[e].name)+"&st="+this.shareToken+"&sp="+p.a.encode(this.password)},getDealedPath:function(e){e=encodeURIComponent(e);return p.a.encode(e)},goBack:function(){var e=0<this.parent.lastIndexOf(this.pathSep)?this.parent.lastIndexOf(this.pathSep):1,e=this.parent.substring(0,e);"win32"==this.platform&&2==e.length&&":"==e[1]&&(e+=this.pathSep),"win32"==this.platform&&this.parent.length<=4&&":"==this.parent[1]&&(e=""),this.getFileTree(e)},getFileType:function(e){switch(this.typeData[e]){case 1:return"image";case 2:return"video";case 3:return"text";case 4:return"pdf";case 5:return"music";case 6:return"word";case 7:return"ppt";case 8:return"excel";case 9:return"book";default:return"file"}},onItemClick:function(e,t){2==(this.selectedFile=e).type?this.enterPath(e):"image"==e.fileType?this.goPreviewImage(t):"pdf"==e.fileType?this.goPreviewPdf(this.getRawUrl(t)):"book"==e.fileType?this.goBookReader(this.getRawUrl(t),e):window.open(this.getRawUrl(t),"_blank")},goBookReader:function(e,t){localStorage.currentReadBook=JSON.stringify({path:t.parent,filename:t.name});e=c.a.getBookReadUrl(e);this.goUrl(e,t)},goUrl:function(e,t){this.isFromApp?window.android?window.android.onOpenNewWebViewByPath(e,t.name):window.webkit&&window.webkit.messageHandlers?(t=JSON.stringify({func:"onOpenNewWebViewByPath",path:e,title:t.name}),window.webkit.messageHandlers.bridge.postMessage(t)):window.open(e,"_blank"):window.open(e,"_blank")},enterPath:function(e){this.getFileTree(e.fileFullPath)},getFileTree:function(e,t){var l=this;t&&(this.password=t),this.api.post("/api/file/getTempShareFiles",{parent:e,shareToken:this.shareToken,password:this.password}).then(function(e){if(!e.code){for(var t in l.parent=e.data.parent,l.isRoot=""==l.parent,l.platform=e.data.platform,l.pathSep=e.data.sep,e.data.children.sort(function(e,t){return t.type-e.type}),l.fileTree=e.data.children,l.fileTree){var i,a;1==l.fileTree[t].type&&(0<=(i=(a=l.fileTree[t].name).lastIndexOf("."))?(a=a.substring(i).toLowerCase(),l.fileTree[t].ext=a,l.fileTree[t].fileType=l.getFileType(a),l.fileTree[t].fileType):l.fileTree[t].fileType="file",l.fileTree[t].url=c.a.getTinyUrlByFilePath(l.fileTree[t].fileFullPath,!0,l.fileTree[t].name)+"&st="+l.shareToken+"&sp="+p.a.encode(l.password))}if(l.$refs.pwdDialog.setShow(!1),l.$refs.listRoot.scrollTop=0,!l.gotCustomConfig&&e.data.customConfig&&0<e.data.customConfig.length){localStorage.removeItem("customHomeBgImage"),localStorage.removeItem("customLogoImage");var o,s=Object(r.a)(e.data.customConfig);try{for(s.s();!(o=s.n()).done;){var n=o.value;"customHomeBgImage"==n.title&&"-"!=n.value?localStorage.customHomeBgImage=n.value:"customLogoImage"==n.title&&"-"!=n.value&&(localStorage.customLogoImage=n.value)}}catch(e){s.e(e)}finally{s.f()}}l.gotCustomConfig=!0}}).catch(function(e){2==e.code&&(l.$refs.pwdDialog.setShow(!0),e.message)&&l.showVsNotification(e.message)})}}},s=(o("cd58"),o("2877")),s=Object(s.a)(a,function(){var a=this,e=a._self._c;return e("div",{staticClass:"brower-root"},[a.gotCustomConfig?e("my-bg"):a._e(),e("div",{staticClass:"main-layout temp-share-padding"},[a.gotCustomConfig?e("img",{staticStyle:{position:"fixed",left:"30px",top:"15px",height:"30px","object-fit":"contain"},attrs:{src:a.getLogoImageUrl,mode:"widthFix"}}):a._e(),e("div",{staticClass:"content-root"},[e("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"20px","justify-content":"space-between"}},[e("div",{staticStyle:{display:"flex"}},[e("my-btn-icon",{attrs:{disabled:a.isRoot,iIcon:"md-arrow-round-back"},on:{click:function(e){return a.goBack()}}}),e("Slider",{staticStyle:{width:"60px","margin-left":"20px"},attrs:{"show-tip":"never",min:30,max:200,step:10},model:{value:a.imgWidth,callback:function(e){a.imgWidth=e},expression:"imgWidth"}})],1),e("div",[e("my-search",{staticStyle:{"max-width":"220px"},attrs:{placeholder:a.$t("movie.searchPlaceHolder")},on:{onSearch:a.onSearch}})],1)]),e("div",{ref:"listRoot",staticClass:"list-root"},a._l(a.fileTree,function(t,i){return!a.searchStr||(a.searchStr,t.name&&t.name.toLowerCase().includes(a.searchStr.toLowerCase()))?e("div",{attrs:{id:"file_"+i}},[e("div",{staticClass:"list-item-list",on:{click:function(e){a.onItemClick(t,i)}}},[e("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",margin:"5px"},style:{width:a.imgWidth+"px",height:a.imgWidth+"px"}},[2==t.type?e("img",{staticStyle:{width:"100%"},attrs:{src:o("60b7")}}):a._e(),1!=t.type||"image"!=t.fileType&&"video"!=t.fileType?a._e():e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.url,expression:"file.url"}],staticClass:"item-img",on:{dragstart:function(e){e.preventDefault()}}}),1==t.type&&"video"==t.fileType?e("span",{staticClass:"play-icon nasIcons icon-play"}):a._e(),1==t.type&&"text"==t.fileType?e("img",{staticClass:"item-img",attrs:{src:o("a481")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"file"==t.fileType?e("img",{staticClass:"item-img",attrs:{src:o("8b5e")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"pdf"==t.fileType?e("img",{staticClass:"item-img",attrs:{src:o("218f")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"music"==t.fileType?e("img",{staticClass:"item-img",attrs:{src:o("1e28")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"word"==t.fileType?e("img",{staticClass:"item-img",attrs:{src:o("9b66")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"excel"==t.fileType?e("img",{staticClass:"item-img",attrs:{src:o("c0ed")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"ppt"==t.fileType?e("img",{staticClass:"item-img",attrs:{src:o("25d4")},on:{dragstart:function(e){e.preventDefault()}}}):a._e(),1==t.type&&"book"==t.fileType?e("div",{staticStyle:{position:"relative",width:"100%",height:"100%"}},[e("img",{staticClass:"item-img",attrs:{src:o("d69a")},on:{dragstart:function(e){e.preventDefault()}}}),t.ext?e("div",{staticStyle:{position:"absolute",left:"0",top:"0",display:"flex","align-items":"center","justify-content":"center",width:"100%",height:"100%"}},[e("div",{staticStyle:{color:"white","font-weight":"bold"}},[a._v(" "+a._s(t.ext.replace(".","").toUpperCase()))])]):a._e()]):a._e()]),e("div",{staticStyle:{flex:"1","padding-top":"5px","padding-bottom":"5px"}},[e("p",{staticClass:"filename"},[a._v(a._s(t.name||t.fileFullPath))]),t.size?e("p",{staticClass:"size"},[a._v(a._s(a.$t("file.size"))+":"+a._s(a.utils.getSizeStr(t.size)))]):a._e(),t.createTime?e("p",{staticClass:"size"},[a._v(a._s(a.$t("movie.createTime"))+":"+a._s(a.utils.formatTimeStamp(t.createTime))+" ")]):a._e()]),e("Tooltip",{attrs:{disabled:a.isMobile,place:"",content:a.$t("copyLink"),placement:"left-start"}},[a.isWindowsDiskSign(t)?a._e():e("Icon",{staticStyle:{"flex-shrink":"0","margin-left":"10px","font-size":"16px"},attrs:{type:"ios-link"},on:{click:function(e){return e.stopPropagation(),a.showCopyDialog(i)}}})],1),a.isWindowsDiskSign(t)?a._e():e("Icon",{staticStyle:{"flex-shrink":"0","margin-left":"10px","font-size":"16px"},attrs:{type:"md-download"},on:{click:function(e){return e.stopPropagation(),a.onClickDownload(t,i)}}})],1),e("div",{staticStyle:{width:"100%",height:"0.5px",background:"lightgrey"}})]):a._e()}),0)]),a.fileTree.length<1?e("my-nodata",{staticStyle:{position:"absolute",width:"100%","margin-top":"150px"},attrs:{title:a.$t("file.withoutSharedFile")}}):a._e()],1),e("my-dialog-input",{ref:"pwdDialog",attrs:{showCloseBtn:!0,title:a.$t("file.accessPwd"),content:""},on:{onOkClick:function(e){return a.getFileTree("",e)}}}),a.showPhotoDetail?e("photo-detail",{ref:"photoDetail",attrs:{enableExif:!1,fromFolderBrower:!0},on:{onClose:function(e){a.showPhotoDetail=!1}}}):a._e(),e("vs-dialog",{scopedSlots:a._u([{key:"header",fn:function(){return[a._v(" "+a._s(a.$t("copyLink"))+" ")]},proxy:!0}]),model:{value:a.showUrlDialog,callback:function(e){a.showUrlDialog=e},expression:"showUrlDialog"}},[e("div",{staticStyle:{"max-width":"400px",display:"flex","justify-content":"center"},on:{click:function(e){return a.lanIpClick(a.showUrl)}}},[e("a",{staticClass:"enable-text-select",staticStyle:{"word-break":"break-all","text-align":"center"}},[a._v(" "+a._s(a.showUrl))])])])],1)},[],!1,null,"5ec14a0d",null);t.default=s.exports},cd58:function(e,t,i){i("48c3")}}]);