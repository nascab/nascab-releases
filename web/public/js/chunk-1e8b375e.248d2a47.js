(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1e8b375e"],{"255c":function(t,e,i){"use strict";i("7cd9")},"2b27":function(t,e,i){"use strict";i("b63c")},"4c16":function(t,e,i){},"4f1e":function(t,e,i){},"53e6":function(t,e,i){"use strict";i("4f1e")},"59fb":function(t,e,i){"use strict";i("14d9");var o={props:{restoreFilter:{default:!1,type:Boolean},showSourceFilter:{default:!1,type:Boolean},albumId:{default:"",type:String},nearMode:{default:!1,type:Boolean},editMode:{default:!1,type:Boolean},showSearchBtn:{default:!0,type:Boolean},usePadding:{default:!1,type:Boolean}},computed:{filterConditionCount:function(){return this.selectedSourceFolder.length}},data(){return{timeOrder:"desc",showFilterDialog:!1,sourceFolderList:[],selectedSourceFolder:[],showAndroidPlayerSetting:!1,typeMenuOptionList:[{title:this.$t("photo.all"),id:"0"},{title:this.$t("photo.photo"),id:"1"},{title:this.$t("photo.video"),id:"2"},{title:"LIVE",id:"3"}],rangeMenuOptionList:[{title:this.$t("photo.5km"),id:"0"},{title:this.$t("photo.10km"),id:"1"},{title:this.$t("photo.80km"),id:"2"}],sliderMin:130,sliderMax:350,sliderValue:200,lastSliderValue:200,itemBaseWidth:200,itemWidth:200,itemMargin:5,searchStr:"",loadingPositionStr:!1,firstPhotoGeohash:"",showRangeType:"0",showMode:"cover",showFileType:"0"}},mounted(){this.albumId;var t=localStorage.getItem("photo-settging-img-size"),t=(t&&(this.sliderValue=parseInt(t),this.$emit("onSizeChange",parseInt(t))),localStorage.getItem("photo-settging-show-mode")),t=(t&&this.showMode!=t&&(this.showMode=t,this.$emit("onChangeShowMode",this.showMode)),localStorage.getItem("photo-settging-time-order")),t=(t&&this.timeOrder!=t&&(this.timeOrder=t,this.$emit("onTimeOrderChange",this.timeOrder,!1)),localStorage.getItem("photo-settging-show-range"));t&&this.showRangeType!=t&&(this.showRangeType=t,this.$nextTick(()=>{this.$refs.rangeSelector&&0<this.showRangeType&&this.showRangeType<=2&&this.$refs.rangeSelector.setSelectedIndex(this.showRangeType)})),this.getSourceFolder(),window.addEventListener("keydown",this.onKeyDown)},beforeDestroy(){window.removeEventListener("keydown",this.onKeyDown)},methods:{onKeyDown(i){if(!this.isShowingDialog()){let t,e=i.key;"="==e?this.sliderValue<this.sliderMax&&(t=this.sliderValue+50):"-"==e?this.sliderValue>this.sliderMin&&(t=this.sliderValue-50):e&&"c"==e.toLowerCase()&&("contain"==this.showMode?this.onChangeShowMode("cover"):this.onChangeShowMode("contain")),t&&(this.sliderValue=t,this.onSizeChange(t))}},getSourceFolder(){this.api.post("/api/sourceFolderApi/getPathByType",{type:"photo"}).then(t=>{if(!t.code){if(1==this.$store.state.currentUser.is_admin)if(t.data.length<1)this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("photo.noSourceSetAlert"),()=>{this.$emit("setViewType","photoSourceSet")},null,this.$t("photo.goToSet"));else if(!sessionStorage.PhotoSourcePathUnusableAlert)for(var e in t.data)if(0==t.data[e].exist){sessionStorage.PhotoSourcePathUnusableAlert=1,this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("photo.sourcePathUnusable",{path:t.data[e].path}),()=>{this.$emit("setViewType","photoSourceSet")},null,this.$t("photo.goToSet"));break}for(var i in t.data)this.sourceFolderList.push(t.data[i].path);if(this.restoreFilter)if(localStorage.cacheSelectedSourceFolderJSON)try{var o,s=JSON.parse(localStorage.cacheSelectedSourceFolderJSON);for(o in s)for(var h in this.sourceFolderList)s[o]==this.sourceFolderList[h]&&this.selectedSourceFolder.push(s[o]);0<this.selectedSourceFolder.length?this.onFilterFinish():this.loadFirstPage()}catch(t){this.loadFirstPage()}else this.loadFirstPage();else this.loadFirstPage()}}).catch(t=>{})},loadFirstPage(){this.$emit("onChooseRange",this.showRangeType)},onFilterFinish(){var t=0<this.selectedSourceFolder.length?JSON.stringify(this.selectedSourceFolder):"";this.$emit("onChooseSource",t),this.restoreFilter&&(t?localStorage.cacheSelectedSourceFolderJSON=t:window.localStorage.removeItem("cacheSelectedSourceFolderJSON"))},onSwitchTimeOrder(){this.timeOrder="desc"==this.timeOrder?"asc":"desc",localStorage.setItem("photo-settging-time-order",this.timeOrder),this.$emit("onTimeOrderChange",this.timeOrder,!0)},onSearch(t){this.searchStr=t,this.$emit("onSearch",this.searchStr)},onSearchClear(){this.$emit("onSearch","")},onChooseDataType(t){this.showFileType=t,this.$emit("onChooseDataType",t)},onChooseRange(t){this.showRangeType=t,localStorage.setItem("photo-settging-show-range",this.showRangeType),this.$emit("onChooseRange",t)},onSizeChange(t){this.lastSliderValue,this.lastSliderValue!=t&&(this.lastSliderValue=t,localStorage.setItem("photo-settging-img-size",t),this.$emit("onSizeChange",t))},onChangeShowMode(t){this.showMode=t,localStorage.setItem("photo-settging-show-mode",this.showMode),this.$emit("onChangeShowMode",this.showMode),this.showMode}}},i=(i("53e6"),i("2877")),i=Object(i.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%",width:"100%",position:"relative"}},[i("div",{staticClass:"layout-header-bar",class:{"nas-padding-left":e.usePadding,"nas-padding-right":e.usePadding}},[i("div",{staticClass:"header-right"},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("Badge",{staticClass:"icon-showtype",attrs:{offset:[5,0],count:e.showSourceFilter?e.filterConditionCount:0}},[e.showSourceFilter?i("span",{staticClass:"nasIcons icon-filter icon-filt",on:{click:function(t){e.showFilterDialog=!0}}}):e._e()]),i("Tooltip",{attrs:{disabled:e.isMobile,content:"asc"==e.timeOrder?e.$t("common.asc"):e.$t("common.desc")}},[e.showSourceFilter?i("div",{on:{click:function(t){return e.onSwitchTimeOrder()}}},["asc"==e.timeOrder?i("span",{staticClass:"nasIcons icon-asc icon-showtype",staticStyle:{color:"#386DF2"}}):e._e(),"desc"==e.timeOrder?i("span",{staticClass:"nasIcons icon-desc icon-showtype",staticStyle:{color:"#386DF2"}}):e._e()]):e._e()]),i("my-menu-select",{attrs:{optionList:e.typeMenuOptionList},on:{onItemClick:e.onChooseDataType}}),e.nearMode?i("my-menu-select",{ref:"rangeSelector",staticStyle:{display:"inline-flex","margin-left":"10px"},attrs:{optionList:e.rangeMenuOptionList},on:{onItemClick:e.onChooseRange}}):e._e()],1),e.showSearchBtn?i("div",{staticClass:"search-root"},[i("my-search",{staticStyle:{"max-width":"250px"},attrs:{placeholder:e.$t("photo.searchPlaceHolder")},on:{onSearch:e.onSearch}})],1):e._e()])]),i("vs-dialog",{attrs:{scroll:""},scopedSlots:e._u([{key:"header",fn:function(){return[i("h4",{staticClass:"not-margin"},[e._v(" "+e._s(e.$t("movie.conditionFilter"))+" ")])]},proxy:!0}]),model:{value:e.showFilterDialog,callback:function(t){e.showFilterDialog=t},expression:"showFilterDialog"}},[i("div",[i("div",{staticClass:"nas-mobile-none slider-root"},[i("p",{staticStyle:{"text-align":"left","flex-shrink":"0","font-weight":"bold"}},[e._v(e._s(e.$t("imageSize"))+":")]),i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("Slider",{staticClass:"zoom-slider",attrs:{"show-tip":"never",min:e.sliderMin,max:e.sliderMax,step:10},on:{"on-input":e.onSizeChange},model:{value:e.sliderValue,callback:function(t){e.sliderValue=t},expression:"sliderValue"}}),i("a",{on:{click:function(t){e.showVsAlertDialog(e.$t("quickKey"),e.$t("photoKeyAlert"))}}},[i("Icon",{staticStyle:{"font-weight":"bold",cursor:"pointer"},attrs:{type:"ios-help-circle-outline"}})],1)],1)]),i("Divider",{staticClass:"nas-mobile-none",staticStyle:{margin:"10px 0"}}),i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("p",{staticStyle:{"text-align":"left","flex-shrink":"0","font-weight":"bold"}},[e._v(e._s(e.$t("file.showType"))+":")]),i("RadioGroup",{staticStyle:{"text-align":"left","margin-left":"10px"},on:{"on-change":e.onChangeShowMode},model:{value:e.showMode,callback:function(t){e.showMode=t},expression:"showMode"}},[i("Radio",{attrs:{label:"contain"}},[i("Icon",{attrs:{type:"md-photos"}}),i("span",[e._v(e._s(this.$t("photo.contain")))])],1),i("Radio",{attrs:{label:"cover"}},[i("Icon",{attrs:{type:"ios-apps"}}),i("span",[e._v(e._s(this.$t("photo.cover")))])],1)],1)],1),i("Divider",{staticStyle:{margin:"10px 0"}}),i("p",{staticStyle:{width:"100%","text-align":"left","margin-top":"15px"}},[e._v(e._s(e.$t("movie.selectSourceFolder")))]),i("CheckboxGroup",{on:{"on-change":e.onFilterFinish},model:{value:e.selectedSourceFolder,callback:function(t){e.selectedSourceFolder=t},expression:"selectedSourceFolder"}},e._l(e.sourceFolderList,function(t){return i("Checkbox",{staticClass:"source-item max-line-one",attrs:{label:t,border:""}},[e._v(e._s(""+t))])}),1)],1)])],1)},[],!1,null,"113f49dc",null);e.a=i.exports},"7cd9":function(t,e,i){},"860b":function(t,e,i){"use strict";i("4c16")},b63c:function(t,e,i){},cd79:function(t,e,i){"use strict";i.r(e);i("14d9");var o=i("9453"),s={name:"photo-timeline",props:{geohash:{default:"",type:String}},data(){return{mouseInTimeLine:!1,showTimeLine:!1,showTimeOut:null,scrolling:!1,rootWrapper:null,cursorTop:0,cursorDateStr:"",cursorDateObj:"",dateList:[],itemHeight:1,tmHeight:0,isUsingTimeLine:!1,photoTotalCount:0,movePointerIndex:0,hadMoved:!1}},methods:{barTouchStart(t){this.cancelTimeout(),this.movePointerIndex=0,this.hadMoved=!1,this.isUsingTimeLine=!0},barTouchMove(t){this.isUsingTimeLine=!0,this.rootWrapper||(this.rootWrapper=this.$refs.timeLineRoot.getBoundingClientRect());t=t.changedTouches[0].pageY-this.rootWrapper.top;this.cursorTop=t;let e=0,i=0;for(let t=0;t<this.dateList.length;t++)if(e+=this.dateList[t].height,this.cursorTop<=e){i=0<t?t-1:0;break}this.movePointerIndex=i,this.cursorDateStr=this.dateList[i].yearMonth.replace("-","/"),this.cursorDateObj=this.dateList[i],this.hadMoved=!0},barTouchEnd(t){this.isUsingTimeLine=!1,this.hadMoved&&(this.setTimeoutInvisiable(),this.$emit("onTimeChoose",this.dateList[this.movePointerIndex].original_time))},cancelTimeout(){this.showTimeOut&&clearTimeout(this.showTimeOut)},setTimeoutInvisiable(){this.cancelTimeout(),this.showTimeOut=setTimeout(()=>{this.isUsingTimeLine||!this.isMobile&&this.mouseInTimeLine||(this.showTimeLine=!1,this.scrolling=!1)},1500)},onScroll(){this.scrolling=!0,this.showTimeLine=!0,this.isUsingTimeLine=!1,this.setTimeoutInvisiable()},mouseMove(t){this.$refs.timeLineRoot&&(this.isUsingTimeLine=!0,this.rootWrapper=this.$refs.timeLineRoot.getBoundingClientRect(),this.cursorTop=t.pageY-this.rootWrapper.top)},mouseEnter(t){this.mouseInTimeLine=!0,this.showTimeLine=!0,this.isUsingTimeLine=!0},itemMouseEnter(t){this.cursorDateStr=t.yearMonth.replace("-","/"),this.cursorDateObj=t},mouseLeave(t){this.mouseInTimeLine=!1,setTimeout(()=>{this.mouseInTimeLine||this.scrolling||(this.showTimeLine=!1)},1e3),this.isUsingTimeLine=!1},onTimeClick(t){this.hadMoved=!1,this.$emit("onTimeChoose",this.dateList[t].original_time)},onWindowResize(){this.calItemHeight()},showSelectedTime(t){let e=0,i=0;for(var o in this.dateList)if(i+=this.dateList[o].count,t>=this.dateList[o].original_time){e=o;break}this.cursorTop=i/this.photoTotalCount*this.tmHeight,this.cursorDateStr=this.dateList[e].yearMonth.replace("-","/"),this.cursorDateObj=this.dateList[e]},calItemHeight(){this.photoTotalCount<1||this.$nextTick(()=>{this.rootWrapper=this.$refs.timeLineRoot.getBoundingClientRect(),this.tmHeight=this.rootWrapper.height-60,this.itemHeight=this.tmHeight/this.photoTotalCount;for(let t=0;t<this.dateList.length;t++)this.dateList[t].height=this.dateList[t].count*this.itemHeight})},getTimeLine(t,e,i,o,s,h,a,r,n,l){t={type:parseInt(t)};e&&(t.geohash=e),i&&(t.albumId=i),o&&(t.ordinaryAlbumId=o),s&&(t.searchStr=s),h&&(t.aiClassId=parseInt(h)),a&&(t.faceId=a),r&&(t.sourceFolderList=r),n&&(t.libraryId=n),l&&(t.timeOrder=l),this.api.post("/api/photoApi/getTimeLineDateList",t).then(e=>{if(!e.code){function i(t,e){const i=t.map(t=>t.count),o=[...i].sort((t,e)=>t-e),s=Math.floor(t.length*e),h=o[s-1];return t.filter(t=>t.count>=h)}let t=e.data;t.length,2e3<t.length?t=i(t,.5):1500<t.length?t=i(t,.3):1e3<t.length&&(t=i(t,.2)),t.length,this.dateList=t,this.$emit("onTimeLineGet",e.data),this.initDate()}}).catch(t=>{})},initDate(){if(!(this.dateList.length<1)){for(let t=this.photoTotalCount=0;t<this.dateList.length;t++){var i=new Date(this.dateList[t].original_time),i=(this.dateList[t].dateObj=i,this.dateList[t].year=i.getFullYear(),i.getMonth()+1);this.dateList[t].yearMonth=this.dateList[t].year+"-"+(i<10?"0"+i:i)}let e=0;for(let t=0;t<this.dateList.length;t++)this.photoTotalCount+=this.dateList[t].count,e+=this.dateList[t].count,0<t&&this.dateList[t].year!=this.dateList[t-1].year&&(this.dateList[t-1].showYear=!0,this.dateList[t-1].yearPhotoCount=e,e=0),t==this.dateList.length-1&&(this.dateList[t].showYear=!0,this.dateList[t].yearPhotoCount=e,e=0);this.calItemHeight()}}},mounted(){}},h=(i("860b"),i("2877")),s=Object(h.a)(s,function(){var o=this,t=o.$createElement,s=o._self._c||t;return s("div",{ref:"timeLineRoot",staticClass:"timeline-root",on:{mouseenter:o.mouseEnter,mouseleave:o.mouseLeave,mousemove:o.mouseMove,touchmove:function(t){return t.preventDefault(),o.barTouchMove(t)},touchstart:o.barTouchStart,touchend:o.barTouchEnd}},[o.showTimeLine?s("div",{ref:"dateList",staticClass:"date-list"},o._l(o.dateList,function(e,i){return s("div",{staticClass:"item",style:{height:e.height+"px"},on:{click:function(t){return o.onTimeClick(i)},mouseenter:function(t){return o.itemMouseEnter(e)}}},[e.showYear&&(30<e.yearPhotoCount*o.itemHeight||i==o.dateList.length-1)?s("div",{staticClass:"year-text"},[s("p",[o._v(o._s(e.year))])]):o._e(),10<e.height&&!e.showYear?s("div",{staticClass:"ring-wrapper"},[s("div",{staticClass:"ring"})]):o._e()])}),0):o._e(),o.showTimeLine?s("div",{staticClass:"cursor-root",style:{top:o.cursorTop+"px"}},[s("div",{staticClass:"cursor-line"}),s("p",{staticClass:"cursor-text"},[o._v(" "+o._s(o.cursorDateStr)+" ")])]):o._e(),o.isUsingTimeLine&&o.showTimeLine?s("div",{staticClass:"center-root"},[s("div",{staticClass:"center-root-content"},[o._v(o._s(o.cursorDateObj.original_date))])]):o._e()])},[],!1,null,"37b14c16",null).exports,a=i("d3ac"),r=i("5d55"),n=i("59fb"),l=i("db96"),d=i("2cc5"),o={props:{hasSider:{default:!1,type:Boolean},nearMode:!1,geohash:{default:"",type:String},showSearchBtn:{default:!0,type:Boolean},showAddToAlbum:{default:!0,type:Boolean},showRemoveFromAlbum:{default:!1,type:Boolean},ordinaryAlbumId:{default:"",type:String},albumId:{default:"",type:String},libraryId:{default:"",type:String},aiClassId:{default:"",type:String},faceId:{default:"",type:String}},components:{photoBottomSelect:o.a,photoTimeline:s,photoDetail:a.default,videoDetail:r.default,photoOperationHeader:n.a,photoListContent:l.a},data(){return{sourceFolderList:"",searchStr:"",showRangeType:"0",showVideoDetail:!1,scrollTop:0,timeLine:[],showPhotoDetail:!1,editMode:!1,showMode:"cover",showFileType:"0",timeOrder:"desc"}},created(){window.addEventListener("scroll",this.onPageScroll,!0),window.addEventListener("resize",this.onWindowResize),window.addEventListener("popstate",this.onPopstate),this.$bus.$on("closePhotoGallery",()=>{this.$refs.photoDetail&&this.$refs.photoDetail.closeGallery(),this.showPhotoDetail=!1})},beforeDestroy(){window.removeEventListener("scroll",this.onPageScroll),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("popstate",this.onPopstate),this.$bus.$off("closePhotoGallery")},methods:{setViewType(t){this.$emit("setViewType",t)},galleryLoadMorePre(){this.$refs.photoContent&&this.$refs.photoContent.loadLastPage()},galleryLoadMoreNext(){this.$refs.photoContent&&this.$refs.photoContent.loadNextPage()},onPopstate(){this.showPhotoDetail?(this.$refs.photoDetail.closeGallery(),this.showPhotoDetail=!1):this.showVideoDetail?this.showVideoDetail=!1:this.$router.go(-1)},onChooseRange(t){this.showRangeType=t,this.$nextTick(()=>{this.$refs.timeline&&this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,"",this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder)})},onTimeLineGet(t){this.timeLine=t,this.loadFirstPage()},loadFirstPage(){var t;this.$refs.photoContent.clearList(),this.$refs.photoContent.lastHasMore=!1,0<this.timeLine.length&&(t="desc"==this.timeOrder?1:2,this.$refs.photoContent.getPhotoByDate(this.timeLine[0],t))},onWindowResize(t){this.$nextTick(()=>{this.$refs.photoContent.calculateImgHeight(),this.$refs.timeline.onWindowResize(document.documentElement.clientHeight)})},onPageScroll(i){if(!this.showPhotoDetail&&!this.showVideoDetail&&"photo-wrapper"==i.target.id){this.$refs.photoContent&&this.$refs.photoContent.cancelTouchEvent();let t=null,e=null;i.srcElement.scrollingElement?(t=i.srcElement.scrollingElement.scrollTop,e=i.srcElement.scrollingElement.scrollHeight):i.srcElement?(t=i.srcElement.scrollTop,e=i.srcElement.scrollHeight):i.target&&(t=i.target.scrollTop,e=i.target.scrollHeight),this.scrollTop=t;var o=document.documentElement.clientHeight;!e&&i.srcElement.scrollingElement&&(e=i.srcElement.scrollingElement.scrollHeight),this.scrollTop>o?this.$refs.photoContent&&this.$refs.photoContent.setShowTopBtn(!0):this.$refs.photoContent&&this.$refs.photoContent.setShowTopBtn(!1),0==this.scrollTop&&this.$refs.photoContent&&this.$refs.photoContent.loadLastPage(),this.scrollTop+o>=e-5&&this.$refs.photoContent&&this.$refs.photoContent.loadNextPage(),this.$refs.timeline&&this.$refs.timeline.onScroll()}},onUnSelect(){this.clearSelected()},onTimeOrderChange(t,e){this.timeOrder=t,e&&(this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,null,this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder),this.clearSelected())},onChooseSource(t){this.sourceFolderList=t,this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,null,this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder),this.clearSelected()},onSearch(t){this.searchStr=t,this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,t,this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder),this.clearSelected()},onChooseDataType(t){this.showFileType=t,this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,null,this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder),this.clearSelected()},getGeoParam(){if(!this.geohash)return null;let t=this.geohash.substr(0,5);return"1"==this.showRangeType?t=this.geohash.substr(0,4):"2"==this.showRangeType?t=this.geohash.substr(0,3):"3"==this.showRangeType&&(t=this.geohash.substr(0,2)),t},setImgSize(t){this.$refs.photoContent.itemBaseWidth=t,this.$refs.photoContent.calculateImgHeight()},onTimeChoose(t){var e,i;this.$refs.photoContent.clearList(),"desc"==this.timeOrder?this.$refs.photoContent.getPhotoByTime(t,1,!0):(i=(t=new Date(t)).getFullYear(),e=(t.getMonth()+1).toString().padStart(2,"0"),t=t.getDate().toString().padStart(2,"0"),i=new Date(i+`-${e}-`+t+"T00:00:00").getTime(),this.$refs.photoContent.getPhotoByTime(i,2,!0))},onChangeShowMode(t){this.showMode=t,this.$refs.photoContent.calculateImgHeight()},switchEditMode(){this.editMode=!this.editMode,this.editMode||this.clearSelected()},onHoverSelected(t){this.editMode=!0,this.onPhotoClick(t)},onPhotoLoadOver(t,e){setTimeout(()=>{this.$refs.photoContent.calculateImgHeight()},300),this.showPhotoDetail&&this.$refs.photoDetail&&this.$refs.photoDetail.updateImageList(t,e)},onTrashInSuc(){this.$refs.photoContent.onTrashInSuc()},clearSelected(){this.$refs.photoContent.clearSelected(),this.$refs.selectView&&this.$refs.selectView.clearSelected(),this.editMode=!1},onPhotoClick(o){if(this.editMode){var t=this.$refs.photoContent.photoList,e=t[o];e.selected?(this.$refs.photoContent.setPhotoSelected(o,!1),this.$refs.selectView.removeSelected(e.id),this.$refs.selectView.selectedList.length<1&&(this.editMode=!1)):(this.$refs.photoContent.setPhotoSelected(o,!0),this.$refs.selectView.addSelected(t[o]))}else{let i=[];if(this.$refs.photoContent.groupByDate){var s,e=this.$refs.photoContent.photoList,h=e[o];for(s of e)"DATE"!=s.itemType&&(i.push(s),s.id==h.id)&&(o=i.length-1)}else i=this.$refs.photoContent.photoList;if(1==i[o].type)this.showPhotoDetail=!0,this.$nextTick(()=>{this.$refs.photoDetail.showImg(i,o)}),this.pushState();else if(2==i[o].type)if("1"==localStorage.getItem("rawPlayer")||this.isIosSupportRawPlayer()){let t=[],e=0;for(var a in i)2==i[a].type&&t.push(i[a]);for(var r in t)if(t[r].id==i[o].id){e=r;break}d.a.playVideo({playIndex:e,playList:t,token:this.$store.state.token,fromFileBrower:!1,serverType:"photo"})}else this.showVideoDetail=!0,this.$nextTick(()=>{this.$refs.videoPlayer.playVideo(i,o)}),this.pushState()}}}},s=(i("255c"),Object(h.a)(o,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{ref:"photoListRoot",staticClass:"photo-list-root"},[t("div",{staticClass:"photo-header"},[t("photo-operation-header",{ref:"photoHeader",attrs:{usePadding:!0,showSourceFilter:!0,restoreFilter:!(e.nearMode||e.ordinaryAlbumId||e.albumId||e.faceId||e.aiClassId),editMode:e.editMode,nearMode:e.nearMode},on:{showSearchBtn:e.showSearchBtn,onChooseDataType:e.onChooseDataType,setViewType:e.setViewType,onChangeShowMode:e.onChangeShowMode,onSizeChange:e.setImgSize,onChooseRange:e.onChooseRange,onSearch:e.onSearch,albumId:e.albumId,onSwitchEditMode:e.switchEditMode,onChooseSource:e.onChooseSource,onTimeOrderChange:e.onTimeOrderChange}})],1),t("div",{staticClass:"photo-content"},[t("photo-list-content",{ref:"photoContent",attrs:{timeOrder:e.timeOrder,showMode:e.showMode,geohash:e.geohash,albumId:e.albumId,libraryId:e.libraryId,aiClassId:e.aiClassId,ordinaryAlbumId:e.ordinaryAlbumId,showRangeType:e.showRangeType,showFileType:e.showFileType,searchStr:e.searchStr,faceId:e.faceId,sourceFolderList:e.sourceFolderList},on:{onHoverSelected:e.onHoverSelected,onPhotoClick:e.onPhotoClick,onUnSelect:e.onUnSelect,onPhotoLoadOver:e.onPhotoLoadOver}}),t("photo-timeline",{directives:[{name:"show",rawName:"v-show",value:0<e.timeLine.length,expression:"timeLine.length > 0"}],ref:"timeline",staticClass:"timeline-wrapper",attrs:{geohash:e.geohash,albumId:e.albumId},on:{onTimeChoose:e.onTimeChoose,onTimeLineGet:e.onTimeLineGet}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.editMode,expression:"editMode"}],staticClass:"bottom-select-root"},[t("photo-bottom-select",{ref:"selectView",attrs:{ordinaryAlbumId:e.ordinaryAlbumId,showRemoveFromAlbum:e.showRemoveFromAlbum,showAddToAlbum:e.showAddToAlbum,faceId:e.faceId,editMode:e.editMode},on:{onRemoveFromAlbum:e.onTrashInSuc,onUnSelect:e.onUnSelect,onTrashInSuc:function(t){return e.onTrashInSuc()}}})],1),e.showPhotoDetail?t("photo-detail",{ref:"photoDetail",attrs:{enableRemove:!0},on:{onClose:function(t){e.showPhotoDetail=!1},galleryLoadMorePre:e.galleryLoadMorePre,galleryLoadMoreNext:e.galleryLoadMoreNext}}):e._e(),t("Modal",{attrs:{fullscreen:"","footer-hide":"",closable:!1},model:{value:e.showVideoDetail,callback:function(t){e.showVideoDetail=t},expression:"showVideoDetail"}},[e.showVideoDetail?t("video-detail",{ref:"videoPlayer",attrs:{propsServerType:"photo"},on:{onClose:function(t){e.showVideoDetail=!1}}}):e._e()],1)],1)},[],!1,null,"3fa04050",null));e.default=s.exports},db96:function(t,e,i){"use strict";i("14d9");var o=i("be3b"),s=(i("d930"),{components:{photoFacesSelect:()=>i.e("chunk-4dd5b452").then(i.bind(null,"1498"))},props:{pageRows:{default:10,type:Number},geohash:{default:"",type:String},ordinaryAlbumId:{default:"",type:String},aiClassId:{default:"",type:String},faceId:{default:"",type:String},albumId:{default:"",type:String},libraryId:{default:"",type:String},showMode:{default:"cover",type:String},showFileType:{default:"0",type:String},showRangeType:{default:"0",type:String},trash:{default:0,type:Number},sortField:{default:"original_time",type:String},marginRight:{default:"0",type:String},searchStr:{default:"",type:String},sourceFolderList:{default:"",type:String},timeOrder:{default:"desc",type:String}},data(){return{groupByDate:!0,originalDateItemListLocation:{},originalDateItemListMode:{},isInDragSelectMode:!1,dragStartIndex:0,dragEndIndex:0,dragSelectMode:!0,showSelectFace:!1,showToTopBtn:!1,rightMenuList:[],listMaxLength:500,sortType:"desc",scrollBarWidth:0,token:this.getToken(),itemBaseWidth:200,photoWidth:200,photoHeight:0,photoMargin:5,photoList:[],lastHasMore:!1,nextHasMore:!0,lastLoading:!1,nextLoading:!1,baseUrl:o.a.baseUrl,dataColumns:10,selectedIndex:null,selectedFile:null,switchPeopleIndexList:[]}},mounted(){this.isMobile&&(this.itemBaseWidth=180),"original_time"!=this.sortField&&(this.groupByDate=!1),this.$bus.$on("removeIndexById",t=>{if(this.photoList&&0<this.photoList.length)for(var e in this.photoList)this.photoList[e].id==t&&this.photoList.splice(e,1)}),this.$bus.$on("onIndexUpdate",t=>{for(var e in this.photoList)this.photoList[e].id==t.id&&(this.photoList[e]=t,this.dealPhotoUrl(this.photoList[e]))}),this.$bus.$on("onRemoveFromFace",i=>{this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("photo.removeFromAlbum")+"?",()=>{var t,e=[];for(t of this.photoList)i.includes(t.id)&&e.push(t);this.removeFromFaceApi(e)})}),this.$bus.$on("onSwitchToOtherPeople",t=>{var e,i=[];for(e of this.photoList)t.includes(e.id)&&i.push(e);this.switchPeopleIndexList=i,this.showSelectFace=!0})},beforeDestroy(){this.$bus.$off("removeIndexById"),this.$bus.$off("onIndexUpdate"),this.$bus.$off("onRemoveFromFace")},methods:{initRightMenu(t){this.rightMenuList=[],t.selected||this.rightMenuList.push({text:this.$t("file.check"),type:"CHECK"}),this.rightMenuList.push({text:this.$t("common.download"),type:"DOWNLOAD"}),this.ordinaryAlbumId?this.rightMenuList.push({text:this.$t("photo.removeFromAlbum"),type:"REMOVE_FROM_ALBUM"}):this.rightMenuList.push({text:this.$t("photo.addToAlbum"),type:"ADD_TO_ALBUYM"}),this.faceId&&(this.rightMenuList.push({text:this.$t("photo.setFacePoster"),type:"SET_FACE_POSTER"}),this.rightMenuList.push({text:this.$t("photo.removeFromFace"),type:"REMOVE_FROM_FACE"}),this.$forceUpdate()),1!=this.trash&&this.rightMenuList.push({text:this.$t("photo.putInTrash"),type:"TRASH"}),!t.selected&&this.showOpenInSystem&&(this.rightMenuList.push({text:this.$t("openInSystem"),type:"OPEN_IN_SYSTEM"}),this.rightMenuList.push({text:this.$t("selectedInSystem"),type:"SELECT_IN_SYSTEM"}))},onMouseDown(t,e){t&&1==t.buttons&&(this.isInDragSelectMode=!0,this.dragSelectMode=!this.photoList[e].selected,this.dragStartIndex=e)},onMouseUp(t){this.isInDragSelectMode=!1},onMouseLeaveRoot(){this.isInDragSelectMode=!1},mouseEnterImg(t){this.isInDragSelectMode?(this.dragEndIndex=t,this.setDragRange()):this.isMobile||(this.photoList[t].hover=!0,this.$forceUpdate())},mouseLeaveImg(t){this.isMobile||(this.photoList[t].hover=!1)},setDragRange(){var e=this.dragStartIndex>this.dragEndIndex?this.dragEndIndex:this.dragStartIndex,i=this.dragStartIndex>this.dragEndIndex?this.dragStartIndex:this.dragEndIndex;for(let t=e;t<=i;t++)this.dragSelectMode?this.photoList[t].selected||this.hoverSelect(t):this.photoList[t].selected&&this.hoverSelect(t)},onSelectPeople(){if(this.$refs.photoFaceSelect){var t=this.$refs.photoFaceSelect.getSelectedFaceId();if(t){var e,i=[];for(e of this.switchPeopleIndexList)i.push({photo_index_id:e.id,face_id:e.face_id});t={targetFaceId:t,rawFaceIndexIdList:JSON.stringify(i)};this.api.post("/api/photoApi/switchFaceId",t).then(t=>{if(!t.code){if(this.showVsNotification(this.$t("common.changeSuccess")),t.sucIdList)for(var e in t.sucIdList){var i=t.sucIdList[e];for(let t=this.photoList.length-1;0<=t;t--)if(this.photoList[t].id==i){this.photoList[t].id,this.photoList.splice(t,1);break}}this.showSelectFace=!1}}).catch(t=>{})}}},touchstart(t){clearTimeout(this.longPressTimeout),this.longPressTimeout=setTimeout(()=>{this.hoverSelect(t)},800)},touchend(){clearTimeout(this.longPressTimeout)},cancelTouchEvent(){this.longPressTimeout&&(clearTimeout(this.longPressTimeout),this.longPressTimeout=null)},setShowTopBtn(t){this.showToTopBtn=t},showRightMenu(t,e,i,o){i.selected||this.$emit("onUnSelect"),this.initRightMenu(i),this.selectedFile=i,this.selectedIndex=o,this.$easycm(t,e)},rightMenuClick(t){var e,t=this.rightMenuList[t[0]].type;"CHECK"==t?this.onPhotoClick(this.selectedIndex):"TRASH"==t?this.selectedFile.selected?this.$bus.$emit("onTrashAllMsg"):this.$bus.$emit("onTrashMsg",this.photoList[this.selectedIndex].id):"DOWNLOAD"==t?this.selectedFile.selected?this.$bus.$emit("onDownloadSelectedListMsg"):1==(e=this.photoList[this.selectedIndex]).is_livephoto&&e.livephotoIndex&&e.livephotoIndex.videoIndex&&e.livephotoIndex.photoIndex?(this.downloadFile([e.livephotoIndex.videoIndex.rawUrl]),this.downloadFile([e.livephotoIndex.photoIndex.rawUrl])):this.downloadFile([e.rawUrl]):"ADD_TO_ALBUYM"==t?(this.selectedFile.selected||this.hoverSelect(this.selectedIndex),this.$bus.$emit("onAddToAlbumMsg")):"REMOVE_FROM_ALBUM"==t?(this.selectedFile.selected||this.hoverSelect(this.selectedIndex),this.$bus.$emit("onRemoveFromAlbumMsg")):"SET_FACE_POSTER"==t?this.setFacePosterApi(this.selectedIndex):"REMOVE_FROM_FACE"==t?this.removeFromFaceApi([this.photoList[this.selectedIndex]]):"OPEN_IN_SYSTEM"==t?this.openInSystem(this.selectedFile.path,this.selectedFile.filename):"SELECT_IN_SYSTEM"==t&&this.openInSystem(this.selectedFile.path,this.selectedFile.filename,null,"showItemInFolder")},removeFromFaceApi(o){var t,e=[];for(t of o)e.push({faceId:t.face_id,indexId:t.id});this.api.post("/api/photoApi/removeFromFace",{deleteList:JSON.stringify(e)}).then(t=>{if(!t.code)for(var e in this.showVsNotification(this.$t("common.changeSuccess")),o){var i=o[e];for(let t=this.photoList.length-1;0<=t;t--)if(this.photoList[t].id==i.id){this.photoList.splice(t,1);break}}}).catch(t=>{})},setFacePosterApi(t){this.api.post("/api/photoApi/setFacePoster",{photoIndexId:this.photoList[t].id,setFaceId:this.faceId,rawFaceId:this.photoList[t].face_id}).then(t=>{t.code||this.showVsNotification(this.$t("common.changeSuccess"))}).catch(t=>{})},setOrdinaryCover(t){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("album.setPhotoAsCover"),()=>{this.api.post("/api/ordinaryAlbumApi/setAlbumCover",{indexId:this.photoList[t].id,albumId:this.ordinaryAlbumId}).then(t=>{t.code||this.showVsNotification(this.$t("common.changeSuccess"))}).catch(t=>{})})},setPhotoSelected(t,e){this.photoList[t].selected=e,this.$forceUpdate()},clearList(){this.photoList=[],this.lastHasMore=!0,this.nextHasMore=!0,this.lastLoading=!1,this.nextLoading=!1},hoverSelect(t){this.$emit("onHoverSelected",t)},onTrashInSuc(){for(let t=this.photoList.length-1;0<=t;t--)1==this.photoList[t].selected&&this.photoList.splice(t,1);if(this.groupByDate)for(let t=this.photoList.length-1;0<t;t--)"DATE"==this.photoList[t].itemType&&(this.photoList.length<=1?this.photoList.splice(t,1):"DATE"==this.photoList[t-1].itemType&&this.photoList.splice(t-1,1))},clearSelected(){for(var t=0;t<this.photoList.length;t++)this.photoList[t].selected=!1;this.$forceUpdate()},onPhotoClick(t){this.$emit("onPhotoClick",t)},calculateImgHeight(){var t,e;this.$refs.photoWrapper&&(t=this.$refs.photoWrapper.getBoundingClientRect())&&(e=this.utils.calItemWidth(t,this.itemBaseWidth,this.photoMargin),this.photoWidth=e,this.photoHeight=this.photoWidth,this.dataColumns=parseFloat(t.width/this.itemBaseWidth).toFixed())},loadLastPage(){if(this.lastHasMore&&0<this.photoList.length){let t=this.photoList[0];"DATE"==t.itemType&&(t=this.photoList[1]),this.getPhotoByTime(t[this.sortField],"desc"==this.timeOrder?2:1)}},loadNextPage(){if(this.nextHasMore&&0<this.photoList.length){let t=this.photoList[this.photoList.length-1];"DATE"==t.itemType&&(t=this.photoList[this.photoList.length-2]),this.getPhotoByTime(t[this.sortField],"desc"==this.timeOrder?1:2)}},dealPhotoUrl(t){var e=o.a.getImgFullPath(t.id,!0,t.filename),i=o.a.getImgFullPath(t.id,!1,t.filename);return t.url=e,t.rawUrl=i,t.livephotoIndex&&t.livephotoIndex.photoIndex&&t.livephotoIndex.videoIndex&&(t.livephotoIndex.photoIndex.url=o.a.getImgFullPath(t.livephotoIndex.photoIndex.id,!0,t.livephotoIndex.photoIndex.filename),t.livephotoIndex.photoIndex.rawUrl=o.a.getImgFullPath(t.livephotoIndex.photoIndex.id,!1,t.livephotoIndex.photoIndex.filename),t.livephotoIndex.videoIndex.url=o.a.getImgFullPath(t.livephotoIndex.videoIndex.id,!0,t.livephotoIndex.videoIndex.filename),t.livephotoIndex.videoIndex.rawUrl=o.a.getImgFullPath(t.livephotoIndex.videoIndex.id,!1,t.livephotoIndex.videoIndex.filename),t.url=t.livephotoIndex.photoIndex.url,t.rawUrl=t.livephotoIndex.photoIndex.rawUrl,t.type=1),t.rawImageIndex&&(t.rawImageIndex.url=o.a.getImgFullPath(t.rawImageIndex.id,!0,t.rawImageIndex.filename),t.rawImageIndex.rawUrl=o.a.getImgFullPath(t.rawImageIndex.id,!1,t.rawImageIndex.filename)),t},getPhotoByDate(t,e){let i=t.original_time;1==e?i+=864e5:i-=864e5,this.getPhotoByTime(i,e)},addDateGroupItemToPhotoList(t){if(this.groupByDate){var e=[],i=t;for(let t=i.length-1;0<=t;t--)"DATE"==i[t].itemType&&i.splice(t,1);var o,s=[];for(o in i){var h,a=i[o];a.original_date&&!e.includes(a.original_date)&&(h={date:a.original_date,itemType:"DATE",weekDay:this.utils.getWeekdayString(this,a.original_date)},s.push(h),e.push(a.original_date)),s.push(a)}this.photoList=s}else this.photoList=t},getListRenderCount(i){if(this.groupByDate){let t=[],e=0;for(var o in i){o=i[o];o.original_date&&!t.includes(o.original_date)?(e+=2,t.push(o.original_date)):e+=1}return e}return i.length},getPhotoByTime(t,h,a){let r="desc"==this.timeOrder;if(this.sortType=1==h?"desc":"asc",this.lastLoading||this.nextLoading)this.lastLoading,this.nextLoading;else{h=parseInt(h),r?2==h?this.lastLoading=!0:this.nextLoading=!0:2==h?this.nextLoading=!0:this.lastLoading=!0;for(var e=[],i=0;i<this.photoList.length;i++)this.photoList[i][this.sortField]==t&&e.push(this.photoList[i].id);let s=this.dataColumns*this.pageRows;s<100&&(s=100);var o={hideLoading:!0,timestamp:t,timeType:h,count:s,excludeIds:e,fileType:parseInt(this.showFileType),sortField:this.sortField,sortType:this.sortType,trash:this.trash};if(this.geohash){let t=this.geohash.substr(0,5);"1"==this.showRangeType?t=this.geohash.substr(0,4):"2"==this.showRangeType?t=this.geohash.substr(0,3):"3"==this.showRangeType&&(t=this.geohash.substr(0,2)),o.geohash=t}this.albumId&&(o.albumId=this.albumId),this.libraryId&&(o.libraryId=this.libraryId),this.ordinaryAlbumId&&(o.ordinaryAlbumId=this.ordinaryAlbumId),this.aiClassId&&(o.aiClassId=parseInt(this.aiClassId)),this.faceId&&(o.faceId=this.faceId),this.searchStr&&(o.searchStr=this.searchStr),this.sourceFolderList&&(o.sourceFolderList=this.sourceFolderList),this.api.post("/api/photoApi/getPhotoByTime",o).then(i=>{for(let t=0;t<i.data.length;t++)i.data[t]=this.dealPhotoUrl(i.data[t]);if(r&&2==h||!r&&1==h){i.data.length<s&&(this.lastHasMore=!1),this.addDateGroupItemToPhotoList(i.data.reverse().concat(this.photoList));let e=this.getListRenderCount(i.data.reverse());this.$nextTick(()=>{var t=this.$refs.photoWrapper.childNodes[e+1];t&&(t=50<t.offsetTop?t.offsetTop-50:t.offsetTop,this.$refs.photoWrapper.scrollTop=t),document.getElementsByClassName("right-layout")}),this.$nextTick(()=>{if(0<i.data.length&&this.photoList.length>this.listMaxLength)for(var t=0;t<i.data.length;t++)this.photoList.pop();this.photoList.length})}else this.addDateGroupItemToPhotoList(this.photoList.concat(i.data)),i.data.length<s&&(this.nextHasMore=!1),this.photoList.length;r?2==h?this.lastLoading=!1:this.nextLoading=!1:2==h?this.nextLoading=!1:this.lastLoading=!1,this.$nextTick(()=>{this.calculateImgHeight(),this.$emit("onPhotoLoadOver",r&&2==h||!r&&1==h,i.data),a&&this.loadLastPage()});try{if(i.originalDateItemList&&0<i.originalDateItemList.length)for(var t of i.originalDateItemList)this.originalDateItemListLocation[t.date]=t.locationList;for(var e of i.data){var o;e.mode&&"undefined"!=e.mode&&((o=this.originalDateItemListMode[e.original_date])?o.includes(e.mode)||this.originalDateItemListMode[e.original_date].push(e.mode):this.originalDateItemListMode[e.original_date]=[e.mode])}i.imagePreviewType&&(localStorage.imagePreviewType=i.imagePreviewType),i.imagePreviewSize&&(localStorage.imagePreviewSize=i.imagePreviewSize),i.imagePreviewQuality&&(localStorage.imagePreviewQuality=i.imagePreviewQuality)}catch(t){}}).catch(t=>{r?2==h?this.lastLoading=!1:this.nextLoading=!1:2==h?this.nextLoading=!1:this.lastLoading=!1})}}}}),h=(i("2b27"),i("2877")),h=Object(h.a)(s,function(){var o=this,t=o.$createElement,s=o._self._c||t;return s("div",{ref:"photoWrapper",staticClass:"photo-wrapper",attrs:{id:"photo-wrapper"},on:{mouseleave:o.onMouseLeaveRoot}},[o.lastHasMore?s("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center",height:"60px","align-items":"center"}},[s("Spin")],1):o._e(),o._l(o.photoList,function(e,i){return s("div",{key:e.id,style:{width:"DATE"==e.itemType?"100%":"auto"},attrs:{id:"photoItem"+e.id}},["DATE"!=e.itemType?s("div",{staticClass:"photo-item",staticStyle:{cursor:"pointer"},style:{margin:o.photoMargin+"px",width:o.photoWidth+"px",height:o.photoHeight+"px"},on:{click:function(t){return o.onPhotoClick(i)},mouseenter:function(t){return o.mouseEnterImg(i)},mouseleave:function(t){return o.mouseLeaveImg(i)},contextmenu:function(t){return o.showRightMenu(t,o.$root,e,i)},touchstart:function(t){return o.touchstart(i)},touchend:o.touchend,mousedown:function(t){return o.onMouseDown(t,i)},mouseup:function(t){return o.onMouseUp(i)}}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.url,expression:"photo.url"}],staticClass:"photo-img",style:{height:o.photoHeight+"px","object-fit":o.showMode},attrs:{id:"photoImg"+e.id},on:{dragstart:function(t){t.preventDefault()}}}),2==e.type&&1!=e.is_livephoto?s("div",{staticClass:"icon-play-root"},[s("span",{staticClass:"nasIcons icon-play",staticStyle:{color:"white","font-size":"20px"}}),s("p",{staticClass:"icon-duration"},[o._v(o._s(o.utils.formatSecondsB(e.duration)))])]):o._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:e.hover&&!e.selected,expression:"photo.hover && !photo.selected"}],staticClass:"photo-hover-mask"},[o.ordinaryAlbumId?s("Icon",{staticClass:"photo-select-icon-setcover",attrs:{size:25,color:"#eee",type:"ios-disc"},on:{click:function(t){return t.stopPropagation(),o.setOrdinaryCover(i)}}}):o._e(),s("vs-tooltip",{staticClass:"photo-select-icon-hover",attrs:{disabled:o.isMobile},scopedSlots:o._u([{key:"tooltip",fn:function(){return[s("div",{staticStyle:{"word-break":"break-all"}},[o._v(o._s(o.$t("dragSelectAlert")))])]},proxy:!0}],null,!0)},[s("span",{staticClass:" nasIcons icon-radio-unchecked",on:{click:function(t){return t.stopPropagation(),o.hoverSelect(i)}}})])],1),e.selected?s("div",{staticClass:"photo-select-mask"},[s("span",{staticClass:"photo-select-icon-hover nasIcons icon-radio-checked"})]):o._e(),1==e.is_livephoto?s("div",{staticClass:"wrapper-livephoto flex-row"},[s("span",{staticClass:"nasIcons icon-livezhaopian",staticStyle:{"font-size":"12px",color:"#333333"}}),s("span",{staticStyle:{"font-size":"10px",color:"#333333"}},[o._v("LIVE")])]):1==e.is_raw?s("div",{staticClass:"wrapper-livephoto flex-row"},[s("span",{staticStyle:{"font-size":"10px",color:"#333333"}},[o._v(o._s(e.ext.replace(".","").toUpperCase()))])]):e.rawImageIndex&&e.raw_filename&&1!=o.trash?s("div",{staticClass:"wrapper-livephoto flex-row"},[s("span",{staticStyle:{"font-size":"10px",color:"#333333"}},[o._v(o._s(e.ext.replace(".","").toUpperCase())+"+"+o._s(e.rawImageIndex.ext.replace(".","").toUpperCase()))])]):o._e()]):"DATE"==e.itemType?s("div",[s("div",{staticClass:"group-date-title max-line-one",staticStyle:{width:"100%"}},[o._v(" "+o._s(e.date)+" "+o._s(e.weekDay)+" ")]),o.originalDateItemListLocation[e.date]&&0<o.originalDateItemListLocation[e.date].length?s("div",{staticClass:"group-date-location max-line-one",staticStyle:{width:"100%"}},o._l(o.originalDateItemListLocation[e.date],function(t){return t.name||t.cn_name?s("span",{staticStyle:{"margin-right":"8px"}},[t.name?s("span",[o._v(o._s(t.name))]):o._e(),t.name&&t.cn_name?s("span",[o._v("-")]):o._e(),t.cn_name?s("span",[o._v(o._s(t.cn_name))]):o._e()]):o._e()}),0):o._e(),o.originalDateItemListMode[e.date]&&0<o.originalDateItemListMode[e.date].length?s("div",{staticClass:"group-date-mode max-line-one",staticStyle:{width:"100%"}},[s("span",{staticStyle:{"margin-right":"10px"}},[o._v(o._s(o.$t("photo.camera")))]),o._l(o.originalDateItemListMode[e.date],function(t){return s("span",{staticStyle:{"margin-right":"8px"}},[o._v(" "+o._s(t)+" ")])})],2):o._e()]):o._e()])}),s("div",{staticStyle:{display:"flex","justify-content":"center",width:"100%","flex-direction":"column","align-items":"center"}},[o.nextHasMore&&0<o.photoList.length?s("Button",{staticStyle:{width:"250px","margin-top":"30px",height:"45px","border-radius":"20px"},attrs:{type:"default"},on:{click:function(t){return o.loadNextPage()}}},[o._v(o._s(o.$t("common.loadmore")))]):o._e(),o.nextLoading?s("Spin",{staticStyle:{"margin-top":"30px"},attrs:{size:"large"}}):o._e(),o.nextLoading||o.nextHasMore?o._e():s("span",{staticStyle:{"margin-top":"30px"}},[o._v(o._s(o.$t("common.noMore")))]),s("div",{staticStyle:{height:"50px"}})],1),o.isMobile?o._e():s("easy-cm",{attrs:{list:o.rightMenuList},on:{ecmcb:o.rightMenuClick}}),o.showToTopBtn?s("my-btn-icon",{staticClass:"to-top",attrs:{iIcon:"md-arrow-up"},on:{click:function(t){return o.$refs.photoWrapper.scrollTo({top:0,behavior:"smooth"})}}}):o._e(),s("vs-dialog",{attrs:{scroll:""},scopedSlots:o._u([{key:"header",fn:function(){return[s("h4",{staticStyle:{"font-size":"16px"}},[o._v(" "+o._s(o.$t("photo.changePeopleAlert"))+" ")])]},proxy:!0},{key:"footer",fn:function(){return[s("vs-button",{attrs:{block:""},on:{click:o.onSelectPeople}},[o._v(" "+o._s(o.$t("common.select"))+" ")])]},proxy:!0}]),model:{value:o.showSelectFace,callback:function(t){o.showSelectFace=t},expression:"showSelectFace"}},[s("photo-faces-select",{ref:"photoFaceSelect",attrs:{singleSelectMode:!0}})],1)],2)},[],!1,null,"0d3dedd0",null);e.a=h.exports}}]);