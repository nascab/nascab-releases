(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1b784910"],{"0ccb":function(t,e,o){function i(s){return function(t,e,o){var t=a(h(t)),e=n(e),i=t.length,o=void 0===o?" ":a(o);return e<=i||""===o?t:((i=l(o,c((e=e-i)/o.length))).length>e&&(i=d(i,0,e)),s?t+i:i+t)}}var s=o("e330"),n=o("50c4"),a=o("577e"),r=o("1148"),h=o("1d80"),l=s(r),d=s("".slice),c=Math.ceil;t.exports={start:i(!1),end:i(!0)}},2322:function(t,e,o){},"2f5b":function(t,e,o){o("a02a")},"3a62":function(t,e,o){o("e5e3")},"4ade":function(t,e,o){},"4d90":function(t,e,o){var i=o("23e7"),s=o("0ccb").start;i({target:"String",proto:!0,forced:o("9a0c")},{padStart:function(t){return s(this,t,1<arguments.length?arguments[1]:void 0)}})},"59fb":function(t,e,o){o("14d9"),o("e9c4"),o("b64b"),o("e25e");var i={props:{restoreFilter:{default:!1,type:Boolean},showSourceFilter:{default:!1,type:Boolean},albumId:{default:"",type:String},nearMode:{default:!1,type:Boolean},editMode:{default:!1,type:Boolean},showSearchBtn:{default:!0,type:Boolean},usePadding:{default:!1,type:Boolean}},computed:{filterConditionCount:function(){return this.selectedSourceFolder.length}},data:function(){return{timeOrder:"desc",showFilterDialog:!1,sourceFolderList:[],selectedSourceFolder:[],showAndroidPlayerSetting:!1,typeMenuOptionList:[{title:this.$t("photo.all"),id:"0"},{title:this.$t("photo.photo"),id:"1"},{title:this.$t("photo.video"),id:"2"},{title:"LIVE",id:"3"}],rangeMenuOptionList:[{title:this.$t("photo.5km"),id:"0"},{title:this.$t("photo.10km"),id:"1"},{title:this.$t("photo.80km"),id:"2"}],sliderMin:130,sliderMax:350,sliderValue:200,lastSliderValue:200,itemBaseWidth:200,itemWidth:200,itemMargin:5,searchStr:"",loadingPositionStr:!1,firstPhotoGeohash:"",showRangeType:"0",showMode:"cover",showFileType:"0"}},mounted:function(){var t=this,e=(this.albumId,localStorage.getItem("photo-settging-img-size")),e=(e&&(this.sliderValue=parseInt(e),this.$emit("onSizeChange",parseInt(e))),localStorage.getItem("photo-settging-show-mode")),e=(e&&this.showMode!=e&&(this.showMode=e,this.$emit("onChangeShowMode",this.showMode)),localStorage.getItem("photo-settging-time-order")),e=(e&&this.timeOrder!=e&&(this.timeOrder=e,this.$emit("onTimeOrderChange",this.timeOrder,!1)),localStorage.getItem("photo-settging-show-range"));e&&this.showRangeType!=e&&(this.showRangeType=e,this.$nextTick(function(){t.$refs.rangeSelector&&0<t.showRangeType&&t.showRangeType<=2&&t.$refs.rangeSelector.setSelectedIndex(t.showRangeType)})),this.getSourceFolder(),window.addEventListener("keydown",this.onKeyDown)},beforeDestroy:function(){window.removeEventListener("keydown",this.onKeyDown)},methods:{onKeyDown:function(t){var e;this.isShowingDialog()||("="==(t=t.key)?this.sliderValue<this.sliderMax&&(e=this.sliderValue+50):"-"==t?this.sliderValue>this.sliderMin&&(e=this.sliderValue-50):t&&"c"==t.toLowerCase()&&("contain"==this.showMode?this.onChangeShowMode("cover"):this.onChangeShowMode("contain")),e&&(this.sliderValue=e,this.onSizeChange(e)))},getSourceFolder:function(){var a=this;this.api.post("/api/sourceFolderApi/getPathByType",{type:"photo"}).then(function(t){if(!t.code){if(1==a.$store.state.currentUser.is_admin)if(t.data.length<1)a.showVsConfirmDialog(a.$t("common.confirm"),a.$t("photo.noSourceSetAlert"),function(){a.$emit("setViewType","photoSourceSet")},null,a.$t("photo.goToSet"));else if(!sessionStorage.PhotoSourcePathUnusableAlert)for(var e in t.data)if(0==t.data[e].exist){sessionStorage.PhotoSourcePathUnusableAlert=1,a.showVsConfirmDialog(a.$t("common.confirm"),a.$t("photo.sourcePathUnusable",{path:t.data[e].path}),function(){a.$emit("setViewType","photoSourceSet")},null,a.$t("photo.goToSet"));break}for(var o in t.data)a.sourceFolderList.push(t.data[o].path);if(a.restoreFilter)if(localStorage.cacheSelectedSourceFolderJSON)try{var i,s=JSON.parse(localStorage.cacheSelectedSourceFolderJSON);for(i in s)for(var n in a.sourceFolderList)s[i]==a.sourceFolderList[n]&&a.selectedSourceFolder.push(s[i]);0<a.selectedSourceFolder.length?a.onFilterFinish():a.loadFirstPage()}catch(t){a.loadFirstPage()}else a.loadFirstPage();else a.loadFirstPage()}}).catch(function(t){})},loadFirstPage:function(){this.$emit("onChooseRange",this.showRangeType)},onFilterFinish:function(){var t=0<this.selectedSourceFolder.length?JSON.stringify(this.selectedSourceFolder):"";this.$emit("onChooseSource",t),this.restoreFilter&&(t?localStorage.cacheSelectedSourceFolderJSON=t:window.localStorage.removeItem("cacheSelectedSourceFolderJSON"))},onSwitchTimeOrder:function(){this.timeOrder="desc"==this.timeOrder?"asc":"desc",localStorage.setItem("photo-settging-time-order",this.timeOrder),this.$emit("onTimeOrderChange",this.timeOrder,!0)},onSearch:function(t){this.searchStr=t,this.$emit("onSearch",this.searchStr)},onSearchClear:function(){this.$emit("onSearch","")},onChooseDataType:function(t){this.showFileType=t,this.$emit("onChooseDataType",t)},onChooseRange:function(t){this.showRangeType=t,localStorage.setItem("photo-settging-show-range",this.showRangeType),this.$emit("onChooseRange",t)},onSizeChange:function(t){this.lastSliderValue,this.lastSliderValue!=t&&(this.lastSliderValue=t,localStorage.setItem("photo-settging-img-size",t),this.$emit("onSizeChange",t))},onChangeShowMode:function(t){this.showMode=t,localStorage.setItem("photo-settging-show-mode",this.showMode),this.$emit("onChangeShowMode",this.showMode),this.showMode}}},o=(o("2f5b"),o("2877")),o=Object(o.a)(i,function(){var e=this,o=e._self._c;return o("div",{staticStyle:{height:"100%",width:"100%",position:"relative"}},[o("div",{staticClass:"layout-header-bar",class:{"nas-padding-left":e.usePadding,"nas-padding-right":e.usePadding}},[o("div",{staticClass:"header-right"},[o("div",{staticStyle:{display:"flex","align-items":"center"}},[o("Badge",{staticClass:"icon-showtype",attrs:{offset:[5,0],count:e.showSourceFilter?e.filterConditionCount:0}},[e.showSourceFilter?o("span",{staticClass:"nasIcons icon-filter icon-filt",on:{click:function(t){e.showFilterDialog=!0}}}):e._e()]),o("Tooltip",{attrs:{disabled:e.isMobile,content:"asc"==e.timeOrder?e.$t("common.asc"):e.$t("common.desc")}},[e.showSourceFilter?o("div",{on:{click:function(t){return e.onSwitchTimeOrder()}}},["asc"==e.timeOrder?o("span",{staticClass:"nasIcons icon-asc icon-showtype",staticStyle:{color:"#386DF2"}}):e._e(),"desc"==e.timeOrder?o("span",{staticClass:"nasIcons icon-desc icon-showtype",staticStyle:{color:"#386DF2"}}):e._e()]):e._e()]),o("my-menu-select",{attrs:{optionList:e.typeMenuOptionList},on:{onItemClick:e.onChooseDataType}}),e.nearMode?o("my-menu-select",{ref:"rangeSelector",staticStyle:{display:"inline-flex","margin-left":"10px"},attrs:{optionList:e.rangeMenuOptionList},on:{onItemClick:e.onChooseRange}}):e._e()],1),e.showSearchBtn?o("div",{staticClass:"search-root"},[o("my-search",{staticStyle:{"max-width":"250px"},attrs:{placeholder:e.$t("photo.searchPlaceHolder")},on:{onSearch:e.onSearch}})],1):e._e()])]),o("vs-dialog",{attrs:{scroll:""},scopedSlots:e._u([{key:"header",fn:function(){return[o("h4",{staticClass:"not-margin"},[e._v(" "+e._s(e.$t("movie.conditionFilter"))+" ")])]},proxy:!0}]),model:{value:e.showFilterDialog,callback:function(t){e.showFilterDialog=t},expression:"showFilterDialog"}},[o("div",[o("div",{staticClass:"nas-mobile-none slider-root"},[o("p",{staticStyle:{"text-align":"left","flex-shrink":"0","font-weight":"bold"}},[e._v(e._s(e.$t("imageSize"))+":")]),o("div",{staticStyle:{display:"flex","align-items":"center"}},[o("Slider",{staticClass:"zoom-slider",attrs:{"show-tip":"never",min:e.sliderMin,max:e.sliderMax,step:10},on:{"on-input":e.onSizeChange},model:{value:e.sliderValue,callback:function(t){e.sliderValue=t},expression:"sliderValue"}}),o("a",{on:{click:function(t){e.showVsAlertDialog(e.$t("quickKey"),e.$t("photoKeyAlert"))}}},[o("Icon",{staticStyle:{"font-weight":"bold",cursor:"pointer"},attrs:{type:"ios-help-circle-outline"}})],1)],1)]),o("Divider",{staticClass:"nas-mobile-none",staticStyle:{margin:"10px 0"}}),o("div",{staticStyle:{display:"flex","align-items":"center"}},[o("p",{staticStyle:{"text-align":"left","flex-shrink":"0","font-weight":"bold"}},[e._v(e._s(e.$t("file.showType"))+":")]),o("RadioGroup",{staticStyle:{"text-align":"left","margin-left":"10px"},on:{"on-change":e.onChangeShowMode},model:{value:e.showMode,callback:function(t){e.showMode=t},expression:"showMode"}},[o("Radio",{attrs:{label:"contain"}},[o("Icon",{attrs:{type:"md-photos"}}),o("span",[e._v(e._s(this.$t("photo.contain")))])],1),o("Radio",{attrs:{label:"cover"}},[o("Icon",{attrs:{type:"ios-apps"}}),o("span",[e._v(e._s(this.$t("photo.cover")))])],1)],1)],1),o("Divider",{staticStyle:{margin:"10px 0"}}),o("p",{staticStyle:{width:"100%","text-align":"left","margin-top":"15px"}},[e._v(e._s(e.$t("movie.selectSourceFolder")))]),o("CheckboxGroup",{on:{"on-change":e.onFilterFinish},model:{value:e.selectedSourceFolder,callback:function(t){e.selectedSourceFolder=t},expression:"selectedSourceFolder"}},e._l(e.sourceFolderList,function(t){return o("Checkbox",{staticClass:"source-item max-line-one",attrs:{label:t,border:""}},[e._v(e._s(""+t))])}),1)],1)])],1)},[],!1,null,"113f49dc",null);e.a=o.exports},"6a35":function(t,e,o){o("4ade")},"9a0c":function(t,e,o){o=o("b5db");t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(o)},"9a84":function(t,e,o){o("2322")},a02a:function(t,e,o){},cd79:function(t,e,o){o.r(e);var u=o("b85c"),i=(o("99af"),o("14d9"),o("d3b7"),o("25f0"),o("4d90"),o("9453")),c=o("2909");o("4de4"),o("d81d"),o("4e82"),o("e9f5"),o("910d"),o("ab43"),o("e25e"),o("ac1f"),o("5319");var s={name:"photo-timeline",props:{geohash:{default:"",type:String}},data:function(){return{mouseInTimeLine:!1,showTimeLine:!1,showTimeOut:null,scrolling:!1,rootWrapper:null,cursorTop:0,cursorDateStr:"",cursorDateObj:"",dateList:[],itemHeight:1,tmHeight:0,isUsingTimeLine:!1,photoTotalCount:0,movePointerIndex:0,hadMoved:!1}},methods:{barTouchStart:function(t){this.cancelTimeout(),this.movePointerIndex=0,this.hadMoved=!1,this.isUsingTimeLine=!0},barTouchMove:function(t){this.isUsingTimeLine=!0,this.rootWrapper||(this.rootWrapper=this.$refs.timeLineRoot.getBoundingClientRect());t=t.changedTouches[0].pageY-this.rootWrapper.top;this.cursorTop=t;for(var e=0,o=0,i=0;i<this.dateList.length;i++)if(e+=this.dateList[i].height,this.cursorTop<=e){o=0<i?i-1:0;break}this.movePointerIndex=o,this.cursorDateStr=this.dateList[o].yearMonth.replace("-","/"),this.cursorDateObj=this.dateList[o],this.hadMoved=!0},barTouchEnd:function(t){this.isUsingTimeLine=!1,this.hadMoved&&(this.setTimeoutInvisiable(),this.$emit("onTimeChoose",this.dateList[this.movePointerIndex].original_time))},cancelTimeout:function(){this.showTimeOut&&clearTimeout(this.showTimeOut)},setTimeoutInvisiable:function(){var t=this;this.cancelTimeout(),this.showTimeOut=setTimeout(function(){t.isUsingTimeLine||!t.isMobile&&t.mouseInTimeLine||(t.showTimeLine=!1,t.scrolling=!1)},1500)},onScroll:function(){this.scrolling=!0,this.showTimeLine=!0,this.isUsingTimeLine=!1,this.setTimeoutInvisiable()},mouseMove:function(t){this.$refs.timeLineRoot&&(this.isUsingTimeLine=!0,this.rootWrapper=this.$refs.timeLineRoot.getBoundingClientRect(),this.cursorTop=t.pageY-this.rootWrapper.top)},mouseEnter:function(t){this.mouseInTimeLine=!0,this.showTimeLine=!0,this.isUsingTimeLine=!0},itemMouseEnter:function(t){this.cursorDateStr=t.yearMonth.replace("-","/"),this.cursorDateObj=t},mouseLeave:function(t){var e=this;this.mouseInTimeLine=!1,setTimeout(function(){e.mouseInTimeLine||e.scrolling||(e.showTimeLine=!1)},1e3),this.isUsingTimeLine=!1},onTimeClick:function(t){this.hadMoved=!1,this.$emit("onTimeChoose",this.dateList[t].original_time)},onWindowResize:function(){this.calItemHeight()},showSelectedTime:function(t){var e,o=0,i=0;for(e in this.dateList)if(i+=this.dateList[e].count,t>=this.dateList[e].original_time){o=e;break}this.cursorTop=i/this.photoTotalCount*this.tmHeight,this.cursorDateStr=this.dateList[o].yearMonth.replace("-","/"),this.cursorDateObj=this.dateList[o]},calItemHeight:function(){var e=this;this.photoTotalCount<1||this.$nextTick(function(){e.rootWrapper=e.$refs.timeLineRoot.getBoundingClientRect(),e.tmHeight=e.rootWrapper.height-60,e.itemHeight=e.tmHeight/e.photoTotalCount;for(var t=0;t<e.dateList.length;t++)e.dateList[t].height=e.dateList[t].count*e.itemHeight})},getTimeLine:function(t,e,o,i,s,n,a,r,h,l){var d=this,t={type:parseInt(t)};e&&(t.geohash=e),o&&(t.albumId=o),i&&(t.ordinaryAlbumId=i),s&&(t.searchStr=s),n&&(t.aiClassId=parseInt(n)),a&&(t.faceId=a),r&&(t.sourceFolderList=r),h&&(t.libraryId=h),l&&(t.timeOrder=l),this.api.post("/api/photoApi/getTimeLineDateList",t).then(function(t){var e,o;t.code||(e=function(t,e){var o=t.map(function(t){return t.count}),i=Object(c.a)(o).sort(function(t,e){return t-e})[Math.floor(t.length*e)-1];return t.filter(function(t){return t.count>=i})},(o=t.data).length,2e3<o.length?o=e(o,.5):1500<o.length?o=e(o,.3):1e3<o.length&&(o=e(o,.2)),o.length,d.dateList=o,d.$emit("onTimeLineGet",t.data),d.initDate())}).catch(function(t){})},initDate:function(){if(!(this.dateList.length<1)){for(var t=this.photoTotalCount=0;t<this.dateList.length;t++){var e=new Date(this.dateList[t].original_time),e=(this.dateList[t].dateObj=e,this.dateList[t].year=e.getFullYear(),e.getMonth()+1);this.dateList[t].yearMonth=this.dateList[t].year+"-"+(e<10?"0"+e:e)}for(var o=0,i=0;i<this.dateList.length;i++)this.photoTotalCount+=this.dateList[i].count,o+=this.dateList[i].count,0<i&&this.dateList[i].year!=this.dateList[i-1].year&&(this.dateList[i-1].showYear=!0,this.dateList[i-1].yearPhotoCount=o,o=0),i==this.dateList.length-1&&(this.dateList[i].showYear=!0,this.dateList[i].yearPhotoCount=o,o=0);this.calItemHeight()}}},mounted:function(){}},n=(o("9a84"),o("2877")),s=Object(n.a)(s,function(){var i=this,t=i._self._c;return t("div",{ref:"timeLineRoot",staticClass:"timeline-root",on:{mouseenter:i.mouseEnter,mouseleave:i.mouseLeave,mousemove:i.mouseMove,touchmove:function(t){return t.preventDefault(),i.barTouchMove.apply(null,arguments)},touchstart:i.barTouchStart,touchend:i.barTouchEnd}},[i.showTimeLine?t("div",{ref:"dateList",staticClass:"date-list"},i._l(i.dateList,function(e,o){return t("div",{staticClass:"item",style:{height:e.height+"px"},on:{click:function(t){return i.onTimeClick(o)},mouseenter:function(t){return i.itemMouseEnter(e)}}},[e.showYear&&(30<e.yearPhotoCount*i.itemHeight||o==i.dateList.length-1)?t("div",{staticClass:"year-text"},[t("p",[i._v(i._s(e.year))])]):i._e(),10<e.height&&!e.showYear?t("div",{staticClass:"ring-wrapper"},[t("div",{staticClass:"ring"})]):i._e()])}),0):i._e(),i.showTimeLine?t("div",{staticClass:"cursor-root",style:{top:i.cursorTop+"px"}},[t("div",{staticClass:"cursor-line"}),t("p",{staticClass:"cursor-text"},[i._v(" "+i._s(i.cursorDateStr)+" ")])]):i._e(),i.isUsingTimeLine&&i.showTimeLine?t("div",{staticClass:"center-root"},[t("div",{staticClass:"center-root-content"},[i._v(i._s(i.cursorDateObj.original_date))])]):i._e()])},[],!1,null,"37b14c16",null).exports,a=o("d3ac"),r=o("5d55"),h=o("59fb"),l=o("db96"),m=o("2cc5"),i={props:{hasSider:{default:!1,type:Boolean},nearMode:!1,geohash:{default:"",type:String},showSearchBtn:{default:!0,type:Boolean},showAddToAlbum:{default:!0,type:Boolean},showRemoveFromAlbum:{default:!1,type:Boolean},ordinaryAlbumId:{default:"",type:String},albumId:{default:"",type:String},libraryId:{default:"",type:String},aiClassId:{default:"",type:String},faceId:{default:"",type:String}},components:{photoBottomSelect:i.a,photoTimeline:s,photoDetail:a.default,videoDetail:r.default,photoOperationHeader:h.a,photoListContent:l.a},data:function(){return{sourceFolderList:"",searchStr:"",showRangeType:"0",showVideoDetail:!1,scrollTop:0,timeLine:[],showPhotoDetail:!1,editMode:!1,showMode:"cover",showFileType:"0",timeOrder:"desc"}},created:function(){window.addEventListener("scroll",this.onPageScroll,!0),window.addEventListener("resize",this.onWindowResize)},beforeDestroy:function(){window.removeEventListener("scroll",this.onPageScroll),window.removeEventListener("resize",this.onWindowResize)},methods:{setViewType:function(t){this.$emit("setViewType",t)},galleryLoadMorePre:function(){this.$refs.photoContent&&this.$refs.photoContent.loadLastPage()},galleryLoadMoreNext:function(){this.$refs.photoContent&&this.$refs.photoContent.loadNextPage()},onChooseRange:function(t){var e=this;this.showRangeType=t,this.$nextTick(function(){e.$refs.timeline&&e.$refs.timeline.getTimeLine(e.$refs.photoHeader?e.$refs.photoHeader.showFileType:"0",e.getGeoParam(),e.albumId,e.ordinaryAlbumId,"",e.aiClassId,e.faceId,e.sourceFolderList,e.libraryId,e.timeOrder)})},onTimeLineGet:function(t){this.timeLine=t,this.loadFirstPage()},loadFirstPage:function(){var t;this.$refs.photoContent.clearList(),this.$refs.photoContent.lastHasMore=!1,0<this.timeLine.length&&(t="desc"==this.timeOrder?1:2,this.$refs.photoContent.getPhotoByDate(this.timeLine[0],t))},onWindowResize:function(t){var e=this;this.$nextTick(function(){e.$refs.photoContent.calculateImgHeight(),e.$refs.timeline.onWindowResize(document.documentElement.clientHeight)})},onPageScroll:function(t){var e,o;this.showPhotoDetail||this.showVideoDetail||"photo-wrapper"!=t.target.id||(this.$refs.photoContent&&this.$refs.photoContent.cancelTouchEvent(),e=o=null,t.srcElement.scrollingElement?(o=t.srcElement.scrollingElement.scrollTop,e=t.srcElement.scrollingElement.scrollHeight):t.srcElement?(o=t.srcElement.scrollTop,e=t.srcElement.scrollHeight):t.target&&(o=t.target.scrollTop,e=t.target.scrollHeight),this.scrollTop=o,o=document.documentElement.clientHeight,!e&&t.srcElement.scrollingElement&&(e=t.srcElement.scrollingElement.scrollHeight),this.scrollTop>o?this.$refs.photoContent&&this.$refs.photoContent.setShowTopBtn(!0):this.$refs.photoContent&&this.$refs.photoContent.setShowTopBtn(!1),0==this.scrollTop&&this.$refs.photoContent&&this.$refs.photoContent.loadLastPage(),this.scrollTop+o>=e-5&&this.$refs.photoContent&&this.$refs.photoContent.loadNextPage(),this.$refs.timeline&&this.$refs.timeline.onScroll())},onUnSelect:function(){this.clearSelected()},onTimeOrderChange:function(t,e){this.timeOrder=t,e&&(this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,null,this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder),this.clearSelected())},onChooseSource:function(t){this.sourceFolderList=t,this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,null,this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder),this.clearSelected()},onSearch:function(t){this.searchStr=t,this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,t,this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder),this.clearSelected()},onChooseDataType:function(t){this.showFileType=t,this.$refs.timeline.getTimeLine(this.$refs.photoHeader?this.$refs.photoHeader.showFileType:"0",this.getGeoParam(),this.albumId,this.ordinaryAlbumId,null,this.aiClassId,this.faceId,this.sourceFolderList,this.libraryId,this.timeOrder),this.clearSelected()},getGeoParam:function(){var t;return this.geohash?(t=this.geohash.substr(0,5),"1"==this.showRangeType?t=this.geohash.substr(0,4):"2"==this.showRangeType?t=this.geohash.substr(0,3):"3"==this.showRangeType&&(t=this.geohash.substr(0,2)),t):null},setImgSize:function(t){this.$refs.photoContent.itemBaseWidth=t,this.$refs.photoContent.calculateImgHeight()},onTimeChoose:function(t){var e,o;this.$refs.photoContent.clearList(),"desc"==this.timeOrder?this.$refs.photoContent.getPhotoByTime(t,1,!0):(e=(t=new Date(t)).getFullYear(),o=(t.getMonth()+1).toString().padStart(2,"0"),t=t.getDate().toString().padStart(2,"0"),e="".concat(e,"-").concat(o,"-").concat(t),o=new Date(e+"T00:00:00").getTime(),this.$refs.photoContent.getPhotoByTime(o,2,!0))},onChangeShowMode:function(t){this.showMode=t,this.$refs.photoContent.calculateImgHeight()},switchEditMode:function(){this.editMode=!this.editMode,this.editMode||this.clearSelected()},onHoverSelected:function(t){this.editMode=!0,this.onPhotoClick(t)},onPhotoLoadOver:function(t,e){var o=this;setTimeout(function(){o.$refs.photoContent.calculateImgHeight()},300),this.showPhotoDetail&&this.$refs.photoDetail&&this.$refs.photoDetail.updateImageList(t,e)},onTrashInSuc:function(){this.$refs.photoContent.onTrashInSuc()},clearSelected:function(){this.$refs.photoContent.clearSelected(),this.$refs.selectView&&this.$refs.selectView.clearSelected(),this.editMode=!1},onPhotoClick:function(t){var e=this;if(this.editMode){var o=this.$refs.photoContent.photoList,i=o[t];i.selected?(this.$refs.photoContent.setPhotoSelected(t,!1),this.$refs.selectView.removeSelected(i.id),this.$refs.selectView.selectedList.length<1&&(this.editMode=!1)):(this.$refs.photoContent.setPhotoSelected(t,!0),this.$refs.selectView.addSelected(o[t]))}else{var s=[];if(this.$refs.photoContent.groupByDate){var n,i=this.$refs.photoContent.photoList,a=i[t],r=Object(u.a)(i);try{for(r.s();!(n=r.n()).done;){var h=n.value;"DATE"!=h.itemType&&(s.push(h),h.id==a.id)&&(t=s.length-1)}}catch(t){r.e(t)}finally{r.f()}}else s=this.$refs.photoContent.photoList;if(1==s[t].type)this.showPhotoDetail=!0,this.$nextTick(function(){e.$refs.photoDetail.showImg(s,t)});else if(2==s[t].type)if("1"==localStorage.getItem("rawPlayer")||this.isIosSupportRawPlayer()){var l,d,c=[],p=0;for(l in s)2==s[l].type&&c.push(s[l]);for(d in c)if(c[d].id==s[t].id){p=d;break}m.a.playVideo({playIndex:p,playList:c,token:this.$store.state.token,fromFileBrower:!1,serverType:"photo"})}else this.showVideoDetail=!0,this.addModalToList(this.$refs.refModalVideoDetail),this.$nextTick(function(){e.$refs.videoPlayer.playVideo(s,t)})}}}},s=(o("3a62"),Object(n.a)(i,function(){var e=this,t=e._self._c;return t("div",{ref:"photoListRoot",staticClass:"photo-list-root"},[t("div",{staticClass:"photo-header"},[t("photo-operation-header",{ref:"photoHeader",attrs:{usePadding:!0,showSourceFilter:!0,restoreFilter:!(e.nearMode||e.ordinaryAlbumId||e.albumId||e.faceId||e.aiClassId),editMode:e.editMode,nearMode:e.nearMode},on:{showSearchBtn:e.showSearchBtn,onChooseDataType:e.onChooseDataType,setViewType:e.setViewType,onChangeShowMode:e.onChangeShowMode,onSizeChange:e.setImgSize,onChooseRange:e.onChooseRange,onSearch:e.onSearch,albumId:e.albumId,onSwitchEditMode:e.switchEditMode,onChooseSource:e.onChooseSource,onTimeOrderChange:e.onTimeOrderChange}})],1),t("div",{staticClass:"photo-content"},[t("photo-list-content",{ref:"photoContent",attrs:{timeOrder:e.timeOrder,showMode:e.showMode,geohash:e.geohash,albumId:e.albumId,libraryId:e.libraryId,aiClassId:e.aiClassId,ordinaryAlbumId:e.ordinaryAlbumId,showRangeType:e.showRangeType,showFileType:e.showFileType,searchStr:e.searchStr,faceId:e.faceId,sourceFolderList:e.sourceFolderList},on:{onHoverSelected:e.onHoverSelected,onPhotoClick:e.onPhotoClick,onUnSelect:e.onUnSelect,onPhotoLoadOver:e.onPhotoLoadOver}}),t("photo-timeline",{directives:[{name:"show",rawName:"v-show",value:0<e.timeLine.length,expression:"timeLine.length > 0"}],ref:"timeline",staticClass:"timeline-wrapper",attrs:{geohash:e.geohash,albumId:e.albumId},on:{onTimeChoose:e.onTimeChoose,onTimeLineGet:e.onTimeLineGet}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.editMode,expression:"editMode"}],staticClass:"bottom-select-root"},[t("photo-bottom-select",{ref:"selectView",attrs:{ordinaryAlbumId:e.ordinaryAlbumId,showRemoveFromAlbum:e.showRemoveFromAlbum,showAddToAlbum:e.showAddToAlbum,faceId:e.faceId,editMode:e.editMode},on:{onRemoveFromAlbum:e.onTrashInSuc,onUnSelect:e.onUnSelect,onTrashInSuc:function(t){return e.onTrashInSuc()}}})],1),e.showPhotoDetail?t("photo-detail",{ref:"photoDetail",attrs:{enableRemove:!0},on:{onClose:function(t){e.showPhotoDetail=!1},galleryLoadMorePre:e.galleryLoadMorePre,galleryLoadMoreNext:e.galleryLoadMoreNext}}):e._e(),t("Modal",{ref:"refModalVideoDetail",attrs:{fullscreen:"","footer-hide":"",closable:!1},model:{value:e.showVideoDetail,callback:function(t){e.showVideoDetail=t},expression:"showVideoDetail"}},[e.showVideoDetail?t("video-detail",{ref:"videoPlayer",attrs:{propsServerType:"photo"},on:{onClose:function(t){return e.historyBack()}}}):e._e()],1)],1)},[],!1,null,"7c6775f6",null));e.default=s.exports},db96:function(t,e,o){o("b0c0"),o("ac1f"),o("5319");var g=o("b85c"),i=(o("99af"),o("caad"),o("14d9"),o("a434"),o("e9c4"),o("a9e3"),o("b680"),o("d3b7"),o("acd8"),o("e25e"),o("2532"),o("3ca3"),o("ddb0"),o("be3b")),s=(o("d930"),{components:{photoFacesSelect:function(){return o.e("chunk-596d6bfa").then(o.bind(null,"1498"))}},props:{pageRows:{default:10,type:Number},geohash:{default:"",type:String},ordinaryAlbumId:{default:"",type:String},aiClassId:{default:"",type:String},faceId:{default:"",type:String},albumId:{default:"",type:String},libraryId:{default:"",type:String},showMode:{default:"cover",type:String},showFileType:{default:"0",type:String},showRangeType:{default:"0",type:String},trash:{default:0,type:Number},sortField:{default:"original_time",type:String},marginRight:{default:"0",type:String},searchStr:{default:"",type:String},sourceFolderList:{default:"",type:String},timeOrder:{default:"desc",type:String}},data:function(){return{groupByDate:!0,originalDateItemListLocation:{},originalDateItemListMode:{},isInDragSelectMode:!1,dragStartIndex:0,dragEndIndex:0,dragSelectMode:!0,showSelectFace:!1,showToTopBtn:!1,rightMenuList:[],listMaxLength:500,sortType:"desc",scrollBarWidth:0,token:this.getToken(),itemBaseWidth:200,photoWidth:200,photoHeight:0,photoMargin:5,photoList:[],lastHasMore:!1,nextHasMore:!0,lastLoading:!1,nextLoading:!1,baseUrl:i.a.baseUrl,dataColumns:10,selectedIndex:null,selectedFile:null,switchPeopleIndexList:[]}},mounted:function(){var n=this;this.isMobile&&(this.itemBaseWidth=180),"original_time"!=this.sortField&&(this.groupByDate=!1),this.$bus.$on("removeIndexById",function(t){if(n.photoList&&0<n.photoList.length)for(var e in n.photoList)n.photoList[e].id==t&&n.photoList.splice(e,1)}),this.$bus.$on("onIndexUpdate",function(t){for(var e in n.photoList)n.photoList[e].id==t.id&&(n.photoList[e]=t,n.dealPhotoUrl(n.photoList[e]))}),this.$bus.$on("onRemoveFromFace",function(s){n.showVsConfirmDialog(n.$t("common.confirm"),n.$t("photo.removeFromAlbum")+"?",function(){var t,e=[],o=Object(g.a)(n.photoList);try{for(o.s();!(t=o.n()).done;){var i=t.value;s.includes(i.id)&&e.push(i)}}catch(t){o.e(t)}finally{o.f()}n.removeFromFaceApi(e)})}),this.$bus.$on("onSwitchToOtherPeople",function(t){var e,o=[],i=Object(g.a)(n.photoList);try{for(i.s();!(e=i.n()).done;){var s=e.value;t.includes(s.id)&&o.push(s)}}catch(t){i.e(t)}finally{i.f()}n.switchPeopleIndexList=o,n.showSelectFace=!0})},beforeDestroy:function(){this.$bus.$off("removeIndexById"),this.$bus.$off("onIndexUpdate"),this.$bus.$off("onRemoveFromFace")},methods:{initRightMenu:function(t){this.rightMenuList=[],t.selected||this.rightMenuList.push({text:this.$t("file.check"),type:"CHECK"}),this.rightMenuList.push({text:this.$t("common.download"),type:"DOWNLOAD"}),this.ordinaryAlbumId?this.rightMenuList.push({text:this.$t("photo.removeFromAlbum"),type:"REMOVE_FROM_ALBUM"}):this.rightMenuList.push({text:this.$t("photo.addToAlbum"),type:"ADD_TO_ALBUYM"}),this.faceId&&(this.rightMenuList.push({text:this.$t("photo.setFacePoster"),type:"SET_FACE_POSTER"}),this.rightMenuList.push({text:this.$t("photo.removeFromFace"),type:"REMOVE_FROM_FACE"}),this.$forceUpdate()),1!=this.trash&&this.rightMenuList.push({text:this.$t("photo.putInTrash"),type:"TRASH"}),!t.selected&&this.showOpenInSystem&&(this.rightMenuList.push({text:this.$t("openInSystem"),type:"OPEN_IN_SYSTEM"}),this.rightMenuList.push({text:this.$t("selectedInSystem"),type:"SELECT_IN_SYSTEM"}))},onMouseDown:function(t,e){t&&1==t.buttons&&(this.isInDragSelectMode=!0,this.dragSelectMode=!this.photoList[e].selected,this.dragStartIndex=e)},onMouseUp:function(t){this.isInDragSelectMode=!1},onMouseLeaveRoot:function(){this.isInDragSelectMode=!1},mouseEnterImg:function(t){this.isInDragSelectMode?(this.dragEndIndex=t,this.setDragRange()):this.isMobile||(this.photoList[t].hover=!0,this.$forceUpdate())},mouseLeaveImg:function(t){this.isMobile||(this.photoList[t].hover=!1)},setDragRange:function(){for(var t=this.dragStartIndex>this.dragEndIndex?this.dragEndIndex:this.dragStartIndex,e=this.dragStartIndex>this.dragEndIndex?this.dragStartIndex:this.dragEndIndex,o=t;o<=e;o++)this.dragSelectMode?this.photoList[o].selected||this.hoverSelect(o):this.photoList[o].selected&&this.hoverSelect(o)},onSelectPeople:function(){var s=this;if(this.$refs.photoFaceSelect){var t=this.$refs.photoFaceSelect.getSelectedFaceId();if(t){var e,o=[],i=Object(g.a)(this.switchPeopleIndexList);try{for(i.s();!(e=i.n()).done;){var n=e.value;o.push({photo_index_id:n.id,face_id:n.face_id})}}catch(t){i.e(t)}finally{i.f()}t={targetFaceId:t,rawFaceIndexIdList:JSON.stringify(o)};this.api.post("/api/photoApi/switchFaceId",t).then(function(t){if(!t.code){if(s.showVsNotification(s.$t("common.changeSuccess")),t.sucIdList)for(var e in t.sucIdList)for(var o=t.sucIdList[e],i=s.photoList.length-1;0<=i;i--)if(s.photoList[i].id==o){s.photoList[i].id,s.photoList.splice(i,1);break}s.showSelectFace=!1}}).catch(function(t){})}}},touchstart:function(t){var e=this;clearTimeout(this.longPressTimeout),this.longPressTimeout=setTimeout(function(){e.hoverSelect(t)},800)},touchend:function(){clearTimeout(this.longPressTimeout)},cancelTouchEvent:function(){this.longPressTimeout&&(clearTimeout(this.longPressTimeout),this.longPressTimeout=null)},setShowTopBtn:function(t){this.showToTopBtn=t},showRightMenu:function(t,e,o,i){o.selected||this.$emit("onUnSelect"),this.initRightMenu(o),this.selectedFile=o,this.selectedIndex=i,this.$easycm(t,e)},rightMenuClick:function(t){var e,t=this.rightMenuList[t[0]].type;"CHECK"==t?this.onPhotoClick(this.selectedIndex):"TRASH"==t?this.selectedFile.selected?this.$bus.$emit("onTrashAllMsg"):this.$bus.$emit("onTrashMsg",this.photoList[this.selectedIndex].id):"DOWNLOAD"==t?this.selectedFile.selected?this.$bus.$emit("onDownloadSelectedListMsg"):1==(e=this.photoList[this.selectedIndex]).is_livephoto&&e.livephotoIndex&&e.livephotoIndex.videoIndex&&e.livephotoIndex.photoIndex?(this.downloadFile([e.livephotoIndex.videoIndex.rawUrl]),this.downloadFile([e.livephotoIndex.photoIndex.rawUrl])):this.downloadFile([e.rawUrl]):"ADD_TO_ALBUYM"==t?(this.selectedFile.selected||this.hoverSelect(this.selectedIndex),this.$bus.$emit("onAddToAlbumMsg")):"REMOVE_FROM_ALBUM"==t?(this.selectedFile.selected||this.hoverSelect(this.selectedIndex),this.$bus.$emit("onRemoveFromAlbumMsg")):"SET_FACE_POSTER"==t?this.setFacePosterApi(this.selectedIndex):"REMOVE_FROM_FACE"==t?this.removeFromFaceApi([this.photoList[this.selectedIndex]]):"OPEN_IN_SYSTEM"==t?this.openInSystem(this.selectedFile.path,this.selectedFile.filename):"SELECT_IN_SYSTEM"==t&&this.openInSystem(this.selectedFile.path,this.selectedFile.filename,null,"showItemInFolder")},removeFromFaceApi:function(s){var t,n=this,e=[],o=Object(g.a)(s);try{for(o.s();!(t=o.n()).done;){var i=t.value;e.push({faceId:i.face_id,indexId:i.id})}}catch(t){o.e(t)}finally{o.f()}this.api.post("/api/photoApi/removeFromFace",{deleteList:JSON.stringify(e)}).then(function(t){if(!t.code)for(var e in n.showVsNotification(n.$t("common.changeSuccess")),s)for(var o=s[e],i=n.photoList.length-1;0<=i;i--)if(n.photoList[i].id==o.id){n.photoList.splice(i,1);break}}).catch(function(t){})},setFacePosterApi:function(t){var e=this;this.api.post("/api/photoApi/setFacePoster",{photoIndexId:this.photoList[t].id,setFaceId:this.faceId,rawFaceId:this.photoList[t].face_id}).then(function(t){t.code||e.showVsNotification(e.$t("common.changeSuccess"))}).catch(function(t){})},setOrdinaryCover:function(t){var e=this;this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("album.setPhotoAsCover"),function(){e.api.post("/api/ordinaryAlbumApi/setAlbumCover",{indexId:e.photoList[t].id,albumId:e.ordinaryAlbumId}).then(function(t){t.code||e.showVsNotification(e.$t("common.changeSuccess"))}).catch(function(t){})})},setPhotoSelected:function(t,e){this.photoList[t].selected=e,this.$forceUpdate()},clearList:function(){this.photoList=[],this.lastHasMore=!0,this.nextHasMore=!0,this.lastLoading=!1,this.nextLoading=!1},hoverSelect:function(t){this.$emit("onHoverSelected",t)},onTrashInSuc:function(){for(var t=this.photoList.length-1;0<=t;t--)1==this.photoList[t].selected&&this.photoList.splice(t,1);if(this.groupByDate)for(var e=this.photoList.length-1;0<e;e--)"DATE"==this.photoList[e].itemType&&(this.photoList.length<=1?this.photoList.splice(e,1):"DATE"==this.photoList[e-1].itemType&&this.photoList.splice(e-1,1))},clearSelected:function(){for(var t=0;t<this.photoList.length;t++)this.photoList[t].selected=!1;this.$forceUpdate()},onPhotoClick:function(t){this.$emit("onPhotoClick",t)},calculateImgHeight:function(){var t,e;this.$refs.photoWrapper&&(t=this.$refs.photoWrapper.getBoundingClientRect())&&(e=this.utils.calItemWidth(t,this.itemBaseWidth,this.photoMargin),this.photoWidth=e,this.photoHeight=this.photoWidth,this.dataColumns=parseFloat(t.width/this.itemBaseWidth).toFixed())},loadLastPage:function(){var t;this.lastHasMore&&0<this.photoList.length&&("DATE"==(t=this.photoList[0]).itemType&&(t=this.photoList[1]),this.getPhotoByTime(t[this.sortField],"desc"==this.timeOrder?2:1))},loadNextPage:function(){var t;this.nextHasMore&&0<this.photoList.length&&("DATE"==(t=this.photoList[this.photoList.length-1]).itemType&&(t=this.photoList[this.photoList.length-2]),this.getPhotoByTime(t[this.sortField],"desc"==this.timeOrder?1:2))},dealPhotoUrl:function(t){var e=i.a.getImgFullPath(t.id,!0,t.filename),o=i.a.getImgFullPath(t.id,!1,t.filename);return t.url=e,t.rawUrl=o,t.livephotoIndex&&t.livephotoIndex.photoIndex&&t.livephotoIndex.videoIndex&&(t.livephotoIndex.photoIndex.url=i.a.getImgFullPath(t.livephotoIndex.photoIndex.id,!0,t.livephotoIndex.photoIndex.filename),t.livephotoIndex.photoIndex.rawUrl=i.a.getImgFullPath(t.livephotoIndex.photoIndex.id,!1,t.livephotoIndex.photoIndex.filename),t.livephotoIndex.videoIndex.url=i.a.getImgFullPath(t.livephotoIndex.videoIndex.id,!0,t.livephotoIndex.videoIndex.filename),t.livephotoIndex.videoIndex.rawUrl=i.a.getImgFullPath(t.livephotoIndex.videoIndex.id,!1,t.livephotoIndex.videoIndex.filename),t.url=t.livephotoIndex.photoIndex.url,t.rawUrl=t.livephotoIndex.photoIndex.rawUrl,t.type=1),t.rawImageIndex&&(t.rawImageIndex.url=i.a.getImgFullPath(t.rawImageIndex.id,!0,t.rawImageIndex.filename),t.rawImageIndex.rawUrl=i.a.getImgFullPath(t.rawImageIndex.id,!1,t.rawImageIndex.filename)),t},getPhotoByDate:function(t,e){t=t.original_time;1==e?t+=864e5:t-=864e5,this.getPhotoByTime(t,e)},addDateGroupItemToPhotoList:function(t){if(this.groupByDate){for(var e=[],o=t,i=o.length-1;0<=i;i--)"DATE"==o[i].itemType&&o.splice(i,1);var s,n=[];for(s in o){var a,r=o[s];r.original_date&&!e.includes(r.original_date)&&(a={date:r.original_date,itemType:"DATE",weekDay:this.utils.getWeekdayString(this,r.original_date)},n.push(a),e.push(r.original_date)),n.push(r)}this.photoList=n}else this.photoList=t},getListRenderCount:function(t){if(this.groupByDate){var e,o=[],i=0;for(e in t){var s=t[e];s.original_date&&!o.includes(s.original_date)?(i+=2,o.push(s.original_date)):i+=1}return i}return t.length},getPhotoByTime:function(t,d,c){var p=this,u="desc"==this.timeOrder;if(this.sortType=1==d?"desc":"asc",this.lastLoading||this.nextLoading)this.lastLoading,this.nextLoading;else{d=parseInt(d),u?2==d?this.lastLoading=!0:this.nextLoading=!0:2==d?this.nextLoading=!0:this.lastLoading=!0;for(var e=[],o=0;o<this.photoList.length;o++)this.photoList[o][this.sortField]==t&&e.push(this.photoList[o].id);var i,m=this.dataColumns*this.pageRows,s={hideLoading:!0,timestamp:t,timeType:d,count:m=m<100?100:m,excludeIds:e,fileType:parseInt(this.showFileType),sortField:this.sortField,sortType:this.sortType,trash:this.trash};this.geohash&&(i=this.geohash.substr(0,5),"1"==this.showRangeType?i=this.geohash.substr(0,4):"2"==this.showRangeType?i=this.geohash.substr(0,3):"3"==this.showRangeType&&(i=this.geohash.substr(0,2)),s.geohash=i),this.albumId&&(s.albumId=this.albumId),this.libraryId&&(s.libraryId=this.libraryId),this.ordinaryAlbumId&&(s.ordinaryAlbumId=this.ordinaryAlbumId),this.aiClassId&&(s.aiClassId=parseInt(this.aiClassId)),this.faceId&&(s.faceId=this.faceId),this.searchStr&&(s.searchStr=this.searchStr),this.sourceFolderList&&(s.sourceFolderList=this.sourceFolderList),this.api.post("/api/photoApi/getPhotoByTime",s).then(function(e){for(var o,t=0;t<e.data.length;t++)e.data[t]=p.dealPhotoUrl(e.data[t]);u&&2==d||!u&&1==d?(e.data.length<m&&(p.lastHasMore=!1),p.addDateGroupItemToPhotoList(e.data.reverse().concat(p.photoList)),o=p.getListRenderCount(e.data.reverse()),p.$nextTick(function(){var t=p.$refs.photoWrapper.childNodes[o+1];t&&(t=50<t.offsetTop?t.offsetTop-50:t.offsetTop,p.$refs.photoWrapper.scrollTop=t),document.getElementsByClassName("right-layout")}),p.$nextTick(function(){if(0<e.data.length&&p.photoList.length>p.listMaxLength)for(var t=0;t<e.data.length;t++)p.photoList.pop();p.photoList.length})):(p.addDateGroupItemToPhotoList(p.photoList.concat(e.data)),e.data.length<m&&(p.nextHasMore=!1),p.photoList.length),u?2==d?p.lastLoading=!1:p.nextLoading=!1:2==d?p.nextLoading=!1:p.lastLoading=!1,p.$nextTick(function(){p.calculateImgHeight(),p.$emit("onPhotoLoadOver",u&&2==d||!u&&1==d,e.data),c&&p.loadLastPage()});try{if(e.originalDateItemList&&0<e.originalDateItemList.length){var i,s=Object(g.a)(e.originalDateItemList);try{for(s.s();!(i=s.n()).done;){var n=i.value;p.originalDateItemListLocation[n.date]=n.locationList}}catch(t){s.e(t)}finally{s.f()}}var a,r=Object(g.a)(e.data);try{for(r.s();!(a=r.n()).done;){var h,l=a.value;l.mode&&"undefined"!=l.mode&&((h=p.originalDateItemListMode[l.original_date])?h.includes(l.mode)||p.originalDateItemListMode[l.original_date].push(l.mode):p.originalDateItemListMode[l.original_date]=[l.mode])}}catch(t){r.e(t)}finally{r.f()}e.imagePreviewType&&(localStorage.imagePreviewType=e.imagePreviewType),e.imagePreviewSize&&(localStorage.imagePreviewSize=e.imagePreviewSize),e.imagePreviewQuality&&(localStorage.imagePreviewQuality=e.imagePreviewQuality)}catch(t){}}).catch(function(t){u?2==d?p.lastLoading=!1:p.nextLoading=!1:2==d?p.nextLoading=!1:p.lastLoading=!1})}}}}),n=(o("6a35"),o("2877")),n=Object(n.a)(s,function(){var i=this,s=i._self._c;return s("div",{ref:"photoWrapper",staticClass:"photo-wrapper",attrs:{id:"photo-wrapper"},on:{mouseleave:i.onMouseLeaveRoot}},[i.lastHasMore?s("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center",height:"60px","align-items":"center"}},[s("Spin")],1):i._e(),i._l(i.photoList,function(e,o){return s("div",{key:e.id,style:{width:"DATE"==e.itemType?"100%":"auto"},attrs:{id:"photoItem"+e.id}},["DATE"!=e.itemType?s("div",{staticClass:"photo-item",staticStyle:{cursor:"pointer"},style:{margin:i.photoMargin+"px",width:i.photoWidth+"px",height:i.photoHeight+"px"},on:{click:function(t){return i.onPhotoClick(o)},mouseenter:function(t){return i.mouseEnterImg(o)},mouseleave:function(t){return i.mouseLeaveImg(o)},contextmenu:function(t){return i.showRightMenu(t,i.$root,e,o)},touchstart:function(t){return i.touchstart(o)},touchend:i.touchend,mousedown:function(t){return i.onMouseDown(t,o)},mouseup:function(t){return i.onMouseUp(o)}}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.url,expression:"photo.url"}],staticClass:"photo-img",style:{height:i.photoHeight+"px","object-fit":i.showMode},attrs:{id:"photoImg"+e.id},on:{dragstart:function(t){t.preventDefault()}}}),2==e.type&&1!=e.is_livephoto?s("div",{staticClass:"icon-play-root"},[s("span",{staticClass:"nasIcons icon-play",staticStyle:{color:"white","font-size":"20px"}}),s("p",{staticClass:"icon-duration"},[i._v(i._s(i.utils.formatSecondsB(e.duration)))])]):i._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:e.hover&&!e.selected,expression:"photo.hover && !photo.selected"}],staticClass:"photo-hover-mask"},[i.ordinaryAlbumId?s("Icon",{staticClass:"photo-select-icon-setcover",attrs:{size:25,color:"#eee",type:"ios-disc"},on:{click:function(t){return t.stopPropagation(),i.setOrdinaryCover(o)}}}):i._e(),s("vs-tooltip",{staticClass:"photo-select-icon-hover",attrs:{disabled:i.isMobile},scopedSlots:i._u([{key:"tooltip",fn:function(){return[s("div",{staticStyle:{"word-break":"break-all"}},[i._v(i._s(i.$t("dragSelectAlert")))])]},proxy:!0}],null,!0)},[s("span",{staticClass:"nasIcons icon-radio-unchecked",on:{click:function(t){return t.stopPropagation(),i.hoverSelect(o)}}})])],1),e.selected?s("div",{staticClass:"photo-select-mask"},[s("span",{staticClass:"photo-select-icon-hover nasIcons icon-radio-checked"})]):i._e(),1==e.is_livephoto?s("div",{staticClass:"wrapper-livephoto flex-row"},[s("span",{staticClass:"nasIcons icon-livezhaopian",staticStyle:{"font-size":"12px",color:"#333333"}}),s("span",{staticStyle:{"font-size":"10px",color:"#333333"}},[i._v("LIVE")])]):1==e.is_raw?s("div",{staticClass:"wrapper-livephoto flex-row"},[s("span",{staticStyle:{"font-size":"10px",color:"#333333"}},[i._v(i._s(e.ext.replace(".","").toUpperCase()))])]):e.rawImageIndex&&e.raw_filename&&1!=i.trash?s("div",{staticClass:"wrapper-livephoto flex-row"},[s("span",{staticStyle:{"font-size":"10px",color:"#333333"}},[i._v(i._s(e.ext.replace(".","").toUpperCase())+"+"+i._s(e.rawImageIndex.ext.replace(".","").toUpperCase()))])]):i._e()]):"DATE"==e.itemType?s("div",[s("div",{staticClass:"group-date-title max-line-one",staticStyle:{width:"100%"}},[i._v(" "+i._s(e.date)+" "+i._s(e.weekDay)+" ")]),i.originalDateItemListLocation[e.date]&&0<i.originalDateItemListLocation[e.date].length?s("div",{staticClass:"group-date-location max-line-one",staticStyle:{width:"100%"}},i._l(i.originalDateItemListLocation[e.date],function(t){return t.name||t.cn_name?s("span",{staticStyle:{"margin-right":"8px"}},[t.name?s("span",[i._v(i._s(t.name))]):i._e(),t.name&&t.cn_name?s("span",[i._v("-")]):i._e(),t.cn_name?s("span",[i._v(i._s(t.cn_name))]):i._e()]):i._e()}),0):i._e(),i.originalDateItemListMode[e.date]&&0<i.originalDateItemListMode[e.date].length?s("div",{staticClass:"group-date-mode max-line-one",staticStyle:{width:"100%"}},[s("span",{staticStyle:{"margin-right":"10px"}},[i._v(i._s(i.$t("photo.camera")))]),i._l(i.originalDateItemListMode[e.date],function(t){return s("span",{staticStyle:{"margin-right":"8px"}},[i._v(" "+i._s(t)+" ")])})],2):i._e()]):i._e()])}),s("div",{staticStyle:{display:"flex","justify-content":"center",width:"100%","flex-direction":"column","align-items":"center"}},[i.nextHasMore&&0<i.photoList.length?s("Button",{staticStyle:{width:"250px","margin-top":"30px",height:"45px","border-radius":"20px"},attrs:{type:"default"},on:{click:function(t){return i.loadNextPage()}}},[i._v(i._s(i.$t("common.loadmore")))]):i._e(),i.nextLoading?s("Spin",{staticStyle:{"margin-top":"30px"},attrs:{size:"large"}}):i._e(),i.nextLoading||i.nextHasMore?i._e():s("span",{staticStyle:{"margin-top":"30px"}},[i._v(i._s(i.$t("common.noMore")))]),s("div",{staticStyle:{height:"50px"}})],1),i.isMobile?i._e():s("easy-cm",{attrs:{list:i.rightMenuList},on:{ecmcb:i.rightMenuClick}}),i.showToTopBtn?s("my-btn-icon",{staticClass:"to-top",attrs:{iIcon:"md-arrow-up"},on:{click:function(t){return i.$refs.photoWrapper.scrollTo({top:0,behavior:"smooth"})}}}):i._e(),s("vs-dialog",{attrs:{scroll:""},scopedSlots:i._u([{key:"header",fn:function(){return[s("h4",{staticStyle:{"font-size":"16px"}},[i._v(" "+i._s(i.$t("photo.changePeopleAlert"))+" ")])]},proxy:!0},{key:"footer",fn:function(){return[s("vs-button",{attrs:{block:""},on:{click:i.onSelectPeople}},[i._v(" "+i._s(i.$t("common.select"))+" ")])]},proxy:!0}]),model:{value:i.showSelectFace,callback:function(t){i.showSelectFace=t},expression:"showSelectFace"}},[s("photo-faces-select",{ref:"photoFaceSelect",attrs:{singleSelectMode:!0}})],1)],2)},[],!1,null,"0d3dedd0",null);e.a=n.exports},e5e3:function(t,e,o){}}]);