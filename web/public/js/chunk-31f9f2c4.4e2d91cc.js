(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-31f9f2c4"],{1768:function(t,e,i){"use strict";i("3791")},3791:function(t,e,i){},9453:function(t,e,i){"use strict";i("14d9");var l=i("be3b"),s={name:"photo-bottom-select",props:{ignoreLivephoto:{default:0,type:Number},isInFolderView:{default:!1,type:Boolean},serverType:{default:"photo",type:String},showAddToAlbum:{default:!0,type:Boolean},showRemoveFromAlbum:{default:!1,type:Boolean},editMode:{default:!1,type:Boolean},ordinaryAlbumId:{default:"",type:String},faceId:{default:"",type:String},pathSep:{default:"\\",type:String},photoList:{type:Array,default:()=>[]},trashMode:!1},components:{ordinaryAlbumContent:()=>Promise.all([i.e("chunk-4e886eb8"),i.e("chunk-2d0e48df")]).then(i.bind(null,"a95d"))},data(){return{showSelectAlbum:!1,selectedItemList:[],selectedList:[]}},mounted(){this.$bus.$on("onTrashMsg",t=>{this.inOutTrashApi(1,!1,[t],()=>{this.$bus.$emit("removeIndexById",t)})}),this.$bus.$on("onTrashAllMsg",()=>{this.trashPhotos(1)}),this.$bus.$on("onDownloadSelectedListMsg",()=>{this.downloadSelectedList()}),this.$bus.$on("onAddToAlbumMsg",()=>{this.onAddToAlbum()}),this.$bus.$on("onRemoveFromAlbumMsg",()=>{this.removeFromAlbum()}),this.$bus.$on("onDeleteFromDiskMsg",()=>{this.deleteFromDisk()})},beforeDestroy(){this.$bus.$off("onTrashMsg"),this.$bus.$off("onTrashAllMsg"),this.$bus.$off("onDownloadSelectedListMsg"),this.$bus.$off("onAddToAlbumMsg"),this.$bus.$off("onRemoveFromAlbumMsg"),this.$bus.$off("onDeleteFromDiskMsg")},methods:{onClickDelete(){this.isInFolderView?this.deleteFromDisk():this.trashPhotos(1)},onAddToAlbum(){this.showSelectAlbum=!0},onSwitchToOtherPeople(){this.selectedList.length<1||this.$bus.$emit("onSwitchToOtherPeople",this.selectedList)},downloadSelectedList(){if(!(this.selectedItemList.length<1)){let t=[];for(var i in this.selectedItemList,this.selectedItemList){var s=this.selectedItemList[i];this.selectedItemList[i].rawUrl?1==s.is_livephoto&&s.livephotoIndex&&s.livephotoIndex.videoIndex&&s.livephotoIndex.photoIndex?(t.push(s.livephotoIndex.videoIndex.rawUrl),t.push(s.livephotoIndex.photoIndex.rawUrl)):t.push(s.rawUrl):0==this.selectedItemList[i].is_file&&(s=l.a.getRawFileZipUrl(this.selectedItemList[i].path+this.pathSep+this.selectedItemList[i].filename,this.selectedItemList[i].filename),t.push(s))}t;let e=this;function o(){e.downloadFile(t),e.$emit("onUnSelect")}1<this.selectedItemList.length?this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("file.multiDownloadAlert"),()=>{o()}):o()}},removeFromAlbum(){this.selectedList.length<1||(this.albumId,this.faceId?this.$bus.$emit("onRemoveFromFace",this.selectedList):this.ordinaryAlbumId&&this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("photo.removeFromAlbum")+"?",()=>{this.api.post("/api/ordinaryAlbumApi/deleteFromAlbum",{indexIdArr:this.selectedList,albumId:this.ordinaryAlbumId}).then(t=>{t.code||(this.showVsNotification(this.$t("photo.removeFromAlbumSuc")),this.$emit("onRemoveFromAlbum"),this.$emit("onUnSelect"))}).catch(t=>{})}))},onAddToAlbumSelect(){var t;!this.$refs.ordinaryAlbum||!(t=this.$refs.ordinaryAlbum.getSelectedAlbumId())||this.selectedList.length<1||this.api.post("/api/ordinaryAlbumApi/addToAlbum",{indexIdArr:this.selectedList,albumId:t}).then(t=>{t.code||(this.$emit("onUnSelect"),this.showSelectAlbum=!1,this.showVsNotification(this.$t("photo.addAlbumSuc")))}).catch(t=>{})},onUnSelect(){this.$emit("onUnSelect")},inOutApi(t,e){this.inOutTrashApi(t,e,this.selectedList,()=>{this.selectedList=[],this.selectedItemList=[],1==t?(this.$emit("onTrashInSuc"),this.showVsNotification(this.$t("file.putInTrashSuc")),this.$emit("onUnSelect")):(this.$emit("onTrashOutSuc"),this.showVsNotification(this.$t("file.putOutTrashSuc"))),e&&this.$emit("onNeedRefresh")})},inOutTrashApi(t,e,i,s){this.api.post("/api/fileApi/inOutTrash",{ids:i,trash:t}).then(t=>{t.code||s&&s()}).catch(t=>{})},restoreAll(t){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("file.doAllRestore"),()=>{this.api.post("/api/photoApi/restoreTrashBinFiles",{}).then(t=>{t.code||this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess")+":"+this.$t("common.checkAfter"),()=>{this.$emit("onNeedRefresh")})}).catch(t=>{})})},deleteAll(t){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("file.doAllDelete"),function(t){this.api.post("/api/photoApi/clearTrashBin",{putInSystemTrash:t}).then(t=>{t.code||this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess")+":"+this.$t("common.checkAfter"),()=>{this.$emit("onNeedRefresh")})}).catch(t=>{})},null,null,null,null,null,"linux"==localStorage.platform?null:{checkBoxContent:this.$t("putInSystemTrash"),isCheck:!0})},trashPhotos(t){this.selectedList.length<1&&this.trashMode?this.$emit("restoreAll"):this.inOutApi(t)},deleteApi(e,t){this.ignoreLivephoto,this.api.post("/api/fileApi/deleteFromDisk",{serverType:this.serverType,ids:this.selectedList,putInSystemTrash:t?1:0,ignoreLivephoto:this.ignoreLivephoto}).then(t=>{t.code||(t=t.deletedIds,this.selectedList=[],this.selectedItemList=[],this.showVsNotification(t.length+this.$t("file.fileDeleteSuc")),this.$emit("onDeleteSuc",t),e&&this.showVsAlertDialog(this.$t("common.alert"),this.$t("common.operationSuccess")+":"+this.$t("common.checkAfter"),()=>{this.$emit("onNeedRefresh")}))}).catch(t=>{})},deleteFromDisk(){this.selectedList.length<1&&this.trashMode?this.$emit("deleteAll"):this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),t=>{this.deleteApi(!0,t)},null,null,null,null,null,"linux"==localStorage.platform?null:{checkBoxContent:this.$t("putInSystemTrash"),isCheck:!0})},addSelected(t){this.selectedList.push(t.id),this.selectedItemList.push(t)},removeSelected(e){for(let t=this.selectedList.length;0<=t;t--)if(this.selectedList[t]==e){this.selectedList.splice(t,1),this.selectedItemList.splice(t,1);break}},clearSelected(){this.selectedList=[],this.selectedItemList=[]}}},o=(i("1768"),i("2877")),o=Object(o.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bottom-select-root"},[e.trashMode?e._e():i("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("span",{staticClass:"select-text"},[e._v(e._s(e.$t("common.selected"))+"ï¼š"+e._s(e.selectedList.length)+e._s(e.$t("photo.fileCount")))])]),i("div",{staticClass:"bottom-root"},[i("Tooltip",{attrs:{content:e.$t("common.delete"),disabled:e.isMobile}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"red",iIcon:"md-trash"},on:{click:function(t){return e.onClickDelete()}}})],1),i("Tooltip",{attrs:{content:e.$t("photo.addToAlbum"),disabled:e.isMobile}},[e.showAddToAlbum?i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{iIcon:"md-add"},on:{click:e.onAddToAlbum}}):e._e()],1),i("Tooltip",{attrs:{content:e.$t("photo.changePeople"),disabled:e.isMobile}},[e.faceId?i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{iIcon:"md-swap"},on:{click:e.onSwitchToOtherPeople}}):e._e()],1),i("Tooltip",{attrs:{content:e.$t("photo.removeFromAlbum"),disabled:e.isMobile}},[e.showRemoveFromAlbum?i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{iIcon:"md-remove"},on:{click:e.removeFromAlbum}}):e._e()],1),i("Tooltip",{attrs:{content:e.$t("common.download"),disabled:e.isMobile}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"whtie",iIcon:"md-download"},on:{click:function(t){return e.downloadSelectedList()}}})],1),i("Tooltip",{attrs:{content:e.$t("common.cancel"),disabled:e.isMobile}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"white",iIcon:"md-close"},on:{click:e.onUnSelect}})],1)],1)]),e.trashMode?i("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-between",width:"100%"}},[i("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[i("div",{staticClass:"left-root",on:{click:function(t){return e.trashPhotos(0)}}},[i("Tooltip",{attrs:{disabled:e.isMobile,content:e.selectedList.length<1?e.$t("file.restoreAll"):e.$t("file.restore")+":"+e.selectedList.length}},[i("my-btn-icon",{attrs:{type:"primary",iIcon:"md-refresh"}})],1)],1),i("div",{staticClass:"right-root",on:{click:function(t){return e.deleteFromDisk()}}},[i("Tooltip",{attrs:{disabled:e.isMobile,content:e.selectedList.length<1?e.$t("file.deleteAll"):e.$t("file.delete")+":"+e.selectedList.length}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"red",iIcon:"md-trash"}})],1)],1)]),i("Tooltip",{attrs:{disabled:e.isMobile,content:e.$t("common.cancel")}},[0<e.selectedList.length?i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{type:"white",iIcon:"md-close"},on:{click:e.onUnSelect}}):e._e()],1)],1):e._e(),i("vs-dialog",{attrs:{scroll:""},scopedSlots:e._u([{key:"header",fn:function(){return[i("h4",{staticStyle:{"font-size":"16px"}},[e._v(" "+e._s(e.$t("photo.whichAlbumWanToAdd"))+" ")])]},proxy:!0},{key:"footer",fn:function(){return[i("vs-button",{attrs:{block:""},on:{click:e.onAddToAlbumSelect}},[e._v(" "+e._s(e.$t("common.select"))+" ")])]},proxy:!0}]),model:{value:e.showSelectAlbum,callback:function(t){e.showSelectAlbum=t},expression:"showSelectAlbum"}},[i("ordinary-album-content",{ref:"ordinaryAlbum",attrs:{selectMode:!0}})],1)],1)},[],!1,null,"0ded6d86",null);e.a=o.exports}}]);