"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[969],{350:function(t,e){function i(t,e,i){return(e=function(t){var e=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e,i){s(t,e),e.set(t,i)}function s(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(t,e,i){return t.set(h(t,e),i),i}function o(t,e){return t.get(h(t,e))}function h(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}Object.defineProperty(e,"__esModule",{value:!0}),e.Paginator=void 0;const a=t=>1-(1-t)*(1-t),l=(t,e,i,n,s)=>new Promise((r=>{let o;const h=a=>{o??(o=a);const l=Math.min(1,(a-o)/i);var c,d;s((c=t,d=e,n(l)*(d-c)+c)),l<1?requestAnimationFrame(h):r()};requestAnimationFrame(h)})),c=function(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;const s=t.createRange();return s.setStart(e,i),s.setEnd(e,n),s},d=function(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.nodeValue.length;if(s-n==1)return i(c(t,e,n),c(t,e,s))<0?n:s;const r=Math.floor(n+(s-n)/2),o=i(c(t,e,n,r),c(t,e,r,s));return o<0?d(t,e,i,n,r):o>0?d(t,e,i,r,s):r},{SHOW_ELEMENT:u,SHOW_TEXT:p,SHOW_CDATA_SECTION:g,FILTER_ACCEPT:m,FILTER_REJECT:f,FILTER_SKIP:v}=NodeFilter,w=u|p|g,x=(t,e,i,n)=>{const s=s=>{var r;const o=null===(r=s.localName)||void 0===r?void 0:r.toLowerCase();if("script"===o||"style"===o)return f;if(1===s.nodeType){const{left:t,right:r}=n(s.getBoundingClientRect());if(r<e||t>i)return f;if(t>=e&&r<=i)return m}else{var h;if(null===(h=s.nodeValue)||void 0===h||!h.trim())return v;const r=t.createRange();r.selectNodeContents(s);const{left:o,right:a}=n(r.getBoundingClientRect());if(a>=e&&o<=i)return m}return v};try{const r=t.createTreeWalker(t.body,w,{acceptNode:s}),o=[];for(let t=r.nextNode();t;t=r.nextNode())o.push(t);const h=o[0]??t.body,a=o[o.length-1]??h,l=1===h.nodeType?0:d(t,h,((t,i)=>{const s=n(t.getBoundingClientRect()),r=n(i.getBoundingClientRect());return s.right<e&&r.left>e?0:r.left>e?-1:1})),c=1===a.nodeType?0:d(t,a,((t,e)=>{const s=n(t.getBoundingClientRect()),r=n(e.getBoundingClientRect());return s.right<i&&r.left>i?0:r.left>i?-1:1})),u=t.createRange();return u.setStart(h,l),u.setEnd(a,c),u}catch(t){}},y=t=>{const e=t.defaultView.getComputedStyle(t.body);return"rgba(0, 0, 0, 0)"===e.backgroundColor&&"none"===e.backgroundImage?t.defaultView.getComputedStyle(t.documentElement).background:e.background},b=(t,e)=>Array.from({length:t},(()=>{const t=document.createElement("div"),i=document.createElement("div");return t.append(i),i.setAttribute("part",e),t})),k=(t,e)=>{const{style:i}=t;for(const[t,n]of Object.entries(e))i.setProperty(t,n,"important")};var E=new WeakMap,M=new WeakMap,C=new WeakMap,_=new WeakMap,S=new WeakMap,z=new WeakMap,W=new WeakMap,T=new WeakMap,A=new WeakMap,P=new WeakMap;class L{constructor(t){let{container:e,onExpand:i}=t;n(this,E,new ResizeObserver((()=>this.expand()))),n(this,M,document.createElement("div")),n(this,C,document.createElement("iframe")),n(this,_,document.createRange()),n(this,S,void 0),n(this,z,!1),n(this,W,!1),n(this,T,!0),n(this,A,void 0),n(this,P,{}),this.container=e,this.onExpand=i,o(C,this).setAttribute("part","filter"),o(M,this).append(o(C,this)),Object.assign(o(M,this).style,{boxSizing:"content-box",position:"relative",overflow:"hidden",flex:"0 0 auto",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),Object.assign(o(C,this).style,{overflow:"hidden",border:"0",display:"none",width:"100%",height:"100%"}),o(C,this).setAttribute("sandbox","allow-same-origin allow-scripts"),o(C,this).setAttribute("scrolling","no")}get element(){return o(M,this)}get document(){return o(C,this).contentDocument}async load(t,e,i){if("string"!=typeof t)throw new Error(`${t} is not string`);return new Promise((n=>{o(C,this).addEventListener("load",(()=>{const t=this.document;null==e||e(t),o(C,this).style.display="block";const{vertical:s,rtl:h}=(t=>{const{defaultView:e}=t,{writingMode:i,direction:n}=e.getComputedStyle(t.body);return{vertical:"vertical-rl"===i||"vertical-lr"===i,rtl:"rtl"===t.body.dir||"rtl"===n||"rtl"===t.documentElement.dir}})(t),a=y(t);o(C,this).style.display="none",r(z,this,s),r(W,this,h),o(_,this).selectNodeContents(t.body);const l=null==i?void 0:i({vertical:s,rtl:h,background:a});o(C,this).style.display="block",this.render(l),o(E,this).observe(t.body),t.fonts.ready.then((()=>this.expand())),n()}),{once:!0}),o(C,this).src=t}))}render(t){t&&(r(T,this,"scrolled"!==t.flow),r(P,this,t),o(T,this)?this.columnize(t):this.scrolled(t))}scrolled(t){let{gap:e,columnWidth:i}=t;const n=o(z,this),s=this.document;k(s.documentElement,{"box-sizing":"border-box",padding:n?`${e}px 0`:`0 ${e}px`,"column-width":"auto",height:"auto",width:"auto"}),k(s.body,{[n?"max-height":"max-width"]:`${i}px`,margin:"auto"}),this.setImageSize(),this.expand()}columnize(t){let{width:e,height:i,gap:n,columnWidth:s}=t;const h=o(z,this);r(A,this,h?i:e);const a=this.document;k(a.documentElement,{"box-sizing":"border-box","column-width":`${Math.trunc(s)}px`,"column-gap":`${n}px`,"column-fill":"auto",...h?{width:`${e}px`}:{height:`${i}px`},padding:h?n/2+"px 0":`0 ${n/2}px`,overflow:"hidden","overflow-wrap":"break-word",position:"static",border:"0",margin:"0","max-height":"none","max-width":"none","min-height":"none","min-width":"none","-webkit-line-box-contain":"block glyphs replaced"}),k(a.body,{"max-height":"none","max-width":"none",margin:"0"}),this.setImageSize(),this.expand()}setImageSize(){const{width:t,height:e,margin:i}=o(P,this),n=o(z,this),s=this.document;for(const r of s.body.querySelectorAll("img, svg, video")){const{maxHeight:o,maxWidth:h}=s.defaultView.getComputedStyle(r);k(r,{"max-height":n?"none"!==o&&"0px"!==o?o:"100%":e-2*i+"px","max-width":n?t-2*i+"px":"none"!==h&&"0px"!==h?h:"100%","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"})}}expand(){const{documentElement:t}=this.document;if(o(T,this)){const e=o(z,this)?"height":"width",i=o(z,this)?"width":"height",n=o(_,this).getBoundingClientRect(),s=t.getBoundingClientRect(),r=(o(z,this)?0:o(W,this)?s.right-n.right:n.left-s.left)+n[e],h=Math.ceil(r/o(A,this))*o(A,this);o(M,this).style.padding="0",o(C,this).style[e]=`${h}px`,o(M,this).style[e]=`${h+2*o(A,this)}px`,o(C,this).style[i]="100%",o(M,this).style[i]="100%",t.style[e]=`${o(A,this)}px`,o(S,this)&&(o(S,this).element.style.margin="0",o(S,this).element.style.left=o(z,this)?"0":`${o(A,this)}px`,o(S,this).element.style.top=o(z,this)?`${o(A,this)}px`:"0",o(S,this).element.style[e]=`${h}px`,o(S,this).redraw())}else{const e=o(z,this)?"width":"height",i=o(z,this)?"height":"width",n=t.getBoundingClientRect()[e],{margin:s}=o(P,this),r=o(z,this)?`0 ${s}px`:`${s}px 0`;o(M,this).style.padding=r,o(C,this).style[e]=`${n}px`,o(M,this).style[e]=`${n}px`,o(C,this).style[i]="100%",o(M,this).style[i]="100%",o(S,this)&&(o(S,this).element.style.margin=r,o(S,this).element.style.left="0",o(S,this).element.style.top="0",o(S,this).element.style[e]=`${n}px`,o(S,this).redraw())}this.onExpand()}set overlayer(t){r(S,this,t),o(M,this).append(t.element)}get overlayer(){return o(S,this)}destroy(){try{this.document&&o(E,this).unobserve(this.document.body)}catch(t){console.log(t.message)}}}var R=new WeakMap,$=new WeakMap,B=new WeakMap,I=new WeakMap,N=new WeakMap,O=new WeakMap,j=new WeakMap,V=new WeakMap,X=new WeakMap,F=new WeakMap,D=new WeakMap,H=new WeakMap,q=new WeakMap,Y=new WeakMap,J=new WeakMap,K=new WeakMap,G=new WeakMap,Q=new WeakMap,U=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,it=new WeakSet;class nt extends HTMLElement{constructor(){var t;super(),s(this,t=it),t.add(this),n(this,R,this.attachShadow({mode:"closed"})),n(this,$,new ResizeObserver((()=>this.render()))),n(this,B,void 0),n(this,I,void 0),n(this,N,void 0),n(this,O,void 0),n(this,j,void 0),n(this,V,void 0),n(this,X,!1),n(this,F,!1),n(this,D,0),n(this,H,-1),n(this,q,0),n(this,Y,!1),n(this,J,!1),n(this,K,void 0),n(this,G,new WeakMap),n(this,Q,matchMedia("(prefers-color-scheme: dark)")),n(this,U,void 0),n(this,Z,void 0),n(this,tt,void 0),n(this,et,void 0),i(this,"startX",!1),i(this,"currentX",!1),i(this,"isScrollingLeft",!1),o(R,this).innerHTML='<style>\n        :host {\n            display: block;\n            container-type: size;\n        }\n        :host, #top {\n            box-sizing: border-box;\n            position: relative;\n            overflow: hidden;\n            width: 100%;\n            height: 100%;\n        }\n        #top {\n            --_gap: 7%;\n            --_margin: 48px;\n            --_max-inline-size: 720px;\n            --_max-block-size: 1440px;\n            --_max-column-count: 2;\n            --_max-column-count-portrait: 1;\n            --_max-column-count-spread: var(--_max-column-count);\n            --_half-gap: calc(var(--_gap) / 2);\n            --_max-width: calc(var(--_max-inline-size) * var(--_max-column-count-spread));\n            --_max-height: var(--_max-block-size);\n            display: grid;\n            grid-template-columns:\n                minmax(var(--_half-gap), 1fr)\n                var(--_half-gap)\n                minmax(0, calc(var(--_max-width) - var(--_gap)))\n                var(--_half-gap)\n                minmax(var(--_half-gap), 1fr);\n            grid-template-rows:\n                minmax(var(--_margin), 1fr)\n                minmax(0, var(--_max-height))\n                minmax(var(--_margin), 1fr);\n            &.vertical {\n                --_max-column-count-spread: var(--_max-column-count-portrait);\n                --_max-width: var(--_max-block-size);\n                --_max-height: calc(var(--_max-inline-size) * var(--_max-column-count-spread));\n            }\n            @container (orientation: portrait) {\n                & {\n                    --_max-column-count-spread: var(--_max-column-count-portrait);\n                }\n                &.vertical {\n                    --_max-column-count-spread: var(--_max-column-count);\n                }\n            }\n        }\n        #background {\n            grid-column: 1 / -1;\n            grid-row: 1 / -1;\n        }\n        #container {\n            grid-column: 2 / 5;\n            grid-row: 2;\n            overflow: hidden;\n        }\n        :host([flow="scrolled"]) #container {\n            grid-column: 1 / -1;\n            grid-row: 1 / -1;\n            overflow: auto;\n        }\n        #header {\n            grid-column: 3 / 4;\n            grid-row: 1;\n        }\n        #footer {\n            grid-column: 3 / 4;\n            grid-row: 3;\n            align-self: end;\n        }\n        #header, #footer {\n            display: grid;\n            height: var(--_margin);\n        }\n        :is(#header, #footer) > * {\n            display: flex;\n            align-items: center;\n            min-width: 0;\n        }\n        :is(#header, #footer) > * > * {\n            width: 100%;\n            overflow: hidden;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            text-align: center;\n            font-size: .75em;\n            opacity: .6;\n        }\n        </style>\n        <div id="top">\n            <div id="background" part="filter"></div>\n            <div id="header"></div>\n            <div id="container"></div>\n            <div id="footer"></div>\n        </div>\n        ',r(B,this,o(R,this).getElementById("top")),r(I,this,o(R,this).getElementById("background")),r(N,this,o(R,this).getElementById("container")),r(O,this,o(R,this).getElementById("header")),r(j,this,o(R,this).getElementById("footer")),o($,this).observe(o(N,this)),o(N,this).addEventListener("scroll",(t=>{let e;return function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];e&&clearTimeout(e),e=setTimeout((()=>{e=null,t(...n)}),250)}})((()=>{this.scrolled&&(o(Y,this)?r(Y,this,!1):h(it,this,wt).call(this,"scroll"))})));const e={passive:!1};this.addEventListener("touchstart",h(it,this,ot).bind(this),e),this.addEventListener("touchmove",h(it,this,ht).bind(this),e),this.addEventListener("touchend",h(it,this,at).bind(this)),this.addEventListener("load",(t=>{let{detail:{doc:i}}=t;i.addEventListener("touchstart",h(it,this,ot).bind(this),e),i.addEventListener("touchmove",h(it,this,ht).bind(this),e),i.addEventListener("touchend",h(it,this,at).bind(this))})),r(U,this,(()=>{o(V,this)&&(o(I,this).style.background=y(o(V,this).document))}))}attributeChangedCallback(t,e,i){switch(t){case"flow":this.render();break;case"gap":case"margin":case"max-block-size":case"max-column-count":o(B,this).style.setProperty("--_"+t,i);break;case"max-inline-size":o(B,this).style.setProperty("--_"+t,i),this.render()}}open(t){this.bookDir=t.dir,this.sections=t.sections}replaceNewChildren(t,e){for(;t.firstChild;)t.removeChild(t.firstChild);for(var i=0;i<e.length;i++)t.appendChild(e[i])}render(){o(V,this)&&(o(V,this).render(h(it,this,rt).call(this,{vertical:o(X,this),rtl:o(F,this)})),this.scrollToAnchor(o(q,this)))}get scrolled(){return"scrolled"===this.getAttribute("flow")}get scrollProp(){const{scrolled:t}=this;return o(X,this)?t?"scrollLeft":"scrollTop":t?"scrollTop":"scrollLeft"}get sideProp(){const{scrolled:t}=this;return o(X,this)?t?"width":"height":t?"height":"width"}get size(){return o(N,this).getBoundingClientRect()[this.sideProp]}get viewSize(){return o(V,this).element.getBoundingClientRect()[this.sideProp]}get start(){return Math.abs(o(N,this)[this.scrollProp])}get end(){return this.start+this.size}get page(){return Math.floor((this.start+this.end)/2/this.size)}get pages(){return Math.round(this.viewSize/this.size)}scrollBy(t,e){const i=o(X,this)?e:t,n=o(N,this),{scrollProp:s}=this,[r,h,a]=o(Z,this),l=o(F,this),c=l?r-a:r-h,d=l?r+h:r+a;n[s]=Math.max(c,Math.min(d,n[s]+i))}snap(t,e){const i=o(X,this)?e:t,[n,s,r]=o(Z,this),{start:a,end:l,pages:c,size:d}=this,u=Math.abs(n)-s,p=Math.abs(n)+r,g=i*(o(F,this)?-d:d),m=Math.floor(Math.max(u,Math.min(p,(a+l)/2+(isNaN(g)?0:g)))/d);h(it,this,mt).call(this,m,"snap").then((()=>{const t=m<=0?-1:m>=c-1?1:null;if(t)return h(it,this,bt).call(this,{index:h(it,this,Mt).call(this,t),anchor:t<0?()=>1:()=>0})}))}async scrollToAnchor(t,e){var i,n;r(q,this,t);const s=null===(i=(t=>{if(null==t||!t.collapsed)return t;const{endOffset:e,endContainer:i}=t;if(1===i.nodeType)return i;if(e+1<i.length)t.setEnd(i,e+1);else{if(!(e>1))return i.parentNode;t.setStart(i,e-1)}return t})(t))||void 0===i||null===(n=i.getClientRects)||void 0===n?void 0:n.call(i);if(s){const t=Array.from(s).find((t=>t.width>0&&t.height>0))||s[0];if(!t)return;return await h(it,this,pt).call(this,t,"anchor"),void(e&&h(it,this,ft).call(this))}if(this.scrolled)return void await h(it,this,gt).call(this,t*this.viewSize,"anchor");const{pages:o}=this;if(!o)return;const a=o-2,l=Math.round(t*(a-1));await h(it,this,mt).call(this,l+1,"anchor")}async goTo(t){if(o(J,this))return;const e=await t;return h(it,this,yt).call(this,e.index)?h(it,this,bt).call(this,e):void 0}get atStart(){return null==h(it,this,Mt).call(this,-1)&&this.page<=1}get atEnd(){return null==h(it,this,Mt).call(this,1)&&this.page>=this.pages-2}prev(t){return h(it,this,Ct).call(this,-1,t)}next(t){return h(it,this,Ct).call(this,1,t)}prevSection(){return this.goTo({index:h(it,this,Mt).call(this,-1)})}nextSection(){return this.goTo({index:h(it,this,Mt).call(this,1)})}firstSection(){const t=this.sections.findIndex((t=>"no"!==t.linear));return this.goTo({index:t})}lastSection(){const t=this.sections.findLastIndex((t=>"no"!==t.linear));return this.goTo({index:t})}getContents(){return o(V,this)?[{index:o(H,this),overlayer:o(V,this).overlayer,doc:o(V,this).document}]:[]}setStyles(t){var e,i,n,s,h;r(K,this,t);const a=o(G,this).get(null===(e=o(V,this))||void 0===e?void 0:e.document);if(!a)return;const[l,c]=a;if(Array.isArray(t)){const[e,i]=t;l.textContent=e,c.textContent=i}else c.textContent=t;o(I,this).style.background=y(o(V,this).document),null===(i=o(V,this))||void 0===i||null===(n=i.document)||void 0===n||null===(s=n.fonts)||void 0===s||null===(h=s.ready)||void 0===h||h.then((()=>o(V,this).expand()))}destroy(){var t,e;o($,this).unobserve(this),o(V,this).destroy(),r(V,this,null),null===(t=this.sections[o(H,this)])||void 0===t||null===(e=t.unload)||void 0===e||e.call(t)}}function st(){return o(V,this)&&(o(V,this).destroy(),o(N,this).removeChild(o(V,this).element)),r(V,this,new L({container:this,onExpand:()=>this.scrollToAnchor(o(q,this))})),o(N,this).append(o(V,this).element),o(V,this)}function rt(t){let{vertical:e,rtl:i,background:n}=t;r(X,this,e),r(F,this,i),o(B,this).classList.toggle("vertical",e),o(I,this).style.background=n;const{width:s,height:h}=o(N,this).getBoundingClientRect(),a=e?h:s,l=getComputedStyle(o(B,this)),c=parseFloat(l.getPropertyValue("--_max-inline-size")),d=parseInt(l.getPropertyValue("--_max-column-count-spread")),u=parseFloat(l.getPropertyValue("--_margin"));r(D,this,u);const p=parseFloat(l.getPropertyValue("--_gap"))/100,g=-p/(p-1)*a,m=this.getAttribute("flow");if("scrolled"===m){this.setAttribute("dir",e?"rtl":"ltr"),o(B,this).style.padding="0";const t=c;return this.heads=null,this.feet=null,this.replaceNewChildren(o(O,this),[]),this.replaceNewChildren(o(j,this),[]),{flow:m,margin:u,gap:g,columnWidth:t}}const f=Math.min(d,Math.ceil(a/c)),v=a/f-g;this.setAttribute("dir",i?"rtl":"ltr");const w=e?Math.min(2,Math.ceil(s/c)):f,x={gridTemplateColumns:`repeat(${w}, 1fr)`,gap:`${g}px`,direction:"rtl"===this.bookDir?"rtl":"ltr"};Object.assign(o(O,this).style,x),Object.assign(o(j,this).style,x);const y=b(w,"head"),k=b(w,"foot");return this.heads=y.map((t=>t.children[0])),this.feet=k.map((t=>t.children[0])),this.replaceNewChildren(o(O,this),[...y]),this.replaceNewChildren(o(j,this),[...k]),{height:h,width:s,margin:u,gap:g,columnWidth:v}}function ot(t){if(this.scrolled)return h(it,this,lt).call(this,t);t.preventDefault(),this.startX=t.touches[0].clientX}function ht(t){if(this.scrolled)return h(it,this,ct).call(this,t);t.preventDefault(),this.currentX=t.touches[0].clientX}function at(){if(this.scrolled)return h(it,this,dt).call(this);const t=this.currentX-this.startX;t<-50?(this.isScrollingLeft=!0,this.next()):t>50&&(this.isScrollingLeft=!1,this.prev()),this.startX=null,this.currentX=null}function lt(t){const e=t.changedTouches[0];r(tt,this,{x:null==e?void 0:e.screenX,y:null==e?void 0:e.screenY,t:t.timeStamp,vx:0,xy:0})}function ct(t){const e=o(tt,this);if(e.pinched)return;if(e.pinched=globalThis.visualViewport.scale>1,this.scrolled||e.pinched)return;if(t.touches.length>1)return void(o(et,this)&&t.preventDefault());t.preventDefault();const i=t.changedTouches[0],n=i.screenX,s=i.screenY,h=e.x-n,a=e.y-s,l=t.timeStamp-e.t;e.x=n,e.y=s,e.t=t.timeStamp,e.vx=h/l,e.vy=a/l,r(et,this,!0),this.scrollBy(h,a)}function dt(){r(et,this,!1),this.scrolled||requestAnimationFrame((()=>{1===globalThis.visualViewport.scale&&this.snap(o(tt,this).vx,o(tt,this).vy)}))}function ut(){if(this.scrolled){const t=this.viewSize,e=o(D,this);return o(X,this)?i=>{let{left:n,right:s}=i;return{left:t-s-e,right:t-n-e}}:t=>{let{top:i,bottom:n}=t;return{left:i+e,right:n+e}}}const t=this.pages*this.size;return o(F,this)?e=>{let{left:i,right:n}=e;return{left:t-n,right:t-i}}:o(X,this)?t=>{let{top:e,bottom:i}=t;return{left:e,right:i}}:t=>t}async function pt(t,e){if(this.scrolled){const i=h(it,this,ut).call(this)(t).left-o(D,this);return h(it,this,gt).call(this,i,e)}const i=h(it,this,ut).call(this)(t).left+o(D,this)/2;return h(it,this,mt).call(this,Math.floor(i/this.size)+(o(F,this)?-1:1),e)}async function gt(t,e,i){const n=o(N,this),{scrollProp:s,size:c}=this;return n[s]===t?(r(Z,this,[t,this.atStart?0:c,this.atEnd?0:c]),void h(it,this,wt).call(this,e)):(this.scrolled&&o(X,this)&&(t=-t),("snap"===e||i)&&this.hasAttribute("animated")?l(n[s],t,300,a,(t=>n[s]=t)).then((()=>{r(Z,this,[t,this.atStart?0:c,this.atEnd?0:c]),h(it,this,wt).call(this,e)})):(n[s]=t,r(Z,this,[t,this.atStart?0:c,this.atEnd?0:c]),void h(it,this,wt).call(this,e)))}async function mt(t,e,i){const n=this.size*(o(F,this)?-t:t);return h(it,this,gt).call(this,n,e,i)}function ft(){const{defaultView:t}=o(V,this).document;if(o(q,this).startContainer){const e=t.getSelection();e.removeAllRanges(),e.addRange(o(q,this))}}function vt(){if(this.scrolled)return x(o(V,this).document,this.start+o(D,this),this.end-o(D,this),h(it,this,ut).call(this));const t=o(F,this)?-this.size:this.size;return x(o(V,this).document,this.start-t,this.end-t,h(it,this,ut).call(this))}function wt(t){const e=h(it,this,vt).call(this);"anchor"!==t?r(q,this,e):r(Y,this,!0);const i={reason:t,range:e,index:o(H,this)};if(this.scrolled)i.fraction=this.start/this.viewSize;else if(this.pages>0){const{page:t,pages:e}=this;o(O,this).style.visibility=t>1?"visible":"hidden",i.fraction=(t-1)/(e-2),i.size=1/(e-2)}this.dispatchEvent(new CustomEvent("relocate",{detail:i}))}async function xt(t){const{index:e,src:i,anchor:n,onLoad:s,select:a}=await t;if(r(H,this,e),i){const t=h(it,this,st).call(this),n=t=>{if(t.head){const e=t.createElement("style");t.head.prepend(e);const i=t.createElement("style");t.head.append(i),o(G,this).set(t,[e,i])}null==s||s({doc:t,index:e})},a=h(it,this,rt).bind(this);await t.load(i,n,a),this.dispatchEvent(new CustomEvent("create-overlayer",{detail:{doc:t.document,index:e,attach:e=>t.overlayer=e}})),r(V,this,t)}await this.scrollToAnchor(("function"==typeof n?n(o(V,this).document):n)??0,a)}function yt(t){return t>=0&&t<=this.sections.length-1}async function bt(t){let{index:e,anchor:i,select:n}=t;if(e===o(H,this))await h(it,this,xt).call(this,{index:e,anchor:i,select:n});else{const t=o(H,this),s=e=>{var i,n;null===(i=this.sections[t])||void 0===i||null===(n=i.unload)||void 0===n||n.call(i),this.setStyles(o(K,this)),this.dispatchEvent(new CustomEvent("load",{detail:e}))};await h(it,this,xt).call(this,Promise.resolve(this.sections[e].load()).then((t=>({index:e,src:t,anchor:i,onLoad:s,select:n}))).catch((t=>(console.warn(t),console.warn(new Error(`Failed to load section ${e}`)),{}))))}}function kt(t){if(!o(V,this))return!0;if(this.scrolled)return!(this.start>0)||h(it,this,gt).call(this,Math.max(0,this.start-(t??this.size)),null,!0);if(this.atStart)return;const e=this.page-1;return h(it,this,mt).call(this,e,"page",!0).then((()=>e<=0))}function Et(t){if(!o(V,this))return!0;if(this.scrolled)return!(this.viewSize-this.end>2)||h(it,this,gt).call(this,Math.min(this.viewSize,t?this.start+t:this.end),null,!0);if(this.atEnd)return;const e=this.page+1,i=this.pages;return h(it,this,mt).call(this,e,"page",!0).then((()=>e>=i-1))}function Mt(t){for(let i=o(H,this)+t;h(it,this,yt).call(this,i);i+=t){var e;if("no"!==(null===(e=this.sections[i])||void 0===e?void 0:e.linear))return i}}async function Ct(t,e){if(o(J,this))return;r(J,this,!0);const i=-1===t,n=await(i?h(it,this,kt).call(this,e):h(it,this,Et).call(this,e));n&&await h(it,this,bt).call(this,{index:h(it,this,Mt).call(this,t),anchor:i?()=>1:()=>0}),!n&&this.hasAttribute("animated")||await new Promise((t=>setTimeout(t,100))),r(J,this,!1)}e.Paginator=nt,i(nt,"observedAttributes",["flow","gap","margin","max-inline-size","max-block-size","max-column-count"]),customElements.define("foliate-paginator",nt)}}]);