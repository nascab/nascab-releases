"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[275],{275:function(t,e){function n(t,e,n){i(t,e),e.set(t,n)}function i(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(t,e){return t.get(o(t,e))}function r(t,e,n){return t.set(o(t,e),n),n}function o(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}e.TTS=void 0;const a="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/2001/10/synthesis",h=new Set(["article","aside","audio","blockquote","caption","details","dialog","div","dl","dt","dd","figure","footer","form","figcaption","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","math","nav","ol","p","pre","section","tr"]),c=t=>{var e;return t.lang||(null==t||null===(e=t.getAttributeNS)||void 0===e?void 0:e.call(t,a,"lang"))||(t.parentElement?c(t.parentElement):null)},u=t=>{var e;return(null==t||null===(e=t.getAttributeNS)||void 0===e?void 0:e.call(t,a,"lang"))||(t.parentElement?u(t.parentElement):null)},d=t=>!t.toString().trim();var f=new WeakMap,g=new WeakMap,m=new WeakMap,p=new WeakMap;class v{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>t;n(this,f,[]),n(this,g,void 0),n(this,m,-1),n(this,p,void 0),r(g,this,t),r(p,this,e)}current(){if(s(f,this)[s(m,this)])return s(p,this).call(this,s(f,this)[s(m,this)])}first(){if(s(f,this)[0])return r(m,this,0),s(p,this).call(this,s(f,this)[0])}prev(){const t=s(m,this)-1;if(s(f,this)[t])return r(m,this,t),s(p,this).call(this,s(f,this)[t])}next(){const t=s(m,this)+1;if(s(f,this)[t])return r(m,this,t),s(p,this).call(this,s(f,this)[t]);for(;;){const{done:e,value:n}=s(g,this).next();if(e)break;if(s(f,this).push(n),s(f,this)[t])return r(m,this,t),s(p,this).call(this,s(f,this)[t])}}find(t){const e=s(f,this).findIndex((e=>t(e)));if(e>-1)return r(m,this,e),s(p,this).call(this,s(f,this)[e]);for(;;){const{done:e,value:n}=s(g,this).next();if(e)break;if(s(f,this).push(n),t(n))return r(m,this,s(f,this).length-1),s(p,this).call(this,n)}}}var S=new WeakMap,b=new WeakMap,w=new WeakMap,k=new WeakMap,N=new WeakSet;function T(t,e){return e?t.querySelector(`mark[name="${CSS.escape(e)}"`):null}function E(t,e){var n;if(!t)return;if(!e)return s(k,this).serializeToString(t);const i=document.implementation.createDocument(l,"speak");i.documentElement.replaceWith(i.importNode(t.documentElement,!0));let r=null===(n=e(i))||void 0===n?void 0:n.previousSibling;for(;r;){var o;const t=r.previousSibling??(null===(o=r.parentNode)||void 0===o?void 0:o.previousSibling);r.parentNode.removeChild(r),r=t}return s(k,this).serializeToString(i)}e.TTS=class{constructor(t,e,s){var o;i(this,o=N),o.add(this),n(this,S,void 0),n(this,b,void 0),n(this,w,void 0),n(this,k,new XMLSerializer),this.doc=t,this.highlight=s,r(S,this,new v(function*(t){let e;const n=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);for(let i=n.nextNode();i;i=n.nextNode()){const n=i.tagName.toLowerCase();h.has(n)&&(e&&(e.setEndBefore(i),d(e)||(yield e)),e=t.createRange(),e.setStart(i,0))}e||(e=t.createRange(),e.setStart(t.body.firstChild??t.body,0)),e.setEndAfter(t.body.lastChild??t.body),d(e)||(yield e)}(t),(t=>{const{entries:n,ssml:i}=((t,e,n)=>{const i=c(t.commonAncestorContainer),s=u(t.commonAncestorContainer),r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"word";const n=new Intl.Segmenter(t,{granularity:e}),i="word"===e;return function*(t,e){const s=t.join("");let r=0,o=-1,a=0;for(const{index:l,segment:h,isWordLike:c}of n.segment(s)){if(i&&!c)continue;for(;a<=l;)a+=t[++o].length;const n=o,u=l-(a-t[o].length),d=l+h.length;if(d<s.length)for(;a<=d;)a+=t[++o].length;const f=o,g=d-(a-t[o].length);yield[(r++).toString(),e(n,u,f,g)]}}}(i,n),o=t.cloneContents(),h=[...e(t,r)],d=[...e(o,r)];for(const[t,e]of d){const n=document.createElement("foliate-mark");n.dataset.name=t,e.insertNode(n)}const f=((t,e)=>{const n=document.implementation.createDocument(l,"speak"),{lang:i}=e;i&&n.documentElement.setAttributeNS(a,"lang",i);const s=(t,e,i)=>{if(!t)return;if(3===t.nodeType)return n.createTextNode(t.textContent);if(4===t.nodeType)return n.createCDATASection(t.textContent);if(1!==t.nodeType)return;let r;const o=t.nodeName.toLowerCase();"foliate-mark"===o?(r=n.createElementNS(l,"mark"),r.setAttribute("name",t.dataset.name)):"br"===o?r=n.createElementNS(l,"break"):"em"!==o&&"strong"!==o||(r=n.createElementNS(l,"emphasis"));const h=t.lang||t.getAttributeNS(a,"lang");h&&(r||(r=n.createElementNS(l,"lang")),r.setAttributeNS(a,"lang",h));const c=t.getAttributeNS(l,"alphabet")||i;if(!r){const e=t.getAttributeNS(l,"ph");e&&(r=n.createElementNS(l,"phoneme"),c&&r.setAttribute("alphabet",c),r.setAttribute("ph",e))}r||(r=e);let u=t.firstChild;for(;u;){const t=s(u,r,c);t&&r!==t&&r.append(t),u=u.nextSibling}return r};return s(t.firstChild,n.documentElement,e.alphabet),n})(o,{lang:i,alphabet:s});return{entries:h,ssml:f}})(t,e);return r(b,this,new Map(n)),[i,t]})))}start(){r(w,this,null);const[t]=s(S,this).first()??[];return t?o(N,this,E).call(this,t,(t=>o(N,this,T).call(this,t,s(w,this)))):this.next()}resume(){const[t]=s(S,this).current()??[];return t?o(N,this,E).call(this,t,(t=>o(N,this,T).call(this,t,s(w,this)))):this.next()}prev(t){r(w,this,null);const[e,n]=s(S,this).prev()??[];return t&&n&&this.highlight(n.cloneRange()),o(N,this,E).call(this,e)}next(t){r(w,this,null);const[e,n]=s(S,this).next()??[];return t&&n&&this.highlight(n.cloneRange()),o(N,this,E).call(this,e)}from(t){r(w,this,null);const[e]=s(S,this).find((e=>t.compareBoundaryPoints(Range.END_TO_START,e)<=0));let n;for(const[e,i]of s(b,this).entries())if(t.compareBoundaryPoints(Range.START_TO_START,i)<=0){n=e;break}return o(N,this,E).call(this,e,(t=>o(N,this,T).call(this,t,n)))}setMark(t){const e=s(b,this).get(t);e&&(r(w,this,t),this.highlight(e.cloneRange()))}}}}]);