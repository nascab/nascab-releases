const _0x2d2ae3=_0x5213;(function(_0x1a3c5d,_0x156c9a){const _0x5abed6=_0x5213,_0x3b3318=_0x1a3c5d();while(!![]){try{const _0xabca28=-parseInt(_0x5abed6(0xbd))/0x1+-parseInt(_0x5abed6(0xcb))/0x2*(-parseInt(_0x5abed6(0xd8))/0x3)+parseInt(_0x5abed6(0x83))/0x4+-parseInt(_0x5abed6(0xb4))/0x5*(parseInt(_0x5abed6(0x6a))/0x6)+parseInt(_0x5abed6(0x68))/0x7*(parseInt(_0x5abed6(0xe8))/0x8)+parseInt(_0x5abed6(0x6f))/0x9+-parseInt(_0x5abed6(0xd5))/0xa*(parseInt(_0x5abed6(0xf8))/0xb);if(_0xabca28===_0x156c9a)break;else _0x3b3318['push'](_0x3b3318['shift']());}catch(_0x231986){_0x3b3318['push'](_0x3b3318['shift']());}}}(_0x5860,0x33f81));let path=require(_0x2d2ae3(0xee)),fs=require('fs'),os=require('os'),child_process=require('child_process'),proxyProcess=null;function _0x5213(_0x3e674a,_0x55a431){const _0x5860fc=_0x5860();return _0x5213=function(_0x5213af,_0x5a9f6f){_0x5213af=_0x5213af-0x64;let _0x346bff=_0x5860fc[_0x5213af];return _0x346bff;},_0x5213(_0x3e674a,_0x55a431);}const config=require('../../myConfig/config'),Database=require('better-sqlite3');let dbOther=new Database(config[_0x2d2ae3(0xcd)],{});dbOther[_0x2d2ae3(0xc2)](_0x2d2ae3(0xa0));let dbConfigTable=require(_0x2d2ae3(0x80)),cryptoUtils=require(_0x2d2ae3(0x91)),axios=require(_0x2d2ae3(0x79)),i18nUtil=require(_0x2d2ae3(0x7e)),retryCount=0x0,maxRetryCount=0x9184e729fff,tmpPath,apiConfig,userToken,crtPath,keyPath,i18n;var ping=require(_0x2d2ae3(0x88));let isWin=os[_0x2d2ae3(0xca)]()=='win32',frpIsConnected=![],isWaittingTimeout=![],urlConfig=require(_0x2d2ae3(0xd9));process[_0x2d2ae3(0xf0)]=_0x2d2ae3(0xb2);const healthCheckGap=0x1e;function _0x5860(){const _0xf7e604=['token','错误输出','writeFile','frpc\x20stopped','ping','777','未登录\x20不连接内网穿透','stdout','proxy.frpcStartFail','PING','join','proxySuffix','server_bandwidth','../../express-server/utils/cryptoUtils','value','proxy.conFail','error','alive','unknown','fail','catch','code','apiProxyUrl','_id','probe','https://','FRP\x20Connected','\x0apool_count\x20=\x201\x0atcp_mux\x20=\x20true\x0a\x0a[','journal_mode\x20=\x20WAL','then','tmp','message','type','proxy.noUsableServer','tmp_crt','proxy.noExpress','stringify','account.onlyPtSupport','\x0auser=\x22','message：stop','create','\x20TIMEOUT','proxy.noSubdomain','validServer','proxy.frpcStartFailWin','writeFileSync','NasCabFrpWorker','selected','646545EpyUcH','getServerRootPath','findByTitle','indexOf','post','chmodSync','\x0aserver_port\x20=\x20','parse','context\x20canceled','116008aQTkfJ','invalid\x20user','spawn','run','netRate','pragma','data','state','time','message：reset','start\x20proxy\x20success','retry','router\x20config\x20conflict','platform','97804dQmWYa','userReqDns','dbOther','已选代理服务器','子域名冲突','SIGTERM','首选服务器','TLS\x20handshake\x20error','getI18n','getUrlByUrlKey','4512010xmaXbS','getProxyServer','proxy.conSuc','3EIWpPT','../../myConfig/urlConfig','\x22\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0ameta_subdomain=','proxy_subdomain','远程代理停止','message：start','tmp_key','start','/api/healthCheck','exit','msg','prepare','show_name','user_count','reset','length','6736fDpQHr','frpc\x20process\x20error','proxy.frpcNoExist','userDataFolder','key','\x0aplugin\x20=\x20https2http\x0aplugin_local_addr\x20=\x20127.0.0.1:','path','proxy.noLoginInfo','title','port','apiServer','promise','bandwidth','proxyServerList','\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0abandwidth_limit\x20=\x20','errMsg','11fxFnJU','stopped','proxy.isntVip','operation\x20timed\x20out','\x20refused','2856fKceQd','ping_time','12yTWhNW','\x0aplugin_key_path\x20=\x20\x20','远程连接未启用','nasZs987bac','pid','2625957ELrXBe','serverId','crt','log','decryptString','frpcPath','close','\x20error','kill','cannot\x20find\x20the\x20file\x20specified','axios','FRP\x20Connection\x20health\x20check\x20fail:','toString','正在连接远程代理,重试次数:','远程代理线程退出','../../utils/i18nUtil','getTime','../../db/dbConfigTable','mkdirSync','nasRemoteState','1417924aFauWd'];_0x5860=function(){return _0xf7e604;};return _0x5860();}let healthCheckInterval=null,healthCheckUrl='',healthCheckFailCount=0x0,maxhealthCheckFailCount=0x3;process['on'](_0x2d2ae3(0xe1),()=>{const _0x41179a=_0x2d2ae3;console[_0x41179a(0x72)](_0x41179a(0x7d)),stopProxy(),dbOther['close']();}),process['on'](_0x2d2ae3(0xa3),_0x2d4c04=>{const _0x45ccfb=_0x2d2ae3;if(_0x2d4c04[_0x45ccfb(0xa4)]==_0x45ccfb(0xdf))console[_0x45ccfb(0x72)](_0x45ccfb(0xdd)),startProxy();else{if(_0x2d4c04[_0x45ccfb(0xa4)]=='stop')console['log'](_0x45ccfb(0xab)),stopProxy();else _0x2d4c04[_0x45ccfb(0xa4)]==_0x45ccfb(0xe6)&&(console['log'](_0x45ccfb(0xc6)),_0x2d4c04['msg']&&_0x2d4c04[_0x45ccfb(0xe2)][_0x45ccfb(0x70)]?resetProxy(_0x2d4c04['msg']['serverId']):resetProxy());}});let stopProxy=function(){const _0x5171bc=_0x2d2ae3;proxyProcess&&(proxyProcess['kill'](),console[_0x5171bc(0x72)](_0x5171bc(0xdc)),proxyProcess=null);};function saveNasProxyState(_0x27ae53,_0x124b10,_0x20e02a){const _0x570f58=_0x2d2ae3;if(_0x20e02a)console[_0x570f58(0x72)](_0x20e02a);dbConfigTable[_0x570f58(0xac)](dbOther,{'title':_0x570f58(0x82),'value':JSON[_0x570f58(0xa8)]({'status':_0x27ae53,'time':_0x124b10,'error':_0x20e02a})});}let resetProxy=async function(_0xd9ffc1){retryCount=0x0,startProxy(_0xd9ffc1);},startProxy=async function(_0xc3a29f){const _0x55eb2a=_0x2d2ae3;i18n=i18nUtil[_0x55eb2a(0xd3)](dbOther),stopProxy();let _0x1870a9=dbConfigTable[_0x55eb2a(0xb6)](dbOther,'nasRemoteEnable');if(!_0x1870a9||_0x1870a9&&_0x1870a9[_0x55eb2a(0x92)]!=0x1)return console['log'](_0x55eb2a(0x6c)),saveNasProxyState(_0x55eb2a(0x97),new Date()[_0x55eb2a(0x7f)](),i18n['__']('proxy.disable'));console[_0x55eb2a(0x72)](_0x55eb2a(0x7c),retryCount);let _0x5805bd=dbConfigTable[_0x55eb2a(0xb6)](dbOther,config['nasAccountInfoConfigKey']);if(!_0x5805bd)return console['log'](_0x55eb2a(0x8a)),saveNasProxyState(_0x55eb2a(0x97),new Date()['getTime'](),i18n['__'](_0x55eb2a(0xef)));if(!fs['existsSync'](config['frpcPath']))return saveNasProxyState(_0x55eb2a(0x97),new Date()[_0x55eb2a(0x7f)](),i18n['__'](_0x55eb2a(0xea)));retryCount+=0x1;if(retryCount>=maxRetryCount)return saveNasProxyState(_0x55eb2a(0x97),new Date()[_0x55eb2a(0x7f)](),i18n['__'](_0x55eb2a(0x93)));os[_0x55eb2a(0xca)]()!='win32'&&fs[_0x55eb2a(0xb9)](config[_0x55eb2a(0x74)],_0x55eb2a(0x89)),cryptoUtils[_0x55eb2a(0x73)](config['nasAccountInfoPwd'],_0x5805bd[_0x55eb2a(0x92)])[_0x55eb2a(0xa1)](_0xa67d62=>{const _0x1a02e9=_0x55eb2a;let _0x4dd2ad=JSON[_0x1a02e9(0xbb)](_0xa67d62),_0x1ca950=_0x4dd2ad['userInfo'],_0x2846ec=_0x4dd2ad['vipInfo'];_0x1ca950[_0x1a02e9(0x84)]&&_0x1ca950[_0x1a02e9(0x84)]['length']>0x0&&(userToken=_0x1ca950[_0x1a02e9(0x84)][_0x1ca950[_0x1a02e9(0x84)][_0x1a02e9(0xe7)]-0x1]);if(!userToken)return saveNasProxyState('fail',new Date()[_0x1a02e9(0x7f)](),i18n['__'](_0x1a02e9(0xef)));if(!_0x2846ec)return saveNasProxyState(_0x1a02e9(0x97),new Date()[_0x1a02e9(0x7f)](),i18n['__'](_0x1a02e9(0x65)));if(_0x2846ec[_0x1a02e9(0xa4)]<0x2)return saveNasProxyState(_0x1a02e9(0x97),new Date()[_0x1a02e9(0x7f)](),i18n['__'](_0x1a02e9(0xa9)));if(!_0x2846ec[_0x1a02e9(0xdb)])return saveNasProxyState(_0x1a02e9(0x97),new Date()[_0x1a02e9(0x7f)](),i18n['__'](_0x1a02e9(0xae)));let _0x34197a=dbConfigTable['findByTitle'](dbOther,_0x1a02e9(0xf2));if(!_0x34197a)return saveNasProxyState(_0x1a02e9(0x97),new Date()[_0x1a02e9(0x7f)](),i18n['__'](_0x1a02e9(0xa7)));apiConfig=JSON[_0x1a02e9(0xbb)](_0x34197a[_0x1a02e9(0x92)]);if(!apiConfig[_0x1a02e9(0xf1)]||apiConfig[_0x1a02e9(0xc4)]!=_0x1a02e9(0xc0))return saveNasProxyState('fail',new Date()['getTime'](),i18n['__'](_0x1a02e9(0xa7)));let _0x81e9ad={'token':userToken,'type':_0x1a02e9(0xd6)};axios['post'](urlConfig[_0x1a02e9(0xd4)](dbOther,_0x1a02e9(0x9a)),_0x81e9ad)[_0x1a02e9(0xa1)](async _0x4e2a4c=>{const _0x4fb3b7=_0x1a02e9;if(_0x4e2a4c['data'][_0x4fb3b7(0x99)])return saveNasProxyState(_0x4fb3b7(0x97),new Date()[_0x4fb3b7(0x7f)](),_0x4e2a4c[_0x4fb3b7(0xc3)][_0x4fb3b7(0xe2)]?_0x4e2a4c[_0x4fb3b7(0xc3)]['msg']:i18n['__'](_0x4fb3b7(0x93)));else{let _0x3b26dc=_0x4e2a4c[_0x4fb3b7(0xc3)]['validServer'],_0x4a7cfc=null,_0x31efb9=dbConfigTable['findByTitle'](dbOther,'proxyServerList');if(_0x31efb9&&_0x31efb9['value'])try{_0x31efb9=JSON['parse'](_0x31efb9[_0x4fb3b7(0x92)]);for(let _0x3b343d=0x0;_0x3b343d<_0x3b26dc[_0x4fb3b7(0xe7)];_0x3b343d++){if(_0xc3a29f){if(_0xc3a29f==_0x3b26dc[_0x3b343d][_0x4fb3b7(0x9b)]){_0x4a7cfc=_0x3b26dc[_0x3b343d];break;}}else for(let _0x4b3a1a=0x0;_0x4b3a1a<_0x31efb9['length'];_0x4b3a1a++){if(_0x31efb9[_0x4b3a1a]['selected']&&_0x31efb9[_0x4b3a1a][_0x4fb3b7(0x9b)]==_0x3b26dc[_0x3b343d]['_id']){_0x4a7cfc=_0x3b26dc[_0x3b343d];break;}}}}catch(_0x28b7bf){console[_0x4fb3b7(0x72)](_0x28b7bf);}testPing(_0x4e2a4c[_0x4fb3b7(0xc3)][_0x4fb3b7(0xaf)],_0x4a7cfc?_0x4a7cfc[_0x4fb3b7(0x9b)]:null);}})[_0x1a02e9(0x98)](_0x338d9c=>{console['log'](_0x338d9c);});})[_0x55eb2a(0x98)](_0x5679e5=>{const _0xcfc8fe=_0x55eb2a;console[_0xcfc8fe(0x72)](_0x5679e5);});};function userReqDns(_0x1832f4,_0x34e06d){const _0x315709=_0x2d2ae3;tmpPath=path[_0x315709(0x8e)](config[_0x315709(0xeb)],_0x315709(0xa2),'proxy');!fs['existsSync'](tmpPath)&&fs[_0x315709(0x81)](tmpPath,{'recursive':!![]});let _0x3202f2=0x1;crtPath=path['join'](tmpPath,_0x315709(0xa6)),keyPath=path[_0x315709(0x8e)](tmpPath,_0x315709(0xde)),axios['post'](urlConfig[_0x315709(0xd4)](dbOther,_0x315709(0x9a)),{'token':userToken,'type':_0x315709(0xcc),'serverId':_0x34e06d[_0x315709(0x9b)],'getKey':_0x3202f2})['then'](async _0x3524ef=>{const _0x4d7296=_0x315709;if(_0x3524ef[_0x4d7296(0xc3)][_0x4d7296(0x99)])return saveNasProxyState('fail',new Date()[_0x4d7296(0x7f)](),_0x3524ef[_0x4d7296(0xc3)][_0x4d7296(0xe2)]?_0x3524ef['data'][_0x4d7296(0xe2)]:i18n['__']('proxy.conFail'));else{if(_0x3202f2==0x1){let _0x1483c1=await cryptoUtils[_0x4d7296(0x73)](_0x4d7296(0x6d),_0x3524ef[_0x4d7296(0xc3)][_0x4d7296(0x71)]),_0x22921b=await cryptoUtils[_0x4d7296(0x73)](_0x4d7296(0x6d),_0x3524ef[_0x4d7296(0xc3)][_0x4d7296(0xec)]);fs['writeFileSync'](crtPath,_0x1483c1),fs[_0x4d7296(0xb1)](keyPath,_0x22921b);}connectProxy(_0x1832f4,_0x34e06d);}})[_0x315709(0x98)](_0x2e7a70=>{const _0x434b34=_0x315709;console[_0x434b34(0x72)](_0x2e7a70);});}function testPing(_0x26107b,_0x4105f5){const _0x44ee76=_0x2d2ae3;if(_0x26107b[_0x44ee76(0xe7)]<0x1)return saveNasProxyState(_0x44ee76(0x97),new Date()[_0x44ee76(0x7f)](),i18n['__']('proxy.noUsableServer'));let _0x28e33c=0x0,_0x3f0957=null;function _0x5c81c5(){const _0x6baab3=_0x44ee76;if(_0x28e33c>=_0x26107b[_0x6baab3(0xe7)]){for(let _0x2d7e0b of _0x26107b){if(_0x4105f5&&_0x4105f5==_0x2d7e0b[_0x6baab3(0x9b)]&&_0x2d7e0b[_0x6baab3(0x95)]){_0x3f0957=_0x2d7e0b,console[_0x6baab3(0x72)](_0x6baab3(0xd1),_0x3f0957[_0x6baab3(0xe4)]);break;}if(_0x2d7e0b[_0x6baab3(0x95)]&&_0x2d7e0b[_0x6baab3(0x69)]&&_0x2d7e0b[_0x6baab3(0x69)]!=_0x6baab3(0x96)){if(_0x3f0957==null)_0x3f0957=_0x2d7e0b;else _0x3f0957[_0x6baab3(0x69)]*_0x3f0957['netRate']>_0x2d7e0b[_0x6baab3(0x69)]*_0x2d7e0b['netRate']&&(_0x3f0957=_0x2d7e0b);}}if(!_0x3f0957)return saveNasProxyState(_0x6baab3(0x97),new Date()[_0x6baab3(0x7f)](),i18n['__'](_0x6baab3(0xa5)));userReqDns(_0x26107b,_0x3f0957);}}for(let _0x1175d0 of _0x26107b){let _0x24c30b=0x1;if(!_0x1175d0[_0x44ee76(0xe5)]||!_0x1175d0[_0x44ee76(0x90)])_0x24c30b=0x1;else try{_0x24c30b=parseInt(_0x1175d0[_0x44ee76(0xe5)])/parseInt(_0x1175d0[_0x44ee76(0x90)]);}catch(_0x346d3b){console['log'](_0x346d3b);}_0x1175d0[_0x44ee76(0xc1)]=_0x24c30b;}for(let _0x4f4186 of _0x26107b){ping[_0x44ee76(0xf3)][_0x44ee76(0x9c)](_0x4f4186['ip'],{'timeout':0x14})[_0x44ee76(0xa1)](function(_0x92bcba){const _0x527ef5=_0x44ee76;_0x28e33c+=0x1,_0x4f4186[_0x527ef5(0x95)]=_0x92bcba[_0x527ef5(0x95)],_0x4f4186['ping_time']=_0x92bcba['time'],_0x5c81c5(),console[_0x527ef5(0x72)](_0x527ef5(0x8d),_0x4f4186['ip'],_0x92bcba[_0x527ef5(0x95)],_0x92bcba[_0x527ef5(0xc5)]?_0x92bcba[_0x527ef5(0xc5)]:_0x527ef5(0xad));})[_0x44ee76(0x98)](_0x1a11f6=>{const _0x3c1173=_0x44ee76;_0x28e33c+=0x1,_0x4f4186[_0x3c1173(0x95)]=![],_0x4f4186[_0x3c1173(0x69)]=0x1869f,console[_0x3c1173(0x72)](_0x3c1173(0x8d),_0x4f4186['ip'],'\x20TIMEOUT'),_0x5c81c5();});}}function setHealthCheckInterval(){healthCheckInterval&&clearInterval(healthCheckInterval),healthCheckInterval=setInterval(()=>{proxyProcess==null?startProxy():checkFrpConnectHealth();},healthCheckGap*0x3e8);}function tryRestartFrpc(){if(isWaittingTimeout)return;setTimeout(()=>{isWaittingTimeout=![],!frpIsConnected&&startProxy();},0x2710);}function checkFrpConnectHealth(){const _0x4d8385=_0x2d2ae3;axios[_0x4d8385(0xb8)](healthCheckUrl+_0x4d8385(0xe0),{'timeout':0x3a98})[_0x4d8385(0xa1)](async _0x5202ed=>{const _0x3e403e=_0x4d8385;_0x5202ed[_0x3e403e(0xc3)][_0x3e403e(0x99)]?(healthCheckFailCount+=0x1,console[_0x3e403e(0x72)]('FRP\x20Connection\x20health\x20check\x20fail:',healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy())):healthCheckFailCount=0x0;})['catch'](_0x15f1de=>{const _0x3f12ce=_0x4d8385;healthCheckFailCount+=0x1,console['log'](_0x3f12ce(0x7a),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy());});}async function connectProxy(_0x3ca942,_0x3db0be){const _0x50c3bd=_0x2d2ae3;for(let _0x57b212 of _0x3ca942){_0x57b212[_0x50c3bd(0x9b)]==_0x3db0be[_0x50c3bd(0x9b)]?_0x57b212[_0x50c3bd(0xb3)]=!![]:_0x57b212[_0x50c3bd(0xb3)]=![];}dbConfigTable['create'](dbOther,{'title':_0x50c3bd(0xf5),'value':JSON[_0x50c3bd(0xa8)](_0x3ca942)}),console['log'](_0x50c3bd(0xce),_0x3db0be['ip']);let _0x4caf56=apiConfig[_0x50c3bd(0xf1)],_0x407639=_0x3db0be[_0x50c3bd(0xf1)],_0x20cfe5=_0x3db0be[_0x50c3bd(0xdb)],_0x895d66=path['join'](tmpPath,'proxyConfig'),_0x5db426=dbConfigTable[_0x50c3bd(0xb5)](dbOther);healthCheckUrl=_0x50c3bd(0x9d)+_0x20cfe5+'.'+urlConfig[_0x50c3bd(0xd4)](dbOther,_0x50c3bd(0x8f))+_0x5db426;let _0x2fac0e='\x0a[common]\x0aserver_addr\x20=\x20'+_0x3db0be['ip']+_0x50c3bd(0xba)+_0x407639+_0x50c3bd(0xaa)+userToken+_0x50c3bd(0xda)+_0x20cfe5+'\x0asubdomain\x20=\x20'+_0x20cfe5+_0x50c3bd(0x9f)+_0x20cfe5+'-https]\x0atype\x20=\x20https\x0alocal_port\x20=\x20'+_0x4caf56+_0x50c3bd(0xed)+_0x4caf56+'\x0aplugin_crt_path\x20=\x20'+crtPath+_0x50c3bd(0x6b)+keyPath+'\x0aplugin_host_header_rewrite\x20=\x20127.0.0.1\x0aplugin_header_X-From-Where\x20=\x20NasCab\x0asubdomain\x20=\x20'+_0x20cfe5+_0x50c3bd(0xf6)+_0x3db0be[_0x50c3bd(0xf4)]+'\x0a';fs[_0x50c3bd(0x86)](_0x895d66,_0x2fac0e,()=>{const _0x4fce97=_0x50c3bd;try{proxyProcess!=null&&proxyProcess[_0x4fce97(0x77)](),proxyProcess=child_process[_0x4fce97(0xbf)](''+config[_0x4fce97(0x74)],['-c',_0x895d66],{'detached':![],'killSignal':_0x4fce97(0xd0)}),proxyProcess['on'](_0x4fce97(0x94),function(_0x312b3f){const _0x560317=_0x4fce97;return console[_0x560317(0x72)](_0x560317(0xe9),_0x312b3f),saveNasProxyState(_0x560317(0x97),new Date()[_0x560317(0x7f)](),isWin?i18n['__'](_0x560317(0xb0)):i18n['__'](_0x560317(0x8c)));});}catch(_0x54a28c){return console[_0x4fce97(0x72)](_0x54a28c),saveNasProxyState(_0x4fce97(0x97),new Date()['getTime'](),isWin?i18n['__']('proxy.frpcStartFailWin'):i18n['__']('proxy.frpcStartFail'));}proxyProcess[_0x4fce97(0x8b)]['on'](_0x4fce97(0xc3),_0x4d2557=>{const _0x7cb68f=_0x4fce97;let _0x7e5d2f=_0x4d2557[_0x7cb68f(0x7b)]();console[_0x7cb68f(0x72)]('数据输出',_0x7e5d2f);if(_0x7e5d2f[_0x7cb68f(0xb7)](_0x7cb68f(0xc9))!=-0x1)console[_0x7cb68f(0x72)](_0x7cb68f(0xcf)),frpIsConnected=!![],setHealthCheckInterval(),saveNasProxyState('success',new Date()[_0x7cb68f(0x7f)](),i18n['__'](_0x7cb68f(0xd7)));else{if(_0x7e5d2f['indexOf'](_0x7cb68f(0x78))!=-0x1)startProxy();else{if(_0x7e5d2f[_0x7cb68f(0xb7)](_0x7cb68f(0x76))!=-0x1||_0x7e5d2f[_0x7cb68f(0xb7)](_0x7cb68f(0x67))!=-0x1){frpIsConnected=![];if(isWaittingTimeout)return;isWaittingTimeout=!![],setTimeout(()=>{const _0xd1d71d=_0x7cb68f;isWaittingTimeout=![],!frpIsConnected&&_0x7e5d2f[_0xd1d71d(0xb7)](_0xd1d71d(0xc8))!=-0x1&&(console[_0xd1d71d(0x72)]('---Connection\x20error\x20，\x20reconnecting\x20frpc---',_0x7e5d2f),startProxy());},0x4e20);}else{if(_0x7e5d2f[_0x7cb68f(0xb7)](_0x7cb68f(0xbe))!=-0x1){console[_0x7cb68f(0x72)](_0x7cb68f(0xf7),_0x7e5d2f);var _0x37a178=_0x7e5d2f['lastIndexOf']('invalid\x20user');let _0x495d85=_0x7e5d2f['substring'](_0x37a178,_0x7e5d2f[_0x7cb68f(0xe7)]);saveNasProxyState(_0x7cb68f(0x97),new Date()[_0x7cb68f(0x7f)](),_0x495d85);}else{if(_0x7e5d2f['indexOf'](_0x7cb68f(0xc7))!=-0x1)frpIsConnected=!![],retryCount=0x0,console[_0x7cb68f(0x72)](_0x7cb68f(0x9e)),saveNasProxyState('success',new Date()['getTime'](),i18n['__'](_0x7cb68f(0xd7))),dbOther[_0x7cb68f(0xe3)]('REPLACE\x20INTO\x20process_record(process_id)\x20VALUES(?)')[_0x7cb68f(0xc0)](proxyProcess[_0x7cb68f(0x6e)]+''),fs['rm'](crtPath,()=>{}),fs['rm'](keyPath,()=>{}),fs['rm'](_0x895d66,()=>{}),setHealthCheckInterval();else{if(_0x7e5d2f[_0x7cb68f(0xb7)](_0x7cb68f(0x66))!=-0x1)saveNasProxyState(_0x7cb68f(0x97),new Date()[_0x7cb68f(0x7f)](),i18n['__']('proxy.timeout'));else{if(_0x7e5d2f[_0x7cb68f(0xb7)](_0x7cb68f(0x64))!=-0x1)saveNasProxyState(_0x7cb68f(0x97),new Date()['getTime'](),i18n['__'](_0x7cb68f(0x64))),tryRestartFrpc();else _0x7e5d2f[_0x7cb68f(0xb7)]('tmp/proxy/tmp_crt')!=-0x1&&tryRestartFrpc();}}}}}}}),proxyProcess['stderr']['on']('data',_0x404ed2=>{const _0x302c71=_0x4fce97;let _0x1e18f8=_0x404ed2[_0x302c71(0x7b)]();console[_0x302c71(0x72)](_0x302c71(0x85),_0x1e18f8),_0x1e18f8[_0x302c71(0xb7)]('wsarecv')==-0x1&&_0x1e18f8[_0x302c71(0xb7)](_0x302c71(0xbc))==-0x1&&_0x1e18f8['indexOf'](_0x302c71(0xd2))==-0x1&&(frpIsConnected=![]),tryRestartFrpc();}),proxyProcess['on'](_0x4fce97(0x75),_0x4bd207=>{const _0x33144e=_0x4fce97;console[_0x33144e(0x72)](_0x33144e(0x87)),frpIsConnected=![],stopProxy();});});}