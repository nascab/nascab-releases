const _0x5e5c23=_0x1f46;(function(_0x53686e,_0x86b160){const _0x1b6c07=_0x1f46,_0x304d64=_0x53686e();while(!![]){try{const _0x5c2e2e=-parseInt(_0x1b6c07(0x242))/0x1*(parseInt(_0x1b6c07(0x1c0))/0x2)+-parseInt(_0x1b6c07(0x23b))/0x3+-parseInt(_0x1b6c07(0x1c6))/0x4*(parseInt(_0x1b6c07(0x1d0))/0x5)+parseInt(_0x1b6c07(0x23d))/0x6*(parseInt(_0x1b6c07(0x22a))/0x7)+parseInt(_0x1b6c07(0x21c))/0x8+parseInt(_0x1b6c07(0x213))/0x9*(parseInt(_0x1b6c07(0x1d9))/0xa)+parseInt(_0x1b6c07(0x24f))/0xb;if(_0x5c2e2e===_0x86b160)break;else _0x304d64['push'](_0x304d64['shift']());}catch(_0x4c779e){_0x304d64['push'](_0x304d64['shift']());}}}(_0x2109,0xd3fb0));let path=require(_0x5e5c23(0x22c)),fs=require('fs'),os=require('os'),child_process=require('child_process'),proxyProcess=null;const config=require(_0x5e5c23(0x220)),Database=require(_0x5e5c23(0x1ee));let dbOther=new Database(config['dbOther'],{});dbOther[_0x5e5c23(0x221)](_0x5e5c23(0x1e8));let dbConfigTable=require('../../db/dbConfigTable'),cryptoUtils=require(_0x5e5c23(0x1f2)),axios=require(_0x5e5c23(0x1bf)),i18nUtil=require('../../utils/i18nUtil'),retryCount=0x0,maxRetryCount=0x9184e729fff,tmpPath,apiConfig,userToken,crtPath,keyPath,i18n;var ping=require('ping');let isWin=os[_0x5e5c23(0x1dd)]()=='win32',frpIsConnected=![],isWaittingTimeout=![],urlConfig=require(_0x5e5c23(0x240));function _0x1f46(_0x5d85f6,_0x328c25){const _0x210960=_0x2109();return _0x1f46=function(_0x1f468b,_0x26a7c6){_0x1f468b=_0x1f468b-0x1bc;let _0x27d3e6=_0x210960[_0x1f468b];return _0x27d3e6;},_0x1f46(_0x5d85f6,_0x328c25);}process[_0x5e5c23(0x1ea)]=_0x5e5c23(0x1bc);const healthCheckGap=0x1e;let healthCheckInterval=null,healthCheckUrl='',healthCheckFailCount=0x0,maxhealthCheckFailCount=0x3;process['on'](_0x5e5c23(0x214),()=>{const _0x4feced=_0x5e5c23;console[_0x4feced(0x248)](_0x4feced(0x1d2)),stopProxy(),dbOther[_0x4feced(0x228)]();}),process['on'](_0x5e5c23(0x1f5),_0x37ad1b=>{const _0x225011=_0x5e5c23;if(_0x37ad1b[_0x225011(0x1cd)]==_0x225011(0x1ce))console[_0x225011(0x248)](_0x225011(0x24e)),startProxy();else{if(_0x37ad1b['type']==_0x225011(0x23c))console[_0x225011(0x248)](_0x225011(0x232)),stopProxy();else _0x37ad1b[_0x225011(0x1cd)]=='reset'&&(console[_0x225011(0x248)](_0x225011(0x1cb)),_0x37ad1b[_0x225011(0x236)]&&_0x37ad1b['msg']['serverId']?resetProxy(_0x37ad1b['msg'][_0x225011(0x223)]):resetProxy());}});let stopProxy=function(){const _0x4dfaab=_0x5e5c23;proxyProcess&&(proxyProcess['kill'](),console[_0x4dfaab(0x248)](_0x4dfaab(0x222)),proxyProcess=null);};function saveNasProxyState(_0x53f4d6,_0x24a378,_0x28dfef){const _0x5aa687=_0x5e5c23;if(_0x28dfef)console[_0x5aa687(0x248)](_0x28dfef);dbConfigTable['create'](dbOther,{'title':_0x5aa687(0x237),'value':JSON[_0x5aa687(0x22f)]({'status':_0x53f4d6,'time':_0x24a378,'error':_0x28dfef})});}function _0x2109(){const _0x5bc927=['错误输出','server_bandwidth','3459784mqJsWG','TLS\x20handshake\x20error','REPLACE\x20INTO\x20process_record(process_id)\x20VALUES(?)','unknown','proxy.noExpress','message：reset','getUrlByUrlKey','type','start','time','5yknXrq','\x22\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0ameta_subdomain=','远程代理线程退出','FRP\x20Connection\x20health\x20check\x20fail:','数据输出','已选代理服务器','value','errMsg','proxy','60aCQVeb','stderr','proxy.noLoginInfo','FRP\x20Connected','platform','tmp_crt','start\x20proxy\x20success','frpc\x20process\x20error','win32','\x0aplugin\x20=\x20https2http\x0aplugin_local_addr\x20=\x20127.0.0.1:','getTime','alive','\x20TIMEOUT','proxy.noUsableServer','spawn','journal_mode\x20=\x20WAL','validServer','title','---Connection\x20error\x20，\x20reconnecting\x20frpc---','\x0a[common]\x0aserver_addr\x20=\x20','kill','better-sqlite3','PING','key','retry','../../express-server/utils/cryptoUtils','pid','proxy_subdomain','message','proxy.conFail','wsarecv','getI18n','show_name','code','\x0asubdomain\x20=\x20','create','prepare','stopped','nasAccountInfoConfigKey','\x0aserver_port\x20=\x20','invalid\x20user','ping_time','writeFile','tmp','then','operation\x20timed\x20out','toString','decryptString','/api/healthCheck','\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0abandwidth_limit\x20=\x20','join','context\x20canceled','getProxyServer','远程连接未启用','tmp/proxy/tmp_crt','apiProxyUrl','user_count','proxy.noSubdomain','837945BCBaLk','exit','proxy.timeout','\x0aplugin_host_header_rewrite\x20=\x20127.0.0.1\x0aplugin_header_X-From-Where\x20=\x20NasCab\x0asubdomain\x20=\x20','-https]\x0atype\x20=\x20https\x0alocal_port\x20=\x20','chmodSync','\x0aplugin_key_path\x20=\x20\x20','data','length','11287088MsmWcV','promise','token','netRate','../../myConfig/config','pragma','远程代理停止','serverId','proxy.frpcStartFail','apiServer','\x0auser=\x22','getServerRootPath','close','proxyConfig','133NldSKx','parse','path','fail','port','stringify','nasZs987bac','userInfo','message：stop','frpcPath','\x0apool_count\x20=\x201\x0atcp_mux\x20=\x20true\x0a\x0a[','post','msg','nasRemoteState','\x0aplugin_crt_path\x20=\x20','selected','bandwidth','3497370RXwuTo','stop','207474pDIWbj','probe','indexOf','../../myConfig/urlConfig','\x20error','326428eRDdle','proxy.frpcStartFailWin','findByTitle','router\x20config\x20conflict','nasAccountInfoPwd','首选服务器','log','writeFileSync','tmp_key','lastIndexOf','proxy.conSuc','existsSync','message：start','17360233fRyGQw','userDataFolder','未登录\x20不连接内网穿透','_id','\x20refused','NasCabFrpWorker','catch','proxy.frpcNoExist','axios','8ocsFeY','正在连接远程代理,重试次数:','run','vipInfo'];_0x2109=function(){return _0x5bc927;};return _0x2109();}let resetProxy=async function(_0x8c1ba){retryCount=0x0,startProxy(_0x8c1ba);},startProxy=async function(_0x2b789f){const _0x1e04f2=_0x5e5c23;i18n=i18nUtil[_0x1e04f2(0x1f8)](dbOther),stopProxy();let _0x23159e=dbConfigTable[_0x1e04f2(0x244)](dbOther,'nasRemoteEnable');if(!_0x23159e||_0x23159e&&_0x23159e[_0x1e04f2(0x1d6)]!=0x1)return console[_0x1e04f2(0x248)](_0x1e04f2(0x20e)),saveNasProxyState('fail',new Date()['getTime'](),i18n['__']('proxy.disable'));console[_0x1e04f2(0x248)](_0x1e04f2(0x1c1),retryCount);let _0x3ee23f=dbConfigTable[_0x1e04f2(0x244)](dbOther,config[_0x1e04f2(0x1ff)]);if(!_0x3ee23f)return console['log'](_0x1e04f2(0x251)),saveNasProxyState(_0x1e04f2(0x22d),new Date()['getTime'](),i18n['__'](_0x1e04f2(0x1db)));if(!fs[_0x1e04f2(0x24d)](config[_0x1e04f2(0x233)]))return saveNasProxyState(_0x1e04f2(0x22d),new Date()['getTime'](),i18n['__'](_0x1e04f2(0x1be)));retryCount+=0x1;if(retryCount>=maxRetryCount)return saveNasProxyState(_0x1e04f2(0x22d),new Date()[_0x1e04f2(0x1e3)](),i18n['__']('proxy.conFail'));os['platform']()!=_0x1e04f2(0x1e1)&&fs[_0x1e04f2(0x218)](config[_0x1e04f2(0x233)],'777'),cryptoUtils[_0x1e04f2(0x208)](config[_0x1e04f2(0x246)],_0x3ee23f[_0x1e04f2(0x1d6)])[_0x1e04f2(0x205)](_0x4f5b0b=>{const _0x2e2ad6=_0x1e04f2;let _0x339acd=JSON[_0x2e2ad6(0x22b)](_0x4f5b0b),_0x56211f=_0x339acd[_0x2e2ad6(0x231)],_0x33d7e7=_0x339acd[_0x2e2ad6(0x1c3)];_0x56211f[_0x2e2ad6(0x21e)]&&_0x56211f[_0x2e2ad6(0x21e)][_0x2e2ad6(0x21b)]>0x0&&(userToken=_0x56211f[_0x2e2ad6(0x21e)][_0x56211f[_0x2e2ad6(0x21e)][_0x2e2ad6(0x21b)]-0x1]);if(!userToken)return saveNasProxyState('fail',new Date()[_0x2e2ad6(0x1e3)](),i18n['__'](_0x2e2ad6(0x1db)));if(!_0x33d7e7)return saveNasProxyState('fail',new Date()[_0x2e2ad6(0x1e3)](),i18n['__']('proxy.isntVip'));if(_0x33d7e7['type']<0x2)return saveNasProxyState('fail',new Date()[_0x2e2ad6(0x1e3)](),i18n['__']('account.onlyPtSupport'));if(!_0x33d7e7['proxy_subdomain'])return saveNasProxyState(_0x2e2ad6(0x22d),new Date()[_0x2e2ad6(0x1e3)](),i18n['__'](_0x2e2ad6(0x212)));let _0x17e46a=dbConfigTable[_0x2e2ad6(0x244)](dbOther,_0x2e2ad6(0x225));if(!_0x17e46a)return saveNasProxyState(_0x2e2ad6(0x22d),new Date()['getTime'](),i18n['__'](_0x2e2ad6(0x1ca)));apiConfig=JSON[_0x2e2ad6(0x22b)](_0x17e46a['value']);if(!apiConfig[_0x2e2ad6(0x22e)]||apiConfig['state']!=_0x2e2ad6(0x1c2))return saveNasProxyState('fail',new Date()[_0x2e2ad6(0x1e3)](),i18n['__'](_0x2e2ad6(0x1ca)));let _0x2b937f={'token':userToken,'type':_0x2e2ad6(0x20d)};axios[_0x2e2ad6(0x235)](urlConfig[_0x2e2ad6(0x1cc)](dbOther,_0x2e2ad6(0x210)),_0x2b937f)[_0x2e2ad6(0x205)](async _0x3106ef=>{const _0x18dc88=_0x2e2ad6;if(_0x3106ef[_0x18dc88(0x21a)][_0x18dc88(0x1fa)])return saveNasProxyState(_0x18dc88(0x22d),new Date()[_0x18dc88(0x1e3)](),_0x3106ef[_0x18dc88(0x21a)]['msg']?_0x3106ef['data'][_0x18dc88(0x236)]:i18n['__'](_0x18dc88(0x1f6)));else{let _0x1e30aa=_0x3106ef['data'][_0x18dc88(0x1e9)],_0x534a41=null,_0x51e399=dbConfigTable['findByTitle'](dbOther,'proxyServerList');if(_0x51e399&&_0x51e399[_0x18dc88(0x1d6)])try{_0x51e399=JSON[_0x18dc88(0x22b)](_0x51e399[_0x18dc88(0x1d6)]);for(let _0x9e86c5=0x0;_0x9e86c5<_0x1e30aa['length'];_0x9e86c5++){if(_0x2b789f){if(_0x2b789f==_0x1e30aa[_0x9e86c5]['_id']){_0x534a41=_0x1e30aa[_0x9e86c5];break;}}else for(let _0x247849=0x0;_0x247849<_0x51e399[_0x18dc88(0x21b)];_0x247849++){if(_0x51e399[_0x247849][_0x18dc88(0x239)]&&_0x51e399[_0x247849][_0x18dc88(0x252)]==_0x1e30aa[_0x9e86c5]['_id']){_0x534a41=_0x1e30aa[_0x9e86c5];break;}}}}catch(_0x24455e){console[_0x18dc88(0x248)](_0x24455e);}testPing(_0x3106ef[_0x18dc88(0x21a)][_0x18dc88(0x1e9)],_0x534a41?_0x534a41['_id']:null);}})[_0x2e2ad6(0x1bd)](_0x4a9391=>{const _0x4abf8d=_0x2e2ad6;console[_0x4abf8d(0x248)](_0x4a9391);});})['catch'](_0x4c4e81=>{const _0x3458da=_0x1e04f2;console[_0x3458da(0x248)](_0x4c4e81);});};function userReqDns(_0x10f96d,_0x1adfc2){const _0x47b21d=_0x5e5c23;tmpPath=path[_0x47b21d(0x20b)](config[_0x47b21d(0x250)],_0x47b21d(0x204),_0x47b21d(0x1d8));!fs[_0x47b21d(0x24d)](tmpPath)&&fs['mkdirSync'](tmpPath,{'recursive':!![]});let _0x152785=0x1;crtPath=path[_0x47b21d(0x20b)](tmpPath,_0x47b21d(0x1de)),keyPath=path[_0x47b21d(0x20b)](tmpPath,_0x47b21d(0x24a)),axios[_0x47b21d(0x235)](urlConfig[_0x47b21d(0x1cc)](dbOther,'apiProxyUrl'),{'token':userToken,'type':'userReqDns','serverId':_0x1adfc2[_0x47b21d(0x252)],'getKey':_0x152785})[_0x47b21d(0x205)](async _0x43560b=>{const _0x877b1a=_0x47b21d;if(_0x43560b[_0x877b1a(0x21a)]['code'])return saveNasProxyState(_0x877b1a(0x22d),new Date()['getTime'](),_0x43560b[_0x877b1a(0x21a)]['msg']?_0x43560b[_0x877b1a(0x21a)][_0x877b1a(0x236)]:i18n['__'](_0x877b1a(0x1f6)));else{if(_0x152785==0x1){let _0x5721c1=await cryptoUtils[_0x877b1a(0x208)](_0x877b1a(0x230),_0x43560b[_0x877b1a(0x21a)]['crt']),_0x55e934=await cryptoUtils['decryptString']('nasZs987bac',_0x43560b[_0x877b1a(0x21a)][_0x877b1a(0x1f0)]);fs[_0x877b1a(0x249)](crtPath,_0x5721c1),fs[_0x877b1a(0x249)](keyPath,_0x55e934);}connectProxy(_0x10f96d,_0x1adfc2);}})[_0x47b21d(0x1bd)](_0x48d70f=>{const _0x49b00c=_0x47b21d;console[_0x49b00c(0x248)](_0x48d70f);});}function testPing(_0x27a380,_0x782c93){const _0x2f9826=_0x5e5c23;if(_0x27a380[_0x2f9826(0x21b)]<0x1)return saveNasProxyState('fail',new Date()['getTime'](),i18n['__'](_0x2f9826(0x1e6)));let _0xb06f1a=0x0,_0x5cd2f6=null;function _0x1d28c7(){const _0x1f953b=_0x2f9826;if(_0xb06f1a>=_0x27a380[_0x1f953b(0x21b)]){for(let _0x35a307 of _0x27a380){if(_0x782c93&&_0x782c93==_0x35a307['_id']&&_0x35a307[_0x1f953b(0x1e4)]){_0x5cd2f6=_0x35a307,console[_0x1f953b(0x248)](_0x1f953b(0x247),_0x5cd2f6[_0x1f953b(0x1f9)]);break;}if(_0x35a307[_0x1f953b(0x1e4)]&&_0x35a307[_0x1f953b(0x202)]&&_0x35a307['ping_time']!=_0x1f953b(0x1c9)){if(_0x5cd2f6==null)_0x5cd2f6=_0x35a307;else _0x5cd2f6[_0x1f953b(0x202)]*_0x5cd2f6[_0x1f953b(0x21f)]>_0x35a307[_0x1f953b(0x202)]*_0x35a307[_0x1f953b(0x21f)]&&(_0x5cd2f6=_0x35a307);}}if(!_0x5cd2f6)return saveNasProxyState(_0x1f953b(0x22d),new Date()[_0x1f953b(0x1e3)](),i18n['__'](_0x1f953b(0x1e6)));userReqDns(_0x27a380,_0x5cd2f6);}}for(let _0x3facc1 of _0x27a380){let _0x3f60cf=0x1;if(!_0x3facc1[_0x2f9826(0x211)]||!_0x3facc1[_0x2f9826(0x1c5)])_0x3f60cf=0x1;else try{_0x3f60cf=parseInt(_0x3facc1[_0x2f9826(0x211)])/parseInt(_0x3facc1[_0x2f9826(0x1c5)]);}catch(_0xe7b2f3){console[_0x2f9826(0x248)](_0xe7b2f3);}_0x3facc1[_0x2f9826(0x21f)]=_0x3f60cf;}for(let _0x38438e of _0x27a380){ping[_0x2f9826(0x21d)][_0x2f9826(0x23e)](_0x38438e['ip'],{'timeout':0x14})[_0x2f9826(0x205)](function(_0x319416){const _0x439b42=_0x2f9826;_0xb06f1a+=0x1,_0x38438e[_0x439b42(0x1e4)]=_0x319416[_0x439b42(0x1e4)],_0x38438e[_0x439b42(0x202)]=_0x319416[_0x439b42(0x1cf)],_0x1d28c7(),console[_0x439b42(0x248)](_0x439b42(0x1ef),_0x38438e['ip'],_0x319416[_0x439b42(0x1e4)],_0x319416[_0x439b42(0x1cf)]?_0x319416['time']:'\x20TIMEOUT');})[_0x2f9826(0x1bd)](_0x3da609=>{const _0x16b376=_0x2f9826;_0xb06f1a+=0x1,_0x38438e[_0x16b376(0x1e4)]=![],_0x38438e['ping_time']=0x1869f,console[_0x16b376(0x248)]('PING',_0x38438e['ip'],_0x16b376(0x1e5)),_0x1d28c7();});}}function setHealthCheckInterval(){healthCheckInterval&&clearInterval(healthCheckInterval),healthCheckInterval=setInterval(()=>{proxyProcess==null?startProxy():checkFrpConnectHealth();},healthCheckGap*0x3e8);}function tryRestartFrpc(){if(isWaittingTimeout)return;setTimeout(()=>{isWaittingTimeout=![],!frpIsConnected&&startProxy();},0x2710);}function checkFrpConnectHealth(){const _0x263c14=_0x5e5c23;axios[_0x263c14(0x235)](healthCheckUrl+_0x263c14(0x209),{'timeout':0x3a98})['then'](async _0x332e33=>{const _0x395bb9=_0x263c14;_0x332e33[_0x395bb9(0x21a)][_0x395bb9(0x1fa)]?(healthCheckFailCount+=0x1,console[_0x395bb9(0x248)](_0x395bb9(0x1d3),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy())):healthCheckFailCount=0x0;})[_0x263c14(0x1bd)](_0x2c34ea=>{const _0x3d9f5d=_0x263c14;healthCheckFailCount+=0x1,console[_0x3d9f5d(0x248)](_0x3d9f5d(0x1d3),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy());});}async function connectProxy(_0x525bfc,_0xa25cd9){const _0x42a837=_0x5e5c23;for(let _0x5dfe1f of _0x525bfc){_0x5dfe1f[_0x42a837(0x252)]==_0xa25cd9['_id']?_0x5dfe1f['selected']=!![]:_0x5dfe1f['selected']=![];}dbConfigTable[_0x42a837(0x1fc)](dbOther,{'title':'proxyServerList','value':JSON[_0x42a837(0x22f)](_0x525bfc)}),console[_0x42a837(0x248)](_0x42a837(0x1d5),_0xa25cd9['ip']);let _0x4dd8ea=apiConfig[_0x42a837(0x22e)],_0x519839=_0xa25cd9['port'],_0x98ee88=_0xa25cd9[_0x42a837(0x1f4)],_0x2c12f4=path['join'](tmpPath,_0x42a837(0x229)),_0x20f4af=dbConfigTable[_0x42a837(0x227)](dbOther);healthCheckUrl='https://'+_0x98ee88+'.'+urlConfig[_0x42a837(0x1cc)](dbOther,'proxySuffix')+_0x20f4af;let _0x1b5c71=_0x42a837(0x1ec)+_0xa25cd9['ip']+_0x42a837(0x200)+_0x519839+_0x42a837(0x226)+userToken+_0x42a837(0x1d1)+_0x98ee88+_0x42a837(0x1fb)+_0x98ee88+_0x42a837(0x234)+_0x98ee88+_0x42a837(0x217)+_0x4dd8ea+_0x42a837(0x1e2)+_0x4dd8ea+_0x42a837(0x238)+crtPath+_0x42a837(0x219)+keyPath+_0x42a837(0x216)+_0x98ee88+_0x42a837(0x20a)+_0xa25cd9[_0x42a837(0x23a)]+'\x0a';fs[_0x42a837(0x203)](_0x2c12f4,_0x1b5c71,()=>{const _0x142b67=_0x42a837;try{proxyProcess!=null&&proxyProcess[_0x142b67(0x1ed)](),proxyProcess=child_process[_0x142b67(0x1e7)](''+config[_0x142b67(0x233)],['-c',_0x2c12f4],{'detached':![],'killSignal':'SIGTERM'}),proxyProcess['on']('error',function(_0x433ff2){const _0x2d788d=_0x142b67;return console[_0x2d788d(0x248)](_0x2d788d(0x1e0),_0x433ff2),saveNasProxyState(_0x2d788d(0x22d),new Date()[_0x2d788d(0x1e3)](),isWin?i18n['__']('proxy.frpcStartFailWin'):i18n['__'](_0x2d788d(0x224)));});}catch(_0x3c7221){return console[_0x142b67(0x248)](_0x3c7221),saveNasProxyState(_0x142b67(0x22d),new Date()[_0x142b67(0x1e3)](),isWin?i18n['__'](_0x142b67(0x243)):i18n['__'](_0x142b67(0x224)));}proxyProcess['stdout']['on'](_0x142b67(0x21a),_0x58e232=>{const _0x117c9a=_0x142b67;let _0x322310=_0x58e232[_0x117c9a(0x207)]();console[_0x117c9a(0x248)](_0x117c9a(0x1d4),_0x322310);if(_0x322310[_0x117c9a(0x23f)](_0x117c9a(0x245))!=-0x1)console[_0x117c9a(0x248)]('子域名冲突'),frpIsConnected=!![],setHealthCheckInterval(),saveNasProxyState('success',new Date()[_0x117c9a(0x1e3)](),i18n['__'](_0x117c9a(0x24c)));else{if(_0x322310[_0x117c9a(0x23f)]('cannot\x20find\x20the\x20file\x20specified')!=-0x1)startProxy();else{if(_0x322310[_0x117c9a(0x23f)](_0x117c9a(0x241))!=-0x1||_0x322310['indexOf'](_0x117c9a(0x253))!=-0x1){frpIsConnected=![];if(isWaittingTimeout)return;isWaittingTimeout=!![],setTimeout(()=>{const _0x1757eb=_0x117c9a;isWaittingTimeout=![],!frpIsConnected&&_0x322310[_0x1757eb(0x23f)](_0x1757eb(0x1f1))!=-0x1&&(console[_0x1757eb(0x248)](_0x1757eb(0x1eb),_0x322310),startProxy());},0x4e20);}else{if(_0x322310[_0x117c9a(0x23f)]('invalid\x20user')!=-0x1){console[_0x117c9a(0x248)](_0x117c9a(0x1d7),_0x322310);var _0x551e6d=_0x322310[_0x117c9a(0x24b)](_0x117c9a(0x201));let _0xf3692b=_0x322310['substring'](_0x551e6d,_0x322310[_0x117c9a(0x21b)]);saveNasProxyState(_0x117c9a(0x22d),new Date()[_0x117c9a(0x1e3)](),_0xf3692b);}else{if(_0x322310[_0x117c9a(0x23f)](_0x117c9a(0x1df))!=-0x1)frpIsConnected=!![],retryCount=0x0,console['log'](_0x117c9a(0x1dc)),saveNasProxyState('success',new Date()[_0x117c9a(0x1e3)](),i18n['__'](_0x117c9a(0x24c))),dbOther[_0x117c9a(0x1fd)](_0x117c9a(0x1c8))[_0x117c9a(0x1c2)](proxyProcess[_0x117c9a(0x1f3)]+''),fs['rm'](crtPath,()=>{}),fs['rm'](keyPath,()=>{}),fs['rm'](_0x2c12f4,()=>{}),setHealthCheckInterval();else{if(_0x322310['indexOf'](_0x117c9a(0x206))!=-0x1)saveNasProxyState(_0x117c9a(0x22d),new Date()[_0x117c9a(0x1e3)](),i18n['__'](_0x117c9a(0x215)));else{if(_0x322310[_0x117c9a(0x23f)](_0x117c9a(0x1fe))!=-0x1)saveNasProxyState('fail',new Date()[_0x117c9a(0x1e3)](),i18n['__'](_0x117c9a(0x1fe))),tryRestartFrpc();else _0x322310[_0x117c9a(0x23f)](_0x117c9a(0x20f))!=-0x1&&tryRestartFrpc();}}}}}}}),proxyProcess[_0x142b67(0x1da)]['on'](_0x142b67(0x21a),_0x5126f7=>{const _0x31e44f=_0x142b67;let _0x5c9029=_0x5126f7[_0x31e44f(0x207)]();console['log'](_0x31e44f(0x1c4),_0x5c9029),_0x5c9029[_0x31e44f(0x23f)](_0x31e44f(0x1f7))==-0x1&&_0x5c9029[_0x31e44f(0x23f)](_0x31e44f(0x20c))==-0x1&&_0x5c9029[_0x31e44f(0x23f)](_0x31e44f(0x1c7))==-0x1&&(frpIsConnected=![]),tryRestartFrpc();}),proxyProcess['on'](_0x142b67(0x228),_0x50c94c=>{console['log']('frpc\x20stopped'),frpIsConnected=![],stopProxy();});});}