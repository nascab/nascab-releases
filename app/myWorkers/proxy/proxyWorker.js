const _0x1561fb=_0xccb8;(function(_0x5b4d57,_0x3eac03){const _0x3915a=_0xccb8,_0x4f9089=_0x5b4d57();while(!![]){try{const _0x134b3f=-parseInt(_0x3915a(0xff))/0x1+-parseInt(_0x3915a(0x10f))/0x2+-parseInt(_0x3915a(0x104))/0x3+parseInt(_0x3915a(0xe1))/0x4*(parseInt(_0x3915a(0x12e))/0x5)+-parseInt(_0x3915a(0x11d))/0x6+-parseInt(_0x3915a(0xf4))/0x7+parseInt(_0x3915a(0x13a))/0x8*(parseInt(_0x3915a(0xd3))/0x9);if(_0x134b3f===_0x3eac03)break;else _0x4f9089['push'](_0x4f9089['shift']());}catch(_0x2bc957){_0x4f9089['push'](_0x4f9089['shift']());}}}(_0x5876,0x292dd));let path=require(_0x1561fb(0xfd)),fs=require('fs'),os=require('os'),child_process=require(_0x1561fb(0x127)),proxyProcess=null;const config=require(_0x1561fb(0x147)),Database=require(_0x1561fb(0x12a));let dbOther=new Database(config[_0x1561fb(0x121)],{});dbOther[_0x1561fb(0xfa)](_0x1561fb(0x10d));let dbConfigTable=require(_0x1561fb(0xdf)),cryptoUtils=require('../../express-server/utils/cryptoUtils'),axios=require(_0x1561fb(0x137)),i18nUtil=require('../../utils/i18nUtil'),retryCount=0x0,maxRetryCount=0x9184e729fff,tmpPath,apiConfig,userToken,crtPath,keyPath,i18n;var ping=require(_0x1561fb(0xc5));let isWin=os['platform']()==_0x1561fb(0xe4),frpIsConnected=![],isWaittingTimeout=![],urlConfig=require(_0x1561fb(0x14d));process[_0x1561fb(0xfc)]=_0x1561fb(0xf0);const healthCheckGap=0x1e;let healthCheckInterval=null,healthCheckUrl='',healthCheckFailCount=0x0,maxhealthCheckFailCount=0x3;process['on'](_0x1561fb(0xe6),()=>{const _0x1a9824=_0x1561fb;console[_0x1a9824(0x154)](_0x1a9824(0xfe)),stopProxy(),dbOther[_0x1a9824(0xf1)]();}),process['on'](_0x1561fb(0xca),_0x497261=>{const _0x4f9fe4=_0x1561fb;if(_0x497261[_0x4f9fe4(0xcc)]==_0x4f9fe4(0x120))console[_0x4f9fe4(0x154)]('message：start'),startProxy();else{if(_0x497261[_0x4f9fe4(0xcc)]==_0x4f9fe4(0xf7))console['log'](_0x4f9fe4(0x111)),stopProxy();else _0x497261['type']=='reset'&&(console[_0x4f9fe4(0x154)](_0x4f9fe4(0x14f)),_0x497261['msg']&&_0x497261[_0x4f9fe4(0xdd)][_0x4f9fe4(0xe0)]?resetProxy(_0x497261[_0x4f9fe4(0xdd)]['serverId']):resetProxy());}});let stopProxy=function(){const _0x2f62b8=_0x1561fb;proxyProcess&&(proxyProcess[_0x2f62b8(0x12f)](),console[_0x2f62b8(0x154)](_0x2f62b8(0x11e)),proxyProcess=null);};function saveNasProxyState(_0x54c3c5,_0x1c3b54,_0x3b471b){const _0x4bb75c=_0x1561fb;if(_0x3b471b)console['log'](_0x3b471b);dbConfigTable['create'](dbOther,{'title':'nasRemoteState','value':JSON[_0x4bb75c(0xc4)]({'status':_0x54c3c5,'time':_0x1c3b54,'error':_0x3b471b})});}function _0x5876(){const _0x2ea539=['data','193140yTwUWh','proxy.frpcStartFailWin','spawn','\x0apool_count\x20=\x201\x0atcp_mux\x20=\x20true\x0a\x0a[','apiServer','错误输出','catch','server_bandwidth','未登录\x20不连接内网穿透','journal_mode\x20=\x20WAL','FRP\x20Connected','309204qPljyB','writeFileSync','message：stop','getTime','TLS\x20handshake\x20error','首选服务器','success','validServer','proxy_subdomain','frpcPath','platform','invalid\x20user','-https]\x0atype\x20=\x20https\x0alocal_port\x20=\x20','proxyServerList','613062CvJPvJ','远程代理停止','router\x20config\x20conflict','start','dbOther','indexOf','error','decryptString','join','run','child_process','getUrlByUrlKey','fail','better-sqlite3','tmp','proxy.noLoginInfo','start\x20proxy\x20success','430siRosY','kill','findByTitle','probe','正在连接远程代理,重试次数:','vipInfo','\x20TIMEOUT','frpc\x20stopped','nasAccountInfoConfigKey','axios','stderr','\x0aplugin_crt_path\x20=\x20','6790048irtLfN','token','stdout','netRate','chmodSync','tmp_crt','selected','ping_time','crt','\x0aplugin_host_header_rewrite\x20=\x20127.0.0.1\x0aplugin_header_X-From-Where\x20=\x20NasCab\x0asubdomain\x20=\x20','errMsg','bandwidth','port','../../myConfig/config','then','toString','alive','proxy.frpcStartFail','pid','../../myConfig/urlConfig','getProxyServer','message：reset','nasAccountInfoPwd','proxy.frpcNoExist','\x0a[common]\x0aserver_addr\x20=\x20','getServerRootPath','log','proxyConfig','userInfo','proxy.noUsableServer','user_count','stringify','ping','\x20refused','stopped','REPLACE\x20INTO\x20process_record(process_id)\x20VALUES(?)','proxy.conSuc','message','proxy','type','proxySuffix','nasRemoteEnable','time','key','_id','post','9ByJwch','mkdirSync','nasZs987bac','PING','getI18n','\x22\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0ameta_subdomain=','proxy.conFail','proxy.timeout','value','promise','msg','existsSync','../../db/dbConfigTable','serverId','3808hqusSG','---Connection\x20error\x20，\x20reconnecting\x20frpc---','\x20error','win32','show_name','exit','\x0asubdomain\x20=\x20','tmp/proxy/tmp_crt','wsarecv','远程连接未启用','/api/healthCheck','\x0aplugin_key_path\x20=\x20\x20','create','code','userDataFolder','NasCabFrpWorker','close','context\x20canceled','\x0aplugin\x20=\x20https2http\x0aplugin_local_addr\x20=\x20127.0.0.1:','2022461veAqUi','FRP\x20Connection\x20health\x20check\x20fail:','proxy.noSubdomain','stop','proxy.noExpress','userReqDns','pragma','length','title','path','远程代理线程退出','151877DTATLm','https://','SIGTERM','parse'];_0x5876=function(){return _0x2ea539;};return _0x5876();}let resetProxy=async function(_0x175be0){retryCount=0x0,startProxy(_0x175be0);},startProxy=async function(_0x6f87df){const _0x4f4890=_0x1561fb;i18n=i18nUtil[_0x4f4890(0xd7)](dbOther),stopProxy();let _0x371e44=dbConfigTable[_0x4f4890(0x130)](dbOther,_0x4f4890(0xce));if(!_0x371e44||_0x371e44&&_0x371e44[_0x4f4890(0xdb)]!=0x1)return console[_0x4f4890(0x154)](_0x4f4890(0xea)),saveNasProxyState(_0x4f4890(0x129),new Date()['getTime'](),i18n['__']('proxy.disable'));console['log'](_0x4f4890(0x132),retryCount);let _0x51bb9f=dbConfigTable['findByTitle'](dbOther,config[_0x4f4890(0x136)]);if(!_0x51bb9f)return console[_0x4f4890(0x154)](_0x4f4890(0x10c)),saveNasProxyState(_0x4f4890(0x129),new Date()[_0x4f4890(0x112)](),i18n['__'](_0x4f4890(0x12c)));if(!fs[_0x4f4890(0xde)](config[_0x4f4890(0x118)]))return saveNasProxyState('fail',new Date()[_0x4f4890(0x112)](),i18n['__'](_0x4f4890(0x151)));retryCount+=0x1;if(retryCount>=maxRetryCount)return saveNasProxyState(_0x4f4890(0x129),new Date()[_0x4f4890(0x112)](),i18n['__'](_0x4f4890(0xd9)));os[_0x4f4890(0x119)]()!=_0x4f4890(0xe4)&&fs[_0x4f4890(0x13e)](config[_0x4f4890(0x118)],'777'),cryptoUtils[_0x4f4890(0x124)](config[_0x4f4890(0x150)],_0x51bb9f[_0x4f4890(0xdb)])[_0x4f4890(0x148)](_0x717789=>{const _0x5629ad=_0x4f4890;let _0x12e67a=JSON[_0x5629ad(0x102)](_0x717789),_0x5d70b4=_0x12e67a[_0x5629ad(0x156)],_0x25f96f=_0x12e67a[_0x5629ad(0x133)];_0x5d70b4[_0x5629ad(0x13b)]&&_0x5d70b4[_0x5629ad(0x13b)][_0x5629ad(0xfb)]>0x0&&(userToken=_0x5d70b4[_0x5629ad(0x13b)][_0x5d70b4['token'][_0x5629ad(0xfb)]-0x1]);if(!userToken)return saveNasProxyState('fail',new Date()[_0x5629ad(0x112)](),i18n['__'](_0x5629ad(0x12c)));if(!_0x25f96f)return saveNasProxyState(_0x5629ad(0x129),new Date()[_0x5629ad(0x112)](),i18n['__']('proxy.isntVip'));if(_0x25f96f['type']<0x2)return saveNasProxyState(_0x5629ad(0x129),new Date()[_0x5629ad(0x112)](),i18n['__']('account.onlyPtSupport'));if(!_0x25f96f[_0x5629ad(0x117)])return saveNasProxyState(_0x5629ad(0x129),new Date()['getTime'](),i18n['__'](_0x5629ad(0xf6)));let _0x10e4de=dbConfigTable[_0x5629ad(0x130)](dbOther,_0x5629ad(0x108));if(!_0x10e4de)return saveNasProxyState('fail',new Date()[_0x5629ad(0x112)](),i18n['__'](_0x5629ad(0xf8)));apiConfig=JSON[_0x5629ad(0x102)](_0x10e4de['value']);if(!apiConfig['port']||apiConfig['state']!=_0x5629ad(0x126))return saveNasProxyState(_0x5629ad(0x129),new Date()[_0x5629ad(0x112)](),i18n['__'](_0x5629ad(0xf8)));let _0x5f2f12={'token':userToken,'type':_0x5629ad(0x14e)};axios[_0x5629ad(0xd2)](urlConfig[_0x5629ad(0x128)](dbOther,'apiProxyUrl'),_0x5f2f12)[_0x5629ad(0x148)](async _0x3b6ee6=>{const _0x2871a2=_0x5629ad;if(_0x3b6ee6[_0x2871a2(0x103)][_0x2871a2(0xee)])return saveNasProxyState(_0x2871a2(0x129),new Date()[_0x2871a2(0x112)](),_0x3b6ee6[_0x2871a2(0x103)][_0x2871a2(0xdd)]?_0x3b6ee6[_0x2871a2(0x103)][_0x2871a2(0xdd)]:i18n['__'](_0x2871a2(0xd9)));else{let _0x1815c0=_0x3b6ee6[_0x2871a2(0x103)][_0x2871a2(0x116)],_0x39dffc=null,_0x524b86=dbConfigTable[_0x2871a2(0x130)](dbOther,'proxyServerList');if(_0x524b86&&_0x524b86[_0x2871a2(0xdb)])try{_0x524b86=JSON[_0x2871a2(0x102)](_0x524b86['value']);for(let _0xd4b1ab=0x0;_0xd4b1ab<_0x1815c0[_0x2871a2(0xfb)];_0xd4b1ab++){if(_0x6f87df){if(_0x6f87df==_0x1815c0[_0xd4b1ab][_0x2871a2(0xd1)]){_0x39dffc=_0x1815c0[_0xd4b1ab];break;}}else for(let _0x3fa91c=0x0;_0x3fa91c<_0x524b86[_0x2871a2(0xfb)];_0x3fa91c++){if(_0x524b86[_0x3fa91c][_0x2871a2(0x140)]&&_0x524b86[_0x3fa91c][_0x2871a2(0xd1)]==_0x1815c0[_0xd4b1ab][_0x2871a2(0xd1)]){_0x39dffc=_0x1815c0[_0xd4b1ab];break;}}}}catch(_0x5ebbf3){console[_0x2871a2(0x154)](_0x5ebbf3);}testPing(_0x3b6ee6[_0x2871a2(0x103)][_0x2871a2(0x116)],_0x39dffc?_0x39dffc[_0x2871a2(0xd1)]:null);}})[_0x5629ad(0x10a)](_0xc6ccb6=>{const _0x2deae0=_0x5629ad;console[_0x2deae0(0x154)](_0xc6ccb6);});})[_0x4f4890(0x10a)](_0x32ce82=>{const _0x450954=_0x4f4890;console[_0x450954(0x154)](_0x32ce82);});};function userReqDns(_0x4dbd99,_0x20eb30){const _0x48fa59=_0x1561fb;tmpPath=path[_0x48fa59(0x125)](config[_0x48fa59(0xef)],_0x48fa59(0x12b),_0x48fa59(0xcb));!fs[_0x48fa59(0xde)](tmpPath)&&fs[_0x48fa59(0xd4)](tmpPath,{'recursive':!![]});let _0x1d3d3c=0x1;crtPath=path[_0x48fa59(0x125)](tmpPath,_0x48fa59(0x13f)),keyPath=path[_0x48fa59(0x125)](tmpPath,'tmp_key'),axios[_0x48fa59(0xd2)](urlConfig[_0x48fa59(0x128)](dbOther,'apiProxyUrl'),{'token':userToken,'type':_0x48fa59(0xf9),'serverId':_0x20eb30['_id'],'getKey':_0x1d3d3c})[_0x48fa59(0x148)](async _0x1a778f=>{const _0x55661a=_0x48fa59;if(_0x1a778f['data'][_0x55661a(0xee)])return saveNasProxyState(_0x55661a(0x129),new Date()[_0x55661a(0x112)](),_0x1a778f[_0x55661a(0x103)][_0x55661a(0xdd)]?_0x1a778f['data'][_0x55661a(0xdd)]:i18n['__'](_0x55661a(0xd9)));else{if(_0x1d3d3c==0x1){let _0x3fb7c1=await cryptoUtils[_0x55661a(0x124)](_0x55661a(0xd5),_0x1a778f[_0x55661a(0x103)][_0x55661a(0x142)]),_0x19eb94=await cryptoUtils[_0x55661a(0x124)]('nasZs987bac',_0x1a778f[_0x55661a(0x103)][_0x55661a(0xd0)]);fs[_0x55661a(0x110)](crtPath,_0x3fb7c1),fs[_0x55661a(0x110)](keyPath,_0x19eb94);}connectProxy(_0x4dbd99,_0x20eb30);}})[_0x48fa59(0x10a)](_0x379597=>{const _0x62ed4=_0x48fa59;console[_0x62ed4(0x154)](_0x379597);});}function _0xccb8(_0x4f5c64,_0x29286c){const _0x58769d=_0x5876();return _0xccb8=function(_0xccb812,_0x5ea90b){_0xccb812=_0xccb812-0xc3;let _0x3aa47d=_0x58769d[_0xccb812];return _0x3aa47d;},_0xccb8(_0x4f5c64,_0x29286c);}function testPing(_0x11f580,_0x451f8b){const _0x319a7e=_0x1561fb;if(_0x11f580[_0x319a7e(0xfb)]<0x1)return saveNasProxyState(_0x319a7e(0x129),new Date()[_0x319a7e(0x112)](),i18n['__']('proxy.noUsableServer'));let _0x15f4fe=0x0,_0xddc7fc=null;function _0x3e5c53(){const _0x9e32f6=_0x319a7e;if(_0x15f4fe>=_0x11f580[_0x9e32f6(0xfb)]){for(let _0xda1f84 of _0x11f580){if(_0x451f8b&&_0x451f8b==_0xda1f84[_0x9e32f6(0xd1)]&&_0xda1f84['alive']){_0xddc7fc=_0xda1f84,console[_0x9e32f6(0x154)](_0x9e32f6(0x114),_0xddc7fc[_0x9e32f6(0xe5)]);break;}if(_0xda1f84[_0x9e32f6(0x14a)]&&_0xda1f84[_0x9e32f6(0x141)]&&_0xda1f84[_0x9e32f6(0x141)]!='unknown'){if(_0xddc7fc==null)_0xddc7fc=_0xda1f84;else _0xddc7fc['ping_time']*_0xddc7fc['netRate']>_0xda1f84[_0x9e32f6(0x141)]*_0xda1f84[_0x9e32f6(0x13d)]&&(_0xddc7fc=_0xda1f84);}}if(!_0xddc7fc)return saveNasProxyState('fail',new Date()[_0x9e32f6(0x112)](),i18n['__'](_0x9e32f6(0x157)));userReqDns(_0x11f580,_0xddc7fc);}}for(let _0x45efe4 of _0x11f580){let _0x125a9e=0x1;if(!_0x45efe4[_0x319a7e(0xc3)]||!_0x45efe4[_0x319a7e(0x10b)])_0x125a9e=0x1;else try{_0x125a9e=parseInt(_0x45efe4['user_count'])/parseInt(_0x45efe4['server_bandwidth']);}catch(_0x27e5d1){console[_0x319a7e(0x154)](_0x27e5d1);}_0x45efe4[_0x319a7e(0x13d)]=_0x125a9e;}for(let _0x198fd2 of _0x11f580){ping[_0x319a7e(0xdc)][_0x319a7e(0x131)](_0x198fd2['ip'],{'timeout':0x14})['then'](function(_0x321976){const _0x1a560e=_0x319a7e;_0x15f4fe+=0x1,_0x198fd2[_0x1a560e(0x14a)]=_0x321976[_0x1a560e(0x14a)],_0x198fd2[_0x1a560e(0x141)]=_0x321976[_0x1a560e(0xcf)],_0x3e5c53(),console[_0x1a560e(0x154)](_0x1a560e(0xd6),_0x198fd2['ip'],_0x321976[_0x1a560e(0x14a)],_0x321976[_0x1a560e(0xcf)]?_0x321976[_0x1a560e(0xcf)]:_0x1a560e(0x134));})[_0x319a7e(0x10a)](_0x32a7f6=>{const _0x427c45=_0x319a7e;_0x15f4fe+=0x1,_0x198fd2[_0x427c45(0x14a)]=![],_0x198fd2[_0x427c45(0x141)]=0x1869f,console[_0x427c45(0x154)](_0x427c45(0xd6),_0x198fd2['ip'],_0x427c45(0x134)),_0x3e5c53();});}}function setHealthCheckInterval(){healthCheckInterval&&clearInterval(healthCheckInterval),healthCheckInterval=setInterval(()=>{proxyProcess==null?startProxy():checkFrpConnectHealth();},healthCheckGap*0x3e8);}function tryRestartFrpc(){if(isWaittingTimeout)return;setTimeout(()=>{isWaittingTimeout=![],!frpIsConnected&&startProxy();},0x2710);}function checkFrpConnectHealth(){const _0x5da1c6=_0x1561fb;axios[_0x5da1c6(0xd2)](healthCheckUrl+_0x5da1c6(0xeb),{'timeout':0x3a98})['then'](async _0x3dad59=>{const _0x424872=_0x5da1c6;_0x3dad59[_0x424872(0x103)][_0x424872(0xee)]?(healthCheckFailCount+=0x1,console[_0x424872(0x154)](_0x424872(0xf5),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy())):healthCheckFailCount=0x0;})[_0x5da1c6(0x10a)](_0x260e7f=>{const _0xed5ef1=_0x5da1c6;healthCheckFailCount+=0x1,console[_0xed5ef1(0x154)](_0xed5ef1(0xf5),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy());});}async function connectProxy(_0x3eb044,_0x38f871){const _0x421e8d=_0x1561fb;for(let _0x38fbe6 of _0x3eb044){_0x38fbe6[_0x421e8d(0xd1)]==_0x38f871[_0x421e8d(0xd1)]?_0x38fbe6[_0x421e8d(0x140)]=!![]:_0x38fbe6[_0x421e8d(0x140)]=![];}dbConfigTable[_0x421e8d(0xed)](dbOther,{'title':_0x421e8d(0x11c),'value':JSON[_0x421e8d(0xc4)](_0x3eb044)}),console[_0x421e8d(0x154)]('已选代理服务器',_0x38f871['ip']);let _0xfd2bbb=apiConfig[_0x421e8d(0x146)],_0x1645b4=_0x38f871[_0x421e8d(0x146)],_0x2ef70f=_0x38f871[_0x421e8d(0x117)],_0x4c68af=path[_0x421e8d(0x125)](tmpPath,_0x421e8d(0x155)),_0x1e13f5=dbConfigTable[_0x421e8d(0x153)](dbOther);healthCheckUrl=_0x421e8d(0x100)+_0x2ef70f+'.'+urlConfig[_0x421e8d(0x128)](dbOther,_0x421e8d(0xcd))+_0x1e13f5;let _0x3717dc=_0x421e8d(0x152)+_0x38f871['ip']+'\x0aserver_port\x20=\x20'+_0x1645b4+'\x0auser=\x22'+userToken+_0x421e8d(0xd8)+_0x2ef70f+_0x421e8d(0xe7)+_0x2ef70f+_0x421e8d(0x107)+_0x2ef70f+_0x421e8d(0x11b)+_0xfd2bbb+_0x421e8d(0xf3)+_0xfd2bbb+_0x421e8d(0x139)+crtPath+_0x421e8d(0xec)+keyPath+_0x421e8d(0x143)+_0x2ef70f+'\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0abandwidth_limit\x20=\x20'+_0x38f871[_0x421e8d(0x145)]+'\x0a';fs['writeFile'](_0x4c68af,_0x3717dc,()=>{const _0x15cfed=_0x421e8d;try{proxyProcess!=null&&proxyProcess[_0x15cfed(0x12f)](),proxyProcess=child_process[_0x15cfed(0x106)](''+config[_0x15cfed(0x118)],['-c',_0x4c68af],{'detached':![],'killSignal':_0x15cfed(0x101)}),proxyProcess['on'](_0x15cfed(0x123),function(_0x5d5aa5){const _0x280bf8=_0x15cfed;return console[_0x280bf8(0x154)]('frpc\x20process\x20error',_0x5d5aa5),saveNasProxyState(_0x280bf8(0x129),new Date()['getTime'](),isWin?i18n['__'](_0x280bf8(0x105)):i18n['__'](_0x280bf8(0x14b)));});}catch(_0x4e8271){return console['log'](_0x4e8271),saveNasProxyState(_0x15cfed(0x129),new Date()['getTime'](),isWin?i18n['__']('proxy.frpcStartFailWin'):i18n['__'](_0x15cfed(0x14b)));}proxyProcess[_0x15cfed(0x13c)]['on'](_0x15cfed(0x103),_0x30138b=>{const _0x131351=_0x15cfed;let _0x5afb52=_0x30138b[_0x131351(0x149)]();console[_0x131351(0x154)]('数据输出',_0x5afb52);if(_0x5afb52[_0x131351(0x122)](_0x131351(0x11f))!=-0x1)console[_0x131351(0x154)]('子域名冲突'),frpIsConnected=!![],setHealthCheckInterval(),saveNasProxyState('success',new Date()['getTime'](),i18n['__']('proxy.conSuc'));else{if(_0x5afb52[_0x131351(0x122)]('cannot\x20find\x20the\x20file\x20specified')!=-0x1)startProxy();else{if(_0x5afb52[_0x131351(0x122)](_0x131351(0xe3))!=-0x1||_0x5afb52[_0x131351(0x122)](_0x131351(0xc6))!=-0x1){frpIsConnected=![];if(isWaittingTimeout)return;isWaittingTimeout=!![],setTimeout(()=>{const _0x28764d=_0x131351;isWaittingTimeout=![],!frpIsConnected&&_0x5afb52[_0x28764d(0x122)]('retry')!=-0x1&&(console[_0x28764d(0x154)](_0x28764d(0xe2),_0x5afb52),startProxy());},0x4e20);}else{if(_0x5afb52[_0x131351(0x122)](_0x131351(0x11a))!=-0x1){console[_0x131351(0x154)](_0x131351(0x144),_0x5afb52);var _0x41b193=_0x5afb52['lastIndexOf'](_0x131351(0x11a));let _0x6a0b95=_0x5afb52['substring'](_0x41b193,_0x5afb52['length']);saveNasProxyState(_0x131351(0x129),new Date()[_0x131351(0x112)](),_0x6a0b95);}else{if(_0x5afb52[_0x131351(0x122)](_0x131351(0x12d))!=-0x1)frpIsConnected=!![],retryCount=0x0,console[_0x131351(0x154)](_0x131351(0x10e)),saveNasProxyState(_0x131351(0x115),new Date()['getTime'](),i18n['__'](_0x131351(0xc9))),dbOther['prepare'](_0x131351(0xc8))[_0x131351(0x126)](proxyProcess[_0x131351(0x14c)]+''),fs['rm'](crtPath,()=>{}),fs['rm'](keyPath,()=>{}),fs['rm'](_0x4c68af,()=>{}),setHealthCheckInterval();else{if(_0x5afb52[_0x131351(0x122)]('operation\x20timed\x20out')!=-0x1)saveNasProxyState(_0x131351(0x129),new Date()[_0x131351(0x112)](),i18n['__'](_0x131351(0xda)));else{if(_0x5afb52[_0x131351(0x122)](_0x131351(0xc7))!=-0x1)saveNasProxyState(_0x131351(0x129),new Date()['getTime'](),i18n['__'](_0x131351(0xc7))),tryRestartFrpc();else _0x5afb52[_0x131351(0x122)](_0x131351(0xe8))!=-0x1&&tryRestartFrpc();}}}}}}}),proxyProcess[_0x15cfed(0x138)]['on'](_0x15cfed(0x103),_0x60eed5=>{const _0x1a2104=_0x15cfed;let _0x17a1e6=_0x60eed5[_0x1a2104(0x149)]();console[_0x1a2104(0x154)](_0x1a2104(0x109),_0x17a1e6),_0x17a1e6['indexOf'](_0x1a2104(0xe9))==-0x1&&_0x17a1e6['indexOf'](_0x1a2104(0xf2))==-0x1&&_0x17a1e6[_0x1a2104(0x122)](_0x1a2104(0x113))==-0x1&&(frpIsConnected=![]),tryRestartFrpc();}),proxyProcess['on'](_0x15cfed(0xf1),_0x477398=>{const _0xabcd1d=_0x15cfed;console['log'](_0xabcd1d(0x135)),frpIsConnected=![],stopProxy();});});}