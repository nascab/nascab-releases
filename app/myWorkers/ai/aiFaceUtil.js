function _0x4f35(_0x3c533a,_0x1606a6){const _0x411aaa=_0x411a();return _0x4f35=function(_0x4f350c,_0x4ee41d){_0x4f350c=_0x4f350c-0x140;let _0x11634f=_0x411aaa[_0x4f350c];return _0x11634f;},_0x4f35(_0x3c533a,_0x1606a6);}const _0x48c5b9=_0x4f35;(function(_0x2f8c84,_0x45f575){const _0x5360fb=_0x4f35,_0x2d017e=_0x2f8c84();while(!![]){try{const _0x5d508c=parseInt(_0x5360fb(0x1b0))/0x1*(parseInt(_0x5360fb(0x1c3))/0x2)+-parseInt(_0x5360fb(0x191))/0x3*(-parseInt(_0x5360fb(0x16e))/0x4)+parseInt(_0x5360fb(0x188))/0x5+-parseInt(_0x5360fb(0x1ae))/0x6+-parseInt(_0x5360fb(0x18c))/0x7*(parseInt(_0x5360fb(0x15e))/0x8)+-parseInt(_0x5360fb(0x14c))/0x9+-parseInt(_0x5360fb(0x150))/0xa*(-parseInt(_0x5360fb(0x1a0))/0xb);if(_0x5d508c===_0x45f575)break;else _0x2d017e['push'](_0x2d017e['shift']());}catch(_0x15599d){_0x2d017e['push'](_0x2d017e['shift']());}}}(_0x411a,0xe1eed));const fs=require('fs'),path=require(_0x48c5b9(0x18a)),tfjs=require(_0x48c5b9(0x175)),wasm=require(_0x48c5b9(0x14e)),sharpUtil=require(_0x48c5b9(0x1aa)),exifUtils=require(_0x48c5b9(0x153)),urlConfig=require(_0x48c5b9(0x176)),faceapi=require(_0x48c5b9(0x1ab)),config=require(_0x48c5b9(0x1b8)),Database=require(_0x48c5b9(0x1a5)),https=require(_0x48c5b9(0x1bf)),dbConfigTable=require(_0x48c5b9(0x15c));function _0x411a(){const _0x464963=['SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20(type=1\x20OR\x20type=2)\x20AND\x20ai_face_detect_state=0\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20is_raw!=1\x20\x20LIMIT\x201','\x20SET\x20compare_state=1\x20where\x20id=','lastInsertRowid','30356Xfhajl','getSharpInstanceFromInput','withFaceLandmarks','faceLandmark68Net','then','photo_faces','pipe','tmp_','findByTitle','face_landmark_68_tiny_model-weights_manifest.json','SELECT\x20*\x20from\x20','slice','AI_FACES','engine','7495587IuvLdL','pragma','@tensorflow/tfjs-backend-wasm','\x20where\x20face_id\x20in\x20','20ehQXxp','UPDATE\x20','join','../../utils/exifUtils','\x20WHERE\x20\x20compare_state=0\x20\x20and\x20face_id\x20is\x20null\x20LIMIT\x201','\x20SET\x20face_id=','all','nets','push','deleteRawTempFile','face_landmark_68_model-weights_manifest.json','exit','../../db/dbConfigTable','findBestMatch','8punmVr','error','loadFromDisk','face_recognition_model.bin','value','createWriteStream','userDataFolder','FaceMatcher','dbOther','ready','(face_descriptor)\x20VALUES(?)','\x20WHERE\x20id=','ssd_mobilenetv1_model-weights_manifest.json','faceapi_models','face_descriptor','uncaughtException','40SSVlCx','_score','wasm','existsSync','endScope','min_similar_score','detection','@tensorflow/tfjs','../../myConfig/urlConfig','modeUrl_ai_face','descriptor','stat','keys','toBuffer','NasCabAiFace','rotate','prepare','\x20where\x20id!=','UPDATE\x20bg_task\x20SET\x20task_state=2\x20where\x20id=','log','UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id=','getRotateFromTags','\x20where\x20belong_face_id\x20is\x20null','journal_mode\x20=\x20WAL','run','faceRecognitionNet','6763725zCrVts','get','path','\x20where\x20face_photo_count<1\x20and\x20belong_face_id\x20is\x20null','1379217DjqPoO','dispose','width','tiny_path','tensor','506697WetLaJ','face_recognition_model-weights_manifest.json','renameSync','close','values','\x20where\x20id=','\x20AND\x20(type=1\x20OR\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20ai_face_detect_state=0\x20\x20AND\x20is_raw!=1\x20LIMIT\x201','INSERT\x20INTO\x20bg_task(task_type)\x20VALUES(?)','REPLACE\x20INTO\x20\x20','\x20where\x20belong_face_id=','dbFileIndex','height','face_id','startScope','face_landmark_68_model.bin','3205037ycRhkC','getUrlByUrlKey','resize','aiFaceEnable','filename','better-sqlite3',',\x20compare_state=1\x20where\x20id\x20=\x20','withFaceDescriptors','_width','photo_faces2index','../../express-server/utils/sharpUtils','../../libs/faceapi/face-api.node-wasm','UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id=','message','10743588oWAobd','(photo_index_id,score,x,y,width,height,face_descriptor)\x20\x20VALUES(?,?,?,?,?,?,?)','8HkwRpp','_height','_box','stringify','REPLACE\x20INTO\x20','ssdMobilenetv1','_distance','parse','../../myConfig/config','SELECT\x20id\x20from\x20','length','send','finish','channels','title','https'];_0x411a=function(){return _0x464963;};return _0x411a();}process[_0x48c5b9(0x1be)]=_0x48c5b9(0x17c);let dbFileIndex=new Database(config[_0x48c5b9(0x19b)],{}),dbOther=new Database(config[_0x48c5b9(0x166)],{});dbOther['pragma'](_0x48c5b9(0x185)),dbFileIndex[_0x48c5b9(0x14d)](_0x48c5b9(0x185)),process['on']('exit',()=>{const _0x4ffa31=_0x48c5b9;dbOther[_0x4ffa31(0x194)](),dbFileIndex['close']();});const DEAL_GAP=0x7530;let TABLE_NAME_FACE2INDEX=_0x48c5b9(0x1a9),TABLE_NAME_PHOTO_FACES=_0x48c5b9(0x143),modelInit=![],modelSavePath=path[_0x48c5b9(0x152)](config[_0x48c5b9(0x164)],'tfModel',_0x48c5b9(0x16b));!fs[_0x48c5b9(0x171)](modelSavePath)&&fs['mkdirSync'](modelSavePath,{'recursive':!![]});let modelBaseUrl=urlConfig[_0x48c5b9(0x1a1)](dbOther,_0x48c5b9(0x177)),modelFileUrlList=[],modelFileList=['face_landmark_68_tiny_model.bin',_0x48c5b9(0x147),_0x48c5b9(0x161),_0x48c5b9(0x192),'ssd_mobilenetv1_model.bin',_0x48c5b9(0x16a),_0x48c5b9(0x19f),_0x48c5b9(0x15a)];for(let i=0x0;i<modelFileList[_0x48c5b9(0x1ba)];i++){modelFileUrlList[_0x48c5b9(0x158)](modelBaseUrl+modelFileList[i]);}function httpDownload(_0x454a64,_0x1df543,_0x31f4b1){return new Promise((_0x5215dd,_0x212720)=>{const _0xd78700=_0x4f35;https[_0xd78700(0x189)](_0x454a64,_0x4ad2f5=>{const _0x4873ec=_0xd78700,_0x26aac3=fs[_0x4873ec(0x163)](_0x1df543);_0x4ad2f5[_0x4873ec(0x144)](_0x26aac3),_0x26aac3['on'](_0x4873ec(0x1bc),()=>{const _0x24c4ce=_0x4873ec;_0x26aac3[_0x24c4ce(0x194)](),fs[_0x24c4ce(0x193)](_0x1df543,_0x31f4b1),_0x5215dd();})['on'](_0x4873ec(0x15f),_0x276814=>{});})['on'](_0xd78700(0x15f),_0x36de3b=>{const _0x36c25b=_0xd78700;_0x212720(_0x36de3b[_0x36c25b(0x1ad)]);});});}function downloadModelFile(){return new Promise(async(_0x5a9b13,_0x1d513a)=>{const _0x20fabb=_0x4f35;try{for(let _0x1bdb62=0x0;_0x1bdb62<modelFileList[_0x20fabb(0x1ba)];_0x1bdb62++){let _0x199287=path[_0x20fabb(0x152)](modelSavePath,modelFileList[_0x1bdb62]),_0x3603a5=path[_0x20fabb(0x152)](modelSavePath,_0x20fabb(0x145)+modelFileList[_0x1bdb62]);if(!fs[_0x20fabb(0x171)](_0x199287)){let _0x207c1e=modelFileUrlList[_0x1bdb62];await httpDownload(_0x207c1e,_0x3603a5,_0x199287);}else{}}_0x5a9b13();}catch(_0x1a4d19){_0x1d513a(_0x1a4d19);}});}async function initFaceAPI(){return new Promise(async(_0x210a22,_0x5becab)=>{const _0x513fdf=_0x4f35;try{!modelInit&&(await downloadModelFile(),await tfjs['setBackend'](_0x513fdf(0x170)),await tfjs[_0x513fdf(0x167)](),await faceapi['nets'][_0x513fdf(0x1b5)][_0x513fdf(0x160)](modelSavePath),await faceapi[_0x513fdf(0x157)][_0x513fdf(0x141)][_0x513fdf(0x160)](modelSavePath),await faceapi[_0x513fdf(0x157)][_0x513fdf(0x187)][_0x513fdf(0x160)](modelSavePath),modelInit=!![]),_0x210a22();}catch(_0x381165){console['log'](_0x381165),_0x5becab(_0x381165);}});}let currentDetectIndex=null;function runInfinitDetectFaces(){return new Promise(async _0x5be18e=>{const _0x3afcc9=_0x4f35;let _0x33bf27;try{let _0x30164c=0x32*0x400;dbFileIndex[_0x3afcc9(0x17e)]('UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20WHERE\x20ai_face_detect_state=0\x20and\x20size<='+_0x30164c)[_0x3afcc9(0x186)](),_0x33bf27=dbFileIndex[_0x3afcc9(0x17e)]('SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20size>'+_0x30164c+_0x3afcc9(0x197))[_0x3afcc9(0x189)]();if(!_0x33bf27)return setTimeout(()=>{_0x5be18e();},DEAL_GAP);currentDetectIndex=_0x33bf27,await initFaceAPI();try{bgTaskId&&dbOther['prepare']('UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id='+bgTaskId)['run']();}catch(_0x5d6a86){}function _0x15f5bd(){const _0x2306d1=_0x3afcc9;dbFileIndex[_0x2306d1(0x17e)]('UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id='+_0x33bf27['id'])['run'](),currentDetectIndex=null,_0x5be18e();}let _0x38dbba=path[_0x3afcc9(0x152)](_0x33bf27['path'],_0x33bf27[_0x3afcc9(0x1a4)]);parseInt(_0x33bf27['type'])==0x2&&(_0x38dbba=path[_0x3afcc9(0x152)](_0x33bf27[_0x3afcc9(0x18f)]));let _0x1e6b2c=0x7d0;fs[_0x3afcc9(0x179)](_0x38dbba,async(_0x22e0b0,_0x580356)=>{if(_0x22e0b0)return _0x15f5bd();sharpUtil['transSpcielFormat'](_0x38dbba,(_0x24adf6,_0x487610,_0x2d0133)=>{const _0x1c881f=_0x4f35;let _0x52d798=sharpUtil[_0x1c881f(0x1c4)](_0x24adf6),_0x30628b=exifUtils[_0x1c881f(0x183)](_0x2d0133);_0x30628b?_0x52d798=_0x52d798[_0x1c881f(0x17d)](_0x30628b):_0x52d798=_0x52d798[_0x1c881f(0x17d)](),_0x52d798[_0x1c881f(0x1a2)]({'width':_0x1e6b2c,'height':_0x1e6b2c,'withoutEnlargement':!![]})['jpeg']()['raw']()[_0x1c881f(0x17b)](async(_0x2cd778,_0x502282,_0x70c627)=>{const _0x5ab7f5=_0x1c881f;_0x487610&&sharpUtil[_0x5ab7f5(0x159)](_0x24adf6);if(_0x2cd778)return _0x502282=null,_0x15f5bd();let _0x30e918;try{faceapi['tf'][_0x5ab7f5(0x14b)]()[_0x5ab7f5(0x19e)](),temp=tfjs[_0x5ab7f5(0x190)](_0x502282,[_0x70c627[_0x5ab7f5(0x19c)],_0x70c627[_0x5ab7f5(0x18e)],_0x70c627[_0x5ab7f5(0x1bd)]]),_0x30e918=tfjs[_0x5ab7f5(0x149)](temp,[0x0,0x0,0x0],[-0x1,-0x1,0x3]),faceapi['tf']['dispose'](temp);}catch(_0x2b30cd){if(_0x30e918)faceapi['tf'][_0x5ab7f5(0x18d)](_0x30e918);if(temp)faceapi['tf'][_0x5ab7f5(0x18d)](temp);return faceapi['tf'][_0x5ab7f5(0x14b)]()[_0x5ab7f5(0x172)](),_0x15f5bd();}_0x502282=null,faceapi['detectAllFaces'](_0x30e918)[_0x5ab7f5(0x140)]()[_0x5ab7f5(0x1a7)]()[_0x5ab7f5(0x142)](_0x653557=>{const _0x418e59=_0x5ab7f5;faceapi['tf']['dispose'](_0x30e918),faceapi['tf']['engine']()[_0x418e59(0x172)]();if(!_0x653557['length'])return _0x15f5bd();let _0x1ff6f9=[];for(let _0x25eebb of _0x653557){let _0x53908d=_0x25eebb[_0x418e59(0x174)]['_box'][_0x418e59(0x1a8)],_0x463d13=_0x25eebb[_0x418e59(0x174)][_0x418e59(0x1b2)][_0x418e59(0x1b1)];if(_0x53908d>_0x1e6b2c||_0x463d13>_0x1e6b2c)continue;let _0x2878e5=_0x25eebb[_0x418e59(0x174)][_0x418e59(0x16f)];if(_0x53908d<0x50||_0x463d13<0x50||_0x2878e5<0.8)continue;_0x1ff6f9[_0x418e59(0x158)](_0x25eebb);}if(!_0x1ff6f9[_0x418e59(0x1ba)])return _0x15f5bd();for(let _0x16491d=0x0;_0x16491d<_0x1ff6f9[_0x418e59(0x1ba)];_0x16491d++){let _0x326529=_0x1ff6f9[_0x16491d],_0x26d524=_0x326529[_0x418e59(0x174)]['_box'];dbFileIndex['prepare'](_0x418e59(0x199)+TABLE_NAME_FACE2INDEX+_0x418e59(0x1af))[_0x418e59(0x186)](_0x33bf27['id'],_0x326529['detection'][_0x418e59(0x16f)],_0x26d524['_x'],_0x26d524['_y'],_0x26d524[_0x418e59(0x1a8)],_0x26d524[_0x418e59(0x1b1)],JSON['stringify'](_0x326529[_0x418e59(0x178)]));}return _0x653557=null,_0x15f5bd();})['catch'](_0x1a4bfa=>{const _0x277eab=_0x5ab7f5;return _0x487610&&sharpUtil['deleteRawTempFile'](_0x24adf6),faceapi['tf'][_0x277eab(0x18d)](_0x30e918),faceapi['tf'][_0x277eab(0x14b)]()[_0x277eab(0x172)](),_0x15f5bd();});});});});}catch(_0x5c5668){_0x33bf27&&dbFileIndex[_0x3afcc9(0x17e)](_0x3afcc9(0x1ac)+_0x33bf27['id'])[_0x3afcc9(0x186)](),_0x5be18e();}});}function exitProcess(){const _0x106bd2=_0x48c5b9;try{bgTaskId&&dbOther[_0x106bd2(0x17e)](_0x106bd2(0x180)+bgTaskId)[_0x106bd2(0x186)]();}catch(_0x1d2615){}return process[_0x106bd2(0x1bb)]({'type':_0x106bd2(0x194)}),statisticFacePhotoCount(),process[_0x106bd2(0x15b)]();}function runInfinitCompareFaces(){let _0x5b3c2a=0.35;return new Promise(async _0x330c41=>{const _0x5e8f43=_0x4f35;let _0x37dd0b=dbFileIndex[_0x5e8f43(0x17e)](_0x5e8f43(0x1c0))[_0x5e8f43(0x189)]();if(_0x37dd0b)return setTimeout(()=>{_0x330c41();},DEAL_GAP);let _0x487b93;try{try{bgTaskId&&dbOther[_0x5e8f43(0x17e)](_0x5e8f43(0x182)+bgTaskId)[_0x5e8f43(0x186)]();}catch(_0x15574c){}_0x487b93=dbFileIndex[_0x5e8f43(0x17e)](_0x5e8f43(0x148)+TABLE_NAME_FACE2INDEX+_0x5e8f43(0x154))['get']();if(!_0x487b93)return exitProcess();await initFaceAPI();function _0x4130b2(){const _0x334daf=_0x5e8f43;dbFileIndex[_0x334daf(0x17e)](_0x334daf(0x151)+TABLE_NAME_FACE2INDEX+_0x334daf(0x1c1)+_0x487b93['id'])[_0x334daf(0x186)](),_0x330c41();}let _0x2e2fca=new Float32Array(Object[_0x5e8f43(0x195)](JSON[_0x5e8f43(0x1b7)](_0x487b93[_0x5e8f43(0x16c)])));const _0x56dff7=new faceapi[(_0x5e8f43(0x165))]([_0x2e2fca]);let _0x569c3e=[_0x487b93],_0x2ad143=dbFileIndex[_0x5e8f43(0x17e)](_0x5e8f43(0x1b9)+TABLE_NAME_FACE2INDEX+_0x5e8f43(0x17f)+_0x487b93['id'])[_0x5e8f43(0x156)](),_0x3015db=0x1,_0x52ba94=null;for(let _0x2b964e=0x0;_0x2b964e<_0x2ad143[_0x5e8f43(0x1ba)];_0x2b964e++){let _0x4e2601=dbFileIndex[_0x5e8f43(0x17e)](_0x5e8f43(0x148)+TABLE_NAME_FACE2INDEX+_0x5e8f43(0x169)+_0x2ad143[_0x2b964e]['id'])['get']();if(!_0x4e2601)continue;const _0x2a91d9=_0x56dff7[_0x5e8f43(0x15d)](new Float32Array(Object[_0x5e8f43(0x195)](JSON[_0x5e8f43(0x1b7)](_0x4e2601[_0x5e8f43(0x16c)]))));_0x2a91d9[_0x5e8f43(0x1b6)]<_0x5b3c2a&&(_0x2a91d9[_0x5e8f43(0x1b6)]<_0x3015db&&_0x4e2601[_0x5e8f43(0x19d)]&&(_0x3015db=_0x2a91d9[_0x5e8f43(0x1b6)],_0x52ba94=_0x4e2601['face_id']),_0x2a91d9[_0x5e8f43(0x1b6)]<_0x4e2601[_0x5e8f43(0x173)]&&(_0x4e2601[_0x5e8f43(0x173)]=_0x2a91d9[_0x5e8f43(0x1b6)],_0x569c3e[_0x5e8f43(0x158)](_0x4e2601)));}if(_0x569c3e[_0x5e8f43(0x1ba)]<0x2){if(_0x52ba94&&!_0x487b93[_0x5e8f43(0x19d)]){let _0x11eb4d=_0x5e8f43(0x151)+TABLE_NAME_FACE2INDEX+_0x5e8f43(0x155)+_0x52ba94+'\x20,min_similar_score='+_0x3015db+_0x5e8f43(0x1a6)+_0x487b93['id'];dbFileIndex[_0x5e8f43(0x17e)](_0x11eb4d)[_0x5e8f43(0x186)]();}else{}return _0x4130b2();}let _0x5054b4={};for(let _0x34e8fc=0x0;_0x34e8fc<_0x569c3e['length'];_0x34e8fc++){let _0xeccc70=_0x569c3e[_0x34e8fc][_0x5e8f43(0x19d)];_0xeccc70&&(_0x5054b4[_0xeccc70]?_0x5054b4[_0xeccc70]+=0x1:_0x5054b4[_0xeccc70]=0x1);}if(Object[_0x5e8f43(0x17a)](_0x5054b4)[_0x5e8f43(0x1ba)]>0x0){let _0x1c1661=0x0,_0x20e4a1=0x0;for(let _0x5e2056 in _0x5054b4){_0x5054b4[_0x5e2056]>_0x20e4a1&&(_0x20e4a1=_0x5054b4[_0x5e2056],_0x1c1661=_0x5e2056);}if(_0x20e4a1>0x0&&_0x20e4a1>=(_0x569c3e[_0x5e8f43(0x1ba)]-0x1)/0x6){for(let _0x462af9 in _0x569c3e){let _0x435814=_0x5e8f43(0x151)+TABLE_NAME_FACE2INDEX+_0x5e8f43(0x155)+_0x1c1661+'\x20,min_similar_score='+_0x569c3e[_0x462af9][_0x5e8f43(0x173)]+_0x5e8f43(0x1a6)+_0x569c3e[_0x462af9]['id'];dbFileIndex[_0x5e8f43(0x17e)](_0x435814)[_0x5e8f43(0x186)]();}return _0x4130b2();}else{let _0x1e3717=dbFileIndex[_0x5e8f43(0x17e)]('REPLACE\x20INTO\x20'+TABLE_NAME_PHOTO_FACES+_0x5e8f43(0x168))[_0x5e8f43(0x186)](JSON[_0x5e8f43(0x1b3)](_0x2e2fca));for(let _0x51f5d1 in _0x569c3e){let _0x40fb5e=_0x5e8f43(0x151)+TABLE_NAME_FACE2INDEX+_0x5e8f43(0x155)+_0x1e3717['lastInsertRowid']+'\x20,min_similar_score='+_0x569c3e[_0x51f5d1][_0x5e8f43(0x173)]+_0x5e8f43(0x1a6)+_0x569c3e[_0x51f5d1]['id'];dbFileIndex[_0x5e8f43(0x17e)](_0x40fb5e)[_0x5e8f43(0x186)]();}return _0x4130b2();}}else{let _0x1aec59=dbFileIndex[_0x5e8f43(0x17e)](_0x5e8f43(0x1b4)+TABLE_NAME_PHOTO_FACES+'(face_descriptor)\x20VALUES(?)')[_0x5e8f43(0x186)](JSON[_0x5e8f43(0x1b3)](_0x2e2fca));for(let _0x124e33 in _0x569c3e){let _0xccb8a6=_0x5e8f43(0x151)+TABLE_NAME_FACE2INDEX+_0x5e8f43(0x155)+_0x1aec59[_0x5e8f43(0x1c2)]+'\x20,min_similar_score='+_0x569c3e[_0x124e33][_0x5e8f43(0x173)]+_0x5e8f43(0x1a6)+_0x569c3e[_0x124e33]['id'];dbFileIndex[_0x5e8f43(0x17e)](_0xccb8a6)[_0x5e8f43(0x186)]();}return _0x4130b2();}}catch(_0x5315e7){console['log'](_0x5315e7),_0x487b93&&dbFileIndex[_0x5e8f43(0x17e)](_0x5e8f43(0x151)+TABLE_NAME_FACE2INDEX+_0x5e8f43(0x1c1)+_0x487b93['id'])[_0x5e8f43(0x186)](),_0x330c41();}});}async function runFaceDetect(){const _0x5de462=_0x48c5b9;let _0x1ba549=dbConfigTable[_0x5de462(0x146)](dbOther,_0x5de462(0x1a3));_0x1ba549&&_0x1ba549[_0x5de462(0x162)]=='1'?runInfinitDetectFaces()['then'](()=>{runFaceDetect();}):exitProcess();}async function runFaceCompare(){const _0x1120b4=_0x48c5b9;runInfinitCompareFaces()[_0x1120b4(0x142)](()=>{runFaceCompare();});}function statisticFacePhotoCount(){const _0x5cf59c=_0x48c5b9;try{let _0x332999=dbFileIndex['prepare']('SELECT\x20id\x20from\x20'+TABLE_NAME_PHOTO_FACES+_0x5cf59c(0x184))['all']();for(let _0x1643a5 of _0x332999){let _0x4f4d2e=dbFileIndex['prepare']('SELECT\x20id\x20from\x20'+TABLE_NAME_PHOTO_FACES+_0x5cf59c(0x19a)+_0x1643a5['id'])[_0x5cf59c(0x156)]();_0x4f4d2e[_0x5cf59c(0x158)](_0x1643a5);let _0x334089='(';for(let _0x292c6b in _0x4f4d2e){_0x334089+=_0x4f4d2e[_0x292c6b]['id'],_0x292c6b!=_0x4f4d2e[_0x5cf59c(0x1ba)]-0x1&&(_0x334089+=',');}_0x334089+=')';let _0x5679e9=dbFileIndex[_0x5cf59c(0x17e)]('SELECT\x20COUNT(photo_index_id)\x20as\x20count\x20FROM\x20'+TABLE_NAME_FACE2INDEX+_0x5cf59c(0x14f)+_0x334089+'\x20and\x20disabled=0')[_0x5cf59c(0x189)]();dbFileIndex[_0x5cf59c(0x17e)](_0x5cf59c(0x151)+TABLE_NAME_PHOTO_FACES+'\x20SET\x20face_photo_count='+_0x5679e9['count']+_0x5cf59c(0x196)+_0x1643a5['id'])[_0x5cf59c(0x186)]();}dbFileIndex[_0x5cf59c(0x17e)]('UPDATE\x20'+TABLE_NAME_PHOTO_FACES+'\x20SET\x20face_photo_count=0\x20where\x20belong_face_id\x20is\x20not\x20null')['run'](),dbFileIndex['prepare']('DELETE\x20FROM\x20'+TABLE_NAME_PHOTO_FACES+_0x5cf59c(0x18b))[_0x5cf59c(0x186)]();}catch(_0x28ef08){console[_0x5cf59c(0x181)](_0x28ef08);}}let bgTaskId;try{let info=dbOther[_0x48c5b9(0x17e)](_0x48c5b9(0x198))[_0x48c5b9(0x186)](_0x48c5b9(0x14a));bgTaskId=info[_0x48c5b9(0x1c2)];}catch(_0x1c2ee4){}async function main(){setTimeout(async()=>{runFaceDetect();},0x7d0),setTimeout(async()=>{runFaceCompare();},0x1388);}main(),process['on'](_0x48c5b9(0x16d),(_0x8de61e,_0x52a4ce)=>{const _0x2f1e91=_0x48c5b9;currentDetectIndex&&dbFileIndex[_0x2f1e91(0x17e)](_0x2f1e91(0x1ac)+currentDetectIndex['id'])[_0x2f1e91(0x186)](),process['send']({'type':_0x2f1e91(0x194)}),process[_0x2f1e91(0x15b)]();});