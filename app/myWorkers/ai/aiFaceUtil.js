const _0x245969=_0x57f1;function _0x57f1(_0x41fffc,_0x3be47c){const _0x11d11f=_0x11d1();return _0x57f1=function(_0x57f118,_0xcd64cd){_0x57f118=_0x57f118-0x1c1;let _0x1faed2=_0x11d11f[_0x57f118];return _0x1faed2;},_0x57f1(_0x41fffc,_0x3be47c);}(function(_0x199ec1,_0x398048){const _0x2a4788=_0x57f1,_0x339a49=_0x199ec1();while(!![]){try{const _0x547468=parseInt(_0x2a4788(0x1f0))/0x1*(-parseInt(_0x2a4788(0x215))/0x2)+parseInt(_0x2a4788(0x1e3))/0x3+-parseInt(_0x2a4788(0x218))/0x4*(parseInt(_0x2a4788(0x207))/0x5)+-parseInt(_0x2a4788(0x21b))/0x6+parseInt(_0x2a4788(0x219))/0x7+parseInt(_0x2a4788(0x236))/0x8+parseInt(_0x2a4788(0x1d6))/0x9*(-parseInt(_0x2a4788(0x203))/0xa);if(_0x547468===_0x398048)break;else _0x339a49['push'](_0x339a49['shift']());}catch(_0x46bf93){_0x339a49['push'](_0x339a49['shift']());}}}(_0x11d1,0x7d356));const fs=require('fs'),path=require(_0x245969(0x21f)),tfjs=require(_0x245969(0x1f1)),wasm=require(_0x245969(0x220)),sharpUtil=require(_0x245969(0x1c8)),exifUtils=require('../../utils/exifUtils'),urlConfig=require('../../myConfig/urlConfig'),faceapi=require(_0x245969(0x200)),config=require(_0x245969(0x226)),Database=require('better-sqlite3'),https=require(_0x245969(0x227)),dbConfigTable=require('../../db/dbConfigTable');process['title']=_0x245969(0x1ea);let dbFileIndex=new Database(config[_0x245969(0x233)],{}),dbOther=new Database(config[_0x245969(0x211)],{});dbOther['pragma']('journal_mode\x20=\x20WAL'),dbFileIndex[_0x245969(0x205)]('journal_mode\x20=\x20WAL'),process['on'](_0x245969(0x1f6),()=>{const _0x275419=_0x245969;dbOther['close'](),dbFileIndex[_0x275419(0x1db)]();});const DEAL_GAP=0x7530;let TABLE_NAME_FACE2INDEX='photo_faces2index',TABLE_NAME_PHOTO_FACES=_0x245969(0x22e),modelInit=![],modelSavePath=path['join'](config[_0x245969(0x1df)],'tfModel',_0x245969(0x1e7));!fs[_0x245969(0x1e5)](modelSavePath)&&fs['mkdirSync'](modelSavePath,{'recursive':!![]});let modelBaseUrl=urlConfig['getUrlByUrlKey'](dbOther,_0x245969(0x217)),modelFileUrlList=[],modelFileList=[_0x245969(0x214),_0x245969(0x1f4),_0x245969(0x1e4),_0x245969(0x1e9),_0x245969(0x216),'ssd_mobilenetv1_model-weights_manifest.json',_0x245969(0x1fc),_0x245969(0x231)];for(let i=0x0;i<modelFileList[_0x245969(0x1ed)];i++){modelFileUrlList[_0x245969(0x212)](modelBaseUrl+modelFileList[i]);}function httpDownload(_0x1d7026,_0x45053d,_0x5eb113){return new Promise((_0xf663eb,_0xa4d252)=>{const _0x2f943f=_0x57f1;https[_0x2f943f(0x222)](_0x1d7026,_0x4d1b89=>{const _0x288f39=_0x2f943f,_0x237af3=fs['createWriteStream'](_0x45053d);_0x4d1b89['pipe'](_0x237af3),_0x237af3['on'](_0x288f39(0x1e2),()=>{const _0x58020a=_0x288f39;_0x237af3[_0x58020a(0x1db)](),fs[_0x58020a(0x1da)](_0x45053d,_0x5eb113),_0xf663eb();})['on'](_0x288f39(0x22c),_0x500cbf=>{});})['on']('error',_0xeaa1ea=>{const _0xc73ae=_0x2f943f;_0xa4d252(_0xeaa1ea[_0xc73ae(0x20a)]);});});}function downloadModelFile(){return new Promise(async(_0xa5ecb0,_0x4551dd)=>{const _0x1d73cb=_0x57f1;try{for(let _0xcf086d=0x0;_0xcf086d<modelFileList[_0x1d73cb(0x1ed)];_0xcf086d++){let _0x879a30=path[_0x1d73cb(0x230)](modelSavePath,modelFileList[_0xcf086d]),_0x4c501e=path[_0x1d73cb(0x230)](modelSavePath,_0x1d73cb(0x1cb)+modelFileList[_0xcf086d]);if(!fs[_0x1d73cb(0x1e5)](_0x879a30)){let _0x2fb7a0=modelFileUrlList[_0xcf086d];await httpDownload(_0x2fb7a0,_0x4c501e,_0x879a30);}else{}}_0xa5ecb0();}catch(_0x12d771){_0x4551dd(_0x12d771);}});}async function initFaceAPI(){return new Promise(async(_0x40f841,_0xe12e22)=>{const _0x104370=_0x57f1;try{!modelInit&&(await downloadModelFile(),await tfjs[_0x104370(0x1ec)](_0x104370(0x1d2)),await tfjs[_0x104370(0x1c2)](),await faceapi['nets'][_0x104370(0x235)]['loadFromDisk'](modelSavePath),await faceapi[_0x104370(0x21d)][_0x104370(0x1d4)][_0x104370(0x224)](modelSavePath),await faceapi[_0x104370(0x21d)][_0x104370(0x239)][_0x104370(0x224)](modelSavePath),modelInit=!![]),_0x40f841();}catch(_0x226fc0){console[_0x104370(0x1eb)](_0x226fc0),_0xe12e22(_0x226fc0);}});}let currentDetectIndex=null;function runInfinitDetectFaces(){return new Promise(async _0x48c840=>{const _0x2a00fb=_0x57f1;let _0x4e2a76;try{let _0x28a4f4=0x32*0x400;dbFileIndex[_0x2a00fb(0x206)](_0x2a00fb(0x1e8)+_0x28a4f4)[_0x2a00fb(0x1fd)](),_0x4e2a76=dbFileIndex[_0x2a00fb(0x206)]('SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20size>'+_0x28a4f4+_0x2a00fb(0x232))[_0x2a00fb(0x222)]();if(!_0x4e2a76)return setTimeout(()=>{_0x48c840();},DEAL_GAP);currentDetectIndex=_0x4e2a76,await initFaceAPI();try{bgTaskId&&dbOther[_0x2a00fb(0x206)](_0x2a00fb(0x1c9)+bgTaskId)[_0x2a00fb(0x1fd)]();}catch(_0xa0bc71){}function _0x4092e7(){const _0x3e9e89=_0x2a00fb;dbFileIndex[_0x3e9e89(0x206)]('UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id='+_0x4e2a76['id'])[_0x3e9e89(0x1fd)](),currentDetectIndex=null,_0x48c840();}let _0x40423a=path[_0x2a00fb(0x230)](_0x4e2a76[_0x2a00fb(0x21f)],_0x4e2a76[_0x2a00fb(0x1cc)]);parseInt(_0x4e2a76['type'])==0x2&&(_0x40423a=path['join'](_0x4e2a76['tiny_path']));let _0xe8dd57=0x7d0;fs[_0x2a00fb(0x1f9)](_0x40423a,async(_0x2e18f7,_0x4865a3)=>{const _0xbf90c3=_0x2a00fb;if(_0x2e18f7)return _0x4092e7();sharpUtil[_0xbf90c3(0x23b)](_0x40423a,(_0x148683,_0xae0d05,_0x2b5c3f)=>{const _0x294068=_0xbf90c3;let _0x163757=sharpUtil['getSharpInstanceFromInput'](_0x148683),_0x26663a=exifUtils[_0x294068(0x21e)](_0x2b5c3f);_0x26663a?_0x163757=_0x163757[_0x294068(0x208)](_0x26663a):_0x163757=_0x163757[_0x294068(0x208)](),_0x163757[_0x294068(0x23a)]({'width':_0xe8dd57,'height':_0xe8dd57,'withoutEnlargement':!![]})[_0x294068(0x1f5)]()[_0x294068(0x1d1)]()[_0x294068(0x1dd)](async(_0x1d6667,_0x399d95,_0x52fe07)=>{const _0x2cea55=_0x294068;_0xae0d05&&sharpUtil[_0x2cea55(0x20b)](_0x148683);if(_0x1d6667)return _0x399d95=null,_0x4092e7();let _0x4d5524;try{faceapi['tf']['engine']()[_0x2cea55(0x22b)](),temp=tfjs[_0x2cea55(0x1e6)](_0x399d95,[_0x52fe07['height'],_0x52fe07[_0x2cea55(0x225)],_0x52fe07[_0x2cea55(0x1cf)]]),_0x4d5524=tfjs[_0x2cea55(0x1d8)](temp,[0x0,0x0,0x0],[-0x1,-0x1,0x3]),faceapi['tf'][_0x2cea55(0x210)](temp);}catch(_0x1fc37a){if(_0x4d5524)faceapi['tf']['dispose'](_0x4d5524);if(temp)faceapi['tf'][_0x2cea55(0x210)](temp);return faceapi['tf'][_0x2cea55(0x1c1)]()[_0x2cea55(0x228)](),_0x4092e7();}_0x399d95=null,faceapi[_0x2cea55(0x1f7)](_0x4d5524)[_0x2cea55(0x22a)]()[_0x2cea55(0x1de)]()[_0x2cea55(0x1f3)](_0x24a2c4=>{const _0x5c95f6=_0x2cea55;faceapi['tf'][_0x5c95f6(0x210)](_0x4d5524),faceapi['tf']['engine']()['endScope']();if(!_0x24a2c4[_0x5c95f6(0x1ed)])return _0x4092e7();let _0x2d115c=[];for(let _0x39419f of _0x24a2c4){let _0x124340=_0x39419f[_0x5c95f6(0x238)][_0x5c95f6(0x1fe)][_0x5c95f6(0x1c4)],_0x1f8f94=_0x39419f[_0x5c95f6(0x238)][_0x5c95f6(0x1fe)]['_height'];if(_0x124340>_0xe8dd57||_0x1f8f94>_0xe8dd57)continue;let _0x276993=_0x39419f[_0x5c95f6(0x238)][_0x5c95f6(0x213)];if(_0x124340<0x50||_0x1f8f94<0x50||_0x276993<0.8)continue;_0x2d115c[_0x5c95f6(0x212)](_0x39419f);}if(!_0x2d115c[_0x5c95f6(0x1ed)])return _0x4092e7();for(let _0x1c3bda=0x0;_0x1c3bda<_0x2d115c[_0x5c95f6(0x1ed)];_0x1c3bda++){let _0x331d9b=_0x2d115c[_0x1c3bda],_0x538aad=_0x331d9b['detection']['_box'];dbFileIndex[_0x5c95f6(0x206)](_0x5c95f6(0x21a)+TABLE_NAME_FACE2INDEX+_0x5c95f6(0x1ef))[_0x5c95f6(0x1fd)](_0x4e2a76['id'],_0x331d9b['detection'][_0x5c95f6(0x213)],_0x538aad['_x'],_0x538aad['_y'],_0x538aad[_0x5c95f6(0x1c4)],_0x538aad['_height'],JSON[_0x5c95f6(0x234)](_0x331d9b[_0x5c95f6(0x20d)]));}return _0x24a2c4=null,_0x4092e7();})[_0x2cea55(0x1ff)](_0x2ae3bf=>{const _0x23ff92=_0x2cea55;return _0xae0d05&&sharpUtil[_0x23ff92(0x20b)](_0x148683),faceapi['tf']['dispose'](_0x4d5524),faceapi['tf']['engine']()[_0x23ff92(0x228)](),_0x4092e7();});});});});}catch(_0x10ce65){_0x4e2a76&&dbFileIndex[_0x2a00fb(0x206)](_0x2a00fb(0x1e0)+_0x4e2a76['id'])[_0x2a00fb(0x1fd)](),_0x48c840();}});}function exitProcess(){const _0xa6c7b=_0x245969;try{bgTaskId&&dbOther[_0xa6c7b(0x206)](_0xa6c7b(0x223)+bgTaskId)[_0xa6c7b(0x1fd)]();}catch(_0x50123d){}return process[_0xa6c7b(0x1d7)]({'type':_0xa6c7b(0x1db)}),statisticFacePhotoCount(),process['exit']();}function runInfinitCompareFaces(){let _0x459e92=0.35;return new Promise(async _0x1f5c83=>{const _0x2f50ac=_0x57f1;let _0x58c17b=dbFileIndex[_0x2f50ac(0x206)]('SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20(type=1\x20OR\x20type=2)\x20AND\x20ai_face_detect_state=0\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20is_raw!=1\x20\x20LIMIT\x201')[_0x2f50ac(0x222)]();if(_0x58c17b)return setTimeout(()=>{_0x1f5c83();},DEAL_GAP);let _0x4380e5;try{try{bgTaskId&&dbOther[_0x2f50ac(0x206)](_0x2f50ac(0x1c9)+bgTaskId)[_0x2f50ac(0x1fd)]();}catch(_0x511f3a){}_0x4380e5=dbFileIndex[_0x2f50ac(0x206)](_0x2f50ac(0x20c)+TABLE_NAME_FACE2INDEX+_0x2f50ac(0x1e1))[_0x2f50ac(0x222)]();if(!_0x4380e5)return exitProcess();await initFaceAPI();function _0x5f1d04(){const _0x4b8cb6=_0x2f50ac;dbFileIndex['prepare'](_0x4b8cb6(0x23c)+TABLE_NAME_FACE2INDEX+'\x20SET\x20compare_state=1\x20where\x20id='+_0x4380e5['id'])[_0x4b8cb6(0x1fd)](),_0x1f5c83();}let _0xe8eeb7=new Float32Array(Object['values'](JSON['parse'](_0x4380e5[_0x2f50ac(0x21c)])));const _0x1aca25=new faceapi[(_0x2f50ac(0x1d3))]([_0xe8eeb7]);let _0x127a06=[_0x4380e5],_0x29522e=dbFileIndex[_0x2f50ac(0x206)](_0x2f50ac(0x1fb)+TABLE_NAME_FACE2INDEX+_0x2f50ac(0x1d5)+_0x4380e5['id'])[_0x2f50ac(0x237)](),_0x6ddc67=0x1,_0x32aa14=null;for(let _0xef1ca8=0x0;_0xef1ca8<_0x29522e[_0x2f50ac(0x1ed)];_0xef1ca8++){let _0x54fd60=dbFileIndex['prepare']('SELECT\x20*\x20from\x20'+TABLE_NAME_FACE2INDEX+_0x2f50ac(0x23f)+_0x29522e[_0xef1ca8]['id'])['get']();if(!_0x54fd60)continue;const _0x37ae2f=_0x1aca25[_0x2f50ac(0x1c6)](new Float32Array(Object[_0x2f50ac(0x1d0)](JSON[_0x2f50ac(0x221)](_0x54fd60['face_descriptor']))));_0x37ae2f['_distance']<_0x459e92&&(_0x37ae2f[_0x2f50ac(0x202)]<_0x6ddc67&&_0x54fd60[_0x2f50ac(0x1dc)]&&(_0x6ddc67=_0x37ae2f[_0x2f50ac(0x202)],_0x32aa14=_0x54fd60[_0x2f50ac(0x1dc)]),_0x37ae2f[_0x2f50ac(0x202)]<_0x54fd60[_0x2f50ac(0x209)]&&(_0x54fd60[_0x2f50ac(0x209)]=_0x37ae2f[_0x2f50ac(0x202)],_0x127a06[_0x2f50ac(0x212)](_0x54fd60)));}if(_0x127a06['length']<0x2){if(_0x32aa14&&!_0x4380e5[_0x2f50ac(0x1dc)]){let _0x5b8b60='UPDATE\x20'+TABLE_NAME_FACE2INDEX+_0x2f50ac(0x22d)+_0x32aa14+_0x2f50ac(0x204)+_0x6ddc67+_0x2f50ac(0x1f8)+_0x4380e5['id'];dbFileIndex['prepare'](_0x5b8b60)[_0x2f50ac(0x1fd)]();}else{}return _0x5f1d04();}let _0x3f7161={};for(let _0x3521fe=0x0;_0x3521fe<_0x127a06['length'];_0x3521fe++){let _0xf6cb04=_0x127a06[_0x3521fe][_0x2f50ac(0x1dc)];_0xf6cb04&&(_0x3f7161[_0xf6cb04]?_0x3f7161[_0xf6cb04]+=0x1:_0x3f7161[_0xf6cb04]=0x1);}if(Object[_0x2f50ac(0x1ee)](_0x3f7161)[_0x2f50ac(0x1ed)]>0x0){let _0x2d6f45=0x0,_0x28ab57=0x0;for(let _0x5ac4ce in _0x3f7161){_0x3f7161[_0x5ac4ce]>_0x28ab57&&(_0x28ab57=_0x3f7161[_0x5ac4ce],_0x2d6f45=_0x5ac4ce);}if(_0x28ab57>0x0&&_0x28ab57>=(_0x127a06['length']-0x1)/0x6){for(let _0x265128 in _0x127a06){let _0xaac334=_0x2f50ac(0x23c)+TABLE_NAME_FACE2INDEX+_0x2f50ac(0x22d)+_0x2d6f45+_0x2f50ac(0x204)+_0x127a06[_0x265128][_0x2f50ac(0x209)]+_0x2f50ac(0x1f8)+_0x127a06[_0x265128]['id'];dbFileIndex['prepare'](_0xaac334)[_0x2f50ac(0x1fd)]();}return _0x5f1d04();}else{let _0x1a1bfd=dbFileIndex['prepare'](_0x2f50ac(0x20f)+TABLE_NAME_PHOTO_FACES+'(face_descriptor)\x20VALUES(?)')[_0x2f50ac(0x1fd)](JSON[_0x2f50ac(0x234)](_0xe8eeb7));for(let _0x5b228b in _0x127a06){let _0x5dd192=_0x2f50ac(0x23c)+TABLE_NAME_FACE2INDEX+_0x2f50ac(0x22d)+_0x1a1bfd[_0x2f50ac(0x1c5)]+'\x20,min_similar_score='+_0x127a06[_0x5b228b][_0x2f50ac(0x209)]+_0x2f50ac(0x1f8)+_0x127a06[_0x5b228b]['id'];dbFileIndex['prepare'](_0x5dd192)[_0x2f50ac(0x1fd)]();}return _0x5f1d04();}}else{let _0x6adc48=dbFileIndex[_0x2f50ac(0x206)](_0x2f50ac(0x20f)+TABLE_NAME_PHOTO_FACES+_0x2f50ac(0x1c3))['run'](JSON[_0x2f50ac(0x234)](_0xe8eeb7));for(let _0x3a1064 in _0x127a06){let _0x18b0e1=_0x2f50ac(0x23c)+TABLE_NAME_FACE2INDEX+_0x2f50ac(0x22d)+_0x6adc48[_0x2f50ac(0x1c5)]+_0x2f50ac(0x204)+_0x127a06[_0x3a1064][_0x2f50ac(0x209)]+_0x2f50ac(0x1f8)+_0x127a06[_0x3a1064]['id'];dbFileIndex[_0x2f50ac(0x206)](_0x18b0e1)[_0x2f50ac(0x1fd)]();}return _0x5f1d04();}}catch(_0x54a9fd){console['log'](_0x54a9fd),_0x4380e5&&dbFileIndex['prepare'](_0x2f50ac(0x23c)+TABLE_NAME_FACE2INDEX+_0x2f50ac(0x1d9)+_0x4380e5['id'])[_0x2f50ac(0x1fd)](),_0x1f5c83();}});}async function runFaceDetect(){const _0x2a0c75=_0x245969;let _0x581986=dbConfigTable[_0x2a0c75(0x1ce)](dbOther,'aiFaceEnable');_0x581986&&_0x581986['value']=='1'?runInfinitDetectFaces()[_0x2a0c75(0x1f3)](()=>{runFaceDetect();}):exitProcess();}async function runFaceCompare(){runInfinitCompareFaces()['then'](()=>{runFaceCompare();});}function statisticFacePhotoCount(){const _0x1f9883=_0x245969;try{let _0x4c2350=dbFileIndex['prepare']('SELECT\x20id\x20from\x20'+TABLE_NAME_PHOTO_FACES+_0x1f9883(0x1fa))[_0x1f9883(0x237)]();for(let _0x24badb of _0x4c2350){let _0x353863=dbFileIndex[_0x1f9883(0x206)](_0x1f9883(0x1fb)+TABLE_NAME_PHOTO_FACES+'\x20where\x20belong_face_id='+_0x24badb['id'])['all']();_0x353863[_0x1f9883(0x212)](_0x24badb);let _0x5e9bbb='(';for(let _0x1b29a4 in _0x353863){_0x5e9bbb+=_0x353863[_0x1b29a4]['id'],_0x1b29a4!=_0x353863[_0x1f9883(0x1ed)]-0x1&&(_0x5e9bbb+=',');}_0x5e9bbb+=')';let _0x462c83=dbFileIndex[_0x1f9883(0x206)](_0x1f9883(0x201)+TABLE_NAME_FACE2INDEX+_0x1f9883(0x23d)+_0x5e9bbb+_0x1f9883(0x23e))['get']();dbFileIndex[_0x1f9883(0x206)]('UPDATE\x20'+TABLE_NAME_PHOTO_FACES+'\x20SET\x20face_photo_count='+_0x462c83[_0x1f9883(0x1cd)]+_0x1f9883(0x1ca)+_0x24badb['id'])[_0x1f9883(0x1fd)]();}dbFileIndex[_0x1f9883(0x206)](_0x1f9883(0x23c)+TABLE_NAME_PHOTO_FACES+_0x1f9883(0x22f))[_0x1f9883(0x1fd)](),dbFileIndex[_0x1f9883(0x206)](_0x1f9883(0x1c7)+TABLE_NAME_PHOTO_FACES+_0x1f9883(0x229))[_0x1f9883(0x1fd)]();}catch(_0x167a84){console[_0x1f9883(0x1eb)](_0x167a84);}}let bgTaskId;try{let info=dbOther[_0x245969(0x206)](_0x245969(0x20e))[_0x245969(0x1fd)](_0x245969(0x1f2));bgTaskId=info[_0x245969(0x1c5)];}catch(_0x5bac08){}function _0x11d1(){const _0x22ad5f=['\x20where\x20belong_face_id\x20is\x20null','SELECT\x20id\x20from\x20','face_landmark_68_model.bin','run','_box','catch','../../libs/faceapi/face-api.node-wasm','SELECT\x20COUNT(photo_index_id)\x20as\x20count\x20FROM\x20','_distance','430GkoGgR','\x20,min_similar_score=','pragma','prepare','94920bQtRUo','rotate','min_similar_score','message','deleteRawTempFile','SELECT\x20*\x20from\x20','descriptor','INSERT\x20INTO\x20bg_task(task_type)\x20VALUES(?)','REPLACE\x20INTO\x20','dispose','dbOther','push','_score','face_landmark_68_tiny_model.bin','6ilCaag','ssd_mobilenetv1_model.bin','modeUrl_ai_face','12zUeDer','1706236zdOfOd','REPLACE\x20INTO\x20\x20','689526DpSVnG','face_descriptor','nets','getRotateFromTags','path','@tensorflow/tfjs-backend-wasm','parse','get','UPDATE\x20bg_task\x20SET\x20task_state=2\x20where\x20id=','loadFromDisk','width','../../myConfig/config','https','endScope','\x20where\x20face_photo_count<1\x20and\x20belong_face_id\x20is\x20null','withFaceLandmarks','startScope','error','\x20SET\x20face_id=','photo_faces','\x20SET\x20face_photo_count=0\x20where\x20belong_face_id\x20is\x20not\x20null','join','face_landmark_68_model-weights_manifest.json','\x20AND\x20(type=1\x20OR\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20ai_face_detect_state=0\x20\x20AND\x20is_raw!=1\x20LIMIT\x201','dbFileIndex','stringify','ssdMobilenetv1','7625968dqgorO','all','detection','faceRecognitionNet','resize','transSpcielFormat','UPDATE\x20','\x20where\x20face_id\x20in\x20','\x20and\x20disabled=0','\x20WHERE\x20id=','engine','ready','(face_descriptor)\x20VALUES(?)','_width','lastInsertRowid','findBestMatch','DELETE\x20FROM\x20','../../express-server/utils/sharpUtils','UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id=','\x20where\x20id=','tmp_','filename','count','findByTitle','channels','values','raw','wasm','FaceMatcher','faceLandmark68Net','\x20where\x20id!=','119628zyyGMk','send','slice','\x20SET\x20compare_state=1\x20where\x20id=','renameSync','close','face_id','toBuffer','withFaceDescriptors','userDataFolder','UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id=','\x20WHERE\x20\x20compare_state=0\x20\x20and\x20face_id\x20is\x20null\x20LIMIT\x201','finish','1797840FjHASK','face_recognition_model.bin','existsSync','tensor','faceapi_models','UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20WHERE\x20ai_face_detect_state=0\x20and\x20size<=','face_recognition_model-weights_manifest.json','NasCabAiFace','log','setBackend','length','keys','(photo_index_id,score,x,y,width,height,face_descriptor)\x20\x20VALUES(?,?,?,?,?,?,?)','179997RdEQYk','@tensorflow/tfjs','AI_FACES','then','face_landmark_68_tiny_model-weights_manifest.json','jpeg','exit','detectAllFaces',',\x20compare_state=1\x20where\x20id\x20=\x20','stat'];_0x11d1=function(){return _0x22ad5f;};return _0x11d1();}async function main(){setTimeout(async()=>{runFaceDetect();},0x7d0),setTimeout(async()=>{runFaceCompare();},0x1388);}main(),process['on']('uncaughtException',(_0x516ffc,_0x3e0b48)=>{const _0x3f679c=_0x245969;currentDetectIndex&&dbFileIndex['prepare'](_0x3f679c(0x1e0)+currentDetectIndex['id'])['run'](),process[_0x3f679c(0x1d7)]({'type':_0x3f679c(0x1db)}),process[_0x3f679c(0x1f6)]();});