const _0x23dd8a=_0x4800;(function(_0x23552c,_0x211036){const _0x31b479=_0x4800,_0x4a7981=_0x23552c();while(!![]){try{const _0x338b49=parseInt(_0x31b479(0x90))/0x1*(-parseInt(_0x31b479(0xa1))/0x2)+-parseInt(_0x31b479(0x97))/0x3+-parseInt(_0x31b479(0xc1))/0x4*(parseInt(_0x31b479(0xba))/0x5)+parseInt(_0x31b479(0x9a))/0x6+-parseInt(_0x31b479(0xd8))/0x7+-parseInt(_0x31b479(0xa9))/0x8*(parseInt(_0x31b479(0xb4))/0x9)+parseInt(_0x31b479(0x109))/0xa;if(_0x338b49===_0x211036)break;else _0x4a7981['push'](_0x4a7981['shift']());}catch(_0x4de53d){_0x4a7981['push'](_0x4a7981['shift']());}}}(_0x17af,0x74bce));const fs=require('fs'),path=require(_0x23dd8a(0x103)),tfjs=require(_0x23dd8a(0x94)),wasm=require(_0x23dd8a(0xcb)),sharpUtil=require(_0x23dd8a(0x8a)),exifUtils=require(_0x23dd8a(0x108)),urlConfig=require(_0x23dd8a(0xc5)),faceapi=require(_0x23dd8a(0x8d)),config=require(_0x23dd8a(0xeb)),Database=require(_0x23dd8a(0xee)),https=require('https'),dbConfigTable=require(_0x23dd8a(0xb0));process[_0x23dd8a(0xc7)]=_0x23dd8a(0x9f);let dbFileIndex=new Database(config[_0x23dd8a(0xaf)],{}),dbOther=new Database(config[_0x23dd8a(0xe6)],{});dbOther['pragma']('journal_mode\x20=\x20WAL'),dbFileIndex[_0x23dd8a(0xa3)](_0x23dd8a(0xb1)),process['on'](_0x23dd8a(0x106),()=>{const _0x4883dd=_0x23dd8a;dbOther[_0x4883dd(0xa6)](),dbFileIndex[_0x4883dd(0xa6)]();});const DEAL_GAP=0x7530;let TABLE_NAME_FACE2INDEX='photo_faces2index',TABLE_NAME_PHOTO_FACES='photo_faces',modelInit=![],modelSavePath=path['join'](config[_0x23dd8a(0x8f)],_0x23dd8a(0xfc),'faceapi_models');!fs[_0x23dd8a(0x101)](modelSavePath)&&fs[_0x23dd8a(0x9d)](modelSavePath,{'recursive':!![]});let modelBaseUrl=urlConfig['getUrlByUrlKey'](dbOther,_0x23dd8a(0xfa)),modelFileUrlList=[],modelFileList=[_0x23dd8a(0xa7),_0x23dd8a(0xa0),_0x23dd8a(0xb3),'face_recognition_model-weights_manifest.json','ssd_mobilenetv1_model.bin','ssd_mobilenetv1_model-weights_manifest.json',_0x23dd8a(0xcf),'face_landmark_68_model-weights_manifest.json'];for(let i=0x0;i<modelFileList['length'];i++){modelFileUrlList['push'](modelBaseUrl+modelFileList[i]);}function httpDownload(_0x58ce69,_0x3c4814,_0x2ace30){return new Promise((_0x208fb2,_0x2ec442)=>{const _0x47a194=_0x4800;https[_0x47a194(0xb8)](_0x58ce69,_0x1d8537=>{const _0x5634ee=_0x47a194,_0x34b880=fs['createWriteStream'](_0x3c4814);_0x1d8537[_0x5634ee(0xce)](_0x34b880),_0x34b880['on'](_0x5634ee(0xcd),()=>{const _0x4d44a7=_0x5634ee;_0x34b880[_0x4d44a7(0xa6)](),fs[_0x4d44a7(0xca)](_0x3c4814,_0x2ace30),_0x208fb2();})['on']('error',_0x22662b=>{});})['on'](_0x47a194(0x93),_0x40d503=>{const _0x25e996=_0x47a194;_0x2ec442(_0x40d503[_0x25e996(0xfd)]);});});}function downloadModelFile(){return new Promise(async(_0x145eb3,_0x1d2370)=>{const _0x5edb26=_0x4800;try{for(let _0x4a4e56=0x0;_0x4a4e56<modelFileList['length'];_0x4a4e56++){let _0x1ddd34=path[_0x5edb26(0xc4)](modelSavePath,modelFileList[_0x4a4e56]),_0x32f6e1=path[_0x5edb26(0xc4)](modelSavePath,_0x5edb26(0x95)+modelFileList[_0x4a4e56]);if(!fs[_0x5edb26(0x101)](_0x1ddd34)){let _0x456e14=modelFileUrlList[_0x4a4e56];await httpDownload(_0x456e14,_0x32f6e1,_0x1ddd34);}else{}}_0x145eb3();}catch(_0xd3c739){_0x1d2370(_0xd3c739);}});}async function initFaceAPI(){return new Promise(async(_0x517c58,_0x73503)=>{const _0x2c2e69=_0x4800;try{!modelInit&&(await downloadModelFile(),await tfjs[_0x2c2e69(0x98)](_0x2c2e69(0xda)),await tfjs[_0x2c2e69(0xe7)](),await faceapi['nets']['ssdMobilenetv1']['loadFromDisk'](modelSavePath),await faceapi[_0x2c2e69(0xc0)][_0x2c2e69(0xdc)][_0x2c2e69(0xab)](modelSavePath),await faceapi[_0x2c2e69(0xc0)][_0x2c2e69(0xd9)][_0x2c2e69(0xab)](modelSavePath),modelInit=!![]),_0x517c58();}catch(_0x3e3b5b){console[_0x2c2e69(0xdf)](_0x3e3b5b),_0x73503(_0x3e3b5b);}});}let currentDetectIndex=null;function runInfinitDetectFaces(){return new Promise(async _0x33a19c=>{const _0xd013dc=_0x4800;let _0x20c369;try{let _0x21d565=0x32*0x400;dbFileIndex[_0xd013dc(0x107)]('UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20WHERE\x20ai_face_detect_state=0\x20and\x20size<='+_0x21d565)[_0xd013dc(0xd0)](),_0x20c369=dbFileIndex['prepare'](_0xd013dc(0xe9)+_0x21d565+_0xd013dc(0xc2))['get']();if(!_0x20c369)return setTimeout(()=>{_0x33a19c();},DEAL_GAP);currentDetectIndex=_0x20c369,await initFaceAPI();try{bgTaskId&&dbOther['prepare']('UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id='+bgTaskId)[_0xd013dc(0xd0)]();}catch(_0x512b6d){}function _0x3b581a(){const _0x43b122=_0xd013dc;dbFileIndex['prepare'](_0x43b122(0xb7)+_0x20c369['id'])['run'](),currentDetectIndex=null,_0x33a19c();}let _0x53fa5a=path['join'](_0x20c369[_0xd013dc(0x103)],_0x20c369[_0xd013dc(0xad)]);parseInt(_0x20c369['type'])==0x2&&(_0x53fa5a=path[_0xd013dc(0xc4)](_0x20c369[_0xd013dc(0x9c)]));let _0x317470=0x7d0;fs[_0xd013dc(0xc9)](_0x53fa5a,async(_0x371fc0,_0x32862c)=>{if(_0x371fc0)return _0x3b581a();sharpUtil['transSpcielFormat'](_0x53fa5a,(_0x19bcd4,_0x509929,_0x3a7ad2)=>{const _0x2bf79d=_0x4800;let _0x27e583=sharpUtil[_0x2bf79d(0xbb)](_0x19bcd4),_0x2faa04=exifUtils[_0x2bf79d(0xe3)](_0x3a7ad2);_0x2faa04?_0x27e583=_0x27e583['rotate'](_0x2faa04):_0x27e583=_0x27e583[_0x2bf79d(0xe0)](),_0x27e583[_0x2bf79d(0x92)]({'width':_0x317470,'height':_0x317470,'withoutEnlargement':!![]})[_0x2bf79d(0xcc)]()[_0x2bf79d(0xbe)]()[_0x2bf79d(0x89)](async(_0x2503aa,_0x15a029,_0x1f05fe)=>{const _0x5dedcf=_0x2bf79d;_0x509929&&sharpUtil['deleteRawTempFile'](_0x19bcd4);if(_0x2503aa)return _0x15a029=null,_0x3b581a();let _0x2ef974;try{faceapi['tf'][_0x5dedcf(0xdd)]()[_0x5dedcf(0xde)](),temp=tfjs['tensor'](_0x15a029,[_0x1f05fe[_0x5dedcf(0xb6)],_0x1f05fe[_0x5dedcf(0xf0)],_0x1f05fe['channels']]),_0x2ef974=tfjs[_0x5dedcf(0x99)](temp,[0x0,0x0,0x0],[-0x1,-0x1,0x3]),faceapi['tf']['dispose'](temp);}catch(_0x878bed){if(_0x2ef974)faceapi['tf'][_0x5dedcf(0xec)](_0x2ef974);if(temp)faceapi['tf'][_0x5dedcf(0xec)](temp);return faceapi['tf'][_0x5dedcf(0xdd)]()[_0x5dedcf(0xf7)](),_0x3b581a();}_0x15a029=null,faceapi[_0x5dedcf(0xf9)](_0x2ef974)[_0x5dedcf(0xd3)]()['withFaceDescriptors']()['then'](_0x2cf262=>{const _0xccaf29=_0x5dedcf;faceapi['tf'][_0xccaf29(0xec)](_0x2ef974),faceapi['tf']['engine']()[_0xccaf29(0xf7)]();if(!_0x2cf262[_0xccaf29(0xf1)])return _0x3b581a();let _0xb2eabd=[];for(let _0x4c90aa of _0x2cf262){let _0x36c6b5=_0x4c90aa[_0xccaf29(0x102)][_0xccaf29(0xae)][_0xccaf29(0xa8)],_0x4dbc44=_0x4c90aa[_0xccaf29(0x102)][_0xccaf29(0xae)]['_height'];if(_0x36c6b5>_0x317470||_0x4dbc44>_0x317470)continue;let _0xb7292c=_0x4c90aa[_0xccaf29(0x102)][_0xccaf29(0x8e)];if(_0x36c6b5<0x50||_0x4dbc44<0x50||_0xb7292c<0.8)continue;_0xb2eabd[_0xccaf29(0xdb)](_0x4c90aa);}if(!_0xb2eabd['length'])return _0x3b581a();for(let _0x543cfd=0x0;_0x543cfd<_0xb2eabd[_0xccaf29(0xf1)];_0x543cfd++){let _0x80d186=_0xb2eabd[_0x543cfd],_0x2bdec0=_0x80d186[_0xccaf29(0x102)][_0xccaf29(0xae)];dbFileIndex['prepare'](_0xccaf29(0xd2)+TABLE_NAME_FACE2INDEX+_0xccaf29(0xe2))['run'](_0x20c369['id'],_0x80d186['detection'][_0xccaf29(0x8e)],_0x2bdec0['_x'],_0x2bdec0['_y'],_0x2bdec0[_0xccaf29(0xa8)],_0x2bdec0[_0xccaf29(0xac)],JSON[_0xccaf29(0xf3)](_0x80d186[_0xccaf29(0xd7)]));}return _0x2cf262=null,_0x3b581a();})[_0x5dedcf(0xfe)](_0x246406=>{const _0xfbfd05=_0x5dedcf;return _0x509929&&sharpUtil[_0xfbfd05(0xe8)](_0x19bcd4),faceapi['tf'][_0xfbfd05(0xec)](_0x2ef974),faceapi['tf']['engine']()[_0xfbfd05(0xf7)](),_0x3b581a();});});});});}catch(_0x239fc5){_0x20c369&&dbFileIndex[_0xd013dc(0x107)](_0xd013dc(0xb7)+_0x20c369['id'])[_0xd013dc(0xd0)](),_0x33a19c();}});}function exitProcess(){const _0x470f9a=_0x23dd8a;try{bgTaskId&&dbOther[_0x470f9a(0x107)](_0x470f9a(0x105)+bgTaskId)[_0x470f9a(0xd0)]();}catch(_0x30896c){}return process['send']({'type':_0x470f9a(0xa6)}),statisticFacePhotoCount(),process['exit']();}function runInfinitCompareFaces(){let _0x5c70e1=0.35;return new Promise(async _0x4bdd8b=>{const _0x2ffbdf=_0x4800;let _0x4f2638=dbFileIndex['prepare'](_0x2ffbdf(0xd4))[_0x2ffbdf(0xb8)]();if(_0x4f2638)return setTimeout(()=>{_0x4bdd8b();},DEAL_GAP);let _0x6a591d;try{try{bgTaskId&&dbOther[_0x2ffbdf(0x107)](_0x2ffbdf(0xa2)+bgTaskId)[_0x2ffbdf(0xd0)]();}catch(_0x5c070b){}_0x6a591d=dbFileIndex[_0x2ffbdf(0x107)](_0x2ffbdf(0xf2)+TABLE_NAME_FACE2INDEX+'\x20WHERE\x20\x20compare_state=0\x20\x20and\x20face_id\x20is\x20null\x20LIMIT\x201')[_0x2ffbdf(0xb8)]();if(!_0x6a591d)return exitProcess();await initFaceAPI();function _0x7d6ab0(){const _0x1fb229=_0x2ffbdf;dbFileIndex[_0x1fb229(0x107)](_0x1fb229(0xc6)+TABLE_NAME_FACE2INDEX+_0x1fb229(0xea)+_0x6a591d['id'])['run'](),_0x4bdd8b();}let _0x32828a=new Float32Array(Object['values'](JSON[_0x2ffbdf(0xef)](_0x6a591d[_0x2ffbdf(0xc3)])));const _0x30b56b=new faceapi[(_0x2ffbdf(0x9b))]([_0x32828a]);let _0x529482=[_0x6a591d],_0x2099c9=dbFileIndex[_0x2ffbdf(0x107)](_0x2ffbdf(0xff)+TABLE_NAME_FACE2INDEX+'\x20where\x20id!='+_0x6a591d['id'])[_0x2ffbdf(0xb2)](),_0x53e6f9=0x1,_0x19b1f6=null;for(let _0x10a487=0x0;_0x10a487<_0x2099c9['length'];_0x10a487++){let _0xb4875c=dbFileIndex[_0x2ffbdf(0x107)](_0x2ffbdf(0xf2)+TABLE_NAME_FACE2INDEX+_0x2ffbdf(0x8c)+_0x2099c9[_0x10a487]['id'])[_0x2ffbdf(0xb8)]();if(!_0xb4875c)continue;const _0x1504d6=_0x30b56b[_0x2ffbdf(0xa4)](new Float32Array(Object['values'](JSON[_0x2ffbdf(0xef)](_0xb4875c[_0x2ffbdf(0xc3)]))));_0x1504d6[_0x2ffbdf(0xfb)]<_0x5c70e1&&(_0x1504d6[_0x2ffbdf(0xfb)]<_0x53e6f9&&_0xb4875c['face_id']&&(_0x53e6f9=_0x1504d6['_distance'],_0x19b1f6=_0xb4875c[_0x2ffbdf(0xbf)]),_0x1504d6[_0x2ffbdf(0xfb)]<_0xb4875c['min_similar_score']&&(_0xb4875c['min_similar_score']=_0x1504d6[_0x2ffbdf(0xfb)],_0x529482[_0x2ffbdf(0xdb)](_0xb4875c)));}if(_0x529482['length']<0x2){if(_0x19b1f6&&!_0x6a591d[_0x2ffbdf(0xbf)]){let _0x1fcbc9=_0x2ffbdf(0xc6)+TABLE_NAME_FACE2INDEX+_0x2ffbdf(0xb9)+_0x19b1f6+_0x2ffbdf(0xb5)+_0x53e6f9+',\x20compare_state=1\x20where\x20id\x20=\x20'+_0x6a591d['id'];dbFileIndex[_0x2ffbdf(0x107)](_0x1fcbc9)[_0x2ffbdf(0xd0)]();}else{}return _0x7d6ab0();}let _0x5cc941={};for(let _0x7c4462=0x0;_0x7c4462<_0x529482[_0x2ffbdf(0xf1)];_0x7c4462++){let _0x3a699a=_0x529482[_0x7c4462][_0x2ffbdf(0xbf)];_0x3a699a&&(_0x5cc941[_0x3a699a]?_0x5cc941[_0x3a699a]+=0x1:_0x5cc941[_0x3a699a]=0x1);}if(Object[_0x2ffbdf(0xf8)](_0x5cc941)['length']>0x0){let _0x4097c0=0x0,_0x5b6225=0x0;for(let _0x5de452 in _0x5cc941){_0x5cc941[_0x5de452]>_0x5b6225&&(_0x5b6225=_0x5cc941[_0x5de452],_0x4097c0=_0x5de452);}if(_0x5b6225>0x0&&_0x5b6225>=(_0x529482[_0x2ffbdf(0xf1)]-0x1)/0x6){for(let _0x457d11 in _0x529482){let _0x361d1d='UPDATE\x20'+TABLE_NAME_FACE2INDEX+_0x2ffbdf(0xb9)+_0x4097c0+_0x2ffbdf(0xb5)+_0x529482[_0x457d11]['min_similar_score']+',\x20compare_state=1\x20where\x20id\x20=\x20'+_0x529482[_0x457d11]['id'];dbFileIndex['prepare'](_0x361d1d)[_0x2ffbdf(0xd0)]();}return _0x7d6ab0();}else{let _0x92cc9b=dbFileIndex[_0x2ffbdf(0x107)](_0x2ffbdf(0xf5)+TABLE_NAME_PHOTO_FACES+'(face_descriptor)\x20VALUES(?)')['run'](JSON[_0x2ffbdf(0xf3)](_0x32828a));for(let _0x143f2a in _0x529482){let _0x53964a=_0x2ffbdf(0xc6)+TABLE_NAME_FACE2INDEX+_0x2ffbdf(0xb9)+_0x92cc9b[_0x2ffbdf(0xe5)]+'\x20,min_similar_score='+_0x529482[_0x143f2a]['min_similar_score']+_0x2ffbdf(0x9e)+_0x529482[_0x143f2a]['id'];dbFileIndex[_0x2ffbdf(0x107)](_0x53964a)['run']();}return _0x7d6ab0();}}else{let _0x5209ae=dbFileIndex[_0x2ffbdf(0x107)](_0x2ffbdf(0xf5)+TABLE_NAME_PHOTO_FACES+_0x2ffbdf(0x96))[_0x2ffbdf(0xd0)](JSON['stringify'](_0x32828a));for(let _0x3b80f2 in _0x529482){let _0x424284=_0x2ffbdf(0xc6)+TABLE_NAME_FACE2INDEX+_0x2ffbdf(0xb9)+_0x5209ae[_0x2ffbdf(0xe5)]+_0x2ffbdf(0xb5)+_0x529482[_0x3b80f2][_0x2ffbdf(0x104)]+_0x2ffbdf(0x9e)+_0x529482[_0x3b80f2]['id'];dbFileIndex[_0x2ffbdf(0x107)](_0x424284)[_0x2ffbdf(0xd0)]();}return _0x7d6ab0();}}catch(_0x4e2c18){console[_0x2ffbdf(0xdf)](_0x4e2c18),_0x6a591d&&dbFileIndex[_0x2ffbdf(0x107)]('UPDATE\x20'+TABLE_NAME_FACE2INDEX+'\x20SET\x20compare_state=1\x20where\x20id='+_0x6a591d['id'])[_0x2ffbdf(0xd0)](),_0x4bdd8b();}});}async function runFaceDetect(){const _0x4c8a72=_0x23dd8a;let _0x413326=dbConfigTable[_0x4c8a72(0x91)](dbOther,_0x4c8a72(0xe4));_0x413326&&_0x413326['value']=='1'?runInfinitDetectFaces()[_0x4c8a72(0xaa)](()=>{runFaceDetect();}):exitProcess();}async function runFaceCompare(){const _0x2db42f=_0x23dd8a;runInfinitCompareFaces()[_0x2db42f(0xaa)](()=>{runFaceCompare();});}function statisticFacePhotoCount(){const _0x362647=_0x23dd8a;try{let _0x5d0205=dbFileIndex['prepare'](_0x362647(0xff)+TABLE_NAME_PHOTO_FACES+_0x362647(0xf6))[_0x362647(0xb2)]();for(let _0x15d7fc of _0x5d0205){let _0x43ba46=dbFileIndex['prepare'](_0x362647(0xff)+TABLE_NAME_PHOTO_FACES+'\x20where\x20belong_face_id='+_0x15d7fc['id'])[_0x362647(0xb2)]();_0x43ba46['push'](_0x15d7fc);let _0x1ee9bb='(';for(let _0x1c3548 in _0x43ba46){_0x1ee9bb+=_0x43ba46[_0x1c3548]['id'],_0x1c3548!=_0x43ba46[_0x362647(0xf1)]-0x1&&(_0x1ee9bb+=',');}_0x1ee9bb+=')';let _0x3f35e3=dbFileIndex['prepare'](_0x362647(0x10a)+TABLE_NAME_FACE2INDEX+_0x362647(0xc8)+_0x1ee9bb+_0x362647(0xd6))[_0x362647(0xb8)]();dbFileIndex['prepare']('UPDATE\x20'+TABLE_NAME_PHOTO_FACES+_0x362647(0xd5)+_0x3f35e3[_0x362647(0xed)]+_0x362647(0xbc)+_0x15d7fc['id'])[_0x362647(0xd0)]();}dbFileIndex['prepare'](_0x362647(0xc6)+TABLE_NAME_PHOTO_FACES+_0x362647(0x100))[_0x362647(0xd0)](),dbFileIndex[_0x362647(0x107)](_0x362647(0xe1)+TABLE_NAME_PHOTO_FACES+_0x362647(0xd1))['run']();}catch(_0x513c98){console[_0x362647(0xdf)](_0x513c98);}}let bgTaskId;function _0x17af(){const _0x2d6489=['SELECT\x20*\x20from\x20','stringify','INSERT\x20INTO\x20bg_task(task_type)\x20VALUES(?)','REPLACE\x20INTO\x20','\x20where\x20belong_face_id\x20is\x20null','endScope','keys','detectAllFaces','modeUrl_ai_face','_distance','tfModel','message','catch','SELECT\x20id\x20from\x20','\x20SET\x20face_photo_count=0\x20where\x20belong_face_id\x20is\x20not\x20null','existsSync','detection','path','min_similar_score','UPDATE\x20bg_task\x20SET\x20task_state=2\x20where\x20id=','exit','prepare','../../utils/exifUtils','25300330JhFNxA','SELECT\x20COUNT(photo_index_id)\x20as\x20count\x20FROM\x20','toBuffer','../../express-server/utils/sharpUtils','send','\x20WHERE\x20id=','../../libs/faceapi/face-api.node-wasm','_score','userDataFolder','58eomLYL','findByTitle','resize','error','@tensorflow/tfjs','tmp_','(face_descriptor)\x20VALUES(?)','2728215fzWVaA','setBackend','slice','2384010ToDpfI','FaceMatcher','tiny_path','mkdirSync',',\x20compare_state=1\x20where\x20id\x20=\x20','NasCabAiFace','face_landmark_68_tiny_model-weights_manifest.json','2930RdOBvp','UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id=','pragma','findBestMatch','uncaughtException','close','face_landmark_68_tiny_model.bin','_width','96FeqpGN','then','loadFromDisk','_height','filename','_box','dbFileIndex','../../db/dbConfigTable','journal_mode\x20=\x20WAL','all','face_recognition_model.bin','558999KjIIgu','\x20,min_similar_score=','height','UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id=','get','\x20SET\x20face_id=','615265lGzbes','getSharpInstanceFromInput','\x20where\x20id=','AI_FACES','raw','face_id','nets','12muszCB','\x20AND\x20(type=1\x20OR\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20ai_face_detect_state=0\x20\x20AND\x20is_raw!=1\x20LIMIT\x201','face_descriptor','join','../../myConfig/urlConfig','UPDATE\x20','title','\x20where\x20face_id\x20in\x20','stat','renameSync','@tensorflow/tfjs-backend-wasm','jpeg','finish','pipe','face_landmark_68_model.bin','run','\x20where\x20face_photo_count<1\x20and\x20belong_face_id\x20is\x20null','REPLACE\x20INTO\x20\x20','withFaceLandmarks','SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20(type=1\x20OR\x20type=2)\x20AND\x20ai_face_detect_state=0\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20is_raw!=1\x20\x20LIMIT\x201','\x20SET\x20face_photo_count=','\x20and\x20disabled=0','descriptor','2382408XZjVbL','faceRecognitionNet','wasm','push','faceLandmark68Net','engine','startScope','log','rotate','DELETE\x20FROM\x20','(photo_index_id,score,x,y,width,height,face_descriptor)\x20\x20VALUES(?,?,?,?,?,?,?)','getRotateFromTags','aiFaceEnable','lastInsertRowid','dbOther','ready','deleteRawTempFile','SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20size>','\x20SET\x20compare_state=1\x20where\x20id=','../../myConfig/config','dispose','count','better-sqlite3','parse','width','length'];_0x17af=function(){return _0x2d6489;};return _0x17af();}function _0x4800(_0x42fcc7,_0x1ff4e5){const _0x17afcc=_0x17af();return _0x4800=function(_0x48007e,_0xae3d72){_0x48007e=_0x48007e-0x89;let _0x7a0935=_0x17afcc[_0x48007e];return _0x7a0935;},_0x4800(_0x42fcc7,_0x1ff4e5);}try{let info=dbOther[_0x23dd8a(0x107)](_0x23dd8a(0xf4))[_0x23dd8a(0xd0)](_0x23dd8a(0xbd));bgTaskId=info[_0x23dd8a(0xe5)];}catch(_0x2a6004){}async function main(){setTimeout(async()=>{runFaceDetect();},0x7d0),setTimeout(async()=>{runFaceCompare();},0x1388);}main(),process['on'](_0x23dd8a(0xa5),(_0x30327e,_0x118aee)=>{const _0x1727c0=_0x23dd8a;currentDetectIndex&&dbFileIndex[_0x1727c0(0x107)](_0x1727c0(0xb7)+currentDetectIndex['id'])[_0x1727c0(0xd0)](),process[_0x1727c0(0x8b)]({'type':_0x1727c0(0xa6)}),process['exit']();});