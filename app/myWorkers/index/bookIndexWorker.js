function _0x447a(_0x231d0d,_0x561ca1){const _0x27fade=_0x27fa();return _0x447a=function(_0x447a16,_0x1be1e4){_0x447a16=_0x447a16-0x19d;let _0x4825a9=_0x27fade[_0x447a16];return _0x4825a9;},_0x447a(_0x231d0d,_0x561ca1);}const _0x576d54=_0x447a;function _0x27fa(){const _0x2d05e0=['scan_path','5008892xWXZIH','journal_mode\x20=\x20WAL','now','耗时:','recursionFilesAddIndex','title','./bookIndexUtil','isDirectory','SCAN_TYPE_BOOK','5oeXwbp','uncaughtException','getTime','Error\x20occurred\x20','INDEX_TABLE_NAME_BOOK','dbOther','deleteTask','then','recursionDeleteIndex','文件数量','../../db/dbScanTaskTable','UPDATE\x20source_folder\x20SET\x20last_scan_time=?\x20\x20WHERE\x20path=?\x20and\x20type=\x27book\x27','470058PWDLpK','扫描目录已不存在\x20','exit','7522569vFjwLX','setIndexingState','NasCabBookIndexWorker','2025474PeZIbh','dbFileIndex','log','要扫描的目录不是文件夹','statSync','816130iXqahW','8XNafso','文件夹数量','./indexUtil','path','1677196jSWaKY','4529544yNrsoG','run'];_0x27fa=function(){return _0x2d05e0;};return _0x27fa();}(function(_0x55a77f,_0x96d73a){const _0x1c5c07=_0x447a,_0x555626=_0x55a77f();while(!![]){try{const _0x5059af=parseInt(_0x1c5c07(0x1c3))/0x1+parseInt(_0x1c5c07(0x1b8))/0x2+parseInt(_0x1c5c07(0x1be))/0x3+parseInt(_0x1c5c07(0x19f))/0x4*(-parseInt(_0x1c5c07(0x1ac))/0x5)+-parseInt(_0x1c5c07(0x1a0))/0x6+-parseInt(_0x1c5c07(0x1a3))/0x7*(-parseInt(_0x1c5c07(0x1c4))/0x8)+-parseInt(_0x1c5c07(0x1bb))/0x9;if(_0x5059af===_0x96d73a)break;else _0x555626['push'](_0x555626['shift']());}catch(_0x51fb1a){_0x555626['push'](_0x555626['shift']());}}}(_0x27fa,0x696c1));const fs=require('fs'),path=require(_0x576d54(0x19e)),config=require('../../myConfig/config'),Database=require('better-sqlite3'),dbOther=new Database(config[_0x576d54(0x1b1)],{}),dbFileIndex=new Database(config[_0x576d54(0x1bf)],{});dbFileIndex['pragma'](_0x576d54(0x1a4)),dbOther['pragma'](_0x576d54(0x1a4));const dbFileIndexTable=require('../../db/dbFileIndexTable');process[_0x576d54(0x1a8)]=_0x576d54(0x1bd);const bookIndexUtil=require(_0x576d54(0x1a9)),indexTableName=dbFileIndexTable[_0x576d54(0x1b0)],dbScanTaskTable=require(_0x576d54(0x1b6)),indexUtil=require(_0x576d54(0x19d));process['on'](_0x576d54(0x1ad),(_0x1c0875,_0x211523)=>{const _0x517300=_0x576d54;console['log'](_0x517300(0x1af),_0x1c0875);});async function startIndexingFolder(_0x11bc20){return new Promise(async(_0x446a47,_0x368c69)=>{const _0x1fff82=_0x447a;try{let _0x3a6e53=new Date()[_0x1fff82(0x1ae)](),_0x7ac268=fs[_0x1fff82(0x1c2)](_0x11bc20);if(!_0x7ac268[_0x1fff82(0x1aa)]())return console[_0x1fff82(0x1c0)](_0x1fff82(0x1c1),_0x11bc20),_0x446a47();console[_0x1fff82(0x1c0)]('图书管理:\x20开始扫描',_0x11bc20),await indexUtil[_0x1fff82(0x1b4)](dbFileIndex,indexTableName,_0x11bc20);let {checkFileCount:_0x14d23b,checkPathCount:_0xe61600}=await bookIndexUtil[_0x1fff82(0x1a7)](dbOther,dbFileIndex,_0x11bc20);console[_0x1fff82(0x1c0)]('图书管理：扫描完成：'+_0x11bc20,_0x1fff82(0x1a6),new Date()['getTime']()-_0x3a6e53,'ms',_0x1fff82(0x1c5),_0xe61600,_0x1fff82(0x1b5),_0x14d23b),_0x446a47();}catch(_0x2978f9){console[_0x1fff82(0x1c0)](_0x1fff82(0x1b9),_0x11bc20),_0x446a47();}});}async function runScanTask(){const _0xe5daf8=_0x576d54;let _0x259183=dbScanTaskTable['getOnTask'](dbOther,dbScanTaskTable[_0xe5daf8(0x1ab)]);_0x259183?(dbOther['prepare'](_0xe5daf8(0x1b7))[_0xe5daf8(0x1a1)](Date[_0xe5daf8(0x1a5)](),_0x259183[_0xe5daf8(0x1a2)]),startIndexingFolder(_0x259183[_0xe5daf8(0x1a2)])[_0xe5daf8(0x1b3)](()=>{const _0x45753f=_0xe5daf8;dbScanTaskTable[_0x45753f(0x1b2)](dbOther,_0x259183['id']),runScanTask();})):(console[_0xe5daf8(0x1c0)]('图书管理:未找到扫描任务[Books\x20scanning\x20task\x20not\x20found]'),indexUtil['setIndexingState'](dbOther,indexTableName,![]),process[_0xe5daf8(0x1ba)]());}indexUtil[_0x576d54(0x1bc)](dbOther,indexTableName,!![]),runScanTask();