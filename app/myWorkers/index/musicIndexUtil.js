function _0x134a(){const _0x3dc0fe=['basename','getMonth','original_date','parseAudioTags','dirname','base64','TALB','ceil','getMediaCoverCachePath','stringify','create','389133ktFVRW','performer','writeFile','addFinalIndexToDB','is_file','getDate','24ZZzeJY','dealMediaInfo','title','2875479GMPboi','atimeMs','log','data','ctimeMs','indexOf','getById','string','tags','../../express-server/utils/sharpUtils','description','year','getMusicSameNameCover','musicTypeList','includes','9080570lTykTP','jsmediatags','getFullYear','album','music','getDurationFromStream','join','from','transStringToUtf8','2964143NTHmjB','2RokUIB','recursionFilesAddIndex','290sOHoIa','path','type','exports','duration','addOriginalDate','birthtime','NaN','lastInsertRowid','APIC','Null','761976ZoDdNm','dealFirstLetterSingle','artist','mtimeMs','coverPath','original_time','getTime','INDEX_TABLE_NAME_MUSIC','image','genre','5457080TZYTyd','picture','fileCoverPath','format','stream_info','addFileIndexToDb','genTinyFile','read','content\x20type','lyrics','streams','52112CjtUMu','temp.'];_0x134a=function(){return _0x3dc0fe;};return _0x134a();}const _0x2457ba=_0x33fc;function _0x33fc(_0x2f1a83,_0x18d3ac){const _0x134a02=_0x134a();return _0x33fc=function(_0x33fc3d,_0x49dae0){_0x33fc3d=_0x33fc3d-0xa5;let _0x4b0141=_0x134a02[_0x33fc3d];return _0x4b0141;},_0x33fc(_0x2f1a83,_0x18d3ac);}(function(_0x4f4635,_0x1f97b4){const _0x3d0f09=_0x33fc,_0x507e1b=_0x4f4635();while(!![]){try{const _0x3f123a=-parseInt(_0x3d0f09(0xaf))/0x1+-parseInt(_0x3d0f09(0xde))/0x2*(parseInt(_0x3d0f09(0xc5))/0x3)+parseInt(_0x3d0f09(0xf5))/0x4+-parseInt(_0x3d0f09(0xd4))/0x5+-parseInt(_0x3d0f09(0xeb))/0x6+parseInt(_0x3d0f09(0xdd))/0x7*(parseInt(_0x3d0f09(0xc2))/0x8)+-parseInt(_0x3d0f09(0xbc))/0x9*(-parseInt(_0x3d0f09(0xe0))/0xa);if(_0x3f123a===_0x1f97b4)break;else _0x507e1b['push'](_0x507e1b['shift']());}catch(_0x28dfb7){_0x507e1b['push'](_0x507e1b['shift']());}}}(_0x134a,0xe4377));const path=require('path'),fs=require('fs'),dbFileIndexTable=require('../../db/dbFileIndexTable'),config=require('../../myConfig/config'),videoStreamUtil=require('../../utils/videoStreamUtil'),indexUtil=require('./indexUtil');let musicUtils=require('../../utils/musicUtil');const indexTableName=dbFileIndexTable[_0x2457ba(0xf2)],musicIndexUtil={},sharpUtil=require(_0x2457ba(0xce));let jsmediatags=require(_0x2457ba(0xd5)),musicTypeList=config[_0x2457ba(0xd2)];musicIndexUtil['dealFileChange']=async function(_0x635668,_0x160177,_0xd2e203){const _0x6c87f6=_0x2457ba;await indexUtil['dealFileChange'](_0x635668,_0x160177,_0xd2e203,indexTableName,musicIndexUtil[_0x6c87f6(0xa9)],musicIndexUtil['recursionFilesAddIndex']);return;},musicIndexUtil[_0x2457ba(0xdf)]=async function(_0x1d305d,_0x2f4339,_0x4f2f8b){const _0x31e9bc=_0x2457ba;return await indexUtil['recursionFilesAddIndex'](_0x1d305d,_0x2f4339,indexTableName,_0x31e9bc(0xd8),_0x4f2f8b,musicIndexUtil[_0x31e9bc(0xa9)]);},musicIndexUtil[_0x2457ba(0xa9)]=async function(_0x375b3d,_0x1c8b06,_0x4df511,_0x5f1fb4,_0x4f0b8b,_0x1f1e2e){const _0x1937e6=_0x2457ba;let _0xd8b6de=indexUtil['doesPathCanAddToDb'](_0x375b3d,'music',config,_0x4df511,_0x5f1fb4);if(!_0xd8b6de)return;let _0x15f2fd=_0x1f1e2e['birthtimeMs'];_0x1f1e2e[_0x1937e6(0xee)]<_0x15f2fd&&(_0x15f2fd=_0x1f1e2e['mtimeMs']);_0x1f1e2e[_0x1937e6(0xc6)]<_0x15f2fd&&(_0x15f2fd=_0x1f1e2e[_0x1937e6(0xc6)]);_0x1f1e2e[_0x1937e6(0xc9)]<_0x15f2fd&&(_0x15f2fd=_0x1f1e2e[_0x1937e6(0xc9)]);let _0x23e1fc={'path':_0x4df511,'filename':_0x5f1fb4,'is_file':_0x4f0b8b,'ctime':_0x1f1e2e['ctimeMs'],'mtime':_0x1f1e2e[_0x1937e6(0xee)],'ext':path['extname'](_0x5f1fb4),'birthtime':Math[_0x1937e6(0xb8)](_0x15f2fd),'size':_0x1f1e2e['size'],'check_time':new Date()[_0x1937e6(0xf1)]()};_0x23e1fc=await musicIndexUtil['dealMediaInfo'](_0x1c8b06,_0x23e1fc);},musicIndexUtil[_0x2457ba(0xc3)]=async function(_0x393d7c,_0x4afc1a){const _0x16a055=_0x2457ba;let _0x43065e=![],_0x532e37=path[_0x16a055(0xda)](_0x4afc1a[_0x16a055(0xe1)],_0x4afc1a['filename']);if(_0x4afc1a[_0x16a055(0xc0)]==0x1&&_0x4afc1a['ext']&&musicTypeList[_0x16a055(0xd3)](_0x4afc1a['ext']['toLowerCase']())){_0x4afc1a[_0x16a055(0xe2)]=0x3;try{let _0x2bed02=await indexUtil['ffprobeSync'](_0x532e37);if(_0x2bed02&&_0x2bed02['streams']&&_0x2bed02[_0x16a055(0xae)]['length']>0x0){_0x4afc1a[_0x16a055(0xa8)]=JSON[_0x16a055(0xba)](_0x2bed02[_0x16a055(0xae)]);let _0x121ae8=videoStreamUtil[_0x16a055(0xd9)](_0x2bed02);_0x121ae8&&(_0x4afc1a[_0x16a055(0xe4)]=_0x121ae8);}if(_0x2bed02&&_0x2bed02[_0x16a055(0xa7)]&&_0x2bed02[_0x16a055(0xa7)][_0x16a055(0xcd)]){let _0x154dff=_0x2bed02[_0x16a055(0xa7)][_0x16a055(0xcd)][_0x16a055(0xd7)];_0x154dff&&(_0x4afc1a[_0x16a055(0xd7)]=_0x154dff),_0x2bed02['format']['duration']&&!_0x4afc1a[_0x16a055(0xe4)]&&(_0x4afc1a[_0x16a055(0xe4)]=_0x2bed02['format'][_0x16a055(0xe4)]);}musicIndexUtil[_0x16a055(0xb4)](_0x532e37,_0x4afc1a,_0x3e6d96=>{const _0x583ec3=_0x16a055;return _0x3e6d96[_0x583ec3(0xd7)]&&(_0x3e6d96[_0x583ec3(0xd7)]=musicUtils[_0x583ec3(0xdc)](_0x3e6d96[_0x583ec3(0xd7)])),_0x3e6d96[_0x583ec3(0xed)]&&(_0x3e6d96[_0x583ec3(0xed)]=musicUtils[_0x583ec3(0xdc)](_0x3e6d96['artist'])),_0x3e6d96[_0x583ec3(0xc4)]&&(_0x3e6d96[_0x583ec3(0xc4)]=musicUtils['transStringToUtf8'](_0x3e6d96[_0x583ec3(0xc4)])),_0x3e6d96[_0x583ec3(0xad)]&&(_0x3e6d96[_0x583ec3(0xad)]=musicUtils[_0x583ec3(0xdc)](_0x3e6d96[_0x583ec3(0xad)])),musicIndexUtil[_0x583ec3(0xe5)](_0x393d7c,_0x43065e,_0x3e6d96);});}catch(_0x45eb2f){return console['log'](_0x45eb2f),musicIndexUtil[_0x16a055(0xe5)](_0x393d7c,_0x43065e,_0x4afc1a);}}else{if(_0x4afc1a[_0x16a055(0xc0)]==0x1)return;return musicIndexUtil[_0x16a055(0xe5)](_0x393d7c,_0x43065e,_0x4afc1a);}},musicIndexUtil[_0x2457ba(0xe5)]=function(_0x3ff21f,_0x30e545,_0x2f39f9){const _0x4a1577=_0x2457ba;_0x30e545&&_0x30e545<config['exifMinTimeStamp']&&(_0x30e545=![]);(!_0x30e545||_0x30e545==_0x4a1577(0xe7)||_0x30e545=='Nan'||_0x30e545==_0x4a1577(0xe7)||_0x30e545==_0x4a1577(0xea))&&(_0x30e545=_0x2f39f9[_0x4a1577(0xe6)]||_0x2f39f9['ctime']);let _0x20ca83=new Date(_0x30e545);_0x2f39f9[_0x4a1577(0xf0)]=_0x20ca83[_0x4a1577(0xf1)]();let _0x157664=_0x20ca83[_0x4a1577(0xd6)](),_0x3fedd9=_0x20ca83[_0x4a1577(0xb2)]()+0x1;_0x3fedd9=_0x3fedd9>=0xa?_0x3fedd9:'0'+_0x3fedd9;let _0x4d1e4b=_0x20ca83[_0x4a1577(0xc1)]();_0x4d1e4b=_0x4d1e4b>=0xa?_0x4d1e4b:'0'+_0x4d1e4b,_0x2f39f9[_0x4a1577(0xb3)]=_0x157664+'-'+_0x3fedd9+'-'+_0x4d1e4b,musicIndexUtil[_0x4a1577(0xbf)](_0x3ff21f,_0x2f39f9);},musicIndexUtil[_0x2457ba(0xbf)]=function(_0x17cd22,_0x3ccb9e){const _0x4a0942=_0x2457ba;!_0x3ccb9e[_0x4a0942(0xd7)]&&(_0x3ccb9e[_0x4a0942(0xd7)]=path['basename'](_0x3ccb9e['path']));let _0x28de07=musicUtils[_0x4a0942(0xd1)](_0x17cd22,_0x3ccb9e);_0x3ccb9e[_0x4a0942(0xa6)]=_0x28de07?_0x28de07:'';let _0x310f11=dbFileIndexTable[_0x4a0942(0xbb)](_0x17cd22,_0x3ccb9e,indexTableName);if(_0x310f11&&_0x310f11[_0x4a0942(0xe8)]){let _0x58fedb=dbFileIndexTable[_0x4a0942(0xcb)](_0x17cd22,_0x310f11[_0x4a0942(0xe8)],dbFileIndexTable[_0x4a0942(0xf2)]);_0x58fedb&&musicUtils[_0x4a0942(0xec)](_0x17cd22,_0x58fedb);}},musicIndexUtil[_0x2457ba(0xb4)]=function(_0x28b409,_0x2305d7,_0x5a226c){const _0x3b497a=_0x2457ba;function _0x341256(_0x35e96a,_0x24f0a9,_0x4d029b,_0x2233ce,_0x5a576a){const _0xf70083=_0x33fc;try{!_0x2305d7[_0x24f0a9]&&(_0x35e96a[_0x4d029b]&&typeof _0x35e96a[_0x4d029b]==_0xf70083(0xcc)&&(_0x2305d7[_0x4d029b]=_0x35e96a[_0x4d029b]),!_0x2305d7[_0x24f0a9]&&_0x2233ce&&_0x35e96a[_0x2233ce]&&_0x35e96a[_0x2233ce][_0xf70083(0xc8)]&&typeof _0x35e96a[_0x2233ce][_0xf70083(0xc8)]==_0xf70083(0xcc)&&_0x35e96a[_0x2233ce][_0xf70083(0xcf)]&&typeof _0x35e96a[_0x2233ce][_0xf70083(0xcf)]==_0xf70083(0xcc)&&_0x35e96a[_0x2233ce][_0xf70083(0xcf)]['toLowerCase']()[_0xf70083(0xca)](_0x5a576a)!=-0x1&&(_0x2305d7[_0x24f0a9]=_0x35e96a[_0x2233ce][_0xf70083(0xc8)]));}catch(_0x479dbf){console[_0xf70083(0xc7)](_0x479dbf);}}jsmediatags[_0x3b497a(0xab)](_0x28b409,{'onSuccess':function(_0x5307c1){const _0x5aa2b6=_0x3b497a;let _0x3e11e1=_0x5307c1[_0x5aa2b6(0xcd)];_0x341256(_0x3e11e1,'album',_0x5aa2b6(0xd7),_0x5aa2b6(0xb7),_0x5aa2b6(0xd7)),_0x341256(_0x3e11e1,_0x5aa2b6(0xc4),_0x5aa2b6(0xc4),'TIT2',_0x5aa2b6(0xc4)),_0x341256(_0x3e11e1,'artist',_0x5aa2b6(0xed),'TPE1',_0x5aa2b6(0xbd)),_0x341256(_0x3e11e1,_0x5aa2b6(0xd0),_0x5aa2b6(0xd0),'TYER',_0x5aa2b6(0xd0)),_0x341256(_0x3e11e1,_0x5aa2b6(0xf4),'genre','TYER',_0x5aa2b6(0xac));try{_0x3e11e1[_0x5aa2b6(0xad)]&&(_0x3e11e1[_0x5aa2b6(0xad)]=JSON['stringify'](_0x3e11e1['lyrics'])),_0x341256(_0x3e11e1,_0x5aa2b6(0xad),_0x5aa2b6(0xad),'','');}catch(_0x2ba0fa){console[_0x5aa2b6(0xc7)](_0x2ba0fa);}var _0x16026a;_0x3e11e1[_0x5aa2b6(0xa5)]&&_0x3e11e1['picture'][_0x5aa2b6(0xc8)]&&(_0x16026a=_0x3e11e1[_0x5aa2b6(0xa5)]['data']);!_0x16026a&&_0x3e11e1['APIC']&&_0x3e11e1[_0x5aa2b6(0xe9)][_0x5aa2b6(0xc8)]&&_0x3e11e1[_0x5aa2b6(0xe9)][_0x5aa2b6(0xc8)][_0x5aa2b6(0xc8)]&&(_0x16026a=_0x3e11e1[_0x5aa2b6(0xe9)][_0x5aa2b6(0xc8)][_0x5aa2b6(0xc8)]);let _0x406ef8='';if(_0x16026a){let _0x610e65=0x200;_0x406ef8=config[_0x5aa2b6(0xb9)](_0x2305d7,_0x610e65);let _0x1ee8a0=path[_0x5aa2b6(0xda)](path[_0x5aa2b6(0xb5)](_0x406ef8),_0x5aa2b6(0xb0)+path[_0x5aa2b6(0xb1)](_0x406ef8));fs[_0x5aa2b6(0xbe)](_0x1ee8a0,Buffer[_0x5aa2b6(0xdb)](_0x16026a),{'encoding':_0x5aa2b6(0xb6)},function(_0x1c47a7){const _0x434443=_0x5aa2b6;_0x1c47a7?console['log'](_0x1c47a7):sharpUtil[_0x434443(0xaa)](_0x1ee8a0,path[_0x434443(0xb5)](_0x406ef8),path['basename'](_0x406ef8),_0x434443(0xf3),null,_0x7e0e59=>{const _0x43fd7a=_0x434443;_0x2305d7[_0x43fd7a(0xef)]=_0x406ef8,fs['rm'](_0x1ee8a0,_0x169f60=>{}),_0x5a226c(_0x2305d7);},_0x55ae4c=>{_0x5a226c(_0x2305d7);},_0x610e65);});}else _0x5a226c(_0x2305d7);},'onError':function(_0x192a8e){const _0x134df3=_0x3b497a;console[_0x134df3(0xc7)](_0x192a8e),_0x5a226c(_0x2305d7);}});},module[_0x2457ba(0xe3)]=musicIndexUtil;