const _0xb204be=_0x5f58;(function(_0x13b6e0,_0x20c6b7){const _0x2d2fec=_0x5f58,_0x54e978=_0x13b6e0();while(!![]){try{const _0x5d4c6c=parseInt(_0x2d2fec(0x1c5))/0x1*(parseInt(_0x2d2fec(0x1aa))/0x2)+parseInt(_0x2d2fec(0x1b8))/0x3*(-parseInt(_0x2d2fec(0x1b9))/0x4)+parseInt(_0x2d2fec(0x1ae))/0x5*(-parseInt(_0x2d2fec(0x1b0))/0x6)+-parseInt(_0x2d2fec(0x195))/0x7+-parseInt(_0x2d2fec(0x1c4))/0x8*(parseInt(_0x2d2fec(0x19c))/0x9)+parseInt(_0x2d2fec(0x19d))/0xa+parseInt(_0x2d2fec(0x1cc))/0xb;if(_0x5d4c6c===_0x20c6b7)break;else _0x54e978['push'](_0x54e978['shift']());}catch(_0x3a4526){_0x54e978['push'](_0x54e978['shift']());}}}(_0x3bba,0xd692d));const {parentPort,workerData}=require('worker_threads'),EPub=require('epub'),mobiNode=require(_0xb204be(0x1bb)),mobiJs=require(_0xb204be(0x1c6)),fflate=require('./bookFflate'),fs=require('fs'),path=require(_0xb204be(0x1a0));function _0x5f58(_0x5ca625,_0x465047){const _0x3bbaf9=_0x3bba();return _0x5f58=function(_0x5f583c,_0x4f77ec){_0x5f583c=_0x5f583c-0x192;let _0xcb6ae6=_0x3bbaf9[_0x5f583c];return _0xcb6ae6;},_0x5f58(_0x5ca625,_0x465047);}let originalTime=null,coverData=null,zipUtil=require(_0xb204be(0x1a5));function _0x3bba(){const _0x361b71=['exit','metadata_state','language','.rar','../../utils/zipUtil','parse','book-type','close','end','2wdyMZu','comic','dealedBuffer','.cbr','233355nFrbEc','ext','48GijUIp','没有找到需要处理的书籍目录','.cbz','catch','cover','MOBI写入书籍封面缓存：','total_page','publisher','54lQpwnC','113112VgzFHf','bookCoverCachePath','./bookMobiNode','error','未找到封面','indexObj','title','existsSync','getZipCover','postMessage','coverPath','8gOmoZV','78931IqqfyN','mobi','from','metadata','封面缓存已经存在','join','readFileSync','20769848cukZxp','filename','getCover','log','date','2204062EFuBIV','.mobi','fileCount','.epub','onlyGenCover','.azw3','.zip','11422071FpPeks','13781510kqIQTv','err2','Worker\x20error:','path'];_0x3bba=function(){return _0x361b71;};return _0x3bba();}function returnResult(){const _0x4db8b0=_0xb204be;parentPort[_0x4db8b0(0x1c2)]({'code':0x0,'indexObj':workerData[_0x4db8b0(0x1be)],'originalTime':originalTime,'coverData':coverData}),process[_0x4db8b0(0x1a1)](0x0);}async function genBookInfoMobi(_0x45a2e0){const _0x898ff3=_0xb204be;if(!workerData[_0x898ff3(0x199)])try{let _0x24a225=new mobiJs(_0x45a2e0);_0x24a225[_0x898ff3(0x1bf)]&&(workerData[_0x898ff3(0x1be)][_0x898ff3(0x1bf)]=_0x24a225[_0x898ff3(0x1bf)]),workerData[_0x898ff3(0x1be)][_0x898ff3(0x1a2)]=0x1;}catch(_0x310d8e){}try{if(fs[_0x898ff3(0x1c0)](workerData[_0x898ff3(0x1ba)]))return console['log'](_0x898ff3(0x1c9),workerData[_0x898ff3(0x1be)][_0x898ff3(0x1cd)]),workerData['indexObj'][_0x898ff3(0x1c3)]=workerData[_0x898ff3(0x1ba)],returnResult();let _0x144c31=fs[_0x898ff3(0x1cb)](_0x45a2e0),_0x5a57dc=await new mobiNode['MOBI']({'unzlib':fflate['unzlibSync']})['open'](new Uint8Array(_0x144c31)),_0x2bbaa5=await _0x5a57dc[_0x898ff3(0x192)]();if(!_0x2bbaa5)return returnResult();return console[_0x898ff3(0x193)](_0x898ff3(0x1b5),workerData[_0x898ff3(0x1be)][_0x898ff3(0x1cd)]),coverData=Buffer[_0x898ff3(0x1c7)](_0x2bbaa5),returnResult();}catch(_0x1e288d){return console[_0x898ff3(0x193)](_0x898ff3(0x19e),_0x1e288d),returnResult();}}async function genBookInfoEpub(_0x591657){const _0x3c199f=_0xb204be;let _0x328f8c=new EPub(_0x591657);_0x328f8c['on'](_0x3c199f(0x1a9),function(){const _0x2dd305=_0x3c199f;if(_0x328f8c[_0x2dd305(0x1c8)]){let _0x31f101=_0x328f8c[_0x2dd305(0x1c8)];_0x31f101['creator']&&(workerData[_0x2dd305(0x1be)]['artist']=_0x31f101['creator']);_0x31f101[_0x2dd305(0x1b7)]&&(workerData['indexObj'][_0x2dd305(0x1b7)]=_0x31f101[_0x2dd305(0x1b7)]);_0x31f101[_0x2dd305(0x1a3)]&&(workerData['indexObj'][_0x2dd305(0x1a3)]=_0x31f101['language']);_0x31f101[_0x2dd305(0x1bf)]&&(workerData[_0x2dd305(0x1be)]['title']=_0x31f101['title']);_0x31f101[_0x2dd305(0x1a7)]&&(console[_0x2dd305(0x193)](_0x2dd305(0x1a7),_0x31f101['book-type']),_0x31f101['book-type']==_0x2dd305(0x1ab)&&(workerData['indexObj']['type']=0x2));if(_0x31f101[_0x2dd305(0x194)])try{originalTime=new Date(_0x31f101[_0x2dd305(0x194)])['getTime']();}catch(_0x3da270){console['log'](_0x3da270);}workerData[_0x2dd305(0x1be)][_0x2dd305(0x1a2)]=0x1;if(fs[_0x2dd305(0x1c0)](workerData[_0x2dd305(0x1ba)]))return console[_0x2dd305(0x193)](_0x2dd305(0x1c9),workerData[_0x2dd305(0x1be)][_0x2dd305(0x1cd)]),workerData[_0x2dd305(0x1be)]['coverPath']=workerData[_0x2dd305(0x1ba)],returnResult();_0x328f8c['metadata'][_0x2dd305(0x1b4)]?_0x328f8c['getImage'](_0x328f8c[_0x2dd305(0x1c8)][_0x2dd305(0x1b4)],async(_0x386940,_0x37307f,_0x3abf9d)=>{const _0x309c7d=_0x2dd305;return console['log']('EPUB写入书籍封面缓存：',workerData[_0x309c7d(0x1ba)]),coverData=_0x37307f,returnResult();}):returnResult();}else returnResult();}),_0x328f8c['on']('error',()=>{const _0x5164d4=_0x3c199f;console[_0x5164d4(0x193)]('epub解析失败',_0x591657),returnResult();}),_0x328f8c[_0x3c199f(0x1a6)]();}async function genBookInfoZip(_0xc33e14){const _0x1c3a42=_0xb204be;zipUtil[_0x1c3a42(0x1c1)](_0xc33e14)['then'](_0x2a5fd9=>{const _0x44efde=_0x1c3a42;if(!_0x2a5fd9)return console[_0x44efde(0x193)](_0x44efde(0x1bd),_0xc33e14),returnResult();let _0x331f96=_0x2a5fd9[_0x44efde(0x1ac)],_0x2c3130=_0x2a5fd9[_0x44efde(0x197)];_0x331f96&&(coverData=_0x331f96),_0x2c3130&&(workerData[_0x44efde(0x1be)][_0x44efde(0x1b6)]=_0x2c3130),returnResult();})[_0x1c3a42(0x1b3)](_0x47e294=>{const _0x5bba1b=_0x1c3a42;console[_0x5bba1b(0x193)](_0x47e294);});}if(workerData&&workerData[_0xb204be(0x1be)]&&workerData[_0xb204be(0x1ba)]){let bookFullPath=path[_0xb204be(0x1ca)](workerData[_0xb204be(0x1be)][_0xb204be(0x1a0)],workerData['indexObj']['filename']),lowerExt=workerData[_0xb204be(0x1be)][_0xb204be(0x1af)]['toLowerCase']();if(fs[_0xb204be(0x1c0)](bookFullPath)){if(lowerExt==_0xb204be(0x198))genBookInfoEpub(bookFullPath);else{if(lowerExt==_0xb204be(0x196)||lowerExt==_0xb204be(0x19a)||lowerExt=='.azw')genBookInfoMobi(bookFullPath);else lowerExt==_0xb204be(0x1b2)||lowerExt==_0xb204be(0x19b)||lowerExt==_0xb204be(0x1ad)||lowerExt==_0xb204be(0x1a4)?genBookInfoZip(bookFullPath):returnResult();}}else returnResult();}else console['log'](_0xb204be(0x1b1)),returnResult();parentPort['on'](_0xb204be(0x1bc),_0x2b5681=>{const _0x24c7c2=_0xb204be;console[_0x24c7c2(0x1bc)](_0x24c7c2(0x19f),_0x2b5681),returnResult();}),parentPort['on'](_0xb204be(0x1a8),()=>{const _0x4f2190=_0xb204be;console[_0x4f2190(0x193)]('Worker\x20stopped.');});