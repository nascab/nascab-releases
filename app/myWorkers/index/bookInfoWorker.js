const _0x2629b1=_0x10e1;(function(_0x299dfe,_0x5bba29){const _0x5a1a32=_0x10e1,_0x13ba15=_0x299dfe();while(!![]){try{const _0x537ce2=parseInt(_0x5a1a32(0x163))/0x1+-parseInt(_0x5a1a32(0x162))/0x2*(parseInt(_0x5a1a32(0x176))/0x3)+-parseInt(_0x5a1a32(0x14a))/0x4+parseInt(_0x5a1a32(0x13a))/0x5*(-parseInt(_0x5a1a32(0x157))/0x6)+-parseInt(_0x5a1a32(0x143))/0x7*(-parseInt(_0x5a1a32(0x13e))/0x8)+-parseInt(_0x5a1a32(0x155))/0x9*(-parseInt(_0x5a1a32(0x15d))/0xa)+parseInt(_0x5a1a32(0x142))/0xb*(-parseInt(_0x5a1a32(0x150))/0xc);if(_0x537ce2===_0x5bba29)break;else _0x13ba15['push'](_0x13ba15['shift']());}catch(_0x56ce89){_0x13ba15['push'](_0x13ba15['shift']());}}}(_0x4a94,0x475f2));const {parentPort,workerData}=require('worker_threads'),EPub=require(_0x2629b1(0x159)),mobiNode=require(_0x2629b1(0x17c)),mobiJs=require(_0x2629b1(0x170)),fflate=require(_0x2629b1(0x15a)),fs=require('fs'),path=require(_0x2629b1(0x178));function _0x4a94(){const _0x515cf6=['25blMVCI','getTime','existsSync','.zip','1448bprNYd','.epub','err2','getZipCover','572KNgJIj','12761UplvLn','ext','publisher','catch','dealedBuffer','.azw','metadata_state','1826300msbvhf','book-type','.mobi','close','cover','Worker\x20error:','28344FeprfO','filename','parse','未找到封面','unzlibSync','9zjKJeb','.cbz','59154OaDjMv','Worker\x20stopped.','epub','./bookFflate','bookCoverCachePath','from','1532560JmKtPo','postMessage','log','coverPath','getCover','142wGmdRq','492696bqwfGM','date','error','end','title','comic','language','MOBI写入书籍封面缓存：','metadata','没有找到需要处理的书籍目录','../../utils/zipUtil','fileCount','indexObj','mobi','封面缓存已经存在','artist','EPUB写入书籍封面缓存：','exit','getImage','2319Ryvknp','.cbr','path','type','.rar','then','./bookMobiNode','creator'];_0x4a94=function(){return _0x515cf6;};return _0x4a94();}let originalTime=null,coverData=null,zipUtil=require(_0x2629b1(0x16d));function returnResult(){const _0x44024e=_0x2629b1;parentPort[_0x44024e(0x15e)]({'code':0x0,'indexObj':workerData[_0x44024e(0x16f)],'originalTime':originalTime,'coverData':coverData}),process[_0x44024e(0x174)](0x0);}function _0x10e1(_0x184e05,_0x59f4e9){const _0x4a94db=_0x4a94();return _0x10e1=function(_0x10e1d8,_0x5b7098){_0x10e1d8=_0x10e1d8-0x13a;let _0x3eda0d=_0x4a94db[_0x10e1d8];return _0x3eda0d;},_0x10e1(_0x184e05,_0x59f4e9);}async function genBookInfoMobi(_0x1984e0){const _0x5b67f4=_0x2629b1;if(!workerData['onlyGenCover'])try{let _0x1f8f8d=new mobiJs(_0x1984e0);_0x1f8f8d[_0x5b67f4(0x167)]&&(workerData[_0x5b67f4(0x16f)][_0x5b67f4(0x167)]=_0x1f8f8d[_0x5b67f4(0x167)]),workerData['indexObj'][_0x5b67f4(0x149)]=0x1;}catch(_0x33b51c){}try{if(fs[_0x5b67f4(0x13c)](workerData[_0x5b67f4(0x15b)]))return console[_0x5b67f4(0x15f)](_0x5b67f4(0x171),workerData['indexObj'][_0x5b67f4(0x151)]),workerData[_0x5b67f4(0x16f)][_0x5b67f4(0x160)]=workerData['bookCoverCachePath'],returnResult();let _0x997cd7=fs['readFileSync'](_0x1984e0),_0x5a2385=await new mobiNode['MOBI']({'unzlib':fflate[_0x5b67f4(0x154)]})['open'](new Uint8Array(_0x997cd7)),_0xee9ca8=await _0x5a2385[_0x5b67f4(0x161)]();if(!_0xee9ca8)return returnResult();return console[_0x5b67f4(0x15f)](_0x5b67f4(0x16a),workerData[_0x5b67f4(0x16f)][_0x5b67f4(0x151)]),coverData=Buffer[_0x5b67f4(0x15c)](_0xee9ca8),returnResult();}catch(_0x460265){return console[_0x5b67f4(0x15f)](_0x5b67f4(0x140),_0x460265),returnResult();}}async function genBookInfoEpub(_0x524fe2){const _0x4089b7=_0x2629b1;let _0x24aba2=new EPub(_0x524fe2);_0x24aba2['on'](_0x4089b7(0x166),function(){const _0x31727b=_0x4089b7;if(_0x24aba2[_0x31727b(0x16b)]){let _0x403416=_0x24aba2[_0x31727b(0x16b)];_0x403416[_0x31727b(0x17d)]&&(workerData[_0x31727b(0x16f)][_0x31727b(0x172)]=_0x403416[_0x31727b(0x17d)]);_0x403416[_0x31727b(0x145)]&&(workerData[_0x31727b(0x16f)]['publisher']=_0x403416[_0x31727b(0x145)]);_0x403416[_0x31727b(0x169)]&&(workerData[_0x31727b(0x16f)]['language']=_0x403416[_0x31727b(0x169)]);_0x403416[_0x31727b(0x167)]&&(workerData['indexObj'][_0x31727b(0x167)]=_0x403416['title']);_0x403416[_0x31727b(0x14b)]&&(console[_0x31727b(0x15f)](_0x31727b(0x14b),_0x403416['book-type']),_0x403416[_0x31727b(0x14b)]==_0x31727b(0x168)&&(workerData[_0x31727b(0x16f)][_0x31727b(0x179)]=0x2));if(_0x403416[_0x31727b(0x164)])try{originalTime=new Date(_0x403416[_0x31727b(0x164)])[_0x31727b(0x13b)]();}catch(_0x49047f){console[_0x31727b(0x15f)](_0x49047f);}workerData[_0x31727b(0x16f)][_0x31727b(0x149)]=0x1;if(fs[_0x31727b(0x13c)](workerData[_0x31727b(0x15b)]))return console['log'](_0x31727b(0x171),workerData[_0x31727b(0x16f)]['filename']),workerData[_0x31727b(0x16f)][_0x31727b(0x160)]=workerData[_0x31727b(0x15b)],returnResult();_0x24aba2[_0x31727b(0x16b)][_0x31727b(0x14e)]?_0x24aba2[_0x31727b(0x175)](_0x24aba2['metadata'][_0x31727b(0x14e)],async(_0x5aa114,_0x108603,_0x324a66)=>{const _0x1532bb=_0x31727b;return console[_0x1532bb(0x15f)](_0x1532bb(0x173),workerData['bookCoverCachePath']),coverData=_0x108603,returnResult();}):returnResult();}else returnResult();}),_0x24aba2['on'](_0x4089b7(0x165),()=>{console['log']('epub解析失败',_0x524fe2),returnResult();}),_0x24aba2[_0x4089b7(0x152)]();}async function genBookInfoZip(_0x2bcb7e){const _0x247677=_0x2629b1;zipUtil[_0x247677(0x141)](_0x2bcb7e)[_0x247677(0x17b)](_0x5e0a8e=>{const _0x166839=_0x247677;if(!_0x5e0a8e)return console[_0x166839(0x15f)](_0x166839(0x153),_0x2bcb7e),returnResult();let _0x10c0e1=_0x5e0a8e[_0x166839(0x147)],_0x2df392=_0x5e0a8e[_0x166839(0x16e)];_0x10c0e1&&(coverData=_0x10c0e1),_0x2df392&&(workerData[_0x166839(0x16f)]['total_page']=_0x2df392),returnResult();})[_0x247677(0x146)](_0x4aa8be=>{const _0x3fedbf=_0x247677;console[_0x3fedbf(0x15f)](_0x4aa8be);});}if(workerData&&workerData['indexObj']&&workerData[_0x2629b1(0x15b)]){let bookFullPath=path['join'](workerData[_0x2629b1(0x16f)][_0x2629b1(0x178)],workerData[_0x2629b1(0x16f)][_0x2629b1(0x151)]),lowerExt=workerData[_0x2629b1(0x16f)][_0x2629b1(0x144)]['toLowerCase']();if(fs[_0x2629b1(0x13c)](bookFullPath)){if(lowerExt==_0x2629b1(0x13f))genBookInfoEpub(bookFullPath);else{if(lowerExt==_0x2629b1(0x14c)||lowerExt=='.azw3'||lowerExt==_0x2629b1(0x148))genBookInfoMobi(bookFullPath);else lowerExt==_0x2629b1(0x156)||lowerExt==_0x2629b1(0x13d)||lowerExt==_0x2629b1(0x177)||lowerExt==_0x2629b1(0x17a)?genBookInfoZip(bookFullPath):returnResult();}}else returnResult();}else console[_0x2629b1(0x15f)](_0x2629b1(0x16c)),returnResult();parentPort['on'](_0x2629b1(0x165),_0x4bf489=>{const _0x1ed0c7=_0x2629b1;console[_0x1ed0c7(0x165)](_0x1ed0c7(0x14f),_0x4bf489),returnResult();}),parentPort['on'](_0x2629b1(0x14d),()=>{const _0x1709ab=_0x2629b1;console['log'](_0x1709ab(0x158));});