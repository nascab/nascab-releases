function _0x4ddf(_0x1ab1e6,_0x1044c2){const _0x23dfcd=_0x23df();return _0x4ddf=function(_0x4ddfaf,_0x4fe421){_0x4ddfaf=_0x4ddfaf-0xb2;let _0x2106e1=_0x23dfcd[_0x4ddfaf];return _0x2106e1;},_0x4ddf(_0x1ab1e6,_0x1044c2);}const _0x24f9d0=_0x4ddf;function _0x23df(){const _0x580278=['linux','缓存数据目录内的变动，不处理','nascabconfig','文件夹已不存在\x20删除文件夹及文件夹下的索引','312725Xpbapt','replace','4061832xnbLFo','文件已不存在','split','readdirSync','cacheParentPath','existsSync','sep','20LNQvxj','create','mtimeMs','5TmugEu','uploadTempFilePrefix','checkPathIsInPrivateSpace','\x27\x20or\x20\x27','log','耗时:','来源目录不存在了\x20不处理文件\x20','endsWith','5084008ukEaar','fullPath','some','has','dealFFmpegPath','pop','fileName','err','dealFileChange','getByPath','darwin','recursionFilesAddIndex','isFile','.bc!','recursionDeleteIndex','ffprobe','watchPath','exports','push','error','doesPathCanAddToDb','2156625GaVHRV','is_file','.downloading','../../libs/nasTrans','FFmpeg','filename','isForbiddenPath','../../myConfig/config','length','******New\x20folder******','add','statSync','.xltd','isPathInHiddenDir','getTime','../../db/dbConfigTable','join','4635448ULIGji','来源目录已不存在\x20停止扫描','getPathAllOnlyChild','/proc/','path','delete','Skip\x20hidden\x20file/folder\x20','deleteByPathAndFileName','filePath','.qkdownloading','dbPath','211280jkGQFo','startsWith','ENOENT','../../utils/transCodeUtil','get','dbnascab','prepare','******New\x20file******:','isDirectory','1613835XXdDHr','dbnascab-journal','Not\x20in\x20source\x20folder\x20','../../db/dbFileIndexTable','`folder_path`||\x27','code','.td','tiny','isPathIsInSourceFolder','180nehDMO','deletePathAll','\x27\x20like\x20','../../db/dbSourceFolderTable','isForbiddenFilename'];_0x23df=function(){return _0x580278;};return _0x23df();}(function(_0x2089ab,_0x522a35){const _0x5df602=_0x4ddf,_0x31ed91=_0x2089ab();while(!![]){try{const _0x9c3688=-parseInt(_0x5df602(0xc8))/0x1+parseInt(_0x5df602(0xbf))/0x2+-parseInt(_0x5df602(0xdc))/0x3+parseInt(_0x5df602(0xee))/0x4*(parseInt(_0x5df602(0xe6))/0x5)+parseInt(_0x5df602(0xd1))/0x6*(parseInt(_0x5df602(0xda))/0x7)+parseInt(_0x5df602(0xb4))/0x8+parseInt(_0x5df602(0x103))/0x9*(parseInt(_0x5df602(0xe3))/0xa);if(_0x9c3688===_0x522a35)break;else _0x31ed91['push'](_0x31ed91['shift']());}catch(_0x114ecd){_0x31ed91['push'](_0x31ed91['shift']());}}}(_0x23df,0xc5372));let indexUtil={};const currentPlatform=require('os')['platform'](),path=require('path'),dbSourceFolderTable=require(_0x24f9d0(0xd4)),dbFileIndexTable=require(_0x24f9d0(0xcb)),dbConfigTable=require(_0x24f9d0(0xb2)),config=require(_0x24f9d0(0x10a)),fs=require('fs');let FFmpeg=require(_0x24f9d0(0x106))[_0x24f9d0(0x107)];const transCodeUtil=require(_0x24f9d0(0xc2));indexUtil[_0x24f9d0(0xf9)]=async function(_0x45fbe7,_0x462255,_0x480dd2,_0x241c79,_0x19fa31,_0x2e7031,_0x4c7019){const _0x45444d=_0x24f9d0;let _0x425e26=0x1,_0x1c9c04=0x0;try{let _0x2bd9fe=[{'path':_0x19fa31,'files':fs[_0x45444d(0xdf)](_0x19fa31)}];while(_0x2bd9fe[_0x45444d(0x10b)]>0x0){let {path:_0x4df051,files:_0x5d08aa}=_0x2bd9fe['pop']();if(indexUtil['checkPathIsInPrivateSpace'](_0x45fbe7,_0x4df051))continue;if(indexUtil[_0x45444d(0x110)](_0x4df051)){console['log'](_0x45444d(0xba)+_0x4df051);continue;}for(let _0x484656=0x0;_0x484656<_0x5d08aa[_0x45444d(0x10b)];_0x484656++){let _0x31d116=_0x5d08aa[_0x484656];if(_0x31d116[_0x45444d(0xc0)](config['uploadTempFilePrefix']))continue;if(!indexUtil[_0x45444d(0xd0)](_0x45fbe7,_0x241c79,_0x19fa31))return console['log'](_0x45444d(0xb5),_0x19fa31),![];let _0x1aba08=path[_0x45444d(0xb3)](_0x4df051,_0x31d116);try{let _0x2b0301=fs[_0x45444d(0x10e)](_0x1aba08),_0x2770a5=dbFileIndexTable[_0x45444d(0xf7)](_0x462255,_0x4df051,_0x31d116,_0x480dd2);if(_0x2b0301['isFile']())!_0x2770a5&&await _0x2e7031(_0x45fbe7,_0x462255,_0x4df051,_0x31d116,0x1,_0x2b0301),_0x1c9c04+=0x1;else _0x2b0301[_0x45444d(0xc7)]()&&(!_0x2770a5&&await _0x2e7031(_0x45fbe7,_0x462255,_0x4df051,_0x31d116,0x0,_0x2b0301),_0x2bd9fe[_0x45444d(0x100)]({'path':_0x1aba08,'files':fs[_0x45444d(0xdf)](_0x1aba08)}),_0x425e26+=0x1);_0x4c7019&&_0x4c7019();}catch(_0x8531ca){console['log'](_0x45444d(0xf5),_0x8531ca);continue;}}}return{'checkFileCount':_0x1c9c04,'checkPathCount':_0x425e26};}catch(_0x1ed95b){return console['log'](_0x45444d(0x101),_0x1ed95b),{'checkFileCount':_0x1c9c04,'checkPathCount':_0x425e26};}},indexUtil[_0x24f9d0(0xf6)]=async function(_0x39a743,_0x467188,_0x1cba55,_0xe3726a,_0xb59f79,_0x5720f4,_0x5f06a7){const _0x2ac1e3=_0x24f9d0;let _0x5651d0=_0x1cba55[_0x2ac1e3(0xfe)],_0x4b1292=_0x1cba55[_0x2ac1e3(0xbc)],_0x4fd6a8=_0x1cba55[_0x2ac1e3(0xf4)],_0x1146e1=_0x1cba55[_0x2ac1e3(0xef)];if(_0x4fd6a8['startsWith'](config[_0x2ac1e3(0xe7)]))return;let _0x182173=dbSourceFolderTable[_0x2ac1e3(0xf7)](_0x467188,_0x5651d0);if(!_0x182173){console['log'](_0x2ac1e3(0xec),_0x5651d0);return;}let _0xafae4b=dbFileIndexTable[_0x2ac1e3(0xf7)](_0x39a743,_0x4b1292,_0x4fd6a8,_0xe3726a);try{let _0x2c416f=fs[_0x2ac1e3(0x10e)](_0x1146e1);if(_0x2c416f[_0x2ac1e3(0xfa)]()&&!_0xafae4b)console['log'](_0x2ac1e3(0xc6),_0x4fd6a8),await _0xb59f79(_0x467188,_0x39a743,_0x4b1292,_0x4fd6a8,0x1,_0x2c416f);else{if(_0x2c416f['isDirectory']()&&!_0xafae4b)console[_0x2ac1e3(0xea)](_0x2ac1e3(0x10c),_0x1146e1),await _0xb59f79(_0x467188,_0x39a743,_0x4b1292,_0x4fd6a8,0x0,_0x2c416f),await _0x5720f4(_0x467188,_0x39a743,_0x1146e1);else{if(_0x2c416f&&_0xafae4b){if(_0x2c416f[_0x2ac1e3(0xe5)]!=_0xafae4b['mtime']){let _0x438ff7=dbFileIndexTable[_0x2ac1e3(0xbb)](_0x39a743,_0x4b1292,_0x4fd6a8,_0xe3726a);_0x5f06a7&&_0x5f06a7(_0xafae4b,_0x438ff7),await _0xb59f79(_0x467188,_0x39a743,_0x4b1292,_0x4fd6a8,_0x2c416f['isFile']()?0x1:0x0,_0x2c416f);}else{}}}}}catch(_0x4e6b48){console['log'](_0x2ac1e3(0xdd),_0x4b1292,_0x4fd6a8);try{if(_0x4e6b48[_0x2ac1e3(0xcd)]==_0x2ac1e3(0xc1)){if(_0xafae4b&&_0xafae4b[_0x2ac1e3(0x104)]==0x1){let _0x3834a2=dbFileIndexTable[_0x2ac1e3(0xbb)](_0x39a743,_0x4b1292,_0x4fd6a8,_0xe3726a);_0x5f06a7&&_0x5f06a7(_0xafae4b,_0x3834a2);}else _0xafae4b&&_0xafae4b[_0x2ac1e3(0x104)]==0x0&&(dbFileIndexTable[_0x2ac1e3(0xbb)](_0x39a743,_0x4b1292,_0x4fd6a8,_0xe3726a),dbFileIndexTable[_0x2ac1e3(0xd2)](_0x39a743,_0x1146e1,_0xe3726a));}else console[_0x2ac1e3(0xea)](_0x4e6b48);}catch(_0x9a9748){console[_0x2ac1e3(0xea)](_0x9a9748);}}return;},indexUtil['ffprobeSync']=function(_0x2a1ccc){return new Promise((_0x55ee13,_0x354501)=>{const _0x236402=_0x4ddf;try{FFmpeg(transCodeUtil[_0x236402(0xf2)](_0x2a1ccc))[_0x236402(0xfd)]((_0xba73f6,_0x363f52)=>{_0xba73f6?_0x354501(_0xba73f6):_0x55ee13(_0x363f52);});}catch(_0x652f){_0x354501(_0x652f);}});},indexUtil[_0x24f9d0(0x110)]=function(_0x42af3a){const _0x5aeda4=_0x24f9d0;try{const _0x27a137=_0x42af3a[_0x5aeda4(0xde)](/[\/\\]/)['filter'](Boolean);return _0x27a137[_0x5aeda4(0xf0)](_0xeccf6d=>_0xeccf6d[_0x5aeda4(0xc0)]('.'));}catch(_0x572813){return![];}},indexUtil[_0x24f9d0(0xd0)]=function(_0x1ca962,_0x5d807a,_0x360b8d){const _0x3d07d3=_0x24f9d0;let _0x554327=dbSourceFolderTable['getPathByType'](_0x1ca962,_0x5d807a);for(let _0x5eaa6a of _0x554327){if(_0x360b8d==_0x5eaa6a[_0x3d07d3(0xb8)]||_0x360b8d[_0x3d07d3(0xc0)](path[_0x3d07d3(0xb3)](_0x5eaa6a['path'],path['sep'])))return _0x5eaa6a;}return![];},indexUtil[_0x24f9d0(0xe8)]=function(_0xfc6e33,_0xd01040){const _0x10ebce=_0x24f9d0;if(_0xd01040[_0x10ebce(0xed)](path[_0x10ebce(0xb3)](_0x10ebce(0xd8),path[_0x10ebce(0xe2)],_0x10ebce(0xc9)))||_0xd01040['endsWith'](path[_0x10ebce(0xb3)](_0x10ebce(0xd8),path[_0x10ebce(0xe2)],_0x10ebce(0xcf)))||_0xd01040[_0x10ebce(0xed)](path[_0x10ebce(0xb3)](_0x10ebce(0xd8),path[_0x10ebce(0xe2)],_0x10ebce(0xc4))))return!![];try{_0xd01040=_0xd01040[_0x10ebce(0xdb)](/\'/g,'\x27\x27');let _0x3d1aa3='SELECT\x20*\x20FROM\x20private_space\x20WHERE\x20folder_path=\x27'+_0xd01040+_0x10ebce(0xe9)+_0xd01040+_0x10ebce(0xd3)+_0x10ebce(0xcc)+path[_0x10ebce(0xe2)]+'%\x27',_0x255bef=_0xfc6e33[_0x10ebce(0xc5)](_0x3d1aa3)[_0x10ebce(0xc3)]();return _0x255bef?!![]:![];}catch(_0x4931ba){return![];}},indexUtil['isForbiddenPath']=function(_0x4017a8,_0xd18614){const _0x392069=_0x24f9d0;try{if(currentPlatform==_0x392069(0xd6)||currentPlatform==_0x392069(0xf8)){if(_0xd18614[_0x392069(0xc0)](_0x392069(0xb7)))return!![];if(_0xd18614=='/')return!![];}let _0x7c015d=path[_0x392069(0xb3)](_0x4017a8[_0x392069(0xbe)]),_0xc05a61=path['join'](_0x4017a8[_0x392069(0xe0)]),_0x2f1bba=path[_0x392069(0xb3)](_0xc05a61,path[_0x392069(0xe2)]),_0x3f4fa8=path['join'](_0x7c015d);_0xd18614=path[_0x392069(0xb3)](_0xd18614);if(_0xd18614==_0x7c015d||_0xd18614==_0xc05a61||_0xd18614[_0x392069(0xc0)](_0x3f4fa8)||_0xd18614[_0x392069(0xc0)](_0x2f1bba))return console['log'](_0x392069(0xd7),_0xd18614),!![];return![];}catch(_0x2af841){return console[_0x392069(0xea)](_0x2af841),![];}},indexUtil[_0x24f9d0(0xd5)]=function(_0xbea9c7){const _0x3e368b=_0x24f9d0;try{if(_0xbea9c7['startsWith']('.'))return!![];if(_0xbea9c7[_0x3e368b(0xed)]('.tmp')||_0xbea9c7[_0x3e368b(0xed)](_0x3e368b(0xfb))||_0xbea9c7[_0x3e368b(0xed)](_0x3e368b(0xce))||_0xbea9c7['endsWith'](_0x3e368b(0xbd))||_0xbea9c7[_0x3e368b(0xed)](_0x3e368b(0x10f))||_0xbea9c7[_0x3e368b(0xed)](_0x3e368b(0x105)))return!![];return![];}catch(_0x21fabb){return console[_0x3e368b(0xea)](_0x21fabb),![];}},indexUtil['setIndexingState']=function(_0x1411e8,_0x4f9e42,_0x49a7db){const _0x25dae0=_0x24f9d0;dbConfigTable[_0x25dae0(0xe4)](_0x1411e8,{'title':_0x4f9e42+'-indexing','value':_0x49a7db?'1':'0'});},indexUtil[_0x24f9d0(0x102)]=function(_0x2d0f90,_0x4f986f,_0x1f6445,_0x20651a,_0x6f2c78){const _0x5371ee=_0x24f9d0;if(indexUtil[_0x5371ee(0x109)](_0x1f6445,_0x20651a))return![];if(indexUtil[_0x5371ee(0xd5)](_0x6f2c78))return![];if(!fs[_0x5371ee(0xe1)](path[_0x5371ee(0xb3)](_0x20651a,_0x6f2c78)))return console[_0x5371ee(0xea)]('Not\x20exist\x20',_0x20651a,_0x6f2c78),![];let _0x2374d7=indexUtil[_0x5371ee(0xd0)](_0x2d0f90,_0x4f986f,_0x20651a);if(!_0x2374d7)return console[_0x5371ee(0xea)](_0x5371ee(0xca),_0x4f986f,_0x20651a,_0x6f2c78),![];return _0x2374d7;},indexUtil[_0x24f9d0(0xfc)]=async function(_0x164492,_0x92c946,_0xd7803){const _0x4854d2=_0x24f9d0;let _0x3e0006=[_0xd7803],_0x4b342e=new Set([_0xd7803]),_0x539f62=new Date()[_0x4854d2(0x111)]();while(_0x3e0006[_0x4854d2(0x10b)]>0x0){let _0xefc70b=_0x3e0006[_0x4854d2(0xf3)](),_0x12265f=dbFileIndexTable[_0x4854d2(0xb6)](_0x164492,_0xefc70b,_0x92c946);for(let _0x1a9dc7=0x0;_0x1a9dc7<_0x12265f[_0x4854d2(0x10b)];_0x1a9dc7++){let _0x33bea6=path[_0x4854d2(0xb3)](_0x12265f[_0x1a9dc7][_0x4854d2(0xb8)],_0x12265f[_0x1a9dc7][_0x4854d2(0x108)]);try{let _0x113165=fs['statSync'](_0x33bea6);if(_0x113165[_0x4854d2(0xfa)]()){}else _0x113165[_0x4854d2(0xc7)]()&&(!_0x4b342e[_0x4854d2(0xf1)](_0x33bea6)&&(_0x3e0006[_0x4854d2(0x100)](_0x33bea6),_0x4b342e[_0x4854d2(0x10d)](_0x33bea6)));}catch(_0x43a6d6){_0x43a6d6[_0x4854d2(0xcd)]=='ENOENT'&&(_0x12265f[_0x1a9dc7]['is_file']==0x1?dbFileIndexTable[_0x4854d2(0xb9)](_0x164492,_0x12265f[_0x1a9dc7]['id'],_0x92c946):(console[_0x4854d2(0xea)](_0x4854d2(0xd9),_0x33bea6),dbFileIndexTable['deleteByPathAndFileName'](_0x164492,_0x12265f[_0x1a9dc7]['path'],_0x12265f[_0x1a9dc7][_0x4854d2(0x108)],_0x92c946),dbFileIndexTable[_0x4854d2(0xd2)](_0x164492,_0x33bea6,_0x92c946)));}}}console[_0x4854d2(0xea)]('索引状态比对',_0xd7803,_0x4854d2(0xeb),new Date()[_0x4854d2(0x111)]()-_0x539f62,'ms');},module[_0x24f9d0(0xff)]=indexUtil;