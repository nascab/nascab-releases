function _0x4a21(){const _0x1af85e=['229436FmzPNH','UPDATE\x20file_index_movie\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20show_in_list\x20=\x200\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20is_tvplay\x20=\x201\x20AND\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20is_file\x20=\x201\x20AND\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type\x20=\x202\x20AND\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20show_in_list\x20=\x201;','stringify','exifMinTimeStamp','atimeMs','exports','replace','UPDATE\x20','original_date','ctime','location-eng','getDate','180851tlIKxX','dealMediaInfo','504tnsufQ','path','dealFileChange','is_file','latitude','media_type','INDEX_TABLE_NAME_MOVIE','54187JPBTGI','filenameNumber','lastInsertRowid','\x5cbdmv\x5cstream','824MjyhcO','parseVideoWH','length','./indexUtil','18fmZioU','ffprobeSync','substring','mode','movie','basename','tvplay','stream_info','location','join','getFullYear','../../utils/videoStreamUtil','birthtimeMs','/bdmv/stream','\x20SET\x20show_in_list\x20=\x200\x20WHERE\x20path=?','recursionFilesAddIndex','birthtime','dealTvDrama','needDealTvDrama','com.apple.quicktime.model','9QbhaiR','endsWith','is_tvplay','28647GqFuZQ','originalTime','com.apple.quicktime.creationdate','longitude','708qeZypc','run','create','addFileIndexToDb','creation_time','streams','videoHeight','../../utils/exifUtils','tags','size','toLowerCase','38964510vxdmHf','244cROYeO','UPDATE\x20file_index_movie\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20show_in_list\x20=\x201\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20IN\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20t1.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20file_index_movie\x20t1\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INNER\x20JOIN\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20path,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20min(filename)\x20AS\x20filename\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20file_index_movie\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20is_tvplay\x20=\x201\x20AND\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20is_file\x20=\x201\x20AND\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type\x20=\x202\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20GROUP\x20BY\x20path\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20t2\x20ON\x20t1.path\x20=\x20t2.path\x20AND\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20t1.filename\x20=\x20t2.filename\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20);','log','push','addFinalIndexToDB','影音管理：设置电视剧状态出错','transaction','rawImgTypeList','filename','../../myConfig/config','addOriginalDate','getDurationFromStream','videoTypeList','/BDMV/STREAM','format','doesPathCanAddToDb','duration','type','width','dealFirstLetterSingle','includes','ext','getById','影音管理：电视剧状态处理完成,耗时:','34260DpioFr','height','ctimeMs','videoWidth','1086530TMmjzr','getMonth','getExifInfo','getFilenameNumber','prepare','\x20as\x20t\x20SET\x20show_in_list\x20=\x201,show_name=?\x20WHERE\x20path=?\x20AND\x20duration>1800','mtimeMs','getTime'];_0x4a21=function(){return _0x1af85e;};return _0x4a21();}const _0x590de6=_0x4c6e;(function(_0x4f3f91,_0x5718f3){const _0x5b898c=_0x4c6e,_0x3c1fa7=_0x4f3f91();while(!![]){try{const _0x46d5d6=parseInt(_0x5b898c(0x202))/0x1*(-parseInt(_0x5b898c(0x1d1))/0x2)+parseInt(_0x5b898c(0x205))/0x3*(-parseInt(_0x5b898c(0x215))/0x4)+parseInt(_0x5b898c(0x22d))/0x5*(-parseInt(_0x5b898c(0x209))/0x6)+-parseInt(_0x5b898c(0x1e6))/0x7*(parseInt(_0x5b898c(0x1ea))/0x8)+-parseInt(_0x5b898c(0x1ee))/0x9*(-parseInt(_0x5b898c(0x1c9))/0xa)+parseInt(_0x5b898c(0x1dd))/0xb*(parseInt(_0x5b898c(0x1df))/0xc)+parseInt(_0x5b898c(0x214))/0xd;if(_0x46d5d6===_0x5718f3)break;else _0x3c1fa7['push'](_0x3c1fa7['shift']());}catch(_0x1fdaf8){_0x3c1fa7['push'](_0x3c1fa7['shift']());}}}(_0x4a21,0xa7100));const path=require(_0x590de6(0x1e0)),dbFileIndexTable=require('../../db/dbFileIndexTable'),config=require(_0x590de6(0x21e)),exifUtil=require(_0x590de6(0x210)),videoStreamUtil=require(_0x590de6(0x1f9)),indexUtil=require(_0x590de6(0x1ed)),movieUtil=require('../../express-server/utils/movieUtil'),indexTableName=dbFileIndexTable[_0x590de6(0x1e5)],movieIndexUtil={};movieIndexUtil[_0x590de6(0x200)]=!![];let lastDealTvDramaTimestamp=0x0;movieIndexUtil[_0x590de6(0x1e1)]=async function(_0xc847,_0x384283,_0x325dcf){const _0x477d5b=_0x590de6;await indexUtil[_0x477d5b(0x1e1)](_0xc847,_0x384283,_0x325dcf,indexTableName,movieIndexUtil[_0x477d5b(0x20c)],movieIndexUtil[_0x477d5b(0x1fd)]);return;},movieIndexUtil['recursionFilesAddIndex']=async function(_0x21ec2c,_0x317ef2,_0x23a37d){const _0x271c86=_0x590de6;return await indexUtil[_0x271c86(0x1fd)](_0x21ec2c,_0x317ef2,indexTableName,_0x271c86(0x1f2),_0x23a37d,movieIndexUtil[_0x271c86(0x20c)],()=>{const _0x366514=_0x271c86;let _0x59da21=new Date()[_0x366514(0x1d0)]()-lastDealTvDramaTimestamp;movieIndexUtil[_0x366514(0x200)]&&_0x59da21>0x1d4c0&&(movieIndexUtil[_0x366514(0x1ff)](_0x317ef2),lastDealTvDramaTimestamp=new Date()['getTime']());});},movieIndexUtil[_0x590de6(0x20c)]=async function(_0x51315c,_0x1f15eb,_0x3de813,_0x3708ce,_0x9b7f4f,_0x598047){const _0x136d04=_0x590de6;let _0x13b27f={'path':_0x3de813,'filename':_0x3708ce,'is_file':_0x9b7f4f},_0x291859=indexUtil[_0x136d04(0x224)](_0x51315c,'movie',config,_0x3de813,_0x3708ce);if(!_0x291859)return;_0x291859[_0x136d04(0x1e4)]==_0x136d04(0x1f4)&&(_0x13b27f[_0x136d04(0x204)]=0x1,_0x13b27f['show_in_list']=0x0);let _0x23f752=_0x598047[_0x136d04(0x1fa)];_0x598047[_0x136d04(0x1cf)]<_0x23f752&&(_0x23f752=_0x598047['mtimeMs']),_0x598047[_0x136d04(0x1d5)]<_0x23f752&&(_0x23f752=_0x598047[_0x136d04(0x1d5)]),_0x598047[_0x136d04(0x1c7)]<_0x23f752&&(_0x23f752=_0x598047[_0x136d04(0x1c7)]),_0x13b27f={..._0x13b27f,'ctime':_0x598047[_0x136d04(0x1c7)],'mtime':_0x598047[_0x136d04(0x1cf)],'ext':path['extname'](_0x3708ce),'birthtime':Math['ceil'](_0x23f752),'size':_0x598047[_0x136d04(0x212)],'check_time':new Date()['getTime']()},_0x13b27f=await movieIndexUtil[_0x136d04(0x1de)](_0x1f15eb,_0x13b27f);},movieIndexUtil[_0x590de6(0x1de)]=async function(_0x2e62a3,_0x4d37e1){const _0x5176d6=_0x590de6;let _0x214bb7=![],_0xf46ab3=path[_0x5176d6(0x1f7)](_0x4d37e1[_0x5176d6(0x1e0)],_0x4d37e1['filename']);if(_0x4d37e1[_0x5176d6(0x1e2)]==0x1&&_0x4d37e1['ext']&&(config['imgTypeList'][_0x5176d6(0x229)](_0x4d37e1[_0x5176d6(0x22a)][_0x5176d6(0x213)]())||config[_0x5176d6(0x21c)][_0x5176d6(0x229)](_0x4d37e1['ext'][_0x5176d6(0x213)]()))){_0x4d37e1[_0x5176d6(0x226)]=0x1;try{let {tags:_0x2d64a1,dealedIndexObj:_0x503958}=await exifUtil[_0x5176d6(0x1cb)](_0xf46ab3,_0x4d37e1);return movieIndexUtil[_0x5176d6(0x21f)](_0x2e62a3,_0x503958[_0x5176d6(0x206)],_0x503958);}catch(_0x3eedd6){return movieIndexUtil[_0x5176d6(0x21f)](_0x2e62a3,_0x214bb7,_0x4d37e1);}}else{if(_0x4d37e1[_0x5176d6(0x1e2)]==0x1&&_0x4d37e1[_0x5176d6(0x22a)]&&config[_0x5176d6(0x221)][_0x5176d6(0x229)](_0x4d37e1[_0x5176d6(0x22a)][_0x5176d6(0x213)]())){_0x4d37e1[_0x5176d6(0x226)]=0x2;try{let _0x78561a=await indexUtil[_0x5176d6(0x1ef)](_0xf46ab3),_0x111454=0x0,_0x19fc58=0x0;if(_0x78561a&&_0x78561a[_0x5176d6(0x20e)]&&_0x78561a[_0x5176d6(0x20e)][_0x5176d6(0x1ec)]>0x0){_0x4d37e1[_0x5176d6(0x1f5)]=JSON[_0x5176d6(0x1d3)](_0x78561a[_0x5176d6(0x20e)]);let _0x1f88f4=videoStreamUtil[_0x5176d6(0x1eb)](_0x78561a[_0x5176d6(0x20e)]);_0x4d37e1[_0x5176d6(0x227)]=_0x1f88f4[_0x5176d6(0x1c8)],_0x4d37e1[_0x5176d6(0x22e)]=_0x1f88f4[_0x5176d6(0x20f)];let _0x1c5ad3=videoStreamUtil[_0x5176d6(0x220)](_0x78561a);_0x1c5ad3&&(_0x4d37e1[_0x5176d6(0x225)]=_0x1c5ad3);}if(_0x78561a&&_0x78561a[_0x5176d6(0x223)]&&_0x78561a[_0x5176d6(0x223)][_0x5176d6(0x211)]){let _0x3fc8da=_0x78561a['format'][_0x5176d6(0x211)]['com.apple.quicktime.location.ISO6709'],_0x2f492a=_0x78561a[_0x5176d6(0x223)][_0x5176d6(0x211)][_0x5176d6(0x201)],_0x57af78=_0x78561a[_0x5176d6(0x223)][_0x5176d6(0x211)][_0x5176d6(0x207)];_0x2f492a&&(_0x4d37e1[_0x5176d6(0x1f1)]=_0x2f492a);_0x57af78&&(_0x214bb7=_0x57af78);!_0x214bb7&&_0x78561a['format'][_0x5176d6(0x211)][_0x5176d6(0x20d)]&&(_0x214bb7=_0x78561a[_0x5176d6(0x223)]['tags']['creation_time']);function _0x4b6ed5(_0x5517c8){const _0x1f98e2=_0x5176d6;let _0xa4589f=[];for(let _0x2bb2a5=0x0;_0x2bb2a5<_0x5517c8['length'];_0x2bb2a5++){(_0x5517c8[_0x2bb2a5]=='+'||_0x5517c8[_0x2bb2a5]=='-')&&_0xa4589f[_0x1f98e2(0x218)](_0x2bb2a5);}if(_0xa4589f['length']==0x2)_0x111454=_0x5517c8[_0x1f98e2(0x1f0)](_0xa4589f[0x0],_0xa4589f[0x1]),_0x19fc58=_0x5517c8[_0x1f98e2(0x1f0)](_0xa4589f[0x1]);else _0xa4589f[_0x1f98e2(0x1ec)]>=0x3&&(_0x111454=_0x5517c8[_0x1f98e2(0x1f0)](_0xa4589f[0x0],_0xa4589f[0x1]),_0x19fc58=_0x5517c8['substring'](_0xa4589f[0x1],_0xa4589f[0x2]));}_0x3fc8da&&_0x4b6ed5(_0x3fc8da);let _0x237379=_0x78561a[_0x5176d6(0x223)][_0x5176d6(0x211)][_0x5176d6(0x1f6)]||_0x78561a[_0x5176d6(0x223)][_0x5176d6(0x211)][_0x5176d6(0x1db)];_0x237379&&!_0x111454&&(_0x237379=_0x237379[_0x5176d6(0x1d7)]('/',''),_0x4b6ed5(_0x237379)),_0x78561a[_0x5176d6(0x223)]['duration']&&(_0x4d37e1[_0x5176d6(0x225)]=_0x78561a[_0x5176d6(0x223)][_0x5176d6(0x225)]);}return _0x4d37e1[_0x5176d6(0x1e3)]=_0x111454,_0x4d37e1[_0x5176d6(0x208)]=_0x19fc58,movieIndexUtil[_0x5176d6(0x21f)](_0x2e62a3,_0x214bb7,_0x4d37e1);}catch(_0x1743b6){return movieIndexUtil[_0x5176d6(0x21f)](_0x2e62a3,_0x214bb7,_0x4d37e1);}}else{if(_0x4d37e1[_0x5176d6(0x1e2)]==0x1)return;return movieIndexUtil[_0x5176d6(0x21f)](_0x2e62a3,_0x214bb7,_0x4d37e1);}}},movieIndexUtil[_0x590de6(0x21f)]=function(_0xbb43f2,_0x2f9b63,_0x5671b4){const _0x526c86=_0x590de6;_0x2f9b63&&_0x2f9b63<config[_0x526c86(0x1d4)]&&(_0x2f9b63=![]);!_0x2f9b63&&(_0x2f9b63=_0x5671b4[_0x526c86(0x1fe)]||_0x5671b4[_0x526c86(0x1da)]);let _0x1eb309=new Date(_0x2f9b63);_0x5671b4['original_time']=_0x1eb309[_0x526c86(0x1d0)]();let _0x5ebd53=_0x1eb309[_0x526c86(0x1f8)](),_0x42ca97=_0x1eb309[_0x526c86(0x1ca)]()+0x1;_0x42ca97=_0x42ca97>=0xa?_0x42ca97:'0'+_0x42ca97;let _0x148f46=_0x1eb309[_0x526c86(0x1dc)]();_0x148f46=_0x148f46>=0xa?_0x148f46:'0'+_0x148f46,_0x5671b4[_0x526c86(0x1d9)]=_0x5ebd53+'-'+_0x42ca97+'-'+_0x148f46,movieIndexUtil[_0x526c86(0x219)](_0xbb43f2,_0x5671b4);},movieIndexUtil['addFinalIndexToDB']=function(_0x3fc851,_0x3db2a2){const _0x379909=_0x590de6;_0x3db2a2[_0x379909(0x204)]==0x1&&_0x3db2a2[_0x379909(0x226)]==0x2&&(movieIndexUtil[_0x379909(0x200)]=!![]);_0x3db2a2[_0x379909(0x1e7)]=movieUtil[_0x379909(0x1cc)](_0x3db2a2[_0x379909(0x21d)]);let _0x4c71d6=dbFileIndexTable[_0x379909(0x20b)](_0x3fc851,_0x3db2a2,indexTableName),_0x54d8eb=_0x3db2a2[_0x379909(0x1e0)][_0x379909(0x213)]();try{if(_0x54d8eb['endsWith'](_0x379909(0x1e9))||_0x54d8eb[_0x379909(0x203)](_0x379909(0x1fb))){_0x3fc851[_0x379909(0x1cd)](_0x379909(0x1d8)+indexTableName+_0x379909(0x1fc))[_0x379909(0x20a)](_0x3db2a2[_0x379909(0x1e0)]);let _0x2f62f4=_0x3db2a2[_0x379909(0x1e0)][_0x379909(0x1d7)](_0x379909(0x1e9),'')['replace']('/bdmv/stream','')[_0x379909(0x1d7)]('\x5cBDMV\x5cSTREAM','')[_0x379909(0x1d7)](_0x379909(0x222),'');_0x2f62f4=path[_0x379909(0x1f3)](_0x2f62f4),_0x3fc851[_0x379909(0x1cd)](_0x379909(0x1d8)+indexTableName+_0x379909(0x1ce))[_0x379909(0x20a)](_0x2f62f4,_0x3db2a2['path']);}}catch(_0x1571a2){}let _0x15e46=dbFileIndexTable[_0x379909(0x22b)](_0x3fc851,_0x4c71d6[_0x379909(0x1e8)],indexTableName);_0x15e46&&movieUtil[_0x379909(0x228)](_0x3fc851,_0x15e46);};let tvDramaIsDealing=![];function _0x4c6e(_0xb4e2d4,_0x119f39){const _0x4a2124=_0x4a21();return _0x4c6e=function(_0x4c6e61,_0x2419f0){_0x4c6e61=_0x4c6e61-0x1c7;let _0x12e9bc=_0x4a2124[_0x4c6e61];return _0x12e9bc;},_0x4c6e(_0xb4e2d4,_0x119f39);}movieIndexUtil[_0x590de6(0x1ff)]=function(_0x5d9497){const _0x371149=_0x590de6;if(!movieIndexUtil[_0x371149(0x200)])return;if(tvDramaIsDealing)return;tvDramaIsDealing=!![];let _0x5c4b0b=new Date()[_0x371149(0x1d0)]();try{let _0xaa486b=_0x371149(0x1d2),_0x47dc40=_0x371149(0x216),_0x1fddd5=_0x5d9497[_0x371149(0x21b)](()=>{const _0xc85991=_0x371149;_0x5d9497['prepare'](_0xaa486b)[_0xc85991(0x20a)](),_0x5d9497[_0xc85991(0x1cd)](_0x47dc40)[_0xc85991(0x20a)]();}),_0x192814=new Date()[_0x371149(0x1d0)]();_0x1fddd5(),console['log'](_0x371149(0x22c),(_0x192814-_0x5c4b0b)/0x3e8+'s');}catch(_0x4ca8de){console[_0x371149(0x217)](_0x371149(0x21a),_0x4ca8de);}tvDramaIsDealing=![],movieIndexUtil[_0x371149(0x200)]=![];},module[_0x590de6(0x1d6)]=movieIndexUtil;