const _0x56b8aa=_0x14c0;function _0x14c0(_0x4f4d69,_0x1dc745){const _0x549aec=_0x549a();return _0x14c0=function(_0x14c065,_0x341c1e){_0x14c065=_0x14c065-0xae;let _0x4fa136=_0x549aec[_0x14c065];return _0x4fa136;},_0x14c0(_0x4f4d69,_0x1dc745);}(function(_0x1e1d31,_0xd62608){const _0x38f518=_0x14c0,_0xf0e63a=_0x1e1d31();while(!![]){try{const _0x3c8d8b=-parseInt(_0x38f518(0xc7))/0x1*(parseInt(_0x38f518(0xc4))/0x2)+parseInt(_0x38f518(0xc5))/0x3+-parseInt(_0x38f518(0xbf))/0x4*(-parseInt(_0x38f518(0xc2))/0x5)+-parseInt(_0x38f518(0xb8))/0x6+parseInt(_0x38f518(0xb4))/0x7+-parseInt(_0x38f518(0xcd))/0x8+parseInt(_0x38f518(0xc8))/0x9*(parseInt(_0x38f518(0xb6))/0xa);if(_0x3c8d8b===_0xd62608)break;else _0xf0e63a['push'](_0xf0e63a['shift']());}catch(_0x589f6a){_0xf0e63a['push'](_0xf0e63a['shift']());}}}(_0x549a,0x2748a));let fs=require('fs');const config=require(_0x56b8aa(0xb3)),Database=require(_0x56b8aa(0xba));let dbOther=new Database(config[_0x56b8aa(0xbe)],{}),dbFileIndex=new Database(config['dbFileIndex'],{});dbFileIndex['pragma']('journal_mode\x20=\x20WAL'),dbOther[_0x56b8aa(0xb0)](_0x56b8aa(0xc3));let musicUtils=require(_0x56b8aa(0xc0));const dbFileIndexTable=require(_0x56b8aa(0xc1));process['title']=_0x56b8aa(0xc6);const musicIndexUtil=require(_0x56b8aa(0xd3)),indexTableName=dbFileIndexTable['INDEX_TABLE_NAME_MUSIC'],dbScanTaskTable=require(_0x56b8aa(0xd2)),indexUtil=require(_0x56b8aa(0xb9));async function startIndexingFolder(_0x2bed1d){return new Promise(async(_0x14439d,_0x5c3c20)=>{const _0x38920f=_0x14c0;try{let _0x362f04=new Date()[_0x38920f(0xb7)](),_0x188e1b=fs[_0x38920f(0xce)](_0x2bed1d);if(!_0x188e1b[_0x38920f(0xcb)]())return console['log']('要扫描的目录不是文件夹',_0x2bed1d),_0x14439d();console['log'](_0x38920f(0xc9),_0x2bed1d),await indexUtil['recursionDeleteIndex'](dbFileIndex,indexTableName,_0x2bed1d);let {checkFileCount:_0x541d21,checkPathCount:_0x1b21fd}=await musicIndexUtil[_0x38920f(0xca)](dbOther,dbFileIndex,_0x2bed1d);console[_0x38920f(0xb1)]('音乐管理：扫描完成：'+_0x2bed1d,_0x38920f(0xbc),new Date()[_0x38920f(0xb7)]()-_0x362f04,'ms','文件夹数量',_0x1b21fd,'文件数量',_0x541d21),_0x14439d();}catch(_0x36b206){console[_0x38920f(0xb1)](_0x38920f(0xcc),_0x2bed1d),_0x14439d();}});}async function runScanTask(){const _0x34156e=_0x56b8aa;let _0x4371c9=dbScanTaskTable[_0x34156e(0xbd)](dbOther,dbScanTaskTable[_0x34156e(0xb2)]);_0x4371c9?(dbOther['prepare']('UPDATE\x20source_folder\x20SET\x20last_scan_time=?\x20\x20WHERE\x20path=?\x20and\x20type=\x27music\x27')['run'](Date[_0x34156e(0xaf)](),_0x4371c9[_0x34156e(0xb5)]),startIndexingFolder(_0x4371c9[_0x34156e(0xb5)])[_0x34156e(0xd4)](()=>{const _0x21c48a=_0x34156e;dbScanTaskTable[_0x21c48a(0xcf)](dbOther,_0x4371c9['id']),musicUtils[_0x21c48a(0xd1)](dbFileIndex),runScanTask();})):(console['log'](_0x34156e(0xd0)),indexUtil[_0x34156e(0xbb)](dbOther,indexTableName,![]),process[_0x34156e(0xae)]());}function _0x549a(){const _0x5eae36=['124wPFrRW','../../utils/musicUtil','../../db/dbFileIndexTable','35605SmLXKt','journal_mode\x20=\x20WAL','76TvDtcX','522249ROkasb','NasCabMusicIndexWorker','7039URwSeI','2484486VNwxpB','音乐管理:\x20开始扫描','recursionFilesAddIndex','isDirectory','扫描目录已不存在\x20','1857384MiqFel','statSync','deleteTask','音乐管理:未找到扫描任务[Music\x20scanning\x20task\x20not\x20found]','dealFirstLetterAll','../../db/dbScanTaskTable','./musicIndexUtil','then','exit','now','pragma','log','SCAN_TYPE_MUSIC','../../myConfig/config','2063369kKCoSf','scan_path','10dIXixs','getTime','1830564IxbBPJ','./indexUtil','better-sqlite3','setIndexingState','耗时:','getOnTask','dbOther'];_0x549a=function(){return _0x5eae36;};return _0x549a();}indexUtil[_0x56b8aa(0xbb)](dbOther,indexTableName,!![]),runScanTask();