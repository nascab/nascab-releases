function _0x1ecf(){const _0xaaffba=['104WPLsMb','3549147PWKQHW','832156biUycv','221058imSwrj','pragma','NasCabMusicIndexWorker','247404FRVref','./musicIndexUtil','dbFileIndex','log','recursionFilesAddIndex','扫描目录已不存在\x20','scan_path','音乐管理:\x20开始扫描','exit','文件数量','recursionDeleteIndex','getTime','dbOther','../../db/dbScanTaskTable','dealFirstLetterAll','journal_mode\x20=\x20WAL','831930xEVOMb','better-sqlite3','10olDxMk','now','then','../../db/dbFileIndexTable','SCAN_TYPE_MUSIC','title','./indexUtil','1285353lqQDvH','要扫描的目录不是文件夹','isDirectory','run','setIndexingState','prepare','耗时:','getOnTask','文件夹数量','../../utils/musicUtil','421428kcAxHf','statSync'];_0x1ecf=function(){return _0xaaffba;};return _0x1ecf();}const _0x13d1e3=_0x4e78;(function(_0x138de6,_0x5104f1){const _0x593df5=_0x4e78,_0x19fe8b=_0x138de6();while(!![]){try{const _0x3b7f24=-parseInt(_0x593df5(0x20a))/0x1+-parseInt(_0x593df5(0x21a))/0x2+-parseInt(_0x593df5(0x202))/0x3+-parseInt(_0x593df5(0x206))/0x4+parseInt(_0x593df5(0x21c))/0x5*(-parseInt(_0x593df5(0x207))/0x6)+-parseInt(_0x593df5(0x205))/0x7+parseInt(_0x593df5(0x204))/0x8*(parseInt(_0x593df5(0x1f8))/0x9);if(_0x3b7f24===_0x5104f1)break;else _0x19fe8b['push'](_0x19fe8b['shift']());}catch(_0x5f3f6b){_0x19fe8b['push'](_0x19fe8b['shift']());}}}(_0x1ecf,0x4075e));let fs=require('fs');const config=require('../../myConfig/config'),Database=require(_0x13d1e3(0x21b));function _0x4e78(_0x3ceb22,_0x4390f3){const _0x1ecfa2=_0x1ecf();return _0x4e78=function(_0x4e78e5,_0x48112a){_0x4e78e5=_0x4e78e5-0x1f3;let _0x3f847a=_0x1ecfa2[_0x4e78e5];return _0x3f847a;},_0x4e78(_0x3ceb22,_0x4390f3);}let dbOther=new Database(config[_0x13d1e3(0x216)],{}),dbFileIndex=new Database(config[_0x13d1e3(0x20c)],{});dbFileIndex[_0x13d1e3(0x208)]('journal_mode\x20=\x20WAL'),dbOther['pragma'](_0x13d1e3(0x219));let musicUtils=require(_0x13d1e3(0x201));const dbFileIndexTable=require(_0x13d1e3(0x1f4));process[_0x13d1e3(0x1f6)]=_0x13d1e3(0x209);const musicIndexUtil=require(_0x13d1e3(0x20b)),indexTableName=dbFileIndexTable['INDEX_TABLE_NAME_MUSIC'],dbScanTaskTable=require(_0x13d1e3(0x217)),indexUtil=require(_0x13d1e3(0x1f7));async function startIndexingFolder(_0x27c4ea){return new Promise(async(_0x1b8ab8,_0x29ce9e)=>{const _0x413b24=_0x4e78;try{let _0xc67ca8=new Date()[_0x413b24(0x215)](),_0x3c7680=fs[_0x413b24(0x203)](_0x27c4ea);if(!_0x3c7680[_0x413b24(0x1fa)]())return console['log'](_0x413b24(0x1f9),_0x27c4ea),_0x1b8ab8();console[_0x413b24(0x20d)](_0x413b24(0x211),_0x27c4ea),await indexUtil[_0x413b24(0x214)](dbFileIndex,indexTableName,_0x27c4ea);let {checkFileCount:_0x58a66f,checkPathCount:_0x162854}=await musicIndexUtil[_0x413b24(0x20e)](dbOther,dbFileIndex,_0x27c4ea);console[_0x413b24(0x20d)]('音乐管理：扫描完成：'+_0x27c4ea,_0x413b24(0x1fe),new Date()['getTime']()-_0xc67ca8,'ms',_0x413b24(0x200),_0x162854,_0x413b24(0x213),_0x58a66f),_0x1b8ab8();}catch(_0x159ee1){console[_0x413b24(0x20d)](_0x413b24(0x20f),_0x27c4ea),_0x1b8ab8();}});}async function runScanTask(){const _0x248428=_0x13d1e3;let _0x78e79=dbScanTaskTable[_0x248428(0x1ff)](dbOther,dbScanTaskTable[_0x248428(0x1f5)]);_0x78e79?(dbOther[_0x248428(0x1fd)]('UPDATE\x20source_folder\x20SET\x20last_scan_time=?\x20\x20WHERE\x20path=?\x20and\x20type=\x27music\x27')[_0x248428(0x1fb)](Date[_0x248428(0x21d)](),_0x78e79['scan_path']),startIndexingFolder(_0x78e79[_0x248428(0x210)])[_0x248428(0x1f3)](()=>{const _0x28ebe3=_0x248428;dbScanTaskTable['deleteTask'](dbOther,_0x78e79['id']),musicUtils[_0x28ebe3(0x218)](dbFileIndex),runScanTask();})):(console[_0x248428(0x20d)]('音乐管理:未找到扫描任务[Music\x20scanning\x20task\x20not\x20found]'),indexUtil['setIndexingState'](dbOther,indexTableName,![]),process[_0x248428(0x212)]());}indexUtil[_0x13d1e3(0x1fc)](dbOther,indexTableName,!![]),runScanTask();