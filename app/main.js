'use strict';const _0x403b72=_0x504e;(function(_0x36b5bf,_0x38b06d){const _0x2a19fc=_0x504e,_0x454d6f=_0x36b5bf();while(!![]){try{const _0x533e37=parseInt(_0x2a19fc(0x258))/0x1+-parseInt(_0x2a19fc(0x2a0))/0x2*(-parseInt(_0x2a19fc(0x247))/0x3)+parseInt(_0x2a19fc(0x23b))/0x4+-parseInt(_0x2a19fc(0x237))/0x5*(parseInt(_0x2a19fc(0x249))/0x6)+parseInt(_0x2a19fc(0x283))/0x7*(parseInt(_0x2a19fc(0x21c))/0x8)+parseInt(_0x2a19fc(0x276))/0x9+-parseInt(_0x2a19fc(0x278))/0xa;if(_0x533e37===_0x38b06d)break;else _0x454d6f['push'](_0x454d6f['shift']());}catch(_0x3aad25){_0x454d6f['push'](_0x454d6f['shift']());}}}(_0x18ab,0xd5eeb));let app,shell,ipcMain;try{app=require(_0x403b72(0x25e))[_0x403b72(0x22e)],shell=require('electron')[_0x403b72(0x23d)],ipcMain=require('electron')[_0x403b72(0x29a)];}catch(_0x5c0d47){console[_0x403b72(0x1fe)](_0x403b72(0x28d));}let mainWindow,sha256=require(_0x403b72(0x25d));const dbFileShare=require(_0x403b72(0x297)),dbUserTable=require(_0x403b72(0x221)),{fork}=require(_0x403b72(0x26b));let bgTaskWorkerIsRunning=![],tinyImgWorkerIsRunning=![],getMovieInfoWorkerIsRunning=![],aiFacesWorkerIsRunning=![],aiClassesWorkerIsRunning=![],aiSimilarPhotoWorker=![],globalInfoWorkerIsRunning=![],photoIndexWorkerIsRunning=![],movieIndexWorkerIsRunning=![],musicIndexWorkerIsRunning=![],bookIndexWorkerIsRunning=![],watchWorkerIsRunning=![];const messageUtil=require(_0x403b72(0x20b));let backupWorkerIsRunning=![],m3u8WorkerIsRunning=![],subtitleGenWorkerIsRunning=![],loadUrl='',listenPortHttp='80';function workerSendMsg(_0x38e47b,_0x324326){const _0x25a49f=_0x403b72;try{_0x38e47b&&!_0x38e47b['killed']&&_0x38e47b['send'](_0x324326,undefined,undefined,_0x47b37e=>{const _0x37de12=_0x504e;_0x47b37e&&console[_0x37de12(0x1fe)]('send\x20message\x20callback\x20',_0x47b37e);});}catch(_0x3cb2c2){console[_0x25a49f(0x1fe)](_0x25a49f(0x290),_0x3cb2c2);}}let dbu;function _0x504e(_0x31193d,_0x383b86){const _0x18ab89=_0x18ab();return _0x504e=function(_0x504e94,_0x392212){_0x504e94=_0x504e94-0x1f1;let _0x4e1112=_0x18ab89[_0x504e94];return _0x4e1112;},_0x504e(_0x31193d,_0x383b86);}function _0x18ab(){const _0x4d8237=['NEW_PHOTO_INDEX','restore','./db/dbFileShare','getServerRootPath','myWorkers/ai/aiClassify.js','ipcMain','FRP\x20OFF','Start\x20checking\x20for\x20updates','getAllByWhere','whenReady','myWorkers/globalInfoWorker.js','8mgZDFf','movie','nasAccountLogin','myWorkers/shareFolder/shareFtp.js','aiSimilarPhotoEnable','create','./db/dbConfigTable','exressPort','run','expressStarted','prepare','setLanguage','START_WORKER_FILE_OPERATION','path','getGlobalInfo','reset','log','nasRemoteState','openPath','图书索引线程已退出[Books\x20indexing\x20worker\x20exited]','catch','myWorkers/ai/aiSimilarPhotos.js','launchWithSys','close','showItemInFolder','book','myWorkers/proxy/proxyWorker.js','dbOther','DDNS\x20worker\x20is\x20stopped','./utils/messageUtil','myWorkers/index/fileWatcherWorker.js','length','webContents','shellType','getTime','expressEnded','SELECT\x20count(*)\x20as\x20count\x20FROM\x20backup_task','initBackupWorker','expressStartedHttps','addProcessRecord','username','getConfigApiPort','message','nasRemoteEnable','音乐索引线程已退出[Music\x20indexing\x20worker\x20exited]','source_type','2469704nuOrGZ','trash','error','resolve','isVisible','./db/dbUserTable','restartWatcher','runNewVersionTask','nasProxyRestart','get','NEW_TINY_IMAGE','Closing\x20FTP','createToken','kill','/#/','NasCab\x20api\x20server\x20starting\x20','refresh','myWorkers/bg/fileOperationWorker.js','app','Closing\x20NasCab\x20ddns','stopIndexWorker','getExpressApiCount','nasDdnsState','NEW_MOVIE_INDEX','then','Ftp\x20worker\x20is\x20stopped','count','607960YRrcEM','HTTPS\x20服务运行端口[HTTPS\x20server\x20running\x20on\x20port]:','FTP','电影索引线程已退出[Movies\x20indexing\x20worker\x20exited]','443052DtfMUP','?token=','shell','http://','stringify','myWorkers/subtitlesGenWorker.js','webDavServer','startClassesAiWork','relaunch','SIGTERM','startUpdate','Relaunch\x20Restart','70347qdhjXJ','myWorkers/bg/backupWorker.js','18umllWR','myWorkers/index/musicIndexWorker.js','SWITCH_MOVIE_INFO','nasDdnsRestart','ddnsIpv6Address','照片索引线程已退出[Photos\x20indexing\x20worker\x20exited]','createMainWindow','HTTP\x20服务运行端口[HTTP\x20server\x20running\x20on\x20port]:','进程出错了','stop','createUserFolder','startSimilarPhotoWork','myWorkers/tinyImgWorker.js','startScanPath','aiFaceEnable','502833rDJQht','cluster','myWorkers/expressWorker.js','startFaceAiWork','did-finish-load','sha256','electron','myWorkers/ddnsWorker.js','did-fail-load','fail','localhost','http://localhost:','./utils/globalInfoUtil','ddnsIpv4Address','nasDdnsEnable','HTTP\x20服务正在运行[HTTP\x20server\x20is\x20running]\x20:','exit','findByTitle','focus','child_process','push','start','type','放入回收站失败','init','fileShareRestart','页面加载完成','https://','second-instance','http://localhost','367020pjMJDn','apiServer','1245550zrdZdo','exitApp','photo','已经放入回收站','myWorkers/ai/aiFaceUtil.js','HTTPS\x20服务正在运行[HTTPS\x20server\x20is\x20running]\x20:','NasCab\x20Api\x20进程数量\x20[NasCab\x20api\x20thread\x20count]:','loadURL','deleteByTitle','刷新页面','页面加载失败','14owLgTe','./utils/initUtil','initWindowEventAndLoadLoading','setupPrimary','已打开路径','nasCabLogout','openDev','autoLoginClient','FTPServer','music','Clientless\x20service\x20mode','OFF','initTray','worker\x20send\x20msg\x20error','pid','value','expireTokenOnTime','aiClassesEnable'];_0x18ab=function(){return _0x4d8237;};return _0x18ab();}function init(){const _0x257aab=_0x403b72;var _0x28dbde=require(_0x257aab(0x259));let _0x5410c5=require(_0x257aab(0x1fb)),_0x5346a6=require(_0x257aab(0x284)),_0x110e9b=require(_0x257aab(0x1f4)),_0x2f1740=_0x5346a6[_0x257aab(0x253)]();dbu=_0x5346a6['initDbu']();let _0x1ec4b1='';function _0x8b4297(_0x2de8f4,_0x1f9f4b){const _0x2a990b=_0x257aab;function _0xb68a5a(){const _0x3728eb=_0x504e;_0x2de8f4[_0x3728eb(0x270)](),_0x1ec4b1=_0x110e9b[_0x3728eb(0x298)](_0x2de8f4['dbOther']);if(app)_0x5346a6[_0x3728eb(0x204)]();_0x5346a6[_0x3728eb(0x1f9)]();if(app)mainWindow=_0x5346a6[_0x3728eb(0x24f)]();_0x5346a6[_0x3728eb(0x270)](_0x2de8f4);if(app)_0x5346a6[_0x3728eb(0x28f)](_0x2de8f4,mainWindow);if(app)_0x5346a6[_0x3728eb(0x285)](_0x2de8f4,mainWindow);_0x5346a6[_0x3728eb(0x293)](),_0x5346a6[_0x3728eb(0x223)](_0x2de8f4);if(app)_0x5346a6[_0x3728eb(0x289)]();_0x1f9f4b(mainWindow);}app?app[_0x2a990b(0x29e)]()[_0x2a990b(0x234)](()=>{_0xb68a5a();}):_0xb68a5a();}_0x8b4297(dbu,_0x5304fd=>{const _0x561fe0=_0x257aab,_0x35ea9a=_0x5346a6['getRootPath']();let _0x1fa515=_0x5346a6[_0x561fe0(0x217)]();_0x5346a6['getFreePort'](_0x1fa515,_0x395ea7=>{const _0x2b684d=_0x561fe0;function _0x65fbdb(_0x5e1c5b){const _0x5b18fd=_0x504e,_0xffbbf9=fork(_0x5410c5['resolve'](__dirname,_0x5e1c5b),[],{'env':{'userDataFolder':_0x2f1740,'appRootPath':_0x35ea9a},'detached':![],'killSignal':_0x5b18fd(0x244)});return _0x5346a6['processList'][_0x5b18fd(0x26c)](_0xffbbf9),_0x5346a6[_0x5b18fd(0x215)](dbu['dbOther'],_0xffbbf9[_0x5b18fd(0x291)]),_0xffbbf9['on']('exit',function(_0x540b43,_0x172261){}),_0xffbbf9['on'](_0x5b18fd(0x21e),function(_0x418133){const _0x1f5146=_0x5b18fd;console['log'](_0x1f5146(0x251),_0x418133);}),_0xffbbf9;}dbu[_0x2b684d(0x209)][_0x2b684d(0x1f8)]('UPDATE\x20bg_task\x20SET\x20task_state=3\x20where\x20task_state=1')['run'](),setInterval(()=>{_0x15775f();},0x258*0x3e8),setTimeout(()=>{const _0x2b09ce=_0x2b684d;_0x5346a6['addScanTaskWhenStart'](dbu[_0x2b09ce(0x209)]),_0x2715bf(),_0x6e6c45(),_0x4d136a(),_0x570581(),_0x26505a(),_0x4c1e82(),_0x3d7d48(),_0x1b3751(),_0x5513b0();},0x1388);let _0x3c4464;function _0x570581(){const _0x266a77=_0x2b684d;if(bookIndexWorkerIsRunning)return;bookIndexWorkerIsRunning=!![],_0x3c4464=_0x65fbdb('myWorkers/index/bookIndexWorker.js'),_0x3c4464['on'](_0x266a77(0x218),function(_0x3ad254){_0x3ad254['type']=='close'&&(bookIndexWorkerIsRunning=![]);}),_0x3c4464['on']('exit',function(_0x5344ca,_0x5b3a40,_0x379645){const _0x22eafb=_0x266a77;console['log'](_0x22eafb(0x201),_0x5b3a40||'',_0x379645||''),bookIndexWorkerIsRunning=![];});}let _0x207fa5;function _0x4d136a(){const _0x1e8223=_0x2b684d;if(musicIndexWorkerIsRunning)return;musicIndexWorkerIsRunning=!![],_0x207fa5=_0x65fbdb(_0x1e8223(0x24a)),_0x207fa5['on'](_0x1e8223(0x218),function(_0x12cc07){const _0x2e9c5c=_0x1e8223;_0x12cc07[_0x2e9c5c(0x26e)]==_0x2e9c5c(0x205)&&(musicIndexWorkerIsRunning=![]);}),_0x207fa5['on'](_0x1e8223(0x268),function(_0x3a6a4d,_0x59d14c,_0x265361){const _0x1e9dba=_0x1e8223;console['log'](_0x1e9dba(0x21a),_0x59d14c||'',_0x265361||''),musicIndexWorkerIsRunning=![];});}let _0x430328;function _0x47b8d2(){const _0x13b89d=_0x2b684d;if(watchWorkerIsRunning)return;watchWorkerIsRunning=!![],_0x430328=_0x65fbdb(_0x13b89d(0x20c)),_0x430328['on'](_0x13b89d(0x218),function(_0x51e17d){const _0x3858f5=_0x13b89d;if(_0x51e17d[_0x3858f5(0x26e)]==_0x3858f5(0x205))watchWorkerIsRunning=![];else{if(_0x51e17d['type']==_0x3858f5(0x295))_0x26505a(),_0x1b3751();else _0x51e17d['type']==_0x3858f5(0x233)&&(_0x26505a(),_0x5513b0(),_0x216093());}}),_0x430328['on'](_0x13b89d(0x268),function(_0x4e02b9,_0x2818b3,_0x196da4){const _0x4ea775=_0x13b89d;console[_0x4ea775(0x1fe)]('------Watch\x20worker\x20is\x20stopped------',_0x2818b3,_0x196da4),watchWorkerIsRunning=![];});}_0x47b8d2();let _0x381dc1;function _0x2715bf(){const _0x200e92=_0x2b684d;if(photoIndexWorkerIsRunning)return;photoIndexWorkerIsRunning=!![],_0x381dc1=_0x65fbdb('myWorkers/index/photoIndexWorker.js'),_0x381dc1['on'](_0x200e92(0x218),function(_0x2a8231){const _0x5043f2=_0x200e92;_0x2a8231[_0x5043f2(0x26e)]==_0x5043f2(0x205)&&(photoIndexWorkerIsRunning=![]),_0x2a8231['type']=='NEW_PHOTO_INDEX'&&(_0x26505a(),_0x1b3751());}),_0x381dc1['on'](_0x200e92(0x268),function(_0x14013a,_0x1e2c8c,_0x57e303){const _0x3714e1=_0x200e92;console[_0x3714e1(0x1fe)](_0x3714e1(0x24e),_0x1e2c8c||'',_0x57e303||''),photoIndexWorkerIsRunning=![];});}let _0x11cd5f;function _0x6e6c45(){const _0x2dbfb1=_0x2b684d;if(movieIndexWorkerIsRunning)return;movieIndexWorkerIsRunning=!![],_0x11cd5f=_0x65fbdb('myWorkers/index/movieIndexWorker.js'),_0x11cd5f['on'](_0x2dbfb1(0x218),function(_0x3320bb){const _0x336f0f=_0x2dbfb1;if(_0x3320bb['type']==_0x336f0f(0x205))movieIndexWorkerIsRunning=![];else _0x3320bb[_0x336f0f(0x26e)]==_0x336f0f(0x233)&&(_0x26505a(),_0x5513b0(),_0x216093());}),_0x11cd5f['on'](_0x2dbfb1(0x268),function(_0x583b8c,_0x339900,_0x1e41c5){const _0xff89fd=_0x2dbfb1;console['log'](_0xff89fd(0x23a),_0x339900||'',_0x1e41c5||''),movieIndexWorkerIsRunning=![];});}function _0x5513b0(){const _0x252c4c=_0x2b684d;if(getMovieInfoWorkerIsRunning)return;getMovieInfoWorkerIsRunning=!![];let _0x42e51b=_0x65fbdb('myWorkers/movieInfoWorker.js');_0x42e51b['on'](_0x252c4c(0x218),function(_0x490263){const _0x29bf79=_0x252c4c;_0x490263['type']==_0x29bf79(0x205)&&(getMovieInfoWorkerIsRunning=![]);}),_0x42e51b['on']('exit',function(){getMovieInfoWorkerIsRunning=![];});}function _0x26505a(){const _0x5eb569=_0x2b684d;if(tinyImgWorkerIsRunning)return;tinyImgWorkerIsRunning=!![];let _0x246987=_0x65fbdb(_0x5eb569(0x255));_0x246987['on'](_0x5eb569(0x218),function(_0x40cbf0){const _0x3aed77=_0x5eb569;if(_0x40cbf0[_0x3aed77(0x26e)]=='close')tinyImgWorkerIsRunning=![];else _0x40cbf0[_0x3aed77(0x26e)]==_0x3aed77(0x226)&&(_0x4c1e82(),_0x3d7d48());}),_0x246987['on'](_0x5eb569(0x268),function(){tinyImgWorkerIsRunning=![];});}let _0x2b7272,_0x17b936;function _0x84267f(){const _0x2ea71b=_0x2b684d;let _0x2647af=dbFileShare['getAllByWhere'](dbu[_0x2ea71b(0x209)],'\x20server_type=\x27FTP\x27',[]);if(_0x2647af&&_0x2647af[_0x2ea71b(0x20d)]>0x0)!_0x2b7272&&(_0x2b7272=_0x65fbdb(_0x2ea71b(0x1f1)),_0x2b7272['on'](_0x2ea71b(0x268),function(){const _0x253175=_0x2ea71b;console[_0x253175(0x1fe)](_0x253175(0x235)),_0x2b7272=null;}));else{_0x110e9b['create'](dbu[_0x2ea71b(0x209)],{'title':_0x2ea71b(0x28b),'value':JSON[_0x2ea71b(0x23f)]({'state':_0x2ea71b(0x252)})});if(_0x2b7272){let _0x168eba=_0x2b7272['kill']();_0x168eba&&(_0x2b7272=null,console[_0x2ea71b(0x1fe)](_0x2ea71b(0x227)));}}}function _0x368b27(){const _0x3c91f4=_0x2b684d;let _0x6a11ef=dbFileShare[_0x3c91f4(0x29d)](dbu[_0x3c91f4(0x209)],'\x20server_type=\x27WebDav\x27',[]);if(_0x6a11ef&&_0x6a11ef[_0x3c91f4(0x20d)]>0x0)!_0x17b936&&(_0x17b936=_0x65fbdb('myWorkers/shareFolder/shareWebDav.js'),_0x17b936['on'](_0x3c91f4(0x268),function(){const _0x1f6179=_0x3c91f4;console[_0x1f6179(0x1fe)]('Webdav\x20worker\x20is\x20stopped'),_0x17b936=null;}));else{_0x110e9b[_0x3c91f4(0x1f3)](dbu[_0x3c91f4(0x209)],{'title':_0x3c91f4(0x241),'value':JSON['stringify']({'state':'stop'})});if(_0x17b936){let _0x1c5dee=_0x17b936[_0x3c91f4(0x229)]();_0x1c5dee&&(_0x17b936=null);}}}let _0x115deb;function _0x1d2de7(){const _0xc24cc0=_0x2b684d;let _0x517d06=![],_0x4c5436=_0x110e9b[_0xc24cc0(0x269)](dbu[_0xc24cc0(0x209)],_0xc24cc0(0x266));_0x4c5436&&_0x4c5436['value']==0x1&&(_0x517d06=!![]);if(_0x517d06)!_0x115deb&&(_0x115deb=_0x65fbdb(_0xc24cc0(0x25f)),_0x115deb['on']('message',function(_0x4e786b){const _0x46db44=_0xc24cc0;_0x4e786b[_0x46db44(0x26e)]==_0x46db44(0x205)&&(_0x115deb=null);}),_0x115deb['on'](_0xc24cc0(0x268),function(){const _0x572336=_0xc24cc0;console[_0x572336(0x1fe)](_0x572336(0x20a)),_0x115deb=null;}));else{if(_0x115deb){let _0x41b873=_0x115deb[_0xc24cc0(0x229)]();_0x41b873&&(_0x115deb=null,console[_0xc24cc0(0x1fe)](_0xc24cc0(0x22f)));}_0x110e9b[_0xc24cc0(0x280)](dbu[_0xc24cc0(0x209)],_0xc24cc0(0x24d)),_0x110e9b[_0xc24cc0(0x280)](dbu[_0xc24cc0(0x209)],_0xc24cc0(0x265)),_0x110e9b[_0xc24cc0(0x1f3)](dbu[_0xc24cc0(0x209)],{'title':_0xc24cc0(0x232),'value':JSON[_0xc24cc0(0x23f)]({'status':'fail','ddnsIp':'','error':_0xc24cc0(0x28e)})});}}_0x1d2de7();let _0x5c88b2;function _0x15e266(){const _0x48cabc=_0x2b684d;if(globalInfoWorkerIsRunning)return;globalInfoWorkerIsRunning=!![],_0x5c88b2=_0x65fbdb(_0x48cabc(0x29f)),_0x5c88b2['on'](_0x48cabc(0x218),function(_0x592e56){const _0x550e4b=_0x48cabc;if(_0x592e56[_0x550e4b(0x26e)]==_0x550e4b(0x205))globalInfoWorkerIsRunning=![];else _0x592e56[_0x550e4b(0x26e)]==_0x550e4b(0x256)&&_0x3810e1(_0x592e56);}),_0x5c88b2['on'](_0x48cabc(0x268),function(){globalInfoWorkerIsRunning=![];});}_0x15e266();function _0x3d7d48(){const _0x11f898=_0x2b684d;let _0x32f885=_0x110e9b['findByTitle'](dbu[_0x11f898(0x209)],_0x11f898(0x257));if(_0x32f885&&_0x32f885[_0x11f898(0x292)]=='1'){if(aiFacesWorkerIsRunning)return;aiFacesWorkerIsRunning=!![];let _0x23973c=_0x65fbdb(_0x11f898(0x27c));_0x23973c['on'](_0x11f898(0x218),function(_0x17a383){const _0x4fb74f=_0x11f898;_0x17a383[_0x4fb74f(0x26e)]==_0x4fb74f(0x205)&&(aiFacesWorkerIsRunning=![]);}),_0x23973c['on']('exit',function(_0x7ae657,_0xf3c63f,_0x108be3){aiFacesWorkerIsRunning=![],_0x23973c=null;});}else{}}function _0x1b3751(){const _0x236a77=_0x2b684d;let _0x46f7dc=_0x110e9b[_0x236a77(0x269)](dbu[_0x236a77(0x209)],_0x236a77(0x1f2));if(_0x46f7dc&&_0x46f7dc[_0x236a77(0x292)]=='1'){if(aiSimilarPhotoWorker)return;aiSimilarPhotoWorker=!![];let _0x3cfe74=_0x65fbdb(_0x236a77(0x203));_0x3cfe74['on'](_0x236a77(0x218),function(_0x500dc9){const _0x3dcb2c=_0x236a77;_0x500dc9['type']==_0x3dcb2c(0x205)&&(aiSimilarPhotoWorker=![]);}),_0x3cfe74['on'](_0x236a77(0x268),()=>{_0x3cfe74=![];});}else{}}function _0x4c1e82(){const _0x61ea91=_0x2b684d;let _0x1a607a=_0x110e9b['findByTitle'](dbu[_0x61ea91(0x209)],_0x61ea91(0x294));if(_0x1a607a&&_0x1a607a['value']=='1'){if(aiClassesWorkerIsRunning)return;aiClassesWorkerIsRunning=!![];let _0x3cc21d=_0x65fbdb(_0x61ea91(0x299));_0x3cc21d['on']('message',function(_0x4d26e9){const _0x41e040=_0x61ea91;_0x4d26e9[_0x41e040(0x26e)]=='close'&&(aiClassesWorkerIsRunning=![]);}),_0x3cc21d['on'](_0x61ea91(0x268),()=>{aiClassesWorkerIsRunning=![];});}else{}}let _0x5ef210;function _0x1eee58(){const _0x522147=_0x2b684d;let _0x362975=dbu['dbOther']['prepare'](_0x522147(0x212))[_0x522147(0x225)]();if(_0x362975[_0x522147(0x236)]>0x0){if(backupWorkerIsRunning)return;backupWorkerIsRunning=!![],_0x5ef210=_0x65fbdb(_0x522147(0x248)),_0x5ef210['on'](_0x522147(0x218),function(_0x10a1ae){const _0x2a0c19=_0x522147;_0x10a1ae[_0x2a0c19(0x26e)]==_0x2a0c19(0x205)&&(backupWorkerIsRunning=![]);}),_0x5ef210['on'](_0x522147(0x268),()=>{backupWorkerIsRunning=![];});}else{if(_0x5ef210){let _0xed09e7=_0x5ef210['kill']();_0xed09e7&&(_0x5ef210=null);}}}_0x1eee58();let _0xdd6cbd;function _0x211bc8(){const _0x38548d=_0x2b684d;if(m3u8WorkerIsRunning)return;m3u8WorkerIsRunning=!![],_0xdd6cbd=_0x65fbdb('myWorkers/m3u8Worker.js'),_0xdd6cbd['on'](_0x38548d(0x218),function(_0x10ee43){_0x10ee43['type']=='close'&&(m3u8WorkerIsRunning=![]);}),_0xdd6cbd['on'](_0x38548d(0x268),function(_0x100025){m3u8WorkerIsRunning=![];});}let _0x27ce7f,_0x211a58=![];function _0x15775f(){const _0x566348=_0x2b684d;_0x211a58&&(!_0x27ce7f&&(_0x27ce7f=_0x65fbdb(_0x566348(0x208)),_0x27ce7f['on'](_0x566348(0x268),_0xb47165=>{console['log']('proxyWorker\x20exit',_0xb47165),_0x27ce7f=null;}),console[_0x566348(0x1fe)]('启用\x20frp')));}function _0x5e9859(){const _0x1edbe1=_0x2b684d;let _0x26ed5f=_0x110e9b[_0x1edbe1(0x269)](dbu[_0x1edbe1(0x209)],_0x1edbe1(0x219));!_0x26ed5f||_0x26ed5f&&_0x26ed5f[_0x1edbe1(0x292)]!=0x1&&_0x26ed5f['value']!='1'?(_0x211a58=![],_0x27ce7f&&(_0x27ce7f[_0x1edbe1(0x229)](),_0x27ce7f=null,console['log']('关闭\x20proxyWorker')),_0x110e9b['create'](dbu['dbOther'],{'title':_0x1edbe1(0x1ff),'value':JSON['stringify']({'status':_0x1edbe1(0x261),'time':new Date()[_0x1edbe1(0x210)]()+'','error':_0x1edbe1(0x29b)})})):(_0x211a58=!![],_0x15775f());}_0x5e9859();let _0x510eb8;function _0x216093(){const _0x3fab4c=_0x2b684d;if(subtitleGenWorkerIsRunning)return;subtitleGenWorkerIsRunning=!![],_0x510eb8=_0x65fbdb(_0x3fab4c(0x240)),_0x510eb8['on'](_0x3fab4c(0x218),function(_0x227943){const _0x4e71c6=_0x3fab4c;_0x227943[_0x4e71c6(0x26e)]==_0x4e71c6(0x205)&&(subtitleGenWorkerIsRunning=![]);}),_0x510eb8['on'](_0x3fab4c(0x268),function(_0x61b708){subtitleGenWorkerIsRunning=![];});}setTimeout(()=>{_0x216093();},0x1388);let _0x29d6e7=![],_0x27d06c=![],_0x5db35a=![];function _0x2fb37b(_0x54b2e9){const _0x50aa66=_0x2b684d;try{!_0x5db35a&&(_0x5db35a=!![],setTimeout(()=>{const _0xdd7084=_0x504e;let _0x29b563=require(_0xdd7084(0x264)),_0x2c521b=_0x29b563['getIpv4Address'](dbu['dbOther']);_0x2c521b?console[_0xdd7084(0x1fe)](_0xdd7084(0x27d),_0xdd7084(0x273)+_0x2c521b+':'+_0x54b2e9+_0x1ec4b1):console[_0xdd7084(0x1fe)](_0xdd7084(0x238),''+_0x54b2e9+_0x1ec4b1);},0x3a98));}catch(_0x35d569){console[_0x50aa66(0x1fe)](_0x35d569);}}let _0x1a13c8=![];function _0x31e87c(){const _0x3c0d17=_0x2b684d;if(app&&_0x5304fd){if(_0x1a13c8)return;_0x1a13c8=!![],setTimeout(()=>{_0x1a13c8=![];},0xbb8);function _0x1ca898(){const _0x199dd9=_0x504e;loadUrl=listenPortHttp=='80'?_0x199dd9(0x275)+_0x1ec4b1+_0x199dd9(0x22a):_0x199dd9(0x263)+listenPortHttp+_0x1ec4b1+'/#/';let _0x469d84=_0x110e9b[_0x199dd9(0x269)](dbu['dbOther'],_0x199dd9(0x28a));if(!_0x469d84||_0x469d84[_0x199dd9(0x292)]=='1'){let _0x5accd7=dbUserTable['getAdmin'](dbu[_0x199dd9(0x209)]);if(_0x5accd7){let _0x199a4c=sha256(new Date()[_0x199dd9(0x210)]()+_0x5accd7[_0x199dd9(0x216)]);dbUserTable[_0x199dd9(0x228)](dbu[_0x199dd9(0x209)],_0x5accd7['id'],_0x199a4c,_0x199dd9(0x262)),loadUrl+=_0x199dd9(0x23c)+_0x199a4c;}}}_0x1ca898(),console[_0x3c0d17(0x1fe)]('loadUrl',loadUrl),_0x5304fd['loadURL'](loadUrl),_0x5304fd[_0x3c0d17(0x20e)]['on'](_0x3c0d17(0x260),function(){const _0x563af4=_0x3c0d17;console[_0x563af4(0x1fe)](_0x563af4(0x282),loadUrl);}),_0x5304fd['webContents']['on'](_0x3c0d17(0x25c),function(){const _0x48e6b6=_0x3c0d17;console[_0x48e6b6(0x1fe)](_0x48e6b6(0x272),loadUrl);}),ipcMain['on'](_0x3c0d17(0x22c),(_0x356f2d,_0x5e9e6d)=>{const _0x44b688=_0x3c0d17;console[_0x44b688(0x1fe)](_0x44b688(0x281),loadUrl),loadUrl&&_0x5304fd[_0x44b688(0x27f)](loadUrl);});}}function _0x22f815(_0x229520){const _0x4a56c8=_0x2b684d;listenPortHttp=_0x229520,_0x368b27(),setTimeout(()=>{_0x84267f();},0x1388),!_0x27d06c&&(_0x27d06c=!![],setTimeout(()=>{const _0x506149=_0x504e;let _0x290b25=require(_0x506149(0x264)),_0x7edd89=_0x290b25['getIpv4Address'](dbu[_0x506149(0x209)]);_0x7edd89?console['log'](_0x506149(0x267),_0x506149(0x23e)+_0x7edd89+':'+listenPortHttp+_0x1ec4b1):console[_0x506149(0x1fe)](_0x506149(0x250),listenPortHttp);},0x3a98)),_0x110e9b[_0x4a56c8(0x1f3)](dbu[_0x4a56c8(0x209)],{'title':_0x4a56c8(0x277),'value':JSON[_0x4a56c8(0x23f)]({'state':_0x4a56c8(0x1f6),'port':listenPortHttp})}),!_0x29d6e7&&(_0x29d6e7=!![],_0x31e87c(),workerSendMsg(_0x27ce7f,{'type':'start'}));}let _0x30baf3=_0x5346a6[_0x2b684d(0x231)]();console[_0x2b684d(0x1fe)](_0x2b684d(0x27e),_0x30baf3),_0x28dbde[_0x2b684d(0x286)]({'exec':_0x5410c5[_0x2b684d(0x21f)](__dirname,_0x2b684d(0x25a))}),_0x28dbde['on'](_0x2b684d(0x268),function(_0xbd89bf,_0x3c6299,_0x6ba6fe){console['log']('NasCab\x20api\x20server\x20restarting\x20',_0x3c6299,_0x6ba6fe),setTimeout(()=>{_0x46e86c();},0x1388);});for(let _0x70d07f=0x0;_0x70d07f<_0x30baf3;_0x70d07f++){console['log'](_0x2b684d(0x22b),_0x70d07f+0x1),_0x46e86c();}function _0x3810e1(_0x255787){const _0x1d6f18=_0x2b684d;if(_0x255787['source_type']==_0x1d6f18(0x2a1))_0x6e6c45();else{if(_0x255787[_0x1d6f18(0x21b)]==_0x1d6f18(0x27a))_0x2715bf();else{if(_0x255787[_0x1d6f18(0x21b)]==_0x1d6f18(0x28c))_0x4d136a();else _0x255787['source_type']==_0x1d6f18(0x207)&&_0x570581();}}_0x255787[_0x1d6f18(0x222)]&&(_0x47b8d2(),workerSendMsg(_0x430328,_0x255787));}function _0x46e86c(){const _0x17aeff=_0x2b684d,_0x12bf15=_0x28dbde['fork']({'usePort':_0x395ea7,'userDataFolder':_0x2f1740,'appRootPath':_0x35ea9a});_0x12bf15['on'](_0x17aeff(0x218),function(_0x498eb6){const _0x54726b=_0x17aeff;try{switch(_0x498eb6[_0x54726b(0x26e)]){case'reloadHomePage':_0x31e87c();break;case _0x54726b(0x1fa):let _0x3ca82f=_0x65fbdb(_0x54726b(0x22d));workerSendMsg(_0x3ca82f,_0x498eb6);break;case'START_WORKER_BG_TASK':if(!bgTaskWorkerIsRunning){bgTaskWorkerIsRunning=!![];let _0x1fc2de=_0x65fbdb('myWorkers/bg/bgTaskWorker.js');_0x1fc2de['on'](_0x54726b(0x218),function(_0xcfc004){const _0x301232=_0x54726b;_0xcfc004[_0x301232(0x26e)]=='close'&&(bgTaskWorkerIsRunning=![]);});}break;case _0x54726b(0x24b):_0x5513b0();break;case'START_PRE_GEN_SUBTITLE':_0x216093();break;case'M3u8Transcode':_0x211bc8(),workerSendMsg(_0xdd6cbd,_0x498eb6);break;case _0x54726b(0x224):_0x5e9859(),workerSendMsg(_0x27ce7f,{'type':_0x54726b(0x1fd),'msg':_0x498eb6});break;case _0x54726b(0x288):_0x5e9859(),workerSendMsg(_0x27ce7f,{'type':_0x54726b(0x252)}),setTimeout(()=>{_0x5513b0();},0x3e8);break;case _0x54726b(0x1fc):_0x15e266(),workerSendMsg(_0x5c88b2,_0x498eb6);break;case _0x54726b(0x245):console[_0x54726b(0x1fe)](_0x54726b(0x29c)),_0x5346a6[_0x54726b(0x245)]();break;case _0x54726b(0x213):_0x1eee58();break;case _0x54726b(0x230):if(_0x498eb6[_0x54726b(0x21b)]=='photo')_0x381dc1&&(_0x381dc1[_0x54726b(0x229)](),_0x381dc1=null,photoIndexWorkerIsRunning=![]);else{if(_0x498eb6['source_type']==_0x54726b(0x2a1))_0x11cd5f&&(_0x11cd5f['kill'](),_0x11cd5f=null,movieIndexWorkerIsRunning=![]);else{if(_0x498eb6['source_type']==_0x54726b(0x28c))_0x207fa5&&(_0x207fa5[_0x54726b(0x229)](),_0x207fa5=null,musicIndexWorkerIsRunning=![]);else _0x498eb6[_0x54726b(0x21b)]==_0x54726b(0x207)&&(_0x3c4464&&(_0x3c4464[_0x54726b(0x229)](),_0x3c4464=null,bookIndexWorkerIsRunning=![]));}}break;case _0x54726b(0x256):_0x3810e1(_0x498eb6);break;case _0x54726b(0x271):if(_0x498eb6['shareType']=='WebDav')_0x368b27(),workerSendMsg(_0x17b936,_0x498eb6);else _0x498eb6['shareType']==_0x54726b(0x239)&&(_0x84267f(),workerSendMsg(_0x2b7272,_0x498eb6));break;case _0x54726b(0x24c):_0x1d2de7(),workerSendMsg(_0x115deb,{'type':_0x54726b(0x26d),'force':0x1});break;case _0x54726b(0x288):_0x1d2de7(),setTimeout(()=>{_0x5513b0();},0x3e8);break;case _0x54726b(0x2a2):_0x5e9859(),workerSendMsg(_0x27ce7f,{'type':'reset'}),_0x1d2de7(),setTimeout(()=>{_0x5513b0();},0x3e8);break;case _0x54726b(0x253):_0x5346a6[_0x54726b(0x253)]();break;case _0x54726b(0x242):_0x4c1e82();break;case _0x54726b(0x25b):_0x3d7d48();break;case _0x54726b(0x254):_0x1b3751();break;case _0x54726b(0x1f7):_0x22f815(_0x498eb6[_0x54726b(0x1f5)]);break;case _0x54726b(0x214):_0x2fb37b(_0x498eb6['exressPort']);break;case'Relaunch':console[_0x54726b(0x1fe)](_0x54726b(0x246));if(app)app[_0x54726b(0x243)]();_0x5346a6[_0x54726b(0x279)](dbu);break;case _0x54726b(0x211):break;case'shell':if(shell){if(_0x498eb6[_0x54726b(0x20f)]==_0x54726b(0x206))_0x498eb6['path']&&shell[_0x54726b(0x206)](_0x498eb6['path']);else{if(_0x498eb6['shellType']=='openPath')_0x498eb6[_0x54726b(0x1fb)]&&shell[_0x54726b(0x200)](_0x498eb6['path'])['then'](_0x511be2=>{const _0xd588e4=_0x54726b;console[_0xd588e4(0x1fe)](_0xd588e4(0x287));})[_0x54726b(0x202)](_0x3a31ef=>{const _0x462514=_0x54726b;console[_0x462514(0x1fe)]('打开路径失败',_0x3a31ef);});else _0x498eb6[_0x54726b(0x20f)]==_0x54726b(0x21d)&&(_0x498eb6['path']&&shell['trashItem'](_0x498eb6[_0x54726b(0x1fb)])[_0x54726b(0x234)](_0x26ea8f=>{const _0x5c4350=_0x54726b;console['log'](_0x5c4350(0x27b));})[_0x54726b(0x202)](_0x5c11d6=>{const _0x23f166=_0x54726b;console['log'](_0x23f166(0x26f),_0x5c11d6);}));}}break;}}catch(_0x1f8440){console[_0x54726b(0x1fe)]('main\x20err',_0x1f8440);}});}});});}if(app){const gotTheLock=app['requestSingleInstanceLock']();!gotTheLock?(app['quit'](),process[_0x403b72(0x229)](process['pid'],_0x403b72(0x244))):(app['on'](_0x403b72(0x274),(_0x3fa040,_0x1751e3,_0x2012b8)=>{const _0x2a056e=_0x403b72;if(mainWindow){if(mainWindow['isMinimized']())mainWindow[_0x2a056e(0x296)]();!mainWindow[_0x2a056e(0x220)]()&&mainWindow['show'](),mainWindow[_0x2a056e(0x26a)]();}}),init());}else init();process['on']('uncaughtException',(_0x35ffc6,_0x1ffc29)=>{const _0x1f92e2=_0x403b72;console[_0x1f92e2(0x1fe)]('main\x20error:',_0x35ffc6);});