'use strict';const _0x2c844e=_0x29c4;(function(_0x3382c9,_0x554db5){const _0x1f1a47=_0x29c4,_0x5602d8=_0x3382c9();while(!![]){try{const _0x3ae353=-parseInt(_0x1f1a47(0x126))/0x1+parseInt(_0x1f1a47(0xed))/0x2+parseInt(_0x1f1a47(0x114))/0x3+-parseInt(_0x1f1a47(0x13b))/0x4+-parseInt(_0x1f1a47(0x109))/0x5+-parseInt(_0x1f1a47(0x10c))/0x6*(parseInt(_0x1f1a47(0xdf))/0x7)+-parseInt(_0x1f1a47(0x143))/0x8*(-parseInt(_0x1f1a47(0x127))/0x9);if(_0x3ae353===_0x554db5)break;else _0x5602d8['push'](_0x5602d8['shift']());}catch(_0x55a018){_0x5602d8['push'](_0x5602d8['shift']());}}}(_0xa7e5,0x629a7));let app,shell,ipcMain;try{app=require('electron')[_0x2c844e(0xef)],shell=require(_0x2c844e(0xe0))[_0x2c844e(0x108)],ipcMain=require(_0x2c844e(0xe0))['ipcMain'];}catch(_0x3c20f8){console[_0x2c844e(0x11a)](_0x2c844e(0xbd));}let mainWindow,sha256=require(_0x2c844e(0xd2));const dbFileShare=require(_0x2c844e(0x14c)),dbUserTable=require(_0x2c844e(0x11b)),{fork}=require(_0x2c844e(0xfd));let bgTaskWorkerIsRunning=![],tinyImgWorkerIsRunning=![],getMovieInfoWorkerIsRunning=![],aiFacesWorkerIsRunning=![],aiClassesWorkerIsRunning=![],aiSimilarPhotoWorker=![],globalInfoWorkerIsRunning=![],photoIndexWorkerIsRunning=![],movieIndexWorkerIsRunning=![],musicIndexWorkerIsRunning=![],bookIndexWorkerIsRunning=![],watchWorkerIsRunning=![];function _0xa7e5(){const _0x5e78b8=['proxyWorker\x20exit','whenReady','72DefCzQ','myWorkers/expressWorker.js','movie','push','killed','myWorkers/tinyImgWorker.js','NEW_MOVIE_INDEX','book','1962861pVskqq','processList','./db/dbConfigTable','expressStarted','pid','focus','log','./db/dbUserTable','myWorkers/subtitlesGenWorker.js','fileShareRestart','length','myWorkers/shareFolder/shareWebDav.js','SIGTERM','HTTPS\x20服务运行端口[HTTPS\x20server\x20running\x20on\x20port]:','http://localhost','START_WORKER_BG_TASK','myWorkers/shareFolder/shareFtp.js','http://localhost:','234529xPfHxi','27UYhyId','kill','then','exit','main\x20err','catch','send','did-fail-load','nasDdnsState','aiSimilarPhotoEnable','音乐索引线程已退出[Music\x20indexing\x20worker\x20exited]','?token=','trashItem','nasRemoteEnable','./utils/initUtil','runNewVersionTask','stringify','expireTokenOnTime','show','initBackupWorker','3034340yCosnZ','myWorkers/m3u8Worker.js','myWorkers/ai/aiFaceUtil.js','UPDATE\x20bg_task\x20SET\x20task_state=3\x20where\x20task_state=1','music','\x20server_type=\x27FTP\x27','type','刷新页面','3013904oHbntf','deleteByTitle','addProcessRecord','shellType','getIpv4Address','nasDdnsEnable','expressEnded','startScanPath','nasDdnsRestart','./db/dbFileShare','nasCabLogout','FRP\x20OFF','start','loadUrl','myWorkers/bg/bgTaskWorker.js','myWorkers/index/fileWatcherWorker.js','setupPrimary','nasRemoteState','------Watch\x20worker\x20is\x20stopped------','电影索引线程已退出[Movies\x20indexing\x20worker\x20exited]','getRootPath','getAdmin','init','openPath','main\x20error:','expressStartedHttps','HTTP\x20服务运行端口[HTTP\x20server\x20running\x20on\x20port]:','NEW_TINY_IMAGE','\x20server_type=\x27WebDav\x27','close','apiServer','SELECT\x20count(*)\x20as\x20count\x20FROM\x20backup_task','Ftp\x20worker\x20is\x20stopped','ddnsIpv6Address','webDavServer','initWindowEventAndLoadLoading','myWorkers/index/bookIndexWorker.js','resolve','Clientless\x20service\x20mode','value','message','FTP','showItemInFolder','isMinimized','NasCab\x20Api\x20进程数量\x20[NasCab\x20api\x20thread\x20count]:','reloadHomePage','fail','myWorkers/proxy/proxyWorker.js','getGlobalInfo','照片索引线程已退出[Photos\x20indexing\x20worker\x20exited]','uncaughtException','startClassesAiWork','Webdav\x20worker\x20is\x20stopped','Relaunch','HTTP\x20服务正在运行[HTTP\x20server\x20is\x20running]\x20:','getConfigApiPort','dbOther','NasCab\x20api\x20server\x20restarting\x20','myWorkers/ddnsWorker.js','sha256','did-finish-load','启用\x20frp','create','ddnsIpv4Address','已经放入回收站','shareType','页面加载完成','放入回收站失败','MEDIA_ARRANGE','nasProxyRestart','stopIndexWorker','Closing\x20NasCab\x20ddns','318262immxAT','electron','打开路径失败','myWorkers/ai/aiClassify.js','worker\x20send\x20msg\x20error','loadURL','myWorkers/mediaArrangeWorker.js','myWorkers/bg/fileOperationWorker.js','findByTitle','source_type','FTPServer','reset','photo','stop','1531300ViciAQ','NEW_PHOTO_INDEX','app','path','http://','refresh','webContents','getTime','aiFaceEnable','restartWatcher','autoLoginClient','exitApp','/#/','myWorkers/ai/aiSimilarPhotos.js','OFF','run','child_process','createUserFolder','https://','myWorkers/bg/backupWorker.js','startUpdate','prepare','getFreePort','initTray','关闭\x20proxyWorker','WebDav','quit','shell','3037830eumpns'];_0xa7e5=function(){return _0x5e78b8;};return _0xa7e5();}const messageUtil=require('./utils/messageUtil');function _0x29c4(_0x2ed4a3,_0x1e37c1){const _0xa7e5ef=_0xa7e5();return _0x29c4=function(_0x29c46c,_0x3cbb83){_0x29c46c=_0x29c46c-0xb6;let _0xae4848=_0xa7e5ef[_0x29c46c];return _0xae4848;},_0x29c4(_0x2ed4a3,_0x1e37c1);}let backupWorkerIsRunning=![],m3u8WorkerIsRunning=![],subtitleGenWorkerIsRunning=![],loadUrl='',listenPortHttp='80';function workerSendMsg(_0x586cf2,_0x4eb0cb){const _0x300345=_0x2c844e;try{_0x586cf2&&!_0x586cf2[_0x300345(0x110)]&&_0x586cf2[_0x300345(0x12d)](_0x4eb0cb,undefined,undefined,_0x1b5726=>{const _0x4980b3=_0x300345;_0x1b5726&&console[_0x4980b3(0x11a)]('send\x20message\x20callback\x20',_0x1b5726);});}catch(_0xc303b2){console[_0x300345(0x11a)](_0x300345(0xe3),_0xc303b2);}}let dbu;function init(){const _0xa21ce1=_0x2c844e;var _0x527f50=require('cluster');let _0x1e1b3f=require(_0xa21ce1(0xf0)),_0x3383b9=require(_0xa21ce1(0x135)),_0x71d557=require(_0xa21ce1(0x116)),_0x238150=_0x3383b9[_0xa21ce1(0xfe)]();dbu=_0x3383b9['initDbu']();let _0x422c90='';function _0x3a2bc3(_0x495bde,_0x5dbd50){const _0x1cde9c=_0xa21ce1;function _0x59f262(){const _0x4d1136=_0x29c4;_0x495bde[_0x4d1136(0x159)](),_0x422c90=_0x71d557['getServerRootPath'](_0x495bde[_0x4d1136(0xcf)]);if(app)_0x3383b9['launchWithSys']();_0x3383b9['setLanguage']();if(app)mainWindow=_0x3383b9['createMainWindow']();_0x3383b9[_0x4d1136(0x159)](_0x495bde);if(app)_0x3383b9[_0x4d1136(0x104)](_0x495bde,mainWindow);if(app)_0x3383b9[_0x4d1136(0xba)](_0x495bde,mainWindow);_0x3383b9[_0x4d1136(0x138)](),_0x3383b9[_0x4d1136(0x136)](_0x495bde);if(app)_0x3383b9['openDev']();_0x5dbd50(mainWindow);}app?app[_0x1cde9c(0x10b)]()['then'](()=>{_0x59f262();}):_0x59f262();}_0x3a2bc3(dbu,_0x3b0c62=>{const _0x32fccc=_0xa21ce1,_0x4fc2c4=_0x3383b9[_0x32fccc(0x157)]();let _0xdda82d=_0x3383b9[_0x32fccc(0xce)]();_0x3383b9[_0x32fccc(0x103)](_0xdda82d,_0x479fbe=>{const _0x5463a5=_0x32fccc;function _0x2a6381(_0x21349f){const _0x46b71d=_0x29c4,_0x2abe74=fork(_0x1e1b3f[_0x46b71d(0xbc)](__dirname,_0x21349f),[],{'env':{'userDataFolder':_0x238150,'appRootPath':_0x4fc2c4},'detached':![],'killSignal':_0x46b71d(0x120)});return _0x3383b9[_0x46b71d(0x115)][_0x46b71d(0x10f)](_0x2abe74),_0x3383b9[_0x46b71d(0x145)](dbu[_0x46b71d(0xcf)],_0x2abe74[_0x46b71d(0x118)]),_0x2abe74['on'](_0x46b71d(0x12a),function(_0x2ab3a0,_0x3fd4a8){}),_0x2abe74['on']('error',function(_0x378a59){const _0x1f2a8d=_0x46b71d;console[_0x1f2a8d(0x11a)]('进程出错了',_0x378a59);}),_0x2abe74;}dbu[_0x5463a5(0xcf)]['prepare'](_0x5463a5(0x13e))[_0x5463a5(0xfc)](),setInterval(()=>{_0x36841c();},0x258*0x3e8),setTimeout(()=>{_0x3383b9['addScanTaskWhenStart'](dbu['dbOther']),_0x55e025(),_0x52662d(),_0x271789(),_0x2e9eff(),_0x1e4a43(),_0x3b943c(),_0x366085(),_0xca1cea(),_0x304d28();},0x1388);let _0x267422;function _0x2e9eff(){const _0x40eefd=_0x5463a5;if(bookIndexWorkerIsRunning)return;bookIndexWorkerIsRunning=!![],_0x267422=_0x2a6381(_0x40eefd(0xbb)),_0x267422['on'](_0x40eefd(0xbf),function(_0x44b467){const _0x24a95e=_0x40eefd;_0x44b467[_0x24a95e(0x141)]==_0x24a95e(0x160)&&(bookIndexWorkerIsRunning=![]);}),_0x267422['on'](_0x40eefd(0x12a),function(_0x2615e2,_0x2b9baa,_0x48bc95){const _0x4abe65=_0x40eefd;console[_0x4abe65(0x11a)]('图书索引线程已退出[Books\x20indexing\x20worker\x20exited]',_0x2b9baa||'',_0x48bc95||''),bookIndexWorkerIsRunning=![];});}let _0x132c35;function _0x271789(){const _0x3de584=_0x5463a5;if(musicIndexWorkerIsRunning)return;musicIndexWorkerIsRunning=!![],_0x132c35=_0x2a6381('myWorkers/index/musicIndexWorker.js'),_0x132c35['on'](_0x3de584(0xbf),function(_0x428902){const _0x9bf0ef=_0x3de584;_0x428902[_0x9bf0ef(0x141)]=='close'&&(musicIndexWorkerIsRunning=![]);}),_0x132c35['on'](_0x3de584(0x12a),function(_0x181ccf,_0xa5f59f,_0x1d0f01){const _0x25490d=_0x3de584;console[_0x25490d(0x11a)](_0x25490d(0x131),_0xa5f59f||'',_0x1d0f01||''),musicIndexWorkerIsRunning=![];});}let _0x387072;function _0x28acb(){const _0x2dfb88=_0x5463a5;if(watchWorkerIsRunning)return;watchWorkerIsRunning=!![],_0x387072=_0x2a6381(_0x2dfb88(0x152)),_0x387072['on'](_0x2dfb88(0xbf),function(_0x1b5fe1){const _0x413f55=_0x2dfb88;if(_0x1b5fe1['type']==_0x413f55(0x160))watchWorkerIsRunning=![];else{if(_0x1b5fe1['type']==_0x413f55(0xee))_0x1e4a43(),_0xca1cea();else _0x1b5fe1['type']==_0x413f55(0x112)&&(_0x1e4a43(),_0x304d28(),_0x35771a());}}),_0x387072['on'](_0x2dfb88(0x12a),function(_0x1d5c8b,_0xf51094,_0x5c8d03){const _0x47335b=_0x2dfb88;console['log'](_0x47335b(0x155),_0xf51094,_0x5c8d03),watchWorkerIsRunning=![];});}_0x28acb();let _0xefef19;function _0x55e025(){const _0x5b6f3c=_0x5463a5;if(photoIndexWorkerIsRunning)return;photoIndexWorkerIsRunning=!![],_0xefef19=_0x2a6381('myWorkers/index/photoIndexWorker.js'),_0xefef19['on'](_0x5b6f3c(0xbf),function(_0x3123c8){const _0x579696=_0x5b6f3c;_0x3123c8['type']==_0x579696(0x160)&&(photoIndexWorkerIsRunning=![]),_0x3123c8[_0x579696(0x141)]=='NEW_PHOTO_INDEX'&&(_0x1e4a43(),_0xca1cea());}),_0xefef19['on'](_0x5b6f3c(0x12a),function(_0x4e15df,_0x334009,_0x160d0d){const _0x3900f8=_0x5b6f3c;console[_0x3900f8(0x11a)](_0x3900f8(0xc8),_0x334009||'',_0x160d0d||''),photoIndexWorkerIsRunning=![];});}let _0x573eba;function _0x52662d(){const _0x5d2caf=_0x5463a5;if(movieIndexWorkerIsRunning)return;movieIndexWorkerIsRunning=!![],_0x573eba=_0x2a6381('myWorkers/index/movieIndexWorker.js'),_0x573eba['on'](_0x5d2caf(0xbf),function(_0x3ade7a){const _0x11ed6b=_0x5d2caf;if(_0x3ade7a[_0x11ed6b(0x141)]=='close')movieIndexWorkerIsRunning=![];else _0x3ade7a[_0x11ed6b(0x141)]=='NEW_MOVIE_INDEX'&&(_0x1e4a43(),_0x304d28(),_0x35771a());}),_0x573eba['on'](_0x5d2caf(0x12a),function(_0x36d73a,_0x276a0d,_0x1271bf){const _0x21ce19=_0x5d2caf;console[_0x21ce19(0x11a)](_0x21ce19(0x156),_0x276a0d||'',_0x1271bf||''),movieIndexWorkerIsRunning=![];});}function _0x304d28(){const _0x5cc4b1=_0x5463a5;if(getMovieInfoWorkerIsRunning)return;getMovieInfoWorkerIsRunning=!![];let _0x29f66d=_0x2a6381('myWorkers/movieInfoWorker.js');_0x29f66d['on'](_0x5cc4b1(0xbf),function(_0xd0e126){const _0x2eb2a7=_0x5cc4b1;_0xd0e126[_0x2eb2a7(0x141)]=='close'&&(getMovieInfoWorkerIsRunning=![]);}),_0x29f66d['on'](_0x5cc4b1(0x12a),function(){getMovieInfoWorkerIsRunning=![];});}function _0x1e4a43(){const _0x65c4c8=_0x5463a5;if(tinyImgWorkerIsRunning)return;tinyImgWorkerIsRunning=!![];let _0x47385d=_0x2a6381(_0x65c4c8(0x111));_0x47385d['on']('message',function(_0x584aec){const _0x2995aa=_0x65c4c8;if(_0x584aec[_0x2995aa(0x141)]=='close')tinyImgWorkerIsRunning=![];else _0x584aec[_0x2995aa(0x141)]==_0x2995aa(0x15e)&&(_0x3b943c(),_0x366085());}),_0x47385d['on'](_0x65c4c8(0x12a),function(){tinyImgWorkerIsRunning=![];});}let _0x263ded,_0x26aaac;function _0x3859c8(){const _0x2edf25=_0x5463a5;let _0x30a5c2=dbFileShare['getAllByWhere'](dbu[_0x2edf25(0xcf)],_0x2edf25(0x140),[]);if(_0x30a5c2&&_0x30a5c2[_0x2edf25(0x11e)]>0x0)!_0x263ded&&(_0x263ded=_0x2a6381(_0x2edf25(0x124)),_0x263ded['on']('exit',function(){const _0x1dcecf=_0x2edf25;console['log'](_0x1dcecf(0xb7)),_0x263ded=null;}));else{_0x71d557['create'](dbu[_0x2edf25(0xcf)],{'title':_0x2edf25(0xe9),'value':JSON[_0x2edf25(0x137)]({'state':_0x2edf25(0xec)})});if(_0x263ded){let _0x15aba3=_0x263ded[_0x2edf25(0x128)]();_0x15aba3&&(_0x263ded=null,console[_0x2edf25(0x11a)]('Closing\x20FTP'));}}}function _0x5043fd(){const _0xcdef34=_0x5463a5;let _0x49ba74=dbFileShare['getAllByWhere'](dbu[_0xcdef34(0xcf)],_0xcdef34(0x15f),[]);if(_0x49ba74&&_0x49ba74[_0xcdef34(0x11e)]>0x0)!_0x26aaac&&(_0x26aaac=_0x2a6381(_0xcdef34(0x11f)),_0x26aaac['on'](_0xcdef34(0x12a),function(){const _0x459a8d=_0xcdef34;console[_0x459a8d(0x11a)](_0x459a8d(0xcb)),_0x26aaac=null;}));else{_0x71d557['create'](dbu['dbOther'],{'title':_0xcdef34(0xb9),'value':JSON[_0xcdef34(0x137)]({'state':_0xcdef34(0xec)})});if(_0x26aaac){let _0x145fe5=_0x26aaac[_0xcdef34(0x128)]();_0x145fe5&&(_0x26aaac=null);}}}let _0x72fcc7;function _0x552dcb(){const _0x3bbab6=_0x5463a5;let _0x4467af=![],_0x459f7a=_0x71d557[_0x3bbab6(0xe7)](dbu[_0x3bbab6(0xcf)],_0x3bbab6(0x148));_0x459f7a&&_0x459f7a[_0x3bbab6(0xbe)]==0x1&&(_0x4467af=!![]);if(_0x4467af)!_0x72fcc7&&(_0x72fcc7=_0x2a6381(_0x3bbab6(0xd1)),_0x72fcc7['on'](_0x3bbab6(0xbf),function(_0x5b1fb3){_0x5b1fb3['type']=='close'&&(_0x72fcc7=null);}),_0x72fcc7['on'](_0x3bbab6(0x12a),function(){const _0x578950=_0x3bbab6;console[_0x578950(0x11a)]('DDNS\x20worker\x20is\x20stopped'),_0x72fcc7=null;}));else{if(_0x72fcc7){let _0x3b8473=_0x72fcc7['kill']();_0x3b8473&&(_0x72fcc7=null,console['log'](_0x3bbab6(0xde)));}_0x71d557['deleteByTitle'](dbu['dbOther'],_0x3bbab6(0xb8)),_0x71d557[_0x3bbab6(0x144)](dbu[_0x3bbab6(0xcf)],_0x3bbab6(0xd6)),_0x71d557[_0x3bbab6(0xd5)](dbu[_0x3bbab6(0xcf)],{'title':_0x3bbab6(0x12f),'value':JSON[_0x3bbab6(0x137)]({'status':_0x3bbab6(0xc5),'ddnsIp':'','error':_0x3bbab6(0xfb)})});}}_0x552dcb();let _0x5013a7;function _0x20e682(){if(globalInfoWorkerIsRunning)return;globalInfoWorkerIsRunning=!![],_0x5013a7=_0x2a6381('myWorkers/globalInfoWorker.js'),_0x5013a7['on']('message',function(_0x497dbf){const _0x3a7169=_0x29c4;if(_0x497dbf[_0x3a7169(0x141)]==_0x3a7169(0x160))globalInfoWorkerIsRunning=![];else _0x497dbf['type']==_0x3a7169(0x14a)&&_0x4dbdb3(_0x497dbf);}),_0x5013a7['on']('exit',function(){globalInfoWorkerIsRunning=![];});}_0x20e682();function _0x366085(){const _0x576744=_0x5463a5;let _0x386b06=_0x71d557['findByTitle'](dbu[_0x576744(0xcf)],_0x576744(0xf5));if(_0x386b06&&_0x386b06[_0x576744(0xbe)]=='1'){if(aiFacesWorkerIsRunning)return;aiFacesWorkerIsRunning=!![];let _0xd53d88=_0x2a6381(_0x576744(0x13d));_0xd53d88['on'](_0x576744(0xbf),function(_0x43c336){const _0x3184c8=_0x576744;_0x43c336[_0x3184c8(0x141)]==_0x3184c8(0x160)&&(aiFacesWorkerIsRunning=![]);}),_0xd53d88['on'](_0x576744(0x12a),function(_0x384bbf,_0x1f984d,_0x4a2cc0){aiFacesWorkerIsRunning=![],_0xd53d88=null;});}else{}}function _0xca1cea(){const _0x178a03=_0x5463a5;let _0x37836f=_0x71d557[_0x178a03(0xe7)](dbu[_0x178a03(0xcf)],_0x178a03(0x130));if(_0x37836f&&_0x37836f[_0x178a03(0xbe)]=='1'){if(aiSimilarPhotoWorker)return;aiSimilarPhotoWorker=!![];let _0x20e817=_0x2a6381(_0x178a03(0xfa));_0x20e817['on'](_0x178a03(0xbf),function(_0x5429b6){const _0x9b893=_0x178a03;_0x5429b6['type']==_0x9b893(0x160)&&(aiSimilarPhotoWorker=![]);}),_0x20e817['on'](_0x178a03(0x12a),()=>{_0x20e817=![];});}else{}}function _0x3b943c(){const _0x24acde=_0x5463a5;let _0x499024=_0x71d557[_0x24acde(0xe7)](dbu['dbOther'],'aiClassesEnable');if(_0x499024&&_0x499024[_0x24acde(0xbe)]=='1'){if(aiClassesWorkerIsRunning)return;aiClassesWorkerIsRunning=!![];let _0x22a971=_0x2a6381(_0x24acde(0xe2));_0x22a971['on'](_0x24acde(0xbf),function(_0x43990b){const _0x5bae7a=_0x24acde;_0x43990b[_0x5bae7a(0x141)]==_0x5bae7a(0x160)&&(aiClassesWorkerIsRunning=![]);}),_0x22a971['on'](_0x24acde(0x12a),()=>{aiClassesWorkerIsRunning=![];});}else{}}let _0x8bfa29;function _0x3041ed(){const _0x6398b8=_0x5463a5;let _0x4bbe4e=dbu[_0x6398b8(0xcf)][_0x6398b8(0x102)](_0x6398b8(0xb6))['get']();if(_0x4bbe4e['count']>0x0){if(backupWorkerIsRunning)return;backupWorkerIsRunning=!![],_0x8bfa29=_0x2a6381(_0x6398b8(0x100)),_0x8bfa29['on'](_0x6398b8(0xbf),function(_0x350e0d){const _0x4a8468=_0x6398b8;_0x350e0d[_0x4a8468(0x141)]==_0x4a8468(0x160)&&(backupWorkerIsRunning=![]);}),_0x8bfa29['on'](_0x6398b8(0x12a),()=>{backupWorkerIsRunning=![];});}else{if(_0x8bfa29){let _0x546559=_0x8bfa29[_0x6398b8(0x128)]();_0x546559&&(_0x8bfa29=null);}}}_0x3041ed();let _0x89346d;function _0x263967(){const _0x4baa2a=_0x5463a5;if(m3u8WorkerIsRunning)return;m3u8WorkerIsRunning=!![],_0x89346d=_0x2a6381(_0x4baa2a(0x13c)),_0x89346d['on'](_0x4baa2a(0xbf),function(_0x3e1db5){const _0x3a8da4=_0x4baa2a;_0x3e1db5[_0x3a8da4(0x141)]==_0x3a8da4(0x160)&&(m3u8WorkerIsRunning=![]);}),_0x89346d['on'](_0x4baa2a(0x12a),function(_0x3fcee0){m3u8WorkerIsRunning=![];});}let _0x4c3a63,_0x1641f3=![];function _0x36841c(){const _0x5c153b=_0x5463a5;_0x1641f3&&(!_0x4c3a63&&(_0x4c3a63=_0x2a6381(_0x5c153b(0xc6)),_0x4c3a63['on'](_0x5c153b(0x12a),_0x1dcbc6=>{const _0x9bedf4=_0x5c153b;console[_0x9bedf4(0x11a)](_0x9bedf4(0x10a),_0x1dcbc6),_0x4c3a63=null;}),console[_0x5c153b(0x11a)](_0x5c153b(0xd4))));}function _0x52362d(){const _0x41c782=_0x5463a5;let _0x224155=_0x71d557['findByTitle'](dbu[_0x41c782(0xcf)],_0x41c782(0x134));!_0x224155||_0x224155&&_0x224155[_0x41c782(0xbe)]!=0x1&&_0x224155[_0x41c782(0xbe)]!='1'?(_0x1641f3=![],_0x4c3a63&&(_0x4c3a63[_0x41c782(0x128)](),_0x4c3a63=null,console[_0x41c782(0x11a)](_0x41c782(0x105))),_0x71d557[_0x41c782(0xd5)](dbu[_0x41c782(0xcf)],{'title':_0x41c782(0x154),'value':JSON[_0x41c782(0x137)]({'status':_0x41c782(0xc5),'time':new Date()[_0x41c782(0xf4)]()+'','error':_0x41c782(0x14e)})})):(_0x1641f3=!![],_0x36841c());}_0x52362d();let _0x496ec4;function _0x35771a(){const _0x747e43=_0x5463a5;if(subtitleGenWorkerIsRunning)return;subtitleGenWorkerIsRunning=!![],_0x496ec4=_0x2a6381(_0x747e43(0x11c)),_0x496ec4['on']('message',function(_0x1d4155){const _0x220029=_0x747e43;_0x1d4155['type']==_0x220029(0x160)&&(subtitleGenWorkerIsRunning=![]);}),_0x496ec4['on'](_0x747e43(0x12a),function(_0x2af32d){subtitleGenWorkerIsRunning=![];});}setTimeout(()=>{_0x35771a();},0x1388);let _0x2bd91a=![],_0x3b1f1e=![],_0x48570c=![];function _0x2d1dc1(_0x5ea511){try{!_0x48570c&&(_0x48570c=!![],setTimeout(()=>{const _0x422de7=_0x29c4;let _0x54c125=require('./utils/globalInfoUtil'),_0x6d91a9=_0x54c125[_0x422de7(0x147)](dbu[_0x422de7(0xcf)]);_0x6d91a9?console['log']('HTTPS\x20服务正在运行[HTTPS\x20server\x20is\x20running]\x20:',_0x422de7(0xff)+_0x6d91a9+':'+_0x5ea511+_0x422c90):console[_0x422de7(0x11a)](_0x422de7(0x121),''+_0x5ea511+_0x422c90);},0x3a98));}catch(_0x2a7756){console['log'](_0x2a7756);}}let _0x161141=![];function _0x376f4e(){const _0x2014d3=_0x5463a5;if(app&&_0x3b0c62){if(_0x161141)return;_0x161141=!![],setTimeout(()=>{_0x161141=![];},0xbb8);function _0x231d91(){const _0x359465=_0x29c4;loadUrl=listenPortHttp=='80'?_0x359465(0x122)+_0x422c90+'/#/':_0x359465(0x125)+listenPortHttp+_0x422c90+_0x359465(0xf9);let _0x505bcb=_0x71d557[_0x359465(0xe7)](dbu[_0x359465(0xcf)],_0x359465(0xf7));if(!_0x505bcb||_0x505bcb[_0x359465(0xbe)]=='1'){let _0x3a4e6d=dbUserTable[_0x359465(0x158)](dbu['dbOther']);if(_0x3a4e6d){let _0x1c188c=sha256(new Date()[_0x359465(0xf4)]()+_0x3a4e6d['username']);dbUserTable['createToken'](dbu[_0x359465(0xcf)],_0x3a4e6d['id'],_0x1c188c,'localhost'),loadUrl+=_0x359465(0x132)+_0x1c188c;}}}_0x231d91(),console['log'](_0x2014d3(0x150),loadUrl),_0x3b0c62[_0x2014d3(0xe4)](loadUrl),_0x3b0c62[_0x2014d3(0xf3)]['on'](_0x2014d3(0x12e),function(){const _0x52bed3=_0x2014d3;console[_0x52bed3(0x11a)]('页面加载失败',loadUrl);}),_0x3b0c62[_0x2014d3(0xf3)]['on'](_0x2014d3(0xd3),function(){const _0x423b92=_0x2014d3;console[_0x423b92(0x11a)](_0x423b92(0xd9),loadUrl);}),ipcMain['on'](_0x2014d3(0xf2),(_0x497f5b,_0x371012)=>{const _0x25b6b9=_0x2014d3;console[_0x25b6b9(0x11a)](_0x25b6b9(0x142),loadUrl),loadUrl&&_0x3b0c62['loadURL'](loadUrl);});}}function _0x5e79d0(_0x444081){const _0x2639aa=_0x5463a5;listenPortHttp=_0x444081,_0x5043fd(),setTimeout(()=>{_0x3859c8();},0x1388),!_0x3b1f1e&&(_0x3b1f1e=!![],setTimeout(()=>{const _0x58cbe4=_0x29c4;let _0x4f1a10=require('./utils/globalInfoUtil'),_0x28a33a=_0x4f1a10[_0x58cbe4(0x147)](dbu[_0x58cbe4(0xcf)]);_0x28a33a?console[_0x58cbe4(0x11a)](_0x58cbe4(0xcd),_0x58cbe4(0xf1)+_0x28a33a+':'+listenPortHttp+_0x422c90):console[_0x58cbe4(0x11a)](_0x58cbe4(0x15d),listenPortHttp);},0x3a98)),_0x71d557[_0x2639aa(0xd5)](dbu['dbOther'],{'title':_0x2639aa(0x161),'value':JSON[_0x2639aa(0x137)]({'state':'run','port':listenPortHttp})}),!_0x2bd91a&&(_0x2bd91a=!![],_0x376f4e(),workerSendMsg(_0x4c3a63,{'type':'start'}));}let _0x219299=_0x3383b9['getExpressApiCount']();console[_0x5463a5(0x11a)](_0x5463a5(0xc3),_0x219299),_0x527f50[_0x5463a5(0x153)]({'exec':_0x1e1b3f['resolve'](__dirname,_0x5463a5(0x10d))}),_0x527f50['on'](_0x5463a5(0x12a),function(_0x394662,_0x1aa1f5,_0x3bc72b){const _0x4f8e9b=_0x5463a5;console[_0x4f8e9b(0x11a)](_0x4f8e9b(0xd0),_0x1aa1f5,_0x3bc72b),setTimeout(()=>{_0x23e534();},0x1388);});for(let _0x2ebc7f=0x0;_0x2ebc7f<_0x219299;_0x2ebc7f++){console[_0x5463a5(0x11a)]('NasCab\x20api\x20server\x20starting\x20',_0x2ebc7f+0x1),_0x23e534();}function _0x4dbdb3(_0x52e016){const _0x13fdcc=_0x5463a5;if(_0x52e016['source_type']==_0x13fdcc(0x10e))_0x52662d();else{if(_0x52e016['source_type']==_0x13fdcc(0xeb))_0x55e025();else{if(_0x52e016[_0x13fdcc(0xe8)]==_0x13fdcc(0x13f))_0x271789();else _0x52e016[_0x13fdcc(0xe8)]==_0x13fdcc(0x113)&&_0x2e9eff();}}_0x52e016[_0x13fdcc(0xf6)]&&(_0x28acb(),workerSendMsg(_0x387072,_0x52e016));}function _0x23e534(){const _0x1673e9=_0x5463a5,_0x29ff68=_0x527f50['fork']({'usePort':_0x479fbe,'userDataFolder':_0x238150,'appRootPath':_0x4fc2c4});_0x29ff68['on'](_0x1673e9(0xbf),function(_0x2005f4){const _0xd2cdad=_0x1673e9;try{switch(_0x2005f4[_0xd2cdad(0x141)]){case _0xd2cdad(0xdb):let _0x17d343=_0x2a6381(_0xd2cdad(0xe5));workerSendMsg(_0x17d343,_0x2005f4);break;case _0xd2cdad(0xc4):_0x376f4e();break;case'START_WORKER_FILE_OPERATION':let _0x320d1a=_0x2a6381(_0xd2cdad(0xe6));workerSendMsg(_0x320d1a,_0x2005f4);break;case _0xd2cdad(0x123):if(!bgTaskWorkerIsRunning){bgTaskWorkerIsRunning=!![];let _0x14722a=_0x2a6381(_0xd2cdad(0x151));_0x14722a['on'](_0xd2cdad(0xbf),function(_0x44c993){const _0x1ca1bd=_0xd2cdad;_0x44c993['type']==_0x1ca1bd(0x160)&&(bgTaskWorkerIsRunning=![]);});}break;case'SWITCH_MOVIE_INFO':_0x304d28();break;case'START_PRE_GEN_SUBTITLE':_0x35771a();break;case'M3u8Transcode':_0x263967(),workerSendMsg(_0x89346d,_0x2005f4);break;case _0xd2cdad(0xdc):_0x52362d(),workerSendMsg(_0x4c3a63,{'type':'reset','msg':_0x2005f4});break;case _0xd2cdad(0x14d):_0x52362d(),workerSendMsg(_0x4c3a63,{'type':_0xd2cdad(0xec)}),setTimeout(()=>{_0x304d28();},0x3e8);break;case _0xd2cdad(0xc7):_0x20e682(),workerSendMsg(_0x5013a7,_0x2005f4);break;case _0xd2cdad(0x101):console[_0xd2cdad(0x11a)]('Start\x20checking\x20for\x20updates'),_0x3383b9[_0xd2cdad(0x101)]();break;case _0xd2cdad(0x13a):_0x3041ed();break;case _0xd2cdad(0xdd):if(_0x2005f4[_0xd2cdad(0xe8)]==_0xd2cdad(0xeb))_0xefef19&&(_0xefef19[_0xd2cdad(0x128)](),_0xefef19=null,photoIndexWorkerIsRunning=![]);else{if(_0x2005f4[_0xd2cdad(0xe8)]==_0xd2cdad(0x10e))_0x573eba&&(_0x573eba[_0xd2cdad(0x128)](),_0x573eba=null,movieIndexWorkerIsRunning=![]);else{if(_0x2005f4[_0xd2cdad(0xe8)]==_0xd2cdad(0x13f))_0x132c35&&(_0x132c35[_0xd2cdad(0x128)](),_0x132c35=null,musicIndexWorkerIsRunning=![]);else _0x2005f4['source_type']=='book'&&(_0x267422&&(_0x267422[_0xd2cdad(0x128)](),_0x267422=null,bookIndexWorkerIsRunning=![]));}}break;case _0xd2cdad(0x14a):_0x4dbdb3(_0x2005f4);break;case _0xd2cdad(0x11d):if(_0x2005f4[_0xd2cdad(0xd8)]==_0xd2cdad(0x106))_0x5043fd(),workerSendMsg(_0x26aaac,_0x2005f4);else _0x2005f4[_0xd2cdad(0xd8)]==_0xd2cdad(0xc0)&&(_0x3859c8(),workerSendMsg(_0x263ded,_0x2005f4));break;case _0xd2cdad(0x14b):_0x552dcb(),workerSendMsg(_0x72fcc7,{'type':_0xd2cdad(0x14f),'force':0x1});break;case _0xd2cdad(0x14d):_0x552dcb(),setTimeout(()=>{_0x304d28();},0x3e8);break;case'nasAccountLogin':_0x52362d(),workerSendMsg(_0x4c3a63,{'type':_0xd2cdad(0xea)}),_0x552dcb(),setTimeout(()=>{_0x304d28();},0x3e8);break;case _0xd2cdad(0xfe):_0x3383b9[_0xd2cdad(0xfe)]();break;case _0xd2cdad(0xca):_0x3b943c();break;case'startFaceAiWork':_0x366085();break;case'startSimilarPhotoWork':_0xca1cea();break;case _0xd2cdad(0x117):_0x5e79d0(_0x2005f4['exressPort']);break;case _0xd2cdad(0x15c):_0x2d1dc1(_0x2005f4['exressPort']);break;case _0xd2cdad(0xcc):console['log']('Relaunch\x20Restart');if(app)app['relaunch']();_0x3383b9[_0xd2cdad(0xf8)](dbu);break;case _0xd2cdad(0x149):break;case _0xd2cdad(0x108):if(shell){if(_0x2005f4[_0xd2cdad(0x146)]==_0xd2cdad(0xc1))_0x2005f4['path']&&shell[_0xd2cdad(0xc1)](_0x2005f4['path']);else{if(_0x2005f4['shellType']==_0xd2cdad(0x15a))_0x2005f4[_0xd2cdad(0xf0)]&&shell[_0xd2cdad(0x15a)](_0x2005f4['path'])[_0xd2cdad(0x129)](_0x3d092b=>{console['log']('已打开路径');})[_0xd2cdad(0x12c)](_0x39861d=>{const _0x999804=_0xd2cdad;console[_0x999804(0x11a)](_0x999804(0xe1),_0x39861d);});else _0x2005f4[_0xd2cdad(0x146)]=='trash'&&(_0x2005f4[_0xd2cdad(0xf0)]&&shell[_0xd2cdad(0x133)](_0x2005f4[_0xd2cdad(0xf0)])['then'](_0xf49bad=>{const _0x60f60f=_0xd2cdad;console['log'](_0x60f60f(0xd7));})[_0xd2cdad(0x12c)](_0x51b90c=>{const _0x21b8a9=_0xd2cdad;console[_0x21b8a9(0x11a)](_0x21b8a9(0xda),_0x51b90c);}));}}break;}}catch(_0x4607b3){console[_0xd2cdad(0x11a)](_0xd2cdad(0x12b),_0x4607b3);}});}});});}if(app){const gotTheLock=app['requestSingleInstanceLock']();!gotTheLock?(app[_0x2c844e(0x107)](),process[_0x2c844e(0x128)](process[_0x2c844e(0x118)],_0x2c844e(0x120))):(app['on']('second-instance',(_0x10a6a2,_0x1fea3f,_0x5bc757)=>{const _0x213366=_0x2c844e;if(mainWindow){if(mainWindow[_0x213366(0xc2)]())mainWindow['restore']();!mainWindow['isVisible']()&&mainWindow[_0x213366(0x139)](),mainWindow[_0x213366(0x119)]();}}),init());}else init();process['on'](_0x2c844e(0xc9),(_0x1808e7,_0x4e317f)=>{const _0x45623f=_0x2c844e;console['log'](_0x45623f(0x15b),_0x1808e7);});