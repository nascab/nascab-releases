function _0x4c9b(){const _0x361ec1=['25evLtbh','uploadTempFilePrefix','torrentPath','STATE_SUC','../../db/dbFileOperationRecord','decodePath','saveFullPath','path','27fNTSbq','skip','over','file','query','2675309lnHTrV','1304460gLfqLG','app','../utils/fileUtils','replace','subtitlePath','addFileOperationRecord','diskStorage','length','TYPE_UPLOAD','225657bmxFlV','SAMENAME','single','getTime','close','uploadSubtitle','2082dUJDnN','returnFileError','base64originalName','uploadFile','exports','../../myConfig/config','body','rename','stat','overMode','dbOther','from','14180800rCdxmj','json','567444FxYblA','join','utimesSync','set','originalname','savePath','2112220hFHIFn','72LtlTOa','LEVEL_MAIN_OPERATION','filename','Connection','upload','statusCode','currentUser','ctime'];_0x4c9b=function(){return _0x361ec1;};return _0x4c9b();}const _0x3609df=_0x32bd;(function(_0x163eae,_0x3e8270){const _0x5187d4=_0x32bd,_0x309c89=_0x163eae();while(!![]){try{const _0x108c02=parseInt(_0x5187d4(0x9c))/0x1*(parseInt(_0x5187d4(0xb1))/0x2)+parseInt(_0x5187d4(0xa2))/0x3+-parseInt(_0x5187d4(0xc5))/0x4+-parseInt(_0x5187d4(0xce))/0x5*(parseInt(_0x5187d4(0xbf))/0x6)+-parseInt(_0x5187d4(0xa1))/0x7+parseInt(_0x5187d4(0xc6))/0x8*(-parseInt(_0x5187d4(0xab))/0x9)+parseInt(_0x5187d4(0xbd))/0xa;if(_0x108c02===_0x3e8270)break;else _0x309c89['push'](_0x309c89['shift']());}catch(_0x29129e){_0x309c89['push'](_0x309c89['shift']());}}}(_0x4c9b,0x4276e));let fs=require('fs'),path=require(_0x3609df(0x9b)),uploadUtil={},multer=require('multer'),fileUtil=require(_0x3609df(0xa4));const config=require(_0x3609df(0xb6));let dbFileOperationRecord=require(_0x3609df(0xd2));function _0x32bd(_0x4abe34,_0x11d871){const _0x4c9bba=_0x4c9b();return _0x32bd=function(_0x32bd5f,_0x688a6e){_0x32bd5f=_0x32bd5f-0x9a;let _0x131fbc=_0x4c9bba[_0x32bd5f];return _0x131fbc;},_0x32bd(_0x4abe34,_0x11d871);}const storage=multer[_0x3609df(0xa8)]({'destination':function(_0x35fa8c,_0x17d443,_0x27b858){const _0x35fe5b=_0x3609df;let _0x2dda7f=_0x35fa8c['query'][_0x35fe5b(0xc4)];if(_0x35fa8c[_0x35fe5b(0xa0)]['filename']){let _0x3e17e=_0x35fa8c[_0x35fe5b(0xa0)][_0x35fe5b(0xc8)];try{_0x3e17e=decodeURIComponent(_0x3e17e);}catch(_0x34d8fb){}_0x17d443[_0x35fe5b(0xc3)]=_0x3e17e;}let _0x56b388=path[_0x35fe5b(0xc0)](_0x2dda7f,_0x17d443['originalname']),_0xe15c0b=_0x35fa8c[_0x35fe5b(0xa0)]['overMode']||_0x35fa8c[_0x35fe5b(0xb7)][_0x35fe5b(0xba)];!_0xe15c0b&&(_0xe15c0b=_0x35fe5b(0x9d)),fs[_0x35fe5b(0xb9)](_0x56b388,(_0x2c922d,_0x9f13d8)=>{const _0x38793a=_0x35fe5b;if(!_0x2c922d){if(_0xe15c0b==_0x38793a(0x9d))return _0x27b858(new Error(_0x38793a(0xac)));else{if(_0xe15c0b==_0x38793a(0xb8))_0x17d443[_0x38793a(0xc3)]=new Date()[_0x38793a(0xae)]()+_0x17d443[_0x38793a(0xc3)];else{if(_0xe15c0b==_0x38793a(0x9e)){}}}}_0x35fa8c[_0x38793a(0xa0)][_0x38793a(0xc3)]=_0x17d443[_0x38793a(0xc3)]['replace'](/[<>\\\/:\*\?\"\|]/g,'_'),_0x17d443['originalname']=(config[_0x38793a(0xcf)]+_0x17d443[_0x38793a(0xc3)])[_0x38793a(0xa5)](/[<>\\\/:\*\?\"\|]/g,'_'),_0x56b388=path[_0x38793a(0xc0)](_0x2dda7f,_0x17d443[_0x38793a(0xc3)]),_0x35fa8c[_0x38793a(0xa0)]['saveFullPath']=_0x56b388,_0x27b858(null,_0x2dda7f);});},'filename':function(_0x4a208f,_0x4d99e5,_0x4288b6){const _0x592b7b=_0x3609df;_0x4a208f['query']['base64originalName']?_0x4288b6(null,Buffer[_0x592b7b(0xbc)](_0x4d99e5[_0x592b7b(0xc3)])['toString']('base64')):_0x4288b6(null,_0x4d99e5[_0x592b7b(0xc3)]);}}),multerUpload=multer({'storage':storage})[_0x3609df(0xad)]('file');uploadUtil[_0x3609df(0xb4)]=function(_0x4e615f,_0x29f7aa,_0x282a1d,_0x163a42,_0xca406d,_0x64ec38,_0x4a95e7){const _0x4a2957=_0x3609df;let _0x25d638=_0x4e615f[_0x4a2957(0xa0)][_0x4a2957(0xc4)]||_0x4e615f['body'][_0x4a2957(0xc4)];if(_0x4e615f[_0x4a2957(0xa0)][_0x4a2957(0xb0)]==0x1){let _0x570085=path[_0x4a2957(0xc0)](config[_0x4a2957(0xa6)],_0x4a2957(0xca));_0x25d638=_0x570085;}else _0xca406d&&(_0x4e615f[_0x4a2957(0xa0)][_0x4a2957(0xb3)]=!![]),_0x282a1d&&(_0x25d638=fileUtil[_0x4a2957(0xd3)](_0x25d638));if(_0x25d638=='nascab_torrentSavePath'){let _0x5560d0=path[_0x4a2957(0xc0)](config[_0x4a2957(0xd0)]);_0x25d638=_0x5560d0;}_0x4e615f['query'][_0x4a2957(0xc4)]=_0x25d638,multerUpload(_0x4e615f,_0x29f7aa,function(_0x12cd4f){const _0x3f89c2=_0x4a2957;if(_0x12cd4f)return _0x12cd4f['message']==_0x3f89c2(0xac)?(_0x29f7aa[_0x3f89c2(0xcb)]=0xc8,_0x29f7aa[_0x3f89c2(0xc2)](_0x3f89c2(0xc9),_0x3f89c2(0xaf)),_0x29f7aa[_0x3f89c2(0xbe)]({'code':0x1,'remark':_0x3f89c2(0xac),'message':_0x29f7aa['__']('sameNameFileAlreadExist')})):(_0x4a95e7&&_0x4a95e7(_0x12cd4f),fileUtil[_0x3f89c2(0xb2)](_0x29f7aa,_0x12cd4f));if(!_0x4e615f['query'][_0x3f89c2(0xc3)]){_0x4a95e7&&_0x4a95e7(_0x12cd4f);return;}let _0xb4f064=path[_0x3f89c2(0xc0)](_0x4e615f[_0x3f89c2(0xa0)][_0x3f89c2(0xc4)],_0x4e615f['query'][_0x3f89c2(0xc3)]);fs[_0x3f89c2(0xb9)](_0x4e615f[_0x3f89c2(0xa0)]['saveFullPath'],(_0x16b440,_0x1f03cb)=>{const _0x5cd101=_0x3f89c2;if(_0x16b440){_0x4a95e7&&_0x4a95e7(_0x16b440);return;}_0x1f03cb['isFile']()&&fs[_0x5cd101(0xb8)](_0x4e615f['query'][_0x5cd101(0x9a)],_0xb4f064,_0x4c918b=>{const _0x2ecc6e=_0x5cd101;if(_0x4c918b)return _0x4a95e7&&_0x4a95e7(_0x4c918b),fileUtil[_0x2ecc6e(0xb2)](_0x29f7aa,_0x4c918b);else{dbFileOperationRecord[_0x2ecc6e(0xa7)](_0x4e615f[_0x2ecc6e(0xa3)][_0x2ecc6e(0xbb)],{'username':_0x4e615f[_0x2ecc6e(0xcc)]['username'],'targetPath':_0xb4f064,'level':dbFileOperationRecord[_0x2ecc6e(0xc7)],'type':dbFileOperationRecord[_0x2ecc6e(0xaa)],'state':dbFileOperationRecord[_0x2ecc6e(0xd1)]}),_0x4e615f[_0x2ecc6e(0x9f)][_0x2ecc6e(0x9b)]=_0xb4f064,_0x4e615f[_0x2ecc6e(0x9f)][_0x2ecc6e(0xc8)]=_0x4e615f[_0x2ecc6e(0xa0)][_0x2ecc6e(0xc3)];let _0x102c56=_0x4e615f['body'][_0x2ecc6e(0xcd)]||_0x4e615f['query']['ctime'];try{if(_0x102c56){_0x102c56=_0x102c56+'';if(_0x102c56[_0x2ecc6e(0xa9)]==0xa)fs[_0x2ecc6e(0xc1)](_0xb4f064,_0x102c56,_0x102c56);else{}}}catch(_0x579f5d){}_0x64ec38&&_0x64ec38(_0x4e615f[_0x2ecc6e(0x9f)]);if(!_0x163a42)return _0x29f7aa[_0x2ecc6e(0xbe)]({'code':0x0,'file':_0x4e615f[_0x2ecc6e(0x9f)]});}});});});},module[_0x3609df(0xb5)]=uploadUtil;