const _0x595c51=_0x3d29;(function(_0x2c822a,_0x59e81e){const _0x174409=_0x3d29,_0xd24483=_0x2c822a();while(!![]){try{const _0x3a28fc=parseInt(_0x174409(0x142))/0x1+-parseInt(_0x174409(0x139))/0x2*(-parseInt(_0x174409(0x178))/0x3)+-parseInt(_0x174409(0x121))/0x4*(-parseInt(_0x174409(0x104))/0x5)+-parseInt(_0x174409(0x168))/0x6*(-parseInt(_0x174409(0x133))/0x7)+-parseInt(_0x174409(0x117))/0x8+parseInt(_0x174409(0x102))/0x9+-parseInt(_0x174409(0x11c))/0xa*(parseInt(_0x174409(0x13c))/0xb);if(_0x3a28fc===_0x59e81e)break;else _0xd24483['push'](_0xd24483['shift']());}catch(_0x19e684){_0xd24483['push'](_0xd24483['shift']());}}}(_0x2e0b,0x80c18));var express=require('express'),router=express[_0x595c51(0x130)]();const fs=require('fs'),sharp=require(_0x595c51(0x13e)),axios=require('axios');let sha256=require(_0x595c51(0x141)),path=require('path'),config=require('../../myConfig/config');const tmdbApi=require(_0x595c51(0x167)),movieInfoUtil=require('../../utils/movieInfoUtil'),movieSeasonUtil=require(_0x595c51(0x158)),dbFileIndexTable=require('../../db/dbFileIndexTable'),dbUserTable=require(_0x595c51(0x153)),dbFileOperationRecord=require(_0x595c51(0x10d)),nfoUtil=require(_0x595c51(0x14f)),httpUtil=require(_0x595c51(0x165));function _0x2e0b(){const _0xa7e478=['app','TYPE_DELETE','get','json','headersSent','DELETE\x20FROM\x20movie_scrape_log\x20WHERE\x201=1','/scrapeAgain','path','dbOther','basename','indexId/tmdbId\x20error','tmdb','796959ArAXpV','send','5DFpTCh','count','/clearMovieInfo','stat','searchType','-thumb.jpg','/setMovieInfo','/clearNfoImg','url','../../db/dbFileOperationRecord','INDEX_TABLE_NAME_MOVIE','doUserCanGet','currentUser','params\x20error','/testTmdbProxy','is_tvplay','search','TMDB\x20search接口请求失败','status_message','6055080SidNEJ','languageList','username','/searchMovieInfo','toBuffer','289020ZDdVqY','.jpg','lastIndexOf','/clearScrapeLog','tvshow.nfo','785828YboYhj','ext','dbFileIndex','catch','substring','end','Need\x20tmdb\x20language','searchMediaType','sourceFolder','operationFail','err1','movieTmdbLanguage','log','dirname','length','Router','sep','KEYWORD','422891jUHVIB','movieTmdbApiUrl','getSeasonNumber','Need\x20tmdb\x20api\x20url','testTmdb','TMDB\x20Error','96890vivMjW','then','is_admin','55VHCoLS','TMDBID','sharp','getProxyUrl','page','sha256','66013NKZTEw','query','\x20as\x20f\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20or\x20path\x20like\x20?','indexId\x20error','power_change','pipe','indexId','searchStr','SELECT\x20*\x20FROM\x20','posterPath','returnErrMsg','API','allSettled','../../utils/nfoUtil','season.nfo','filename','all','../../db/dbUserTable','resize','getById','movieTmdbApiKey','message','../../utils/movieSeasonUtil','prepare','offset','/getImdbImg','SWITCH_MOVIE_INFO','\x20as\x20f\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20','-poster.jpg','runSearchNfoWorker','indexOf','fanart.jpg','STATE_SUC','need\x20folder','push','../../utils/httpUtil','body','../../utils/movieInfoTmdbApi','6myAdLf','status','post','splice','status_code','noCache','LEVEL_MAIN_OPERATION','downloadImg','jpeg','-fanart.jpg','Need\x20tmdb\x20key','scrapeMissing','getDetail','saveMovieInfoToDb','join','poster.jpg','63zIPpFS','run'];_0x2e0b=function(){return _0xa7e478;};return _0x2e0b();}function _0x3d29(_0x4750d4,_0x1005e4){const _0x2e0b24=_0x2e0b();return _0x3d29=function(_0x3d29a4,_0x4009db){_0x3d29a4=_0x3d29a4-0xf8;let _0x20ea5e=_0x2e0b24[_0x3d29a4];return _0x20ea5e;},_0x3d29(_0x4750d4,_0x1005e4);}router[_0x595c51(0x16a)]('/testTmdb',(_0x404f43,_0x330060,_0x2d7d29)=>{const _0x1b1c25=_0x595c51;if(_0x404f43[_0x1b1c25(0x110)][_0x1b1c25(0x13b)]!=0x1)return _0x330060['json']({'code':0x66});let _0x2bf2c5=_0x404f43[_0x1b1c25(0x166)][_0x1b1c25(0x12c)],_0x5c6efe=_0x404f43[_0x1b1c25(0x166)][_0x1b1c25(0x134)],_0x1f3890=_0x404f43[_0x1b1c25(0x166)][_0x1b1c25(0x156)];if(!_0x2bf2c5)return _0x404f43[_0x1b1c25(0x17a)][_0x1b1c25(0x14c)](_0x330060,_0x1b1c25(0x127));if(!_0x5c6efe)return _0x404f43[_0x1b1c25(0x17a)][_0x1b1c25(0x14c)](_0x330060,_0x1b1c25(0x136));if(!_0x1f3890)return _0x404f43[_0x1b1c25(0x17a)]['returnErrMsg'](_0x330060,_0x1b1c25(0x172));let _0x34a447=movieInfoUtil[_0x1b1c25(0x13f)](_0x404f43['app'][_0x1b1c25(0xfe)]),_0x28201d=new tmdbApi[(_0x1b1c25(0x14d))](_0x1f3890,_0x2bf2c5,_0x5c6efe,_0x34a447);_0x28201d[_0x1b1c25(0x118)]()[_0x1b1c25(0x13a)](_0x9caf49=>{const _0x23c842=_0x1b1c25;if(_0x9caf49['success']==![]||_0x9caf49['status_code'])return _0x330060[_0x23c842(0xf9)]({'code':0x2,'msg':_0x9caf49[_0x23c842(0x116)]});return _0x330060[_0x23c842(0xf9)]({'code':0x0,'data':[]});})[_0x1b1c25(0x124)](_0x3fc93b=>{const _0x5d6646=_0x1b1c25;let _0x3e543a=_0x5d6646(0x138);if(_0x3fc93b){if(_0x3fc93b[_0x5d6646(0x16c)])_0x3e543a+=':'+_0x3fc93b[_0x5d6646(0x116)];else _0x3fc93b[_0x5d6646(0x157)]&&(_0x3e543a+=':'+_0x3fc93b[_0x5d6646(0x157)]);}return _0x330060['json']({'code':0x2,'msg':_0x3e543a,'data':[]});});}),router['post'](_0x595c51(0x112),(_0x13dbed,_0x599e5c,_0x21adda)=>{const _0x3699ef=_0x595c51;if(_0x13dbed[_0x3699ef(0x110)]['is_admin']!=0x1)return _0x599e5c['json']({'code':0x66});movieInfoUtil[_0x3699ef(0x137)](_0x13dbed[_0x3699ef(0x17a)][_0x3699ef(0xfe)])['then'](()=>{const _0x1eed42=_0x3699ef;return _0x599e5c[_0x1eed42(0xf9)]({'code':0x0});})[_0x3699ef(0x124)](_0x247f8e=>{return _0x599e5c['json']({'code':0x2,'msg':_0x247f8e});});}),router[_0x595c51(0x16a)](_0x595c51(0x11a),(_0x21642a,_0x46d593,_0x33a292)=>{const _0x2c5245=_0x595c51;let _0x1106c3=_0x21642a['body'][_0x2c5245(0x149)],_0x56387f=_0x21642a[_0x2c5245(0x166)][_0x2c5245(0x108)],_0x143d3d=_0x21642a['body'][_0x2c5245(0x128)],_0x24b988=_0x21642a['body'][_0x2c5245(0x140)];if(!_0x1106c3||!_0x56387f||!_0x143d3d)return _0x21642a[_0x2c5245(0x17a)][_0x2c5245(0x14c)](_0x46d593,_0x2c5245(0x111));let _0x22fc6f=movieInfoUtil['getTmdbApi'](_0x21642a[_0x2c5245(0x17a)]['dbOther']);if(_0x56387f==_0x2c5245(0x132))_0x22fc6f[_0x2c5245(0x114)](_0x1106c3,_0x143d3d=='TV',null,_0x24b988,!![])[_0x2c5245(0x13a)](_0x41b51a=>{const _0x4445e6=_0x2c5245;if(!_0x46d593['headersSent'])return _0x46d593[_0x4445e6(0xf9)]({'code':0x0,'data':_0x41b51a});})[_0x2c5245(0x124)](_0x1f59ea=>{const _0x56d46a=_0x2c5245;console['log'](_0x56d46a(0x115),_0x1f59ea);if(_0x1f59ea&&_0x1f59ea[_0x56d46a(0x16c)]&&_0x1f59ea['status_message'])return _0x21642a[_0x56d46a(0x17a)][_0x56d46a(0x14c)](_0x46d593,_0x1f59ea[_0x56d46a(0x116)]);if(!_0x46d593[_0x56d46a(0xfa)])return _0x46d593[_0x56d46a(0xf9)]({'code':0x0,'data':[]});});else{if(_0x56387f==_0x2c5245(0x13d))_0x22fc6f[_0x2c5245(0x174)](_0x1106c3,_0x143d3d=='TV')[_0x2c5245(0x13a)](_0x3ab233=>{const _0x5e6ea0=_0x2c5245;if(!_0x46d593['headersSent'])return _0x46d593[_0x5e6ea0(0xf9)]({'code':0x0,'data':[_0x3ab233]});})[_0x2c5245(0x124)](_0x4a068f=>{const _0x159cb1=_0x2c5245;console[_0x159cb1(0x12d)](_0x159cb1(0x115),_0x4a068f);if(_0x4a068f&&_0x4a068f[_0x159cb1(0x16c)]&&_0x4a068f[_0x159cb1(0x116)])return _0x21642a[_0x159cb1(0x17a)]['returnErrMsg'](_0x46d593,_0x4a068f[_0x159cb1(0x116)]);if(!_0x46d593[_0x159cb1(0xfa)])return _0x46d593[_0x159cb1(0xf9)]({'code':0x0,'data':[]});});else{if(!_0x46d593[_0x2c5245(0xfa)])return _0x46d593[_0x2c5245(0xf9)]({'code':0x0,'data':[]});}}});function updateIndexByNfo(_0x5c5b6c,_0x49d812){return new Promise((_0x32a18c,_0x42f82f)=>{const _0x82babd=_0x3d29;nfoUtil['parseNfo'](_0x49d812,!![],![])['then'](_0x1938e4=>{const _0x44b7ac=_0x3d29;return movieInfoUtil[_0x44b7ac(0x175)](_0x5c5b6c,_0x49d812['id'],_0x1938e4),_0x32a18c();})[_0x82babd(0x124)](_0x20e954=>{return _0x32a18c();});});}router['post'](_0x595c51(0xfc),(_0x49ea5b,_0xb34cfa,_0x5ac506)=>{const _0x320f8f=_0x595c51;let _0x52b2ff=_0x49ea5b[_0x320f8f(0x166)][_0x320f8f(0x148)],_0x1e2a46=_0x49ea5b[_0x320f8f(0x166)][_0x320f8f(0x173)],_0x5a285c=dbFileIndexTable['getById'](_0x49ea5b[_0x320f8f(0x17a)][_0x320f8f(0x123)],_0x52b2ff,dbFileIndexTable[_0x320f8f(0x10e)]);if(!_0x5a285c)return _0x49ea5b['app'][_0x320f8f(0x14c)](_0xb34cfa,_0x320f8f(0x145));if(dbUserTable['doUserCanGet'](_0x49ea5b,_0xb34cfa,'',_0x320f8f(0x146),_0x5a285c['path'])==!![]){function _0x216cbb(){const _0x447a77=_0x320f8f;movieInfoUtil[_0x447a77(0x15f)](_0x49ea5b[_0x447a77(0x17a)][_0x447a77(0xfe)],_0x5a285c[_0x447a77(0xfd)],_0x5a285c['filename'],_0x5a285c[_0x447a77(0x113)],null,_0x1e2a46)[_0x447a77(0x13a)](()=>{const _0x15826d=_0x447a77;_0x5a285c[_0x15826d(0x113)]==0x0&&updateIndexByNfo(_0x49ea5b[_0x15826d(0x17a)][_0x15826d(0x123)],_0x5a285c)[_0x15826d(0x13a)](()=>{});})[_0x447a77(0x124)](_0x2e829e=>{});}_0x1e2a46==0x1?_0x216cbb():clearInfo(_0x49ea5b,_0xb34cfa,_0x5a285c)['then'](()=>{_0x216cbb();});if(!_0xb34cfa['headersSent'])return _0xb34cfa[_0x320f8f(0xf9)]({'code':0x0});}}),router[_0x595c51(0x16a)]('/getScrapeLog',(_0xa5fd4b,_0x42b39f,_0x1e88c8)=>{const _0x14dd54=_0x595c51;if(_0xa5fd4b[_0x14dd54(0x110)][_0x14dd54(0x13b)]!=0x1)return _0x42b39f[_0x14dd54(0xf9)]({'code':0x66});let _0x1e2776=_0xa5fd4b[_0x14dd54(0x166)][_0x14dd54(0x105)]||0x1e,_0x2c5b1c=_0xa5fd4b[_0x14dd54(0x166)][_0x14dd54(0x15a)]||0x0;const _0x2f2471='SELECT\x20*\x20FROM\x20movie_scrape_log\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x20?\x20OFFSET\x20?\x20';let _0x8f5abf=_0xa5fd4b[_0x14dd54(0x17a)][_0x14dd54(0x123)][_0x14dd54(0x159)](_0x2f2471)[_0x14dd54(0x152)](_0x1e2776,_0x2c5b1c);return _0x42b39f['json']({'code':0x0,'data':_0x8f5abf});}),router['post'](_0x595c51(0x11f),(_0x2e5001,_0x198cfe,_0x4b8b5a)=>{const _0xaee951=_0x595c51;if(_0x2e5001['currentUser']['is_admin']!=0x1)return _0x198cfe[_0xaee951(0xf9)]({'code':0x66});const _0x30d956=_0xaee951(0xfb);return _0x2e5001[_0xaee951(0x17a)][_0xaee951(0x123)][_0xaee951(0x159)](_0x30d956)[_0xaee951(0x179)](),_0x198cfe[_0xaee951(0xf9)]({'code':0x0});}),router['post'](_0x595c51(0x10b),(_0x199b1e,_0x1a6c3f,_0x1fc93d)=>{const _0x493e43=_0x595c51;if(_0x199b1e[_0x493e43(0x110)]['is_admin']!=0x1)return _0x1a6c3f[_0x493e43(0xf9)]({'code':0x66});let _0xa61690=_0x199b1e[_0x493e43(0x166)][_0x493e43(0x129)];if(!_0xa61690)return _0x199b1e['app']['returnErrMsg'](_0x1a6c3f,_0x493e43(0x163));const _0x240b07='UPDATE\x20file_index_movie\x20SET\x20movie_info_state=0,movie_info_get_time=0,movie_info_get_times=0\x20WHERE\x20path=?\x20OR\x20path\x20like\x20?';_0x199b1e[_0x493e43(0x17a)]['dbFileIndex']['prepare'](_0x240b07)[_0x493e43(0x179)](_0xa61690,_0xa61690+path[_0x493e43(0x131)]+'%');let _0x21c92e=_0x493e43(0x14a)+dbFileIndexTable[_0x493e43(0x10e)]+_0x493e43(0x144),_0x490907=_0x199b1e[_0x493e43(0x17a)]['dbFileIndex'][_0x493e43(0x159)](_0x21c92e)[_0x493e43(0x152)](_0xa61690,_0xa61690+path[_0x493e43(0x131)]+'%'),_0xa0be28=[];for(let _0x1cd66e of _0x490907){movieInfoUtil[_0x493e43(0x175)](_0x199b1e[_0x493e43(0x17a)][_0x493e43(0x123)],_0x1cd66e['id'],{}),_0xa0be28['push'](deleteMovieInfoOfIndex(_0x199b1e,_0x1cd66e));}Promise[_0x493e43(0x14e)](_0xa0be28)[_0x493e43(0x13a)](_0x25e611=>{const _0x8d3a74=_0x493e43;return process[_0x8d3a74(0x103)]({'type':_0x8d3a74(0x15c)}),_0x1a6c3f[_0x8d3a74(0xf9)]({'code':0x0});});});function deleteMovieInfoOfIndex(_0x5ca603,_0x3b099c){return new Promise((_0x5e89f3,_0x5185c7)=>{const _0x4e4bb8=_0x3d29;let _0x3c2d3c=path['join'](_0x3b099c[_0x4e4bb8(0xfd)],_0x3b099c[_0x4e4bb8(0x151)][_0x4e4bb8(0x125)](0x0,_0x3b099c['filename'][_0x4e4bb8(0x11e)](_0x3b099c[_0x4e4bb8(0x122)]))+_0x4e4bb8(0x11d)),_0xcc1dfe=path['join'](_0x3b099c['path'],_0x3b099c['filename'][_0x4e4bb8(0x125)](0x0,_0x3b099c[_0x4e4bb8(0x151)][_0x4e4bb8(0x11e)](_0x3b099c[_0x4e4bb8(0x122)]))+_0x4e4bb8(0x109)),_0x1649a3=path[_0x4e4bb8(0x176)](_0x3b099c[_0x4e4bb8(0xfd)],_0x3b099c[_0x4e4bb8(0x151)][_0x4e4bb8(0x125)](0x0,_0x3b099c['filename'][_0x4e4bb8(0x11e)](_0x3b099c[_0x4e4bb8(0x122)]))+_0x4e4bb8(0x171)),_0x44194c=path[_0x4e4bb8(0x176)](_0x3b099c[_0x4e4bb8(0xfd)],_0x3b099c[_0x4e4bb8(0x151)][_0x4e4bb8(0x125)](0x0,_0x3b099c['filename'][_0x4e4bb8(0x11e)](_0x3b099c[_0x4e4bb8(0x122)]))+'-poster.jpg'),_0x1d635f=path[_0x4e4bb8(0x176)](_0x3b099c[_0x4e4bb8(0xfd)],_0x4e4bb8(0x177)),_0x83f62=path[_0x4e4bb8(0x176)](_0x3b099c[_0x4e4bb8(0xfd)],_0x3b099c[_0x4e4bb8(0x151)][_0x4e4bb8(0x125)](0x0,_0x3b099c[_0x4e4bb8(0x151)][_0x4e4bb8(0x11e)](_0x3b099c[_0x4e4bb8(0x122)]))+'.nfo'),_0x142c2a=[_0x3c2d3c,_0x1d635f,_0xcc1dfe,_0x1649a3,_0x44194c,_0x83f62];if(_0x3b099c['is_tvplay']==0x1){let _0x3d9280=path[_0x4e4bb8(0x176)](_0x3b099c[_0x4e4bb8(0xfd)],_0x4e4bb8(0x120)),_0x3c19ad=path['join'](_0x3b099c[_0x4e4bb8(0xfd)],_0x4e4bb8(0x150));_0x142c2a['push'](_0x3d9280),_0x142c2a['push'](_0x3c19ad);let _0x10bd19=path[_0x4e4bb8(0xff)](_0x3b099c[_0x4e4bb8(0xfd)]),_0x246da8=path[_0x4e4bb8(0x12e)](_0x3b099c[_0x4e4bb8(0xfd)]),_0x4807f5=movieSeasonUtil[_0x4e4bb8(0x135)](_0x10bd19);if(_0x4807f5>0x0){let _0x512f00=path['join'](_0x246da8,_0x4e4bb8(0x120));_0x142c2a[_0x4e4bb8(0x164)](_0x512f00);_0x4807f5<0xa&&(_0x4807f5='0'+_0x4807f5);let _0x1dbaad=path[_0x4e4bb8(0x176)](_0x246da8,'season'+_0x4807f5+_0x4e4bb8(0x15e));_0x142c2a['push'](_0x1dbaad);let _0x50603f=path[_0x4e4bb8(0x176)](_0x246da8,_0x4e4bb8(0x177));_0x142c2a[_0x4e4bb8(0x164)](_0x50603f);let _0x47dade=path['join'](_0x246da8,_0x4e4bb8(0x161));_0x142c2a[_0x4e4bb8(0x164)](_0x47dade);}}console[_0x4e4bb8(0x12d)]('要清除的nfo和海报文件列表',_0x142c2a);function _0x2894ef(){const _0x29bf10=_0x4e4bb8;_0x142c2a['length']>0x0?fs[_0x29bf10(0x107)](_0x142c2a[0x0],(_0x4f3915,_0x334cfe)=>{const _0xad95b0=_0x29bf10;!_0x4f3915&&_0x334cfe&&_0x334cfe['isFile']()?(console[_0xad95b0(0x12d)]('清理',_0x142c2a[0x0]),fs['rm'](_0x142c2a[0x0],_0x41078a=>{const _0x587701=_0xad95b0;let _0x37275e=_0x142c2a[0x0];_0x142c2a[_0x587701(0x16b)](0x0,0x1),!_0x41078a&&(console['log']('刮削文件清理成功',_0x37275e),dbFileOperationRecord['addFileOperationRecord'](_0x5ca603['app']['dbOther'],{'username':_0x5ca603['currentUser'][_0x587701(0x119)],'targetPath':_0x37275e,'level':dbFileOperationRecord[_0x587701(0x16e)],'type':dbFileOperationRecord[_0x587701(0x17b)],'state':dbFileOperationRecord[_0x587701(0x162)]})),_0x2894ef();})):(_0x142c2a[_0xad95b0(0x16b)](0x0,0x1),_0x2894ef());}):(movieInfoUtil['saveMovieInfoToDb'](_0x5ca603[_0x29bf10(0x17a)][_0x29bf10(0x123)],_0x3b099c['id'],{}),_0x5e89f3());}_0x2894ef();});}function clearInfo(_0x5213f2,_0x5b30ed,_0x11f5eb){return new Promise((_0x3057d9,_0x19b2be)=>{const _0x3321b9=_0x3d29;if(dbUserTable[_0x3321b9(0x10f)](_0x5213f2,_0x5b30ed,'','power_delete',_0x11f5eb[_0x3321b9(0xfd)])==!![]){if(_0x11f5eb[_0x3321b9(0x113)]==0x1){let _0x4e68b9=_0x3321b9(0x14a)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x3321b9(0x15d),_0x420673=_0x5213f2[_0x3321b9(0x17a)]['dbFileIndex'][_0x3321b9(0x159)](_0x4e68b9)[_0x3321b9(0x152)](_0x11f5eb['path']),_0x5c9532=[];for(let _0x39395c of _0x420673){_0x5c9532[_0x3321b9(0x164)](deleteMovieInfoOfIndex(_0x5213f2,_0x39395c));}if(_0x5c9532[_0x3321b9(0x12f)]<0x1)return _0x3057d9();Promise[_0x3321b9(0x14e)](_0x5c9532)['then'](_0x3cfc23=>{return _0x3057d9();})[_0x3321b9(0x124)](_0x40effb=>{return _0x3057d9();});}else deleteMovieInfoOfIndex(_0x5213f2,_0x11f5eb)[_0x3321b9(0x13a)](_0x44e182=>{return _0x3057d9();});}});}router[_0x595c51(0x16a)](_0x595c51(0x106),(_0x2b6d48,_0x33fc47,_0x5b4d55)=>{const _0x4c22f2=_0x595c51;let _0x927e71=_0x2b6d48['body'][_0x4c22f2(0x148)],_0x561695=dbFileIndexTable[_0x4c22f2(0x155)](_0x2b6d48[_0x4c22f2(0x17a)][_0x4c22f2(0x123)],_0x927e71,dbFileIndexTable[_0x4c22f2(0x10e)]);if(!_0x561695)return _0x2b6d48[_0x4c22f2(0x17a)][_0x4c22f2(0x14c)](_0x33fc47,_0x4c22f2(0x145));clearInfo(_0x2b6d48,_0x33fc47,_0x561695)[_0x4c22f2(0x13a)](()=>{const _0x2af1e6=_0x4c22f2;return _0x33fc47[_0x2af1e6(0xf9)]({'code':0x0});});}),router[_0x595c51(0x16a)](_0x595c51(0x10a),(_0x2e6658,_0x4484f4,_0x28eac3)=>{const _0x5b6d0a=_0x595c51;let _0x701aee=_0x2e6658[_0x5b6d0a(0x166)][_0x5b6d0a(0x148)],_0x138605=dbFileIndexTable[_0x5b6d0a(0x155)](_0x2e6658['app'][_0x5b6d0a(0x123)],_0x701aee,dbFileIndexTable[_0x5b6d0a(0x10e)]),_0x1072dc=_0x2e6658[_0x5b6d0a(0x166)]['tmdbId'];if(!_0x138605||!_0x1072dc)return _0x2e6658['app']['returnErrMsg'](_0x4484f4,_0x5b6d0a(0x100));dbUserTable[_0x5b6d0a(0x10f)](_0x2e6658,_0x4484f4,'','power_change',_0x138605[_0x5b6d0a(0xfd)])==!![]&&clearInfo(_0x2e6658,_0x4484f4,_0x138605)[_0x5b6d0a(0x13a)](()=>{const _0x16f41a=_0x5b6d0a;return movieInfoUtil[_0x16f41a(0x15f)](_0x2e6658[_0x16f41a(0x17a)][_0x16f41a(0xfe)],_0x138605[_0x16f41a(0xfd)],_0x138605[_0x16f41a(0x151)],_0x138605[_0x16f41a(0x113)],_0x1072dc)[_0x16f41a(0x13a)](()=>{const _0x111263=_0x16f41a;if(_0x138605[_0x111263(0x113)]==0x0)updateIndexByNfo(_0x2e6658[_0x111263(0x17a)][_0x111263(0x123)],_0x138605)[_0x111263(0x13a)](()=>{});else{}})[_0x16f41a(0x124)](_0x57fdd0=>{const _0x497c96=_0x16f41a;return console[_0x497c96(0x12d)](_0x57fdd0),_0x2e6658[_0x497c96(0x17a)]['returnErrMsg'](_0x4484f4,_0x4484f4['__'](_0x497c96(0x12a)));}),_0x4484f4[_0x16f41a(0xf9)]({'code':0x0});});}),router[_0x595c51(0xf8)](_0x595c51(0x15b),(_0x3a0d3b,_0x193785,_0x2a9ea3)=>{const _0x17d2a1=_0x595c51;let _0x1fe469=_0x3a0d3b[_0x17d2a1(0x143)][_0x17d2a1(0x10c)];if(!_0x1fe469||!_0x1fe469[_0x17d2a1(0x160)](_0x17d2a1(0x101))==-0x1)return _0x193785[_0x17d2a1(0x169)](0x194)['end']();_0x1fe469=decodeURIComponent(_0x1fe469);let _0x14841d=path[_0x17d2a1(0x176)](config[_0x17d2a1(0x14b)],sha256(_0x1fe469));function _0x26b0ce(){const _0x4ac930=_0x17d2a1;sharp(_0x14841d,{'failOnError':![]})[_0x4ac930(0x170)]({'quality':0x4d})[_0x4ac930(0x154)]({'width':0x1f4})[_0x4ac930(0x11b)]()[_0x4ac930(0x13a)](_0x49d685=>{const _0x16c211=_0x4ac930;return _0x193785[_0x16c211(0x103)](_0x49d685);})['catch'](_0x599fda=>{const _0x23bf87=_0x4ac930;return console['log'](_0x23bf87(0x12b),_0x599fda),_0x193785[_0x23bf87(0x169)](0x194)['end']();});}fs['stat'](_0x14841d,(_0xf5794a,_0x42d452)=>{const _0x33c88f=_0x17d2a1;if(!_0xf5794a)return _0x26b0ce();_0x3a0d3b['query'][_0x33c88f(0x16d)]==0x1?httpUtil[_0x33c88f(0x16f)](_0x3a0d3b[_0x33c88f(0x17a)]['dbOther'],_0x1fe469)['then'](_0x25874c=>{const _0x47ba52=_0x33c88f;return _0x25874c[_0x47ba52(0x147)](_0x193785);})[_0x33c88f(0x124)](_0x19d877=>{const _0x50ce93=_0x33c88f;return _0x193785[_0x50ce93(0x169)](0x194)[_0x50ce93(0x126)]();}):httpUtil[_0x33c88f(0x16f)](_0x3a0d3b[_0x33c88f(0x17a)][_0x33c88f(0xfe)],_0x1fe469,_0x14841d)[_0x33c88f(0x13a)](_0x3001b6=>{_0x26b0ce();})['catch'](_0x59e424=>{const _0x96446f=_0x33c88f;return _0x193785[_0x96446f(0x169)](0x194)[_0x96446f(0x126)]();});});}),module['exports']=router;