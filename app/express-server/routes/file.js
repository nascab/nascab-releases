const _0x16f5ac=_0xfc37;(function(_0x17c7b1,_0x228729){const _0x5341d3=_0xfc37,_0x7b8f9e=_0x17c7b1();while(!![]){try{const _0x29c3aa=parseInt(_0x5341d3(0x1ae))/0x1+parseInt(_0x5341d3(0x238))/0x2*(-parseInt(_0x5341d3(0x1b4))/0x3)+parseInt(_0x5341d3(0x220))/0x4*(parseInt(_0x5341d3(0x227))/0x5)+parseInt(_0x5341d3(0x1a6))/0x6*(parseInt(_0x5341d3(0x1fa))/0x7)+parseInt(_0x5341d3(0x1e3))/0x8+parseInt(_0x5341d3(0x1ee))/0x9+parseInt(_0x5341d3(0x1c2))/0xa*(-parseInt(_0x5341d3(0x1fb))/0xb);if(_0x29c3aa===_0x228729)break;else _0x7b8f9e['push'](_0x7b8f9e['shift']());}catch(_0xdc6d26){_0x7b8f9e['push'](_0x7b8f9e['shift']());}}}(_0x35ea,0xc88a8));let express=require('express'),router=express['Router'](),path=require(_0x16f5ac(0x26a)),fs=require('fs'),sha256=require(_0x16f5ac(0x217)),fileUtil=require(_0x16f5ac(0x27f));const sharp=require(_0x16f5ac(0x271)),os=require('os');let platform=os['platform']();const dbUserTable=require(_0x16f5ac(0x228)),dbNoticeCenterTable=require(_0x16f5ac(0x1d2)),dbConfigTable=require(_0x16f5ac(0x1c0)),dbSourceFolderTable=require(_0x16f5ac(0x1b7)),dbFileOperationRecord=require(_0x16f5ac(0x1e4)),fileStatUtil=require(_0x16f5ac(0x278)),config=require(_0x16f5ac(0x24d)),sharpUtil=require('../utils/sharpUtils'),globalInfoUtil=require(_0x16f5ac(0x200)),archiver=require(_0x16f5ac(0x261)),encodingUtil=require(_0x16f5ac(0x21f));function _0xfc37(_0x23afb5,_0x3f7907){const _0x35ea0=_0x35ea();return _0xfc37=function(_0xfc378d,_0x20045f){_0xfc378d=_0xfc378d-0x1a4;let _0x5a68bb=_0x35ea0[_0xfc378d];return _0x5a68bb;},_0xfc37(_0x23afb5,_0x3f7907);}let macPowerDetected=![],win32ExcludeList=[_0x16f5ac(0x1d7),_0x16f5ac(0x1d8),_0x16f5ac(0x25c),_0x16f5ac(0x244),_0x16f5ac(0x236),_0x16f5ac(0x1c8)];router[_0x16f5ac(0x26f)](_0x16f5ac(0x24e),(_0x3d9e6a,_0x597d63,_0x220353)=>{const _0xd608f5=_0x16f5ac;if(!_0x3d9e6a[_0xd608f5(0x25f)][_0xd608f5(0x26a)])return _0x597d63[_0xd608f5(0x1bf)](0x194)[_0xd608f5(0x1ca)]();let _0x7b52a7=fileUtil['decodePath'](_0x3d9e6a[_0xd608f5(0x25f)][_0xd608f5(0x26a)]),_0x5d6557=_0x3d9e6a[_0xd608f5(0x25f)][_0xd608f5(0x281)];_0x5d6557&&(_0x7b52a7=path['join'](_0x7b52a7,_0x5d6557)),dbUserTable[_0xd608f5(0x1e2)](_0x3d9e6a,_0x597d63,'','power_get',_0x7b52a7)==!![]&&fs[_0xd608f5(0x283)](_0x7b52a7,(_0x497d65,_0x5d1d9b)=>{const _0x44163b=_0xd608f5;if(_0x497d65)return _0x597d63[_0x44163b(0x1bf)](0x194)[_0x44163b(0x1ca)]();let _0x5f13c0=path[_0x44163b(0x26e)](_0x7b52a7)+'.zip';try{const _0x4b7f7=encodeURIComponent(_0x5f13c0)[_0x44163b(0x1b0)](/%([0-9A-F]{2})/g,(_0x424c27,_0x2a188f)=>'%'+_0x2a188f['toUpperCase']());_0x597d63[_0x44163b(0x1e6)]('Content-Disposition',_0x44163b(0x24b)+_0x4b7f7);}catch(_0x126df5){console[_0x44163b(0x240)](_0x126df5);}const _0x11b520=archiver(_0x44163b(0x20b),{'zlib':{'level':0x0}});_0x11b520['on'](_0x44163b(0x22b),function(_0x23e6aa){const _0x5cbbcd=_0x44163b;console[_0x5cbbcd(0x240)](_0x5cbbcd(0x22d),_0x23e6aa[_0x5cbbcd(0x26b)]||_0x23e6aa[_0x5cbbcd(0x1e8)]),_0x11b520['unpipe'](),!_0x597d63[_0x5cbbcd(0x205)]?(_0x597d63[_0x5cbbcd(0x269)](_0x5cbbcd(0x26c)),_0x597d63[_0x5cbbcd(0x1bf)](0x1f4)[_0x5cbbcd(0x1d4)](_0x5cbbcd(0x1d0))):_0x597d63[_0x5cbbcd(0x273)]();}),_0x11b520['on'](_0x44163b(0x1ca),function(){const _0x1e92b7=_0x44163b;console['log'](_0x1e92b7(0x282)),_0x11b520[_0x1e92b7(0x273)]();});try{fs[_0x44163b(0x1b8)](_0x7b52a7,(_0x5c9c82,_0x5c0700)=>{const _0x27f54f=_0x44163b;for(let _0x114db7 in _0x5c0700){let _0xdd3a29=_0x5c0700[_0x114db7];const _0x3dc926=path['join'](_0x7b52a7,_0xdd3a29);let _0x30ea49=fs[_0x27f54f(0x23a)](_0x3dc926);_0x30ea49[_0x27f54f(0x21e)]()?_0x11b520[_0x27f54f(0x256)](_0x3dc926,_0xdd3a29):_0x11b520['append'](fs[_0x27f54f(0x1bc)](_0x3dc926),{'name':_0xdd3a29});}_0x11b520[_0x27f54f(0x1f5)](),_0x11b520['pipe'](_0x597d63);});}catch(_0x2a5d44){!_0x597d63[_0x44163b(0x205)]&&_0x597d63[_0x44163b(0x1bf)](0x1f4)[_0x44163b(0x1d4)]({'error':_0x44163b(0x288)}),console[_0x44163b(0x22b)](_0x2a5d44);}_0x597d63['on'](_0x44163b(0x1c4),()=>{const _0x5a5678=_0x44163b;console['log'](_0x5a5678(0x1a8)),_0x11b520[_0x5a5678(0x273)]();});});}),router[_0x16f5ac(0x242)](_0x16f5ac(0x1db),(_0x5dac9b,_0x465397,_0x4f5328)=>{const _0x3fe248=_0x16f5ac;let _0x4bc3a6=_0x5dac9b['body'][_0x3fe248(0x24c)],_0x4527b5=path[_0x3fe248(0x1f8)],_0x2e38b8=_0x5dac9b[_0x3fe248(0x1d3)][_0x3fe248(0x1e1)],_0xafdf37=_0x5dac9b[_0x3fe248(0x1d3)]['searchStr'],_0x397538=[],_0x47304b=parseInt(_0x5dac9b['currentUser'][_0x3fe248(0x231)])==0x1;platform==_0x3fe248(0x268)&&_0x4bc3a6&&_0x4bc3a6['length']>0x4&&_0x4bc3a6[_0x3fe248(0x1c9)](path[_0x3fe248(0x1f8)])&&(_0x4bc3a6=_0x4bc3a6['slice'](0x0,-0x1));let _0x5d8f69=fileUtil['getExcludePathList'](_0x5dac9b[_0x3fe248(0x1f4)][_0x3fe248(0x207)]);try{function _0x14f54c(){const _0x37a047=_0x3fe248;let _0x2f1570=dbUserTable[_0x37a047(0x25e)](_0x5dac9b[_0x37a047(0x1f4)][_0x37a047(0x207)],_0x5dac9b[_0x37a047(0x259)][_0x37a047(0x20f)],_0x37a047(0x1c7),_0x37a047(0x28f));for(let _0x65ed77 of _0x2f1570){if(_0x5d8f69[_0x37a047(0x219)](_0x65ed77['path']))continue;_0x397538[_0x37a047(0x239)]({'type':0x2,'name':_0x65ed77[_0x37a047(0x26a)],'fileFullPath':_0x65ed77['path']});}return _0x465397[_0x37a047(0x253)]({'code':0x0,'data':{'parent':'','children':_0x397538,'sep':_0x4527b5,'platform':platform}});}if(!_0x4bc3a6){if(_0x47304b){if(platform==_0x3fe248(0x268)){function _0x45530d(_0x76e176){const _0x828ec6=_0x3fe248;let _0xa36969=[];for(let _0xd04d4c of _0x76e176){if(_0x5d8f69['includes'](_0xd04d4c['name']))continue;_0xd04d4c[_0x828ec6(0x1e1)]=0x2,_0xa36969[_0x828ec6(0x239)](_0xd04d4c);}for(let _0x5c8db5 in _0xa36969){_0xa36969[_0x5c8db5][_0x828ec6(0x28a)]=_0xa36969[_0x5c8db5][_0x828ec6(0x280)];}return _0x465397[_0x828ec6(0x253)]({'code':0x0,'data':{'parent':_0x4bc3a6,'children':_0xa36969,'sep':path[_0x828ec6(0x1f8)],'platform':platform}});}let _0x259b45=dbConfigTable[_0x3fe248(0x252)](_0x5dac9b[_0x3fe248(0x1f4)][_0x3fe248(0x207)],_0x3fe248(0x246));if(_0x259b45)try{_0x259b45=JSON[_0x3fe248(0x1eb)](_0x259b45[_0x3fe248(0x1ac)]),_0x547614(![]),_0x45530d(_0x259b45);}catch(_0x46e708){_0x547614(!![]);}else _0x547614(!![]);function _0x547614(_0x16e081){globalInfoUtil['getWindowsDiskList'](_0x290699=>{const _0x30ba81=_0xfc37;_0x290699=_0x290699[_0x30ba81(0x1ef)]((_0x183ad2,_0x5bed70)=>{const _0x1d1f3a=_0x30ba81;if(!_0x183ad2[_0x1d1f3a(0x280)]||!_0x5bed70[_0x1d1f3a(0x280)])return;return _0x183ad2[_0x1d1f3a(0x280)]['localeCompare'](_0x5bed70[_0x1d1f3a(0x280)]);}),dbConfigTable[_0x30ba81(0x204)](_0x5dac9b[_0x30ba81(0x1f4)][_0x30ba81(0x207)],{'title':_0x30ba81(0x246),'value':JSON[_0x30ba81(0x23b)](_0x290699)}),_0x16e081&&_0x45530d(_0x290699);});}}else{if(platform==_0x3fe248(0x1ab)){if(!macPowerDetected){macPowerDetected=!![];try{const _0x11585d=process[_0x3fe248(0x221)][_0x3fe248(0x1ba)];let _0x4b4b9f=[path[_0x3fe248(0x1a5)](_0x3fe248(0x229),_0x11585d,_0x3fe248(0x1d1)),path[_0x3fe248(0x1a5)]('/Users',_0x11585d,_0x3fe248(0x264)),path[_0x3fe248(0x1a5)](_0x3fe248(0x229),_0x11585d,_0x3fe248(0x25d))];for(let _0x16c229 in _0x4b4b9f){fs[_0x3fe248(0x283)](_0x4b4b9f[_0x16c229],(_0x2b1037,_0x2b01b9)=>{});}}catch(_0x535e41){}}let _0x3fae80=path[_0x3fe248(0x1eb)](process[_0x3fe248(0x1df)]())[_0x3fe248(0x245)];_0x36a3a0(_0x3fae80);}else _0x4bc3a6=path[_0x3fe248(0x1eb)](process[_0x3fe248(0x1df)]())[_0x3fe248(0x245)],_0x36a3a0(_0x4bc3a6);}}else return _0x14f54c();}else _0x36a3a0(_0x4bc3a6);function _0x36a3a0(_0x1825fe){const _0x30a694=_0x3fe248;if(!_0x47304b){if(!dbUserTable[_0x30a694(0x1e2)](_0x5dac9b,_0x465397,'folder','power_get',_0x1825fe,!![]))return console[_0x30a694(0x240)]('未授权',_0x1825fe),_0x14f54c();}if(_0x1825fe==_0x30a694(0x1cf)||_0x1825fe=='sourceFolderMovie'||_0x1825fe==_0x30a694(0x250)||_0x1825fe==_0x30a694(0x27e)){let _0x16aec0='photo';if(_0x1825fe==_0x30a694(0x1a7))_0x16aec0=_0x30a694(0x218);else{if(_0x1825fe==_0x30a694(0x250))_0x16aec0=_0x30a694(0x1aa);else _0x1825fe=='sourceFolderBook'&&(_0x16aec0='book');}let _0x1f860f=dbSourceFolderTable[_0x30a694(0x210)](_0x5dac9b[_0x30a694(0x1f4)]['dbOther'],_0x16aec0);for(let _0x28d91b in _0x1f860f){_0x397538[_0x30a694(0x239)]({'type':0x2,'name':path[_0x30a694(0x26e)](_0x1f860f[_0x28d91b][_0x30a694(0x26a)]),'fileFullPath':_0x1f860f[_0x28d91b][_0x30a694(0x26a)]});}return _0x465397[_0x30a694(0x253)]({'code':0x0,'data':{'parent':_0x1825fe,'children':_0x397538,'sep':_0x4527b5,'platform':platform}});}fs[_0x30a694(0x1b8)](_0x1825fe,{'withFileTypes':!![]},(_0x4b7070,_0x21b4e1)=>{const _0xb0ab74=_0x30a694;if(_0x4b7070)return console[_0xb0ab74(0x240)](_0x4b7070),fileUtil[_0xb0ab74(0x1e7)](_0x465397,_0x4b7070);for(let _0x1732e7=0x0;_0x1732e7<_0x21b4e1[_0xb0ab74(0x1d5)];_0x1732e7++){let _0x468724=_0x21b4e1[_0x1732e7],_0x98b4f2=_0x21b4e1[_0x1732e7][_0xb0ab74(0x280)];if(_0x98b4f2[_0xb0ab74(0x1d5)]>0x0){if(_0x98b4f2[0x0]=='.')continue;if(/[A-Z]:\\/i[_0xb0ab74(0x262)](_0x1825fe)&&_0x1825fe[_0xb0ab74(0x1d5)]<=0x3){if(win32ExcludeList['includes'](_0x98b4f2)||_0x98b4f2[_0xb0ab74(0x1c9)](_0xb0ab74(0x230))||_0x98b4f2['endsWith'](_0xb0ab74(0x208)))continue;}}let _0x370621=path[_0xb0ab74(0x1a5)](_0x1825fe,_0x98b4f2);if(_0x5d8f69['includes'](_0x370621))continue;let _0x337d82=_0x468724['isFile'](),_0x40d003=_0x468724['isDirectory']();function _0x396f5a(){const _0x41aea6=_0xb0ab74;if(_0x337d82)(_0x2e38b8==0x0||_0x2e38b8==0x1)&&_0x397538['push']({'type':0x1,'name':_0x98b4f2,'fileFullPath':_0x370621});else _0x40d003&&_0x397538[_0x41aea6(0x239)]({'type':0x2,'name':_0x98b4f2,'fileFullPath':_0x370621});}_0xafdf37?_0x98b4f2[_0xb0ab74(0x219)](_0xafdf37)&&_0x396f5a():_0x396f5a();try{if(_0x397538[_0xb0ab74(0x1d5)]>0x1770)break;}catch(_0x4ea9de){continue;}}let _0xcf810=_0x397538[_0xb0ab74(0x1d5)],_0x594a30=0x0;if(_0x397538[_0xb0ab74(0x1d5)]<0x1)return _0x465397[_0xb0ab74(0x253)]({'code':0x0,'data':{'parent':_0x1825fe,'children':_0x397538,'sep':_0x4527b5,'platform':platform}});for(let _0x2c303b of _0x397538){fs[_0xb0ab74(0x283)](_0x2c303b[_0xb0ab74(0x28a)],(_0x191a50,_0x23b853)=>{const _0x54d26c=_0xb0ab74;_0x594a30+=0x1;!_0x191a50&&(_0x2c303b[_0x54d26c(0x1d9)]=_0x23b853[_0x54d26c(0x1d9)],_0x2c303b[_0x54d26c(0x215)]=_0x23b853[_0x54d26c(0x215)],_0x2c303b[_0x54d26c(0x25a)]=_0x23b853['birthtimeMs'],_0x2c303b['size']=_0x23b853[_0x54d26c(0x1c6)]);if(_0x594a30>=_0xcf810)return _0x465397[_0x54d26c(0x253)]({'code':0x0,'data':{'parent':_0x1825fe,'children':_0x397538,'sep':_0x4527b5,'platform':platform}});});}});}}catch(_0x1c0085){return console[_0x3fe248(0x240)](_0x1c0085),fileUtil['returnFileError'](_0x465397,_0x1c0085);}}),router[_0x16f5ac(0x26f)](_0x16f5ac(0x23e),(_0x5bee81,_0xd2eec4,_0x4b7b82)=>{const _0xf0fed0=_0x16f5ac;let _0x3cab13=fileUtil[_0xf0fed0(0x21b)](_0x5bee81[_0xf0fed0(0x25f)][_0xf0fed0(0x26a)]);if(!_0x3cab13)return _0xd2eec4[_0xf0fed0(0x1bf)](0x194)['end']();_0x3cab13=path['resolve'](path[_0xf0fed0(0x209)](_0x3cab13));let _0x2f8002=path[_0xf0fed0(0x1a5)](config[_0xf0fed0(0x1b6)],_0xf0fed0(0x224),path[_0xf0fed0(0x1f8)]);return _0x3cab13[_0xf0fed0(0x211)](_0x2f8002)?_0xd2eec4[_0xf0fed0(0x276)](_0x3cab13):(console['log'](_0xf0fed0(0x28c)),_0xd2eec4['status'](0x194)['end']());}),router[_0x16f5ac(0x26f)](_0x16f5ac(0x22a),(_0x4fd100,_0xb59867,_0x35ebd4)=>{const _0x1b3426=_0x16f5ac;let _0x328738=_0x4fd100['query'][_0x1b3426(0x26a)],_0x2f6ef6=_0x4fd100[_0x1b3426(0x25f)][_0x1b3426(0x1d6)]==0x1,_0x247412=fileUtil[_0x1b3426(0x21b)](_0x328738),_0x120d32=_0x4fd100[_0x1b3426(0x25f)]['size'],_0x230e64=_0x4fd100[_0x1b3426(0x25f)][_0x1b3426(0x265)];if(dbUserTable[_0x1b3426(0x1e2)](_0x4fd100,_0xb59867,'',_0x1b3426(0x28f),_0x247412)==!![])try{let _0x4e99cc=_0x4fd100[_0x1b3426(0x25f)][_0x1b3426(0x274)];if(_0x4e99cc&&_0x4e99cc==0x1){if(_0x2f6ef6){const _0x2dfb10=encodeURIComponent(path[_0x1b3426(0x26e)](_0x247412))[_0x1b3426(0x1b0)](/%([0-9A-F]{2})/g,(_0x5d60b2,_0x2c9b4b)=>'%'+_0x2c9b4b[_0x1b3426(0x27b)]());_0xb59867[_0x1b3426(0x1e6)](_0x1b3426(0x26c),_0x1b3426(0x24b)+_0x2dfb10);}return _0xb59867[_0x1b3426(0x276)](_0x247412);}else _0x4fd100[_0x1b3426(0x25f)][_0x1b3426(0x22f)]&&_0x4fd100[_0x1b3426(0x25f)][_0x1b3426(0x22f)]==_0x1b3426(0x247)&&path[_0x1b3426(0x24a)](_0x247412)&&path[_0x1b3426(0x24a)](_0x247412)[_0x1b3426(0x213)]()==_0x1b3426(0x1f1)?(console[_0x1b3426(0x240)](_0x1b3426(0x1ec),_0x247412),encodingUtil[_0x1b3426(0x1b3)](_0x247412)[_0x1b3426(0x1b5)](_0x493e9d=>{const _0x5e1d4d=_0x1b3426;return _0x493e9d?_0x493e9d['pipe'](_0xb59867):(console[_0x5e1d4d(0x240)]('Unable\x20to\x20read\x20file',_0x247412),_0xb59867[_0x5e1d4d(0x276)](_0x247412));})):sharpUtil[_0x1b3426(0x1ea)](_0xb59867,_0x247412,_0x2f6ef6,_0x120d32,_0x230e64);}catch(_0x3ef4f5){return console[_0x1b3426(0x240)](_0x3ef4f5),fileUtil[_0x1b3426(0x1e7)](_0xb59867,_0x3ef4f5);}}),router[_0x16f5ac(0x242)](_0x16f5ac(0x1b1),(_0x36e6ce,_0x199e3b,_0x2bf170)=>{const _0x4cf540=_0x16f5ac;let _0xd71acb=fileUtil['decodePath'](_0x36e6ce['body'][_0x4cf540(0x222)]),_0x2f77ad=_0x36e6ce[_0x4cf540(0x1d3)][_0x4cf540(0x284)];if(_0x2f77ad==_0x4cf540(0x1fc))_0x2f77ad=fs['constants'][_0x4cf540(0x1f0)];else _0x2f77ad=='read'&&(_0x2f77ad=fs[_0x4cf540(0x25b)][_0x4cf540(0x1af)]);try{_0x2f77ad=='all'?fs['access'](_0xd71acb,fs['constants'][_0x4cf540(0x1f0)],_0x2e2ac8=>{const _0x34f04c=_0x4cf540;if(_0x2e2ac8)return fileUtil[_0x34f04c(0x1e7)](_0x199e3b,_0x2e2ac8);return _0x199e3b[_0x34f04c(0x253)]({'code':0x0,'access':!![]});}):fs[_0x4cf540(0x20e)](_0xd71acb,_0x2f77ad,_0x33cda3=>{const _0xd8b324=_0x4cf540;if(_0x33cda3)return fileUtil[_0xd8b324(0x1e7)](_0x199e3b,_0x33cda3);return _0x199e3b['json']({'code':0x0,'access':!![]});});}catch(_0x185987){return _0x199e3b['json']({'code':0x0,'access':![]});}}),router['post'](_0x16f5ac(0x289),(_0x6a5e70,_0x787e94,_0x67671c)=>{const _0x22c0f0=_0x16f5ac;let _0x1dd88d=fileUtil[_0x22c0f0(0x21b)](_0x6a5e70[_0x22c0f0(0x1d3)][_0x22c0f0(0x285)]),_0x46790d=_0x6a5e70[_0x22c0f0(0x1d3)][_0x22c0f0(0x226)],_0x5df153=path['join'](_0x1dd88d,_0x46790d);if(dbUserTable['doUserCanGet'](_0x6a5e70,_0x787e94,'folder',_0x22c0f0(0x1dc),_0x5df153)==!![])try{fs['stat'](_0x5df153,_0x543dd9=>{const _0x5c34bb=_0x22c0f0;if(!_0x543dd9)return _0x6a5e70[_0x5c34bb(0x1f4)][_0x5c34bb(0x1ce)](_0x787e94,_0x787e94['__']('sameNameFileAlreadExist')+':'+_0x5df153);else fs['mkdir'](_0x5df153,{'recursive':!![]},_0x58b8f0=>{const _0x404f94=_0x5c34bb;return _0x58b8f0?fileUtil['returnFileError'](_0x787e94,_0x58b8f0):_0x787e94[_0x404f94(0x253)]({'code':0x0});});});}catch(_0x4dbb37){return fileUtil[_0x22c0f0(0x1e7)](_0x787e94,_0x4dbb37);}}),router[_0x16f5ac(0x242)]('/zipFile',(_0x540653,_0x4869ac,_0x249924)=>{const _0x4d4246=_0x16f5ac;let _0x16fb44=_0x540653[_0x4d4246(0x1d3)]['sourcePath'],_0x57ddb4=_0x540653[_0x4d4246(0x1d3)][_0x4d4246(0x1f7)],_0x47ed4a=_0x540653[_0x4d4246(0x1d3)][_0x4d4246(0x1e1)];if(_0x47ed4a!='zip'&&_0x47ed4a!='unzip')return _0x540653[_0x4d4246(0x1f4)]['returnErrMsg'](_0x4869ac,_0x4869ac['__']('operationFail'));if(dbUserTable[_0x4d4246(0x1e2)](_0x540653,_0x4869ac,_0x4d4246(0x1c7),'power_get',_0x16fb44)==!![]&&dbUserTable[_0x4d4246(0x1e2)](_0x540653,_0x4869ac,_0x4d4246(0x1c7),_0x4d4246(0x1dc),_0x57ddb4)==!![]){let _0x771a78=_0x540653[_0x4d4246(0x1f4)]['dbOther']['prepare'](_0x4d4246(0x206))[_0x4d4246(0x212)](_0x4d4246(0x1e0),JSON[_0x4d4246(0x23b)]({'sourcePath':_0x16fb44,'targetPath':_0x57ddb4,'type':_0x47ed4a,'username':_0x540653[_0x4d4246(0x259)][_0x4d4246(0x20f)]}));return process['send']({'type':_0x4d4246(0x1c1),'taskIdList':[_0x771a78[_0x4d4246(0x234)]]}),_0x4869ac[_0x4d4246(0x253)]({'code':0x0});}}),router[_0x16f5ac(0x242)](_0x16f5ac(0x1ff),(_0xde9ca3,_0xe9a77,_0x21dbd3)=>{const _0x2c15f7=_0x16f5ac;let _0x1a928f=_0xde9ca3[_0x2c15f7(0x1d3)][_0x2c15f7(0x254)],_0x340bdb=_0xde9ca3[_0x2c15f7(0x1d3)][_0x2c15f7(0x1f7)],_0xe9bd7e=_0xde9ca3[_0x2c15f7(0x1d3)][_0x2c15f7(0x1e1)];if(_0x1a928f['length']<0x1)return _0xde9ca3['app']['returnErrMsg'](_0xe9a77,_0xe9a77['__'](_0x2c15f7(0x203)));if(dbUserTable[_0x2c15f7(0x1e2)](_0xde9ca3,_0xe9a77,'folder',_0x2c15f7(0x28f),_0x1a928f[0x0])==!![]&&dbUserTable[_0x2c15f7(0x1e2)](_0xde9ca3,_0xe9a77,'folder',_0x2c15f7(0x1dc),_0x340bdb)==!![])try{let _0x55a087=[];for(let _0xcf3f25 in _0x1a928f){let _0x15fa44=_0x1a928f[_0xcf3f25],_0x195a5d=path[_0x2c15f7(0x26e)](_0x15fa44),_0xd6832e=path['join'](_0x340bdb,_0x195a5d),_0xb97bd7=_0xde9ca3['app'][_0x2c15f7(0x207)]['prepare'](_0x2c15f7(0x206))[_0x2c15f7(0x212)](_0x2c15f7(0x1e0),JSON[_0x2c15f7(0x23b)]({'sourcePath':_0x15fa44,'targetPath':_0xd6832e,'type':_0xe9bd7e,'username':_0xde9ca3[_0x2c15f7(0x259)]['username']}));_0x55a087[_0x2c15f7(0x239)](_0xb97bd7[_0x2c15f7(0x234)]);}return process[_0x2c15f7(0x1d4)]({'type':_0x2c15f7(0x1c1),'taskIdList':_0x55a087}),_0xe9a77[_0x2c15f7(0x253)]({'code':0x0});}catch(_0x2df007){return _0xde9ca3['app'][_0x2c15f7(0x1ce)](_0xe9a77,_0xe9a77['__']('operationFail'));}}),router['post'](_0x16f5ac(0x243),(_0x257375,_0x5de7d7,_0x584fb6)=>{const _0x45531c=_0x16f5ac;let _0x243d80=fileUtil[_0x45531c(0x21b)](_0x257375[_0x45531c(0x1d3)][_0x45531c(0x20d)]),_0x256317=fileUtil[_0x45531c(0x21b)](_0x257375[_0x45531c(0x1d3)][_0x45531c(0x1f7)]),_0x25731a=path[_0x45531c(0x26e)](_0x243d80),_0x161d83=_0x257375[_0x45531c(0x1d3)][_0x45531c(0x1e1)],_0x620326=path['join'](_0x256317,_0x25731a);if(_0x161d83==_0x45531c(0x251)||_0x161d83==_0x45531c(0x232)){if(fs[_0x45531c(0x241)](_0x620326))return _0x257375[_0x45531c(0x1f4)][_0x45531c(0x1ce)](_0x5de7d7,_0x5de7d7['__'](_0x45531c(0x1bb))+':'+_0x620326);}let _0x5589a2=_0x257375['body']['newName'];function _0x5e9344(_0x33ab00,_0x4507aa){const _0x331944=_0x45531c;let _0x438c79=_0x257375['app']['dbOther'][_0x331944(0x1c5)](_0x331944(0x206))[_0x331944(0x212)](_0x331944(0x1e0),JSON[_0x331944(0x23b)]({'sourcePath':_0x33ab00,'targetPath':_0x4507aa,'type':_0x161d83,'username':_0x257375[_0x331944(0x259)][_0x331944(0x20f)]}));return _0x438c79[_0x331944(0x234)];}try{_0x243d80=path[_0x45531c(0x1a5)](_0x243d80),_0x256317=path[_0x45531c(0x1a5)](_0x256317);if(_0x256317==_0x243d80||_0x256317[_0x45531c(0x211)](_0x243d80+path[_0x45531c(0x1f8)]))return _0x257375[_0x45531c(0x1f4)][_0x45531c(0x1ce)](_0x5de7d7,_0x5de7d7['__']('cannotCopyToSelf'));if(dbUserTable[_0x45531c(0x1e2)](_0x257375,_0x5de7d7,_0x45531c(0x1c7),_0x45531c(0x28f),_0x243d80)==!![]){let _0x500309=![];fs[_0x45531c(0x283)](_0x243d80,(_0x52cd95,_0x497766)=>{const _0x56f66b=_0x45531c;if(_0x52cd95)return _0x257375[_0x56f66b(0x1f4)]['returnErrMsg'](_0x5de7d7,_0x5de7d7['__'](_0x56f66b(0x22c))+':'+_0x243d80);let _0x40f5ed=path[_0x56f66b(0x26e)](_0x243d80);fs[_0x56f66b(0x20e)](_0x256317,fs[_0x56f66b(0x25b)][_0x56f66b(0x1af)]|fs[_0x56f66b(0x25b)]['W_OK'],_0x5669aa=>{const _0x370427=_0x56f66b;if(_0x5669aa)return _0x257375[_0x370427(0x1f4)]['returnErrMsg'](_0x5de7d7,_0x5de7d7['__'](_0x370427(0x1ad))+':'+_0x256317);if(_0x161d83=='rename')dbUserTable[_0x370427(0x1e2)](_0x257375,_0x5de7d7,'folder',_0x370427(0x1a4),_0x256317)==!![]&&(_0x256317=path[_0x370427(0x1a5)](_0x256317,_0x5589a2),fs[_0x370427(0x283)](_0x256317,_0x3d724b=>{const _0x4ed404=_0x370427;if(!_0x3d724b)return _0x257375[_0x4ed404(0x1f4)][_0x4ed404(0x1ce)](_0x5de7d7,_0x5de7d7['__'](_0x4ed404(0x1bb))+':'+_0x256317);else fs[_0x4ed404(0x216)](_0x243d80,_0x256317,_0x19239e=>{const _0x1197ac=_0x4ed404;if(_0x19239e)return dbFileOperationRecord[_0x1197ac(0x277)](_0x257375[_0x1197ac(0x1f4)]['dbOther'],{'username':_0x257375[_0x1197ac(0x259)]['username'],'sourcePath':_0x243d80,'targetPath':_0x256317,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'belongId':null,'type':dbFileOperationRecord[_0x1197ac(0x267)],'subType':null,'state':dbFileOperationRecord[_0x1197ac(0x1b2)],'remark':fileUtil[_0x1197ac(0x1e7)](_0x5de7d7,_0x19239e,!![])}),dbNoticeCenterTable[_0x1197ac(0x204)](_0x257375[_0x1197ac(0x1f4)][_0x1197ac(0x207)],{'title':_0x5de7d7['__']('operationFail'),'level':_0x1197ac(0x22b),'content':_0x5de7d7['__']('fileRenameFail')+':'+(_0x243d80+_0x1197ac(0x287)+_0x256317)});_0x500309=!![],dbFileOperationRecord[_0x1197ac(0x277)](_0x257375[_0x1197ac(0x1f4)][_0x1197ac(0x207)],{'username':_0x257375['currentUser']['username'],'sourcePath':_0x243d80,'targetPath':_0x256317,'level':dbFileOperationRecord[_0x1197ac(0x1a9)],'belongId':null,'type':dbFileOperationRecord[_0x1197ac(0x267)],'subType':null,'state':dbFileOperationRecord[_0x1197ac(0x1da)]});}),setTimeout(()=>{return _0x5de7d7['json']({'code':0x0,'isOver':_0x500309?0x1:0x0});},0x3e8);}));else{if(_0x161d83==_0x370427(0x232)){if(dbUserTable[_0x370427(0x1e2)](_0x257375,_0x5de7d7,'folder','power_delete',_0x256317)!==!![])return;}if(dbUserTable[_0x370427(0x1e2)](_0x257375,_0x5de7d7,_0x370427(0x1c7),_0x370427(0x1dc),_0x256317)==!![]){_0x256317=path[_0x370427(0x1a5)](_0x256317,_0x40f5ed);let _0x5eb752=_0x5e9344(_0x243d80,_0x256317);return process[_0x370427(0x1d4)]({'type':_0x370427(0x1c1),'taskIdList':[_0x5eb752]}),_0x5de7d7[_0x370427(0x253)]({'code':0x0});}}});});}}catch(_0x37ce1d){return _0x257375[_0x45531c(0x1f4)][_0x45531c(0x1ce)](_0x5de7d7,_0x5de7d7['__']('operationFail'));}}),router[_0x16f5ac(0x242)](_0x16f5ac(0x23d),(_0x2b70b8,_0x7bcb34,_0x453712)=>{const _0x4d60f7=_0x16f5ac;let _0x269d58=_0x2b70b8[_0x4d60f7(0x1d3)][_0x4d60f7(0x237)];if(!_0x269d58)return _0x7bcb34[_0x4d60f7(0x1bf)](0x194)[_0x4d60f7(0x1ca)]();dbUserTable['doUserCanGet'](_0x2b70b8,_0x7bcb34,_0x4d60f7(0x1c7),_0x4d60f7(0x28f),_0x269d58)==!![]&&fs[_0x4d60f7(0x283)](_0x269d58,(_0x4a4de7,_0x1eabbe)=>{const _0x188d99=_0x4d60f7;if(_0x4a4de7)return fileUtil[_0x188d99(0x1e7)](_0x7bcb34,_0x4a4de7);return _0x1eabbe[_0x188d99(0x27a)]=fileUtil[_0x188d99(0x27d)](_0x1eabbe[_0x188d99(0x1c6)]),_0x7bcb34['json']({'code':0x0,'data':_0x1eabbe});});}),router[_0x16f5ac(0x242)](_0x16f5ac(0x201),(_0x2cf127,_0x37904d,_0x10668a)=>{const _0x443913=_0x16f5ac;let _0x3818f5=_0x2cf127[_0x443913(0x1d3)][_0x443913(0x28e)],_0x2d3b5d=_0x2cf127['body']['fileName'];_0x2d3b5d&&(_0x2d3b5d=_0x2d3b5d['replace'](/[<>\\\/:\*\?\"\|]/g,'_')),_0x3818f5&&(_0x3818f5=fileUtil[_0x443913(0x21b)](_0x3818f5)),fs[_0x443913(0x20e)](_0x3818f5,fs[_0x443913(0x25b)][_0x443913(0x1f0)]|fs[_0x443913(0x25b)]['R_OK'],_0x3801f6=>{const _0x3d9a68=_0x443913;if(_0x3801f6)return _0x37904d[_0x3d9a68(0x253)]({'code':0x1,'message':_0x37904d['__']('noWritePermission')+':'+_0x3818f5});else{let _0x28ccb1='';if(_0x3818f5&&_0x2d3b5d)_0x28ccb1=path[_0x3d9a68(0x1a5)](_0x3818f5,_0x2d3b5d);else{if(_0x3818f5)_0x28ccb1=path['join'](_0x3818f5);else return _0x37904d[_0x3d9a68(0x253)]({'code':0x1,'message':_0x37904d['__']('folderNotExist')+':'+_0x3818f5});}fs[_0x3d9a68(0x283)](_0x28ccb1,_0x1935f1=>{const _0x2f61ac=_0x3d9a68;return _0x1935f1?(console[_0x2f61ac(0x240)](_0x2f61ac(0x1cd),_0x28ccb1),_0x37904d[_0x2f61ac(0x253)]({'code':0x0})):_0x37904d[_0x2f61ac(0x253)]({'code':0x1,'remark':'EXIST'});});}});}),router[_0x16f5ac(0x242)](_0x16f5ac(0x255),(_0x29c344,_0xb87b52,_0x5cb4a3)=>{const _0x190694=_0x16f5ac;let _0xa11017=_0x29c344[_0x190694(0x1d3)]['fullPath'],_0x1ce774=_0x29c344[_0x190694(0x1d3)][_0x190694(0x1dd)];if(!_0xa11017)return _0xb87b52[_0x190694(0x1bf)](0x194)[_0x190694(0x1ca)]();_0xa11017=path[_0x190694(0x1a5)](_0xa11017);if(dbUserTable[_0x190694(0x1e2)](_0x29c344,_0xb87b52,'folder',_0x190694(0x286),_0xa11017)==!![]){if(_0x1ce774==0x1)return process[_0x190694(0x1d4)]({'type':_0x190694(0x21d),'shellType':_0x190694(0x260),'path':_0xa11017}),dbFileOperationRecord[_0x190694(0x277)](_0x29c344[_0x190694(0x1f4)][_0x190694(0x207)],{'username':_0x29c344[_0x190694(0x259)][_0x190694(0x20f)],'targetPath':_0xa11017,'level':dbFileOperationRecord[_0x190694(0x1a9)],'type':dbFileOperationRecord[_0x190694(0x1fe)],'state':dbFileOperationRecord['STATE_SUC']}),_0xb87b52['json']({'code':0x0,'message':_0xb87b52['__'](_0x190694(0x266))});else fs['rm'](_0xa11017,{'recursive':!![]},_0x1be4c2=>{const _0x5510aa=_0x190694;if(_0x1be4c2)return dbFileOperationRecord[_0x5510aa(0x277)](_0x29c344[_0x5510aa(0x1f4)][_0x5510aa(0x207)],{'username':_0x29c344[_0x5510aa(0x259)][_0x5510aa(0x20f)],'targetPath':_0xa11017,'level':dbFileOperationRecord[_0x5510aa(0x1a9)],'type':dbFileOperationRecord[_0x5510aa(0x1fe)],'state':dbFileOperationRecord[_0x5510aa(0x1b2)],'remark':fileUtil[_0x5510aa(0x1e7)](_0xb87b52,_0x1be4c2,!![])}),fileUtil[_0x5510aa(0x1e7)](_0xb87b52,_0x1be4c2);return dbFileOperationRecord[_0x5510aa(0x277)](_0x29c344[_0x5510aa(0x1f4)][_0x5510aa(0x207)],{'username':_0x29c344[_0x5510aa(0x259)]['username'],'targetPath':_0xa11017,'level':dbFileOperationRecord[_0x5510aa(0x1a9)],'type':dbFileOperationRecord[_0x5510aa(0x1fe)],'state':dbFileOperationRecord['STATE_SUC']}),_0xb87b52[_0x5510aa(0x253)]({'code':0x0,'message':_0xb87b52['__'](_0x5510aa(0x266))});});}}),router['post']('/clearOperationRecord',(_0x92adae,_0x68dc21,_0x40ea7c)=>{const _0x314b72=_0x16f5ac;if(_0x92adae[_0x314b72(0x259)][_0x314b72(0x231)]!=0x1)return _0x68dc21[_0x314b72(0x253)]({'code':0x66});return dbFileOperationRecord['deleteFileRecordAll'](_0x92adae['app']['dbOther']),_0x68dc21['json']({'code':0x0});}),router[_0x16f5ac(0x242)]('/getOperationRecord',(_0x6c86a6,_0x3cbbc2,_0x1ba1f8)=>{const _0x2e37b8=_0x16f5ac;let _0x4bee95=_0x6c86a6[_0x2e37b8(0x1d3)]['page'],_0x1c5d0a=_0x6c86a6[_0x2e37b8(0x1d3)][_0x2e37b8(0x272)],_0x49964e=_0x6c86a6[_0x2e37b8(0x1d3)][_0x2e37b8(0x1e1)],_0x285c7a=_0x6c86a6[_0x2e37b8(0x1d3)][_0x2e37b8(0x223)],_0x95b0df=_0x6c86a6[_0x2e37b8(0x1d3)][_0x2e37b8(0x263)],_0xdd85ee=_0x6c86a6['body'][_0x2e37b8(0x279)],_0xe20ea7=_0x6c86a6[_0x2e37b8(0x1d3)]['searchStr'],_0x32a86d;return _0x6c86a6[_0x2e37b8(0x259)][_0x2e37b8(0x231)]==0x1?_0x32a86d=dbFileOperationRecord[_0x2e37b8(0x21a)](_0x6c86a6['app'][_0x2e37b8(0x207)],_0x4bee95,_0x1c5d0a,_0x285c7a,_0x49964e,_0x95b0df,_0xdd85ee,_0xe20ea7):_0x32a86d=dbFileOperationRecord['getByPage'](_0x6c86a6[_0x2e37b8(0x1f4)][_0x2e37b8(0x207)],_0x4bee95,_0x1c5d0a,_0x285c7a,_0x49964e,_0x95b0df,_0xdd85ee,_0xe20ea7,_0x6c86a6[_0x2e37b8(0x259)]['username']),_0x3cbbc2[_0x2e37b8(0x253)]({'code':0x0,'data':_0x32a86d});}),router['post'](_0x16f5ac(0x27c),(_0x3d8e39,_0x4f72d8,_0x3dd6c5)=>{const _0x1e8f13=_0x16f5ac;let _0x45e145=_0x3d8e39['body'][_0x1e8f13(0x249)];if(_0x45e145==_0x1e8f13(0x258)||_0x45e145==_0x1e8f13(0x257)){if(_0x3d8e39[_0x1e8f13(0x259)]['is_admin']!=0x1)return _0x4f72d8[_0x1e8f13(0x253)]({'code':0x66});}if(_0x45e145=='add'){let _0x942fdb=_0x3d8e39[_0x1e8f13(0x1d3)][_0x1e8f13(0x1e1)],_0x159548=_0x3d8e39[_0x1e8f13(0x1d3)][_0x1e8f13(0x1cb)],_0x5f3713=_0x3d8e39[_0x1e8f13(0x1d3)][_0x1e8f13(0x20f)],_0x5c989e=_0x3d8e39[_0x1e8f13(0x1d3)][_0x1e8f13(0x24f)],_0x2bfa59=_0x3d8e39[_0x1e8f13(0x1d3)][_0x1e8f13(0x20f)],_0x494799=_0x3d8e39[_0x1e8f13(0x1d3)][_0x1e8f13(0x20c)],_0x11ee4b=[_0x1e8f13(0x23f),'webdav','samba'];if(!_0x942fdb||!_0x159548||!_0x11ee4b[_0x1e8f13(0x219)](_0x942fdb))return _0x3d8e39[_0x1e8f13(0x1f4)][_0x1e8f13(0x1ce)](_0x4f72d8,_0x4f72d8['__'](_0x1e8f13(0x203)));_0x942fdb==_0x1e8f13(0x23f)&&fileStatUtil[_0x1e8f13(0x225)](_0x159548,()=>{const _0xd456cc=_0x1e8f13;fileStatUtil[_0xd456cc(0x235)](_0x159548,()=>{const _0x550df2=_0xd456cc,_0x14b8f1='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20REPLACE\x20INTO\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path_mount(type,url,name,username,password,remark)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES(?,?,?,?,?,?)';return _0x3d8e39['app'][_0x550df2(0x207)][_0x550df2(0x1c5)](_0x14b8f1)[_0x550df2(0x212)](_0x942fdb,_0x159548,_0x5f3713,_0x2bfa59,_0x494799,_0x5c989e),_0x4f72d8['json']({'code':0x0});},()=>{const _0x1edff9=_0xd456cc;return _0x3d8e39[_0x1edff9(0x1f4)][_0x1edff9(0x1ce)](_0x4f72d8,_0x4f72d8['__']('noReadPermission'));});},()=>{const _0x507e1e=_0x1e8f13;return _0x3d8e39[_0x507e1e(0x1f4)][_0x507e1e(0x1ce)](_0x4f72d8,_0x4f72d8['__'](_0x507e1e(0x26d)));});}else{if(_0x45e145==_0x1e8f13(0x257)){let _0x173e30=_0x3d8e39[_0x1e8f13(0x1d3)]['id'];return _0x3d8e39[_0x1e8f13(0x1f4)][_0x1e8f13(0x207)]['prepare'](_0x1e8f13(0x1f6))['run'](_0x173e30),_0x4f72d8['json']({'code':0x0});}else{if(_0x45e145=='get'){let _0x34daa0=[],_0x3602d5=_0x3d8e39['app'][_0x1e8f13(0x207)][_0x1e8f13(0x1c5)]('select\x20id,type,url,name,remark\x20from\x20path_mount')[_0x1e8f13(0x1e9)]();if(_0x3d8e39[_0x1e8f13(0x259)][_0x1e8f13(0x231)]==0x1)_0x34daa0=_0x3602d5;else{let _0x586c47=dbUserTable[_0x1e8f13(0x25e)](_0x3d8e39[_0x1e8f13(0x1f4)]['dbOther'],_0x3d8e39[_0x1e8f13(0x259)][_0x1e8f13(0x20f)],_0x1e8f13(0x1c7),_0x1e8f13(0x28f));for(let _0x3eb351 in _0x586c47){let _0x10596a=_0x586c47[_0x3eb351][_0x1e8f13(0x26a)][_0x1e8f13(0x213)]();_0x10596a=path[_0x1e8f13(0x1a5)](_0x10596a);for(let _0x8a7d3a in _0x3602d5){try{if(_0x3602d5[_0x8a7d3a][_0x1e8f13(0x1cb)]&&_0x10596a){let _0x5c2d93=_0x3602d5[_0x8a7d3a][_0x1e8f13(0x1cb)][_0x1e8f13(0x213)]();_0x5c2d93['endsWith'](':')&&_0x5c2d93[_0x1e8f13(0x1d5)]==0x2&&(_0x5c2d93=_0x5c2d93+path['sep']),_0x5c2d93=path[_0x1e8f13(0x1a5)](_0x5c2d93)[_0x1e8f13(0x213)](),(_0x10596a==_0x5c2d93||_0x5c2d93[_0x1e8f13(0x211)](path[_0x1e8f13(0x1a5)](_0x10596a+path['sep'])))&&_0x34daa0[_0x1e8f13(0x239)](_0x3602d5[_0x8a7d3a]);}}catch(_0x51d386){continue;}}}}return _0x4f72d8[_0x1e8f13(0x253)]({'code':0x0,'data':_0x34daa0});}}}});function _0x35ea(){const _0x4c6582=['body','send','length','download','System\x20Volume\x20Information','$Recycle.Bin','atimeMs','STATE_SUC','/getPathTree','power_add','putInSystemTrash','createTime','cwd','FILE_OPERATION','type','doUserCanGet','6077864JDGkpV','../../db/dbFileOperationRecord','children','setHeader','returnFileError','stack','all','returnDealedFile','parse','Convert\x20to\x20utf8\x20','SELECT\x20*\x20FROM\x20share_temp\x20where\x20user_id=?','13016943OhINnv','sort','W_OK','.txt','login.pwdErr','charAt','app','finalize','delete\x20from\x20path_mount\x20where\x20id=?','targetPath','sep','days','106463GzBRsP','66zBbGwD','write','/getTempShareFiles','TYPE_DELETE','/operationFileList','../../utils/globalInfoUtil','/fileExist','customHomeBgImage','operationFail','create','headersSent','INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)','dbOther','.tmp','normalize','INSERT\x20INTO\x20share_temp(path,password,token,create_timestamp,end_timestamp,user_id)\x20VALUES(?,?,?,?,?,?)','zip','password','sourcePath','access','username','getPathByType','startsWith','run','toLowerCase','data','mtimeMs','rename','sha256','movie','includes','getByPage','decodePath','getTime','shell','isDirectory','../../utils/encodingUtil','8kmyngw','env','checkPath','level','custom','localPathIsFolder','folderName','1624105vbbBHB','../../db/dbUserTable','/Users','/rawFile*','error','noReadPermission','zip\x20error','random','code','.sys','is_admin','cut','/tempShare','lastInsertRowid','localPathIsReadable','Documents\x20and\x20Settings','fullPath','6082olYuHo','push','statSync','stringify','shareToken','/getPathState','/customImageFile','local','log','existsSync','post','/operationFolder','$WinREAgent','root','cachePathRoot','utf8','ctimeMs','operationType','extname','attachment;\x20filename*=UTF-8\x27\x27','parent','../../myConfig/config','/zipFile/*','pathName','sourceFolderMusic','copy','findByTitle','json','sourcePathList','/deleteByPath','directory','delete','add','currentUser','birthtimeMs','constants','$RECYCLE.BIN','Desktop','getUserPower','query','trash','archiver','test','subType','Downloads','quality','deleteSuccess','TYPE_RENMAE','win32','removeHeader','path','message','Content-Disposition','targetPathInvalid','basename','get','exports','sharp','pageSize','destroy','raw','getTempShareObj','sendFile','addFileOperationRecord','../../utils/fileStatUtil','result','sizeStr','toUpperCase','/operationPathMount','getTransSizeStr','sourceFolderBook','../utils/fileUtils','name','filename','zip\x20finish','stat','checkPower','parentPath','power_delete','\x20->\x20','An\x20error\x20occurred\x20while\x20reading\x20the\x20directory.','/addNewFolder','fileFullPath','findByTitleParamsList','404','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?\x20and\x20user_id=?','folderPath','power_get','power_change','join','6CYhYPS','sourceFolderMovie','res\x20closed,destroy\x20zip\x20stream','LEVEL_MAIN_OPERATION','music','darwin','value','noWritePermission','677560HMrlEP','R_OK','replace','/checkFolderPower','STATE_FAIL','getUtf8FileStream','1131YrNYwz','then','userDataFolder','../../db/dbSourceFolderTable','readdir','floor','USER','sameNameFileAlreadExist','createReadStream','no\x20permission\x20','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','status','../../db/dbConfigTable','START_WORKER_FILE_OPERATION','2634330DijsSB','SELECT\x20*\x20FROM\x20share_temp\x20WHERE\x20token=?','close','prepare','size','folder','PerfLogs','endsWith','end','url','isFile','err','returnErrMsg','sourceFolderPhoto','An\x20error\x20occurred\x20while\x20compressing\x20the\x20files.','Documents','../../db/dbNoticeCenterTable'];_0x35ea=function(){return _0x4c6582;};return _0x35ea();}function getRandomString(_0xd3d9d0){const _0x36eb5e=_0x16f5ac;let _0x308ef7='';const _0x322b60=_0x36eb5e(0x1be),_0x43c75d=_0x322b60[_0x36eb5e(0x1d5)];for(let _0x2364b9=0x0;_0x2364b9<_0xd3d9d0;_0x2364b9++){_0x308ef7+=_0x322b60[_0x36eb5e(0x1f3)](Math[_0x36eb5e(0x1b9)](Math[_0x36eb5e(0x22e)]()*_0x43c75d));}return _0x308ef7;}router['post']('/getTempShare',(_0x2a6593,_0x5bc8e8,_0x20b58c)=>{const _0x10aa89=_0x16f5ac;let _0x15518d=[];return _0x2a6593[_0x10aa89(0x259)][_0x10aa89(0x231)]==0x1?_0x15518d=_0x2a6593[_0x10aa89(0x1f4)][_0x10aa89(0x207)][_0x10aa89(0x1c5)]('SELECT\x20*\x20FROM\x20share_temp')[_0x10aa89(0x1e9)]():_0x15518d=_0x2a6593[_0x10aa89(0x1f4)][_0x10aa89(0x207)][_0x10aa89(0x1c5)](_0x10aa89(0x1ed))['all'](_0x2a6593[_0x10aa89(0x259)]['id']),_0x5bc8e8['json']({'code':0x0,'data':_0x15518d});}),router[_0x16f5ac(0x242)](_0x16f5ac(0x233),(_0x35d34c,_0x3b8976,_0x4f27ec)=>{const _0x47bb50=_0x16f5ac;let _0x297eb9=_0x35d34c[_0x47bb50(0x1d3)][_0x47bb50(0x249)];if(_0x297eb9==_0x47bb50(0x258))try{if(!_0x35d34c[_0x47bb50(0x1d3)][_0x47bb50(0x26a)])return _0x35d34c[_0x47bb50(0x1f4)]['returnErrMsg'](_0x3b8976,_0x47bb50(0x22b));let _0x3f023a=fileUtil[_0x47bb50(0x21b)](_0x35d34c[_0x47bb50(0x1d3)][_0x47bb50(0x26a)]);_0x3f023a=path['join'](_0x3f023a);function _0x27575d(){const _0x34a12e=_0x47bb50;if(dbUserTable[_0x34a12e(0x1e2)](_0x35d34c,_0x3b8976,'','power_get',_0x3f023a)==!![]){let _0x317a9a=_0x35d34c[_0x34a12e(0x1d3)][_0x34a12e(0x20c)]?_0x35d34c[_0x34a12e(0x1d3)][_0x34a12e(0x20c)]:'',_0x4533d5=new Date()[_0x34a12e(0x21c)](),_0x5d3d3c=getRandomString(0x5),_0x3b6822=_0x35d34c['app'][_0x34a12e(0x207)]['prepare'](_0x34a12e(0x1c3))[_0x34a12e(0x26f)](_0x5d3d3c);if(_0x3b6822)return _0x27575d();let _0x36ed33=_0x35d34c['body'][_0x34a12e(0x1f9)]?_0x35d34c[_0x34a12e(0x1d3)][_0x34a12e(0x1f9)]:0x1e,_0x286856=0xe10*0x3e8*0x18*_0x36ed33+_0x4533d5;return _0x35d34c[_0x34a12e(0x1f4)][_0x34a12e(0x207)][_0x34a12e(0x1c5)](_0x34a12e(0x20a))[_0x34a12e(0x212)](_0x3f023a,_0x317a9a,_0x5d3d3c,_0x4533d5,_0x286856,_0x35d34c['currentUser']['id']),_0x3b8976[_0x34a12e(0x253)]({'code':0x0,'token':_0x5d3d3c});}}return _0x27575d();}catch(_0x3f36e8){return console[_0x47bb50(0x240)](_0x3f36e8),_0x35d34c['app'][_0x47bb50(0x1ce)](_0x3b8976,_0x47bb50(0x22b));}else{if(_0x297eb9==_0x47bb50(0x257)){let _0x45f545=_0x35d34c[_0x47bb50(0x1d3)]['deleteId'];return _0x35d34c[_0x47bb50(0x259)]['is_admin']==0x1?_0x35d34c[_0x47bb50(0x1f4)][_0x47bb50(0x207)]['prepare']('DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?')[_0x47bb50(0x212)](_0x45f545):_0x35d34c[_0x47bb50(0x1f4)]['dbOther'][_0x47bb50(0x1c5)](_0x47bb50(0x28d))[_0x47bb50(0x212)](_0x45f545,_0x35d34c[_0x47bb50(0x259)]['id']),_0x3b8976[_0x47bb50(0x253)]({'code':0x0});}}}),router[_0x16f5ac(0x242)](_0x16f5ac(0x1fd),(_0x401cd7,_0x342e80,_0x31b569)=>{const _0x8749bc=_0x16f5ac;let _0x4b5c4f=_0x401cd7['body'][_0x8749bc(0x23c)]||_0x401cd7[_0x8749bc(0x1d3)]['st'],_0x261d84=_0x401cd7[_0x8749bc(0x1d3)]['parent'],_0x2279aa=_0x401cd7[_0x8749bc(0x1d3)][_0x8749bc(0x20c)],_0x57277f=[],_0x398a36=dbConfigTable[_0x8749bc(0x28b)](_0x401cd7[_0x8749bc(0x1f4)][_0x8749bc(0x207)],['customLogoImage',_0x8749bc(0x202)]),_0x1941dd={'code':0x0,'data':{'customConfig':_0x398a36,'parent':_0x261d84,'children':_0x57277f,'sep':path[_0x8749bc(0x1f8)],'platform':platform}};if(!_0x4b5c4f)return _0x342e80[_0x8749bc(0x253)](_0x1941dd);let _0x4a500b=dbUserTable[_0x8749bc(0x275)](_0x401cd7[_0x8749bc(0x1f4)][_0x8749bc(0x207)],_0x4b5c4f);if(!_0x4a500b)return _0x342e80[_0x8749bc(0x253)](_0x1941dd);if(_0x4a500b[_0x8749bc(0x20c)]){if(!_0x2279aa)return _0x342e80[_0x8749bc(0x253)]({'code':0x2});if(_0x4a500b[_0x8749bc(0x20c)]!=_0x2279aa)return _0x342e80[_0x8749bc(0x253)]({'code':0x2,'message':_0x342e80['__'](_0x8749bc(0x1f2))});}function _0xd02158(){const _0x1168eb=_0x8749bc;fs['stat'](_0x4a500b[_0x1168eb(0x26a)],(_0x2c729a,_0xc8d306)=>{const _0x7bd106=_0x1168eb;if(_0x2c729a)return _0x342e80['json'](_0x1941dd);return _0x1941dd[_0x7bd106(0x214)][_0x7bd106(0x1e5)]['push']({'type':_0xc8d306[_0x7bd106(0x1cc)]()?0x1:0x2,'name':path[_0x7bd106(0x26e)](_0x4a500b['path']),'fileFullPath':_0x4a500b['path']}),_0x342e80[_0x7bd106(0x253)](_0x1941dd);});}if(!_0x261d84)_0xd02158();else{let _0x1e6521=dbUserTable['doUserCanGetTempShare'](_0x401cd7[_0x8749bc(0x1f4)]['dbOther'],_0x4b5c4f,_0x261d84,_0x2279aa);if(!_0x1e6521)return console['log'](_0x8749bc(0x1bd),_0x261d84),_0xd02158();fs[_0x8749bc(0x1b8)](_0x261d84,{'withFileTypes':!![]},(_0x4b5d95,_0x3b01ce)=>{const _0x5ce46d=_0x8749bc;if(_0x4b5d95)return _0x342e80['json'](_0x1941dd);let _0x48f736=0x0;if(_0x3b01ce[_0x5ce46d(0x1d5)]<0x1)return _0x342e80['json'](_0x1941dd);for(let _0x1a0397=0x0;_0x1a0397<_0x3b01ce[_0x5ce46d(0x1d5)];_0x1a0397++){let _0x2faf71=_0x3b01ce[_0x1a0397],_0x5018ea=_0x3b01ce[_0x1a0397][_0x5ce46d(0x280)];if(_0x5018ea['length']>0x0){if(_0x5018ea[0x0]=='.'){_0x48f736+=0x1;if(_0x48f736>=_0x3b01ce[_0x5ce46d(0x1d5)])return _0x342e80[_0x5ce46d(0x253)](_0x1941dd);continue;}if(/[A-Z]:\\/i[_0x5ce46d(0x262)](_0x261d84)&&_0x261d84[_0x5ce46d(0x1d5)]<=0x3){if(win32ExcludeList['includes'](_0x5018ea)||_0x5018ea[_0x5ce46d(0x1c9)](_0x5ce46d(0x230))||_0x5018ea[_0x5ce46d(0x1c9)](_0x5ce46d(0x208))){_0x48f736+=0x1;if(_0x48f736>=_0x3b01ce[_0x5ce46d(0x1d5)])return _0x342e80[_0x5ce46d(0x253)](_0x1941dd);continue;}}}let _0x36af39=path['join'](_0x261d84,_0x5018ea);fs[_0x5ce46d(0x283)](_0x36af39,(_0xac04ab,_0x287a82)=>{const _0x3d2962=_0x5ce46d;_0x48f736+=0x1;let _0x3e8c23=_0x2faf71[_0x3d2962(0x1cc)](),_0x327011=_0x2faf71[_0x3d2962(0x21e)](),_0x44d563={'name':_0x5018ea,'fileFullPath':_0x36af39};!_0xac04ab&&_0x287a82&&(_0x44d563[_0x3d2962(0x1c6)]=_0x287a82[_0x3d2962(0x1c6)],_0x44d563[_0x3d2962(0x1de)]=_0x287a82[_0x3d2962(0x25a)]||_0x287a82[_0x3d2962(0x248)]);_0x3e8c23?_0x44d563[_0x3d2962(0x1e1)]=0x1:_0x44d563[_0x3d2962(0x1e1)]=0x2;_0x1941dd[_0x3d2962(0x214)][_0x3d2962(0x1e5)][_0x3d2962(0x239)](_0x44d563);if(_0x48f736>=_0x3b01ce['length'])return _0x342e80[_0x3d2962(0x253)](_0x1941dd);});}});}}),module[_0x16f5ac(0x270)]=router;