function _0x2b91(_0x355c7e,_0x2bd2dc){const _0x3a050f=_0x3a05();return _0x2b91=function(_0x2b9197,_0x42dcbc){_0x2b9197=_0x2b9197-0x173;let _0x10696d=_0x3a050f[_0x2b9197];return _0x10696d;},_0x2b91(_0x355c7e,_0x2bd2dc);}const _0x1753cd=_0x2b91;(function(_0x113189,_0xbef3c2){const _0x351f4f=_0x2b91,_0x59776b=_0x113189();while(!![]){try{const _0x4ab4f0=-parseInt(_0x351f4f(0x19b))/0x1+parseInt(_0x351f4f(0x1a2))/0x2*(-parseInt(_0x351f4f(0x23a))/0x3)+-parseInt(_0x351f4f(0x215))/0x4*(-parseInt(_0x351f4f(0x239))/0x5)+-parseInt(_0x351f4f(0x179))/0x6+-parseInt(_0x351f4f(0x1e6))/0x7*(-parseInt(_0x351f4f(0x240))/0x8)+parseInt(_0x351f4f(0x1f4))/0x9*(parseInt(_0x351f4f(0x236))/0xa)+parseInt(_0x351f4f(0x1db))/0xb*(parseInt(_0x351f4f(0x17c))/0xc);if(_0x4ab4f0===_0xbef3c2)break;else _0x59776b['push'](_0x59776b['shift']());}catch(_0x1820c5){_0x59776b['push'](_0x59776b['shift']());}}}(_0x3a05,0x1fb8a));let express=require('express'),router=express[_0x1753cd(0x1ff)](),path=require('path'),fs=require('fs'),sha256=require(_0x1753cd(0x22a)),fileUtil=require(_0x1753cd(0x243));const sharp=require(_0x1753cd(0x23b)),os=require('os');let platform=os['platform']();const dbUserTable=require(_0x1753cd(0x255)),dbNoticeCenterTable=require('../../db/dbNoticeCenterTable'),dbConfigTable=require('../../db/dbConfigTable'),dbSourceFolderTable=require(_0x1753cd(0x1a7)),dbFileOperationRecord=require(_0x1753cd(0x208)),fileStatUtil=require(_0x1753cd(0x1aa)),config=require(_0x1753cd(0x1a1)),sharpUtil=require(_0x1753cd(0x1f8)),globalInfoUtil=require(_0x1753cd(0x1cc)),archiver=require('archiver'),encodingUtil=require(_0x1753cd(0x245));let macPowerDetected=![],win32ExcludeList=['System\x20Volume\x20Information',_0x1753cd(0x17e),_0x1753cd(0x25d),_0x1753cd(0x1e0),_0x1753cd(0x1a8),'PerfLogs'];router['get'](_0x1753cd(0x203),(_0x1bf734,_0x30ea43,_0x26d824)=>{const _0x1218fc=_0x1753cd;if(!_0x1bf734[_0x1218fc(0x1f2)][_0x1218fc(0x24b)])return _0x30ea43[_0x1218fc(0x1bb)](0x194)[_0x1218fc(0x20f)]();let _0x237f3e=fileUtil[_0x1218fc(0x25f)](_0x1bf734['query'][_0x1218fc(0x24b)]),_0x183b13=_0x1bf734[_0x1218fc(0x1f2)][_0x1218fc(0x19e)];_0x183b13&&(_0x237f3e=path['join'](_0x237f3e,_0x183b13)),dbUserTable[_0x1218fc(0x1cf)](_0x1bf734,_0x30ea43,'',_0x1218fc(0x1bf),_0x237f3e)==!![]&&fs[_0x1218fc(0x230)](_0x237f3e,(_0x106c12,_0x40149e)=>{const _0x5aadba=_0x1218fc;if(_0x106c12)return _0x30ea43[_0x5aadba(0x1bb)](0x194)[_0x5aadba(0x20f)]();let _0x456075=path[_0x5aadba(0x1f1)](_0x237f3e)+_0x5aadba(0x254);try{const _0x413e98=encodeURIComponent(_0x456075)[_0x5aadba(0x1f9)](/%([0-9A-F]{2})/g,(_0x14daca,_0x2a388d)=>'%'+_0x2a388d[_0x5aadba(0x1c3)]());_0x30ea43[_0x5aadba(0x183)]('Content-Disposition','attachment;\x20filename*=UTF-8\x27\x27'+_0x413e98);}catch(_0x8d8898){console[_0x5aadba(0x212)](_0x8d8898);}const _0x31f8a6=archiver(_0x5aadba(0x1b8),{'zlib':{'level':0x0}});_0x31f8a6['on'](_0x5aadba(0x217),function(_0x1cde2a){const _0x52b69c=_0x5aadba;console[_0x52b69c(0x212)](_0x52b69c(0x1ae),_0x1cde2a[_0x52b69c(0x17d)]||_0x1cde2a[_0x52b69c(0x194)]),_0x31f8a6[_0x52b69c(0x234)](),!_0x30ea43[_0x52b69c(0x1f0)]?(_0x30ea43[_0x52b69c(0x1a9)](_0x52b69c(0x24f)),_0x30ea43[_0x52b69c(0x1bb)](0x1f4)[_0x52b69c(0x207)](_0x52b69c(0x1be))):_0x30ea43['destroy']();}),_0x31f8a6['on']('end',function(){const _0x490282=_0x5aadba;console[_0x490282(0x212)](_0x490282(0x223)),_0x31f8a6[_0x490282(0x1b2)]();});try{fs[_0x5aadba(0x173)](_0x237f3e,(_0x4b6dfe,_0x565dfc)=>{const _0x5a669d=_0x5aadba;for(let _0x325a96 in _0x565dfc){let _0x210177=_0x565dfc[_0x325a96];const _0x433737=path[_0x5a669d(0x1b5)](_0x237f3e,_0x210177);let _0x347819=fs[_0x5a669d(0x24d)](_0x433737);_0x347819[_0x5a669d(0x1c8)]()?_0x31f8a6[_0x5a669d(0x252)](_0x433737,_0x210177):_0x31f8a6['append'](fs[_0x5a669d(0x23e)](_0x433737),{'name':_0x210177});}_0x31f8a6[_0x5a669d(0x1b1)](),_0x31f8a6[_0x5a669d(0x22f)](_0x30ea43);});}catch(_0x169406){!_0x30ea43[_0x5aadba(0x1f0)]&&_0x30ea43[_0x5aadba(0x1bb)](0x1f4)[_0x5aadba(0x207)]({'error':_0x5aadba(0x22e)}),console[_0x5aadba(0x217)](_0x169406);}_0x30ea43['on'](_0x5aadba(0x1ac),()=>{const _0x3f4e92=_0x5aadba;console[_0x3f4e92(0x212)]('res\x20closed,destroy\x20zip\x20stream'),_0x31f8a6['destroy']();});});}),router[_0x1753cd(0x1ce)](_0x1753cd(0x20a),(_0x5674ee,_0x35cf19,_0x1e4317)=>{const _0x48a92a=_0x1753cd;let _0x37484d=_0x5674ee[_0x48a92a(0x18f)][_0x48a92a(0x23c)],_0x1dc89b=path[_0x48a92a(0x202)],_0x58432f=_0x5674ee['body']['type'],_0x4c361a=_0x5674ee['body'][_0x48a92a(0x222)],_0x2426b0=[],_0x1af87a=parseInt(_0x5674ee[_0x48a92a(0x22c)][_0x48a92a(0x210)])==0x1,_0x1d90b0=fileUtil['getExcludePathList'](_0x5674ee['app'][_0x48a92a(0x199)]);try{function _0x4ce72a(){const _0x5c15eb=_0x48a92a;let _0xc5665d=dbUserTable[_0x5c15eb(0x246)](_0x5674ee['app']['dbOther'],_0x5674ee['currentUser']['username'],_0x5c15eb(0x1d2),_0x5c15eb(0x1bf));for(let _0x11d4eb of _0xc5665d){if(_0x1d90b0[_0x5c15eb(0x18a)](_0x11d4eb[_0x5c15eb(0x24b)]))continue;_0x2426b0['push']({'type':0x2,'name':_0x11d4eb['path'],'fileFullPath':_0x11d4eb['path']});}return _0x35cf19['json']({'code':0x0,'data':{'parent':'','children':_0x2426b0,'sep':_0x1dc89b,'platform':platform}});}if(!_0x37484d){if(_0x1af87a){if(platform==_0x48a92a(0x258)){function _0x163da8(_0xc3c3a9){const _0x96e826=_0x48a92a;let _0x5a9d36=[];for(let _0xa7f62 of _0xc3c3a9){if(_0x1d90b0['includes'](_0xa7f62[_0x96e826(0x198)]))continue;_0xa7f62[_0x96e826(0x235)]=0x2,_0x5a9d36[_0x96e826(0x1d0)](_0xa7f62);}for(let _0x3835c in _0x5a9d36){_0x5a9d36[_0x3835c]['fileFullPath']=_0x5a9d36[_0x3835c][_0x96e826(0x198)];}return _0x35cf19['json']({'code':0x0,'data':{'parent':_0x37484d,'children':_0x5a9d36,'sep':path[_0x96e826(0x202)],'platform':platform}});}let _0x38900a=dbConfigTable[_0x48a92a(0x1b4)](_0x5674ee[_0x48a92a(0x1b3)][_0x48a92a(0x199)],'cachePathRoot');if(_0x38900a)try{_0x38900a=JSON[_0x48a92a(0x181)](_0x38900a[_0x48a92a(0x19d)]),_0x204b62(![]),_0x163da8(_0x38900a);}catch(_0x112478){_0x204b62(!![]);}else _0x204b62(!![]);function _0x204b62(_0xbacc54){const _0x52206a=_0x48a92a;globalInfoUtil[_0x52206a(0x219)](_0x1c9ae6=>{const _0x1f89b9=_0x52206a;_0x1c9ae6=_0x1c9ae6[_0x1f89b9(0x178)]((_0x38cb8c,_0x3437dd)=>{const _0x372725=_0x1f89b9;if(!_0x38cb8c[_0x372725(0x198)]||!_0x3437dd[_0x372725(0x198)])return;return _0x38cb8c[_0x372725(0x198)]['localeCompare'](_0x3437dd[_0x372725(0x198)]);}),dbConfigTable[_0x1f89b9(0x21e)](_0x5674ee[_0x1f89b9(0x1b3)][_0x1f89b9(0x199)],{'title':_0x1f89b9(0x23f),'value':JSON['stringify'](_0x1c9ae6)}),_0xbacc54&&_0x163da8(_0x1c9ae6);});}}else{if(platform==_0x48a92a(0x1d7)){if(!macPowerDetected){macPowerDetected=!![];try{const _0x3f8588=process[_0x48a92a(0x1c7)]['USER'];let _0xe13f87=[path[_0x48a92a(0x1b5)](_0x48a92a(0x182),_0x3f8588,'Documents'),path[_0x48a92a(0x1b5)](_0x48a92a(0x182),_0x3f8588,'Downloads'),path['join'](_0x48a92a(0x182),_0x3f8588,'Desktop')];for(let _0x12fae2 in _0xe13f87){fs[_0x48a92a(0x230)](_0xe13f87[_0x12fae2],(_0x309bd7,_0x37c09f)=>{});}}catch(_0x21482a){}}let _0x4939f3=path[_0x48a92a(0x181)](process[_0x48a92a(0x1ad)]())['root'];_0x18afbf(_0x4939f3);}else _0x37484d=path['parse'](process[_0x48a92a(0x1ad)]())[_0x48a92a(0x220)],_0x18afbf(_0x37484d);}}else return _0x4ce72a();}else _0x18afbf(_0x37484d);function _0x18afbf(_0x2b25ca){const _0x541bfe=_0x48a92a;if(!_0x1af87a){if(!dbUserTable[_0x541bfe(0x1cf)](_0x5674ee,_0x35cf19,_0x541bfe(0x1d2),_0x541bfe(0x1bf),_0x2b25ca,!![]))return _0x4ce72a();}if(_0x2b25ca==_0x541bfe(0x244)||_0x2b25ca=='sourceFolderMovie'||_0x2b25ca==_0x541bfe(0x25c)||_0x2b25ca=='sourceFolderBook'){let _0x3fa2f0=_0x541bfe(0x21a);if(_0x2b25ca==_0x541bfe(0x193))_0x3fa2f0=_0x541bfe(0x21b);else{if(_0x2b25ca=='sourceFolderMusic')_0x3fa2f0='music';else _0x2b25ca==_0x541bfe(0x1c5)&&(_0x3fa2f0='book');}let _0x2e07f9=dbSourceFolderTable[_0x541bfe(0x18b)](_0x5674ee[_0x541bfe(0x1b3)]['dbOther'],_0x3fa2f0);for(let _0x5b520b in _0x2e07f9){_0x2426b0[_0x541bfe(0x1d0)]({'type':0x2,'name':path['basename'](_0x2e07f9[_0x5b520b][_0x541bfe(0x24b)]),'fileFullPath':_0x2e07f9[_0x5b520b][_0x541bfe(0x24b)]});}return _0x35cf19['json']({'code':0x0,'data':{'parent':_0x2b25ca,'children':_0x2426b0,'sep':_0x1dc89b,'platform':platform}});}fs[_0x541bfe(0x173)](_0x2b25ca,{'withFileTypes':!![]},(_0x8be084,_0x336e96)=>{const _0x654d17=_0x541bfe;if(_0x8be084)return console['log'](_0x8be084),fileUtil[_0x654d17(0x241)](_0x35cf19,_0x8be084);for(let _0x238472=0x0;_0x238472<_0x336e96[_0x654d17(0x21f)];_0x238472++){let _0x49385a=_0x336e96[_0x238472],_0x36f53a=_0x336e96[_0x238472][_0x654d17(0x198)];if(_0x36f53a[_0x654d17(0x21f)]>0x0){if(_0x36f53a[0x0]=='.')continue;if(/[A-Z]:\\/i[_0x654d17(0x1bd)](_0x2b25ca)&&_0x2b25ca[_0x654d17(0x21f)]<=0x3){if(win32ExcludeList[_0x654d17(0x18a)](_0x36f53a)||_0x36f53a[_0x654d17(0x1ee)](_0x654d17(0x1c0))||_0x36f53a[_0x654d17(0x1ee)](_0x654d17(0x20e)))continue;}}let _0x412bc7=path[_0x654d17(0x1b5)](_0x2b25ca,_0x36f53a);if(_0x1d90b0[_0x654d17(0x18a)](_0x412bc7))continue;let _0x5c19c7=_0x49385a[_0x654d17(0x22d)](),_0x4a178e=_0x49385a[_0x654d17(0x1c8)]();function _0x273bf6(){const _0x560982=_0x654d17;if(_0x5c19c7)(_0x58432f==0x0||_0x58432f==0x1)&&_0x2426b0['push']({'type':0x1,'name':_0x36f53a,'fileFullPath':_0x412bc7});else _0x4a178e&&_0x2426b0[_0x560982(0x1d0)]({'type':0x2,'name':_0x36f53a,'fileFullPath':_0x412bc7});}_0x4c361a?_0x36f53a[_0x654d17(0x18a)](_0x4c361a)&&_0x273bf6():_0x273bf6();try{if(_0x2426b0[_0x654d17(0x21f)]>0x1770)break;}catch(_0x320214){continue;}}let _0x6c655c=_0x2426b0[_0x654d17(0x21f)],_0x4743e5=0x0;if(_0x2426b0[_0x654d17(0x21f)]<0x1)return _0x35cf19[_0x654d17(0x1d3)]({'code':0x0,'data':{'parent':_0x2b25ca,'children':_0x2426b0,'sep':_0x1dc89b,'platform':platform}});for(let _0x1605aa of _0x2426b0){fs[_0x654d17(0x230)](_0x1605aa[_0x654d17(0x228)],(_0xc3b423,_0xf2b1e2)=>{const _0x42dc4c=_0x654d17;_0x4743e5+=0x1;!_0xc3b423&&(_0x1605aa[_0x42dc4c(0x1b7)]=_0xf2b1e2[_0x42dc4c(0x1b7)],_0x1605aa[_0x42dc4c(0x24a)]=_0xf2b1e2[_0x42dc4c(0x24a)],_0x1605aa[_0x42dc4c(0x238)]=_0xf2b1e2[_0x42dc4c(0x238)],_0x1605aa[_0x42dc4c(0x19a)]=_0xf2b1e2['size']);if(_0x4743e5>=_0x6c655c)return _0x35cf19['json']({'code':0x0,'data':{'parent':_0x2b25ca,'children':_0x2426b0,'sep':_0x1dc89b,'platform':platform}});});}});}}catch(_0x384f18){return fileUtil[_0x48a92a(0x241)](_0x35cf19,_0x384f18);}}),router[_0x1753cd(0x186)](_0x1753cd(0x1fb),(_0x47104b,_0xa748cd,_0x172250)=>{const _0x3f68d7=_0x1753cd;let _0xf7d731=fileUtil[_0x3f68d7(0x25f)](_0x47104b['query']['path']);if(!_0xf7d731)return _0xa748cd[_0x3f68d7(0x1bb)](0x194)[_0x3f68d7(0x20f)]();_0xf7d731=path[_0x3f68d7(0x1d4)](path[_0x3f68d7(0x197)](_0xf7d731));let _0x5b427f=path['join'](config[_0x3f68d7(0x233)],_0x3f68d7(0x214),path['sep']);return _0xf7d731[_0x3f68d7(0x1f7)](_0x5b427f)?_0xa748cd['sendFile'](_0xf7d731):(console[_0x3f68d7(0x212)](_0x3f68d7(0x1e8)),_0xa748cd[_0x3f68d7(0x1bb)](0x194)[_0x3f68d7(0x20f)]());}),router[_0x1753cd(0x186)]('/rawFile*',(_0x7002a0,_0x4be321,_0x1a4173)=>{const _0x280b8b=_0x1753cd;let _0x13ee88=_0x7002a0[_0x280b8b(0x1f2)][_0x280b8b(0x24b)],_0x1b2e7c=_0x7002a0[_0x280b8b(0x1f2)][_0x280b8b(0x224)]==0x1,_0xba7c87=fileUtil[_0x280b8b(0x25f)](_0x13ee88),_0x5a9398=_0x7002a0[_0x280b8b(0x1f2)][_0x280b8b(0x19a)],_0x4e0bb1=_0x7002a0[_0x280b8b(0x1f2)]['quality'];if(dbUserTable[_0x280b8b(0x1cf)](_0x7002a0,_0x4be321,'','power_get',_0xba7c87)==!![])try{let _0x2dc688=_0x7002a0[_0x280b8b(0x1f2)][_0x280b8b(0x196)];if(_0x2dc688&&_0x2dc688==0x1){if(_0x1b2e7c){const _0x4d031d=encodeURIComponent(path[_0x280b8b(0x1f1)](_0xba7c87))[_0x280b8b(0x1f9)](/%([0-9A-F]{2})/g,(_0x4b4b26,_0x32b7bb)=>'%'+_0x32b7bb['toUpperCase']());_0x4be321[_0x280b8b(0x183)](_0x280b8b(0x24f),_0x280b8b(0x1a5)+_0x4d031d);}return _0x4be321['sendFile'](_0xba7c87);}else _0x7002a0[_0x280b8b(0x1f2)][_0x280b8b(0x1f3)]&&_0x7002a0[_0x280b8b(0x1f2)][_0x280b8b(0x1f3)]==_0x280b8b(0x209)&&path[_0x280b8b(0x24c)](_0xba7c87)&&path[_0x280b8b(0x24c)](_0xba7c87)[_0x280b8b(0x1e4)]()==_0x280b8b(0x1fd)?(console[_0x280b8b(0x212)](_0x280b8b(0x21c),_0xba7c87),encodingUtil[_0x280b8b(0x25a)](_0xba7c87)[_0x280b8b(0x1ca)](_0x298eb5=>{const _0x4aa397=_0x280b8b;return _0x298eb5?_0x298eb5[_0x4aa397(0x22f)](_0x4be321):(console['log'](_0x4aa397(0x189),_0xba7c87),_0x4be321[_0x4aa397(0x174)](_0xba7c87));})):sharpUtil[_0x280b8b(0x177)](_0x4be321,_0xba7c87,_0x1b2e7c,_0x5a9398,_0x4e0bb1);}catch(_0x4242c8){return console['log'](_0x4242c8),fileUtil[_0x280b8b(0x241)](_0x4be321,_0x4242c8);}}),router['post']('/checkFolderPower',(_0x325780,_0x40f6eb,_0xa68903)=>{const _0x47740c=_0x1753cd;let _0x254387=fileUtil[_0x47740c(0x25f)](_0x325780[_0x47740c(0x18f)][_0x47740c(0x1c4)]),_0x448de5=_0x325780[_0x47740c(0x18f)][_0x47740c(0x1d1)];if(_0x448de5=='write')_0x448de5=fs[_0x47740c(0x256)]['W_OK'];else _0x448de5=='read'&&(_0x448de5=fs['constants'][_0x47740c(0x1c1)]);try{_0x448de5==_0x47740c(0x176)?fs[_0x47740c(0x200)](_0x254387,fs[_0x47740c(0x256)][_0x47740c(0x1ba)],_0x1eb734=>{const _0x207a65=_0x47740c;if(_0x1eb734)return fileUtil[_0x207a65(0x241)](_0x40f6eb,_0x1eb734);return _0x40f6eb[_0x207a65(0x1d3)]({'code':0x0,'access':!![]});}):fs[_0x47740c(0x200)](_0x254387,_0x448de5,_0x1ec9e5=>{const _0x9f340a=_0x47740c;if(_0x1ec9e5)return fileUtil[_0x9f340a(0x241)](_0x40f6eb,_0x1ec9e5);return _0x40f6eb[_0x9f340a(0x1d3)]({'code':0x0,'access':!![]});});}catch(_0x42b98d){return _0x40f6eb[_0x47740c(0x1d3)]({'code':0x0,'access':![]});}}),router['post'](_0x1753cd(0x1c6),(_0x1cfcc7,_0x406caf,_0x1982ec)=>{const _0x3b7790=_0x1753cd;let _0xde25ce=fileUtil[_0x3b7790(0x25f)](_0x1cfcc7[_0x3b7790(0x18f)][_0x3b7790(0x1d9)]),_0x33461e=_0x1cfcc7[_0x3b7790(0x18f)][_0x3b7790(0x1fe)],_0x35cf10=path[_0x3b7790(0x1b5)](_0xde25ce,_0x33461e);if(dbUserTable[_0x3b7790(0x1cf)](_0x1cfcc7,_0x406caf,_0x3b7790(0x1d2),_0x3b7790(0x191),_0x35cf10)==!![])try{fs[_0x3b7790(0x230)](_0x35cf10,_0x398440=>{const _0x38cf94=_0x3b7790;if(!_0x398440)return _0x1cfcc7[_0x38cf94(0x1b3)][_0x38cf94(0x211)](_0x406caf,_0x406caf['__'](_0x38cf94(0x1c9))+':'+_0x35cf10);else fs['mkdir'](_0x35cf10,{'recursive':!![]},_0x34f0bc=>{const _0x13ddaf=_0x38cf94;return _0x34f0bc?fileUtil[_0x13ddaf(0x241)](_0x406caf,_0x34f0bc):_0x406caf[_0x13ddaf(0x1d3)]({'code':0x0});});});}catch(_0x2d2aca){return fileUtil['returnFileError'](_0x406caf,_0x2d2aca);}}),router[_0x1753cd(0x1ce)](_0x1753cd(0x23d),(_0x29e4f3,_0x3dc9ca,_0x385392)=>{const _0xf465b=_0x1753cd;let _0x5115ba=_0x29e4f3[_0xf465b(0x18f)][_0xf465b(0x1ea)],_0x4d5740=_0x29e4f3[_0xf465b(0x18f)][_0xf465b(0x22b)],_0x5ba72a=_0x29e4f3[_0xf465b(0x18f)][_0xf465b(0x235)];if(_0x5ba72a!=_0xf465b(0x1b8)&&_0x5ba72a!=_0xf465b(0x225))return _0x29e4f3[_0xf465b(0x1b3)][_0xf465b(0x211)](_0x3dc9ca,_0x3dc9ca['__'](_0xf465b(0x227)));if(dbUserTable[_0xf465b(0x1cf)](_0x29e4f3,_0x3dc9ca,_0xf465b(0x1d2),_0xf465b(0x1bf),_0x5115ba)==!![]&&dbUserTable[_0xf465b(0x1cf)](_0x29e4f3,_0x3dc9ca,'folder',_0xf465b(0x191),_0x4d5740)==!![]){let _0x4d3716=_0x29e4f3[_0xf465b(0x1b3)][_0xf465b(0x199)]['prepare'](_0xf465b(0x1ec))[_0xf465b(0x185)](_0xf465b(0x21d),JSON[_0xf465b(0x18c)]({'sourcePath':_0x5115ba,'targetPath':_0x4d5740,'type':_0x5ba72a,'username':_0x29e4f3[_0xf465b(0x22c)][_0xf465b(0x1e9)]}));return process[_0xf465b(0x207)]({'type':_0xf465b(0x205),'taskIdList':[_0x4d3716['lastInsertRowid']]}),_0x3dc9ca[_0xf465b(0x1d3)]({'code':0x0});}}),router[_0x1753cd(0x1ce)](_0x1753cd(0x251),(_0x492c70,_0x4d20c1,_0x1c5c1f)=>{const _0x3926c9=_0x1753cd;let _0x5d92b3=_0x492c70['body'][_0x3926c9(0x20c)],_0x23a8fd=_0x492c70[_0x3926c9(0x18f)][_0x3926c9(0x22b)],_0x4f19a7=_0x492c70[_0x3926c9(0x18f)]['type'];if(_0x5d92b3['length']<0x1)return _0x492c70[_0x3926c9(0x1b3)][_0x3926c9(0x211)](_0x4d20c1,_0x4d20c1['__'](_0x3926c9(0x227)));if(dbUserTable[_0x3926c9(0x1cf)](_0x492c70,_0x4d20c1,_0x3926c9(0x1d2),_0x3926c9(0x1bf),_0x5d92b3[0x0])==!![]&&dbUserTable[_0x3926c9(0x1cf)](_0x492c70,_0x4d20c1,_0x3926c9(0x1d2),_0x3926c9(0x191),_0x23a8fd)==!![])try{let _0x29fd23=[];for(let _0x4bb6fb in _0x5d92b3){let _0x5d7cf2=_0x5d92b3[_0x4bb6fb],_0x2d4a59=path[_0x3926c9(0x1f1)](_0x5d7cf2),_0x3ba2ba=path[_0x3926c9(0x1b5)](_0x23a8fd,_0x2d4a59),_0x564b5d=_0x492c70['app'][_0x3926c9(0x199)]['prepare'](_0x3926c9(0x1ec))['run'](_0x3926c9(0x21d),JSON[_0x3926c9(0x18c)]({'sourcePath':_0x5d7cf2,'targetPath':_0x3ba2ba,'type':_0x4f19a7,'username':_0x492c70['currentUser'][_0x3926c9(0x1e9)]}));_0x29fd23[_0x3926c9(0x1d0)](_0x564b5d[_0x3926c9(0x18e)]);}return process[_0x3926c9(0x207)]({'type':_0x3926c9(0x205),'taskIdList':_0x29fd23}),_0x4d20c1[_0x3926c9(0x1d3)]({'code':0x0});}catch(_0x10f2c0){return _0x492c70['app'][_0x3926c9(0x211)](_0x4d20c1,_0x4d20c1['__']('operationFail'));}}),router[_0x1753cd(0x1ce)]('/operationFolder',(_0x375c95,_0x40b8fa,_0x481bad)=>{const _0x29b275=_0x1753cd;let _0x1f0120=fileUtil[_0x29b275(0x25f)](_0x375c95[_0x29b275(0x18f)][_0x29b275(0x1ea)]),_0xd28bec=fileUtil[_0x29b275(0x25f)](_0x375c95[_0x29b275(0x18f)]['targetPath']),_0x3557f8=path[_0x29b275(0x1f1)](_0x1f0120),_0x3c67f4=_0x375c95[_0x29b275(0x18f)][_0x29b275(0x235)],_0x55a9ad=path[_0x29b275(0x1b5)](_0xd28bec,_0x3557f8);if(_0x3c67f4==_0x29b275(0x1b6)||_0x3c67f4==_0x29b275(0x1cd)){if(fs[_0x29b275(0x18d)](_0x55a9ad))return _0x375c95[_0x29b275(0x1b3)][_0x29b275(0x211)](_0x40b8fa,_0x40b8fa['__']('sameNameFileAlreadExist')+':'+_0x55a9ad);}let _0x289a8=_0x375c95[_0x29b275(0x18f)]['newName'];function _0x50aaa5(_0x270fa9,_0x5c2784){const _0x5b698e=_0x29b275;let _0x3a60b7=_0x375c95[_0x5b698e(0x1b3)][_0x5b698e(0x199)][_0x5b698e(0x17f)](_0x5b698e(0x1ec))[_0x5b698e(0x185)](_0x5b698e(0x21d),JSON[_0x5b698e(0x18c)]({'sourcePath':_0x270fa9,'targetPath':_0x5c2784,'type':_0x3c67f4,'username':_0x375c95[_0x5b698e(0x22c)]['username']}));return _0x3a60b7[_0x5b698e(0x18e)];}try{_0x1f0120=path[_0x29b275(0x1b5)](_0x1f0120),_0xd28bec=path[_0x29b275(0x1b5)](_0xd28bec);if(_0xd28bec==_0x1f0120||_0xd28bec[_0x29b275(0x1f7)](_0x1f0120+path[_0x29b275(0x202)]))return _0x375c95[_0x29b275(0x1b3)][_0x29b275(0x211)](_0x40b8fa,_0x40b8fa['__'](_0x29b275(0x1c2)));if(dbUserTable[_0x29b275(0x1cf)](_0x375c95,_0x40b8fa,_0x29b275(0x1d2),_0x29b275(0x1bf),_0x1f0120)==!![]){let _0x573bda=![];fs[_0x29b275(0x230)](_0x1f0120,(_0x3ba874,_0x5e9996)=>{const _0x4890ce=_0x29b275;if(_0x3ba874)return _0x375c95[_0x4890ce(0x1b3)][_0x4890ce(0x211)](_0x40b8fa,_0x40b8fa['__'](_0x4890ce(0x1de))+':'+_0x1f0120);let _0x2130ff=path[_0x4890ce(0x1f1)](_0x1f0120);fs[_0x4890ce(0x200)](_0xd28bec,fs[_0x4890ce(0x256)][_0x4890ce(0x1c1)]|fs['constants']['W_OK'],_0x508408=>{const _0x573dc6=_0x4890ce;if(_0x508408)return _0x375c95[_0x573dc6(0x1b3)][_0x573dc6(0x211)](_0x40b8fa,_0x40b8fa['__']('noWritePermission')+':'+_0xd28bec);if(_0x3c67f4==_0x573dc6(0x253))dbUserTable['doUserCanGet'](_0x375c95,_0x40b8fa,_0x573dc6(0x1d2),_0x573dc6(0x1d5),_0xd28bec)==!![]&&(_0xd28bec=path[_0x573dc6(0x1b5)](_0xd28bec,_0x289a8),fs[_0x573dc6(0x230)](_0xd28bec,_0x5333fa=>{const _0xadeb25=_0x573dc6;if(!_0x5333fa)return _0x375c95['app'][_0xadeb25(0x211)](_0x40b8fa,_0x40b8fa['__'](_0xadeb25(0x1c9))+':'+_0xd28bec);else fs[_0xadeb25(0x253)](_0x1f0120,_0xd28bec,_0x512772=>{const _0x49ab8e=_0xadeb25;if(_0x512772)return dbFileOperationRecord['addFileOperationRecord'](_0x375c95[_0x49ab8e(0x1b3)][_0x49ab8e(0x199)],{'username':_0x375c95[_0x49ab8e(0x22c)][_0x49ab8e(0x1e9)],'sourcePath':_0x1f0120,'targetPath':_0xd28bec,'level':dbFileOperationRecord[_0x49ab8e(0x25e)],'belongId':null,'type':dbFileOperationRecord['TYPE_RENMAE'],'subType':null,'state':dbFileOperationRecord[_0x49ab8e(0x1ab)],'remark':fileUtil[_0x49ab8e(0x241)](_0x40b8fa,_0x512772,!![])}),dbNoticeCenterTable[_0x49ab8e(0x21e)](_0x375c95[_0x49ab8e(0x1b3)][_0x49ab8e(0x199)],{'title':_0x40b8fa['__'](_0x49ab8e(0x227)),'level':_0x49ab8e(0x217),'content':_0x40b8fa['__'](_0x49ab8e(0x17b))+':'+(_0x1f0120+_0x49ab8e(0x259)+_0xd28bec)});_0x573bda=!![],dbFileOperationRecord['addFileOperationRecord'](_0x375c95[_0x49ab8e(0x1b3)][_0x49ab8e(0x199)],{'username':_0x375c95[_0x49ab8e(0x22c)]['username'],'sourcePath':_0x1f0120,'targetPath':_0xd28bec,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'belongId':null,'type':dbFileOperationRecord[_0x49ab8e(0x180)],'subType':null,'state':dbFileOperationRecord[_0x49ab8e(0x204)]});}),setTimeout(()=>{const _0x1a31aa=_0xadeb25;return _0x40b8fa[_0x1a31aa(0x1d3)]({'code':0x0,'isOver':_0x573bda?0x1:0x0});},0x3e8);}));else{if(_0x3c67f4==_0x573dc6(0x1cd)){if(dbUserTable[_0x573dc6(0x1cf)](_0x375c95,_0x40b8fa,_0x573dc6(0x1d2),_0x573dc6(0x1dd),_0xd28bec)!==!![])return;}if(dbUserTable['doUserCanGet'](_0x375c95,_0x40b8fa,_0x573dc6(0x1d2),_0x573dc6(0x191),_0xd28bec)==!![]){_0xd28bec=path[_0x573dc6(0x1b5)](_0xd28bec,_0x2130ff);let _0x1d2b3a=_0x50aaa5(_0x1f0120,_0xd28bec);return process[_0x573dc6(0x207)]({'type':_0x573dc6(0x205),'taskIdList':[_0x1d2b3a]}),_0x40b8fa['json']({'code':0x0});}}});});}}catch(_0x42c0b7){return _0x375c95[_0x29b275(0x1b3)][_0x29b275(0x211)](_0x40b8fa,_0x40b8fa['__']('operationFail'));}}),router['post'](_0x1753cd(0x1e7),(_0x2b17a2,_0x47c71f,_0x1bbf0d)=>{const _0xf80f35=_0x1753cd;let _0x5d161=_0x2b17a2[_0xf80f35(0x18f)]['fullPath'];if(!_0x5d161)return _0x47c71f['status'](0x194)[_0xf80f35(0x20f)]();dbUserTable[_0xf80f35(0x1cf)](_0x2b17a2,_0x47c71f,_0xf80f35(0x1d2),_0xf80f35(0x1bf),_0x5d161)==!![]&&fs[_0xf80f35(0x230)](_0x5d161,(_0x5c2a78,_0x11506d)=>{const _0x112b38=_0xf80f35;if(_0x5c2a78)return fileUtil[_0x112b38(0x241)](_0x47c71f,_0x5c2a78);return _0x11506d[_0x112b38(0x1e1)]=fileUtil[_0x112b38(0x201)](_0x11506d[_0x112b38(0x19a)]),_0x47c71f[_0x112b38(0x1d3)]({'code':0x0,'data':_0x11506d});});}),router[_0x1753cd(0x1ce)]('/fileExist',(_0x360691,_0x6d69eb,_0x37d4b3)=>{const _0xe6ead4=_0x1753cd;let _0x4f9da8=_0x360691[_0xe6ead4(0x18f)][_0xe6ead4(0x1a6)],_0x5cc8d5=_0x360691[_0xe6ead4(0x18f)]['fileName'];_0x5cc8d5&&(_0x5cc8d5=_0x5cc8d5[_0xe6ead4(0x1f9)](/[<>\\\/:\*\?\"\|]/g,'_')),_0x4f9da8&&(_0x4f9da8=fileUtil['decodePath'](_0x4f9da8)),fs[_0xe6ead4(0x200)](_0x4f9da8,fs[_0xe6ead4(0x256)][_0xe6ead4(0x1ba)]|fs[_0xe6ead4(0x256)][_0xe6ead4(0x1c1)],_0xf22f74=>{const _0x46c0e7=_0xe6ead4;if(_0xf22f74)return _0x6d69eb[_0x46c0e7(0x1d3)]({'code':0x1,'message':_0x6d69eb['__'](_0x46c0e7(0x213))+':'+_0x4f9da8});else{let _0x3a20f2='';if(_0x4f9da8&&_0x5cc8d5)_0x3a20f2=path[_0x46c0e7(0x1b5)](_0x4f9da8,_0x5cc8d5);else{if(_0x4f9da8)_0x3a20f2=path['join'](_0x4f9da8);else return _0x6d69eb[_0x46c0e7(0x1d3)]({'code':0x1,'message':_0x6d69eb['__'](_0x46c0e7(0x206))+':'+_0x4f9da8});}fs['stat'](_0x3a20f2,_0x8c01fc=>{const _0x5cb8f6=_0x46c0e7;return _0x8c01fc?(console[_0x5cb8f6(0x212)]('err',_0x3a20f2),_0x6d69eb[_0x5cb8f6(0x1d3)]({'code':0x0})):_0x6d69eb[_0x5cb8f6(0x1d3)]({'code':0x1,'remark':_0x5cb8f6(0x1e3)});});}});}),router[_0x1753cd(0x1ce)]('/deleteByPath',(_0x24075e,_0x407e9a,_0x211319)=>{const _0x36d5c3=_0x1753cd;let _0x107f6f=_0x24075e[_0x36d5c3(0x18f)][_0x36d5c3(0x1b0)],_0x2c0702=_0x24075e[_0x36d5c3(0x18f)][_0x36d5c3(0x1fa)];if(!_0x107f6f)return _0x407e9a[_0x36d5c3(0x1bb)](0x194)[_0x36d5c3(0x20f)]();_0x107f6f=path[_0x36d5c3(0x1b5)](_0x107f6f);if(dbUserTable['doUserCanGet'](_0x24075e,_0x407e9a,_0x36d5c3(0x1d2),_0x36d5c3(0x1dd),_0x107f6f)==!![]){if(_0x2c0702==0x1)return process[_0x36d5c3(0x207)]({'type':_0x36d5c3(0x25b),'shellType':_0x36d5c3(0x1a0),'path':_0x107f6f}),dbFileOperationRecord['addFileOperationRecord'](_0x24075e['app'][_0x36d5c3(0x199)],{'username':_0x24075e['currentUser'][_0x36d5c3(0x1e9)],'targetPath':_0x107f6f,'level':dbFileOperationRecord[_0x36d5c3(0x25e)],'type':dbFileOperationRecord[_0x36d5c3(0x1af)],'state':dbFileOperationRecord[_0x36d5c3(0x204)]}),_0x407e9a[_0x36d5c3(0x1d3)]({'code':0x0,'message':_0x407e9a['__']('deleteSuccess')});else fs['rm'](_0x107f6f,{'recursive':!![]},_0x2961ab=>{const _0xca92a8=_0x36d5c3;if(_0x2961ab)return dbFileOperationRecord[_0xca92a8(0x248)](_0x24075e[_0xca92a8(0x1b3)][_0xca92a8(0x199)],{'username':_0x24075e[_0xca92a8(0x22c)][_0xca92a8(0x1e9)],'targetPath':_0x107f6f,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'type':dbFileOperationRecord[_0xca92a8(0x1af)],'state':dbFileOperationRecord[_0xca92a8(0x1ab)],'remark':fileUtil[_0xca92a8(0x241)](_0x407e9a,_0x2961ab,!![])}),fileUtil[_0xca92a8(0x241)](_0x407e9a,_0x2961ab);return dbFileOperationRecord[_0xca92a8(0x248)](_0x24075e[_0xca92a8(0x1b3)]['dbOther'],{'username':_0x24075e[_0xca92a8(0x22c)]['username'],'targetPath':_0x107f6f,'level':dbFileOperationRecord[_0xca92a8(0x25e)],'type':dbFileOperationRecord[_0xca92a8(0x1af)],'state':dbFileOperationRecord[_0xca92a8(0x204)]}),_0x407e9a['json']({'code':0x0,'message':_0x407e9a['__'](_0xca92a8(0x232))});});}}),router['post'](_0x1753cd(0x257),(_0x57ac61,_0x1d5be0,_0x8ab9e4)=>{const _0x567a6b=_0x1753cd;if(_0x57ac61[_0x567a6b(0x22c)][_0x567a6b(0x210)]!=0x1)return _0x1d5be0[_0x567a6b(0x1d3)]({'code':0x66});return dbFileOperationRecord[_0x567a6b(0x218)](_0x57ac61[_0x567a6b(0x1b3)]['dbOther']),_0x1d5be0['json']({'code':0x0});}),router[_0x1753cd(0x1ce)](_0x1753cd(0x1da),(_0x42195e,_0x4ab57e,_0x32f9bc)=>{const _0x1baf49=_0x1753cd;let _0x203394=_0x42195e['body'][_0x1baf49(0x231)],_0x30cea3=_0x42195e[_0x1baf49(0x18f)][_0x1baf49(0x229)],_0x20e2b8=_0x42195e[_0x1baf49(0x18f)][_0x1baf49(0x235)],_0x3a33b4=_0x42195e[_0x1baf49(0x18f)][_0x1baf49(0x1fc)],_0x3741ae=_0x42195e['body']['subType'],_0x3d9e6f=_0x42195e['body'][_0x1baf49(0x1d6)],_0x1d9f68=_0x42195e[_0x1baf49(0x18f)][_0x1baf49(0x222)],_0x37f4c7;return _0x42195e['currentUser'][_0x1baf49(0x210)]==0x1?_0x37f4c7=dbFileOperationRecord[_0x1baf49(0x1f6)](_0x42195e['app'][_0x1baf49(0x199)],_0x203394,_0x30cea3,_0x3a33b4,_0x20e2b8,_0x3741ae,_0x3d9e6f,_0x1d9f68):_0x37f4c7=dbFileOperationRecord[_0x1baf49(0x1f6)](_0x42195e[_0x1baf49(0x1b3)][_0x1baf49(0x199)],_0x203394,_0x30cea3,_0x3a33b4,_0x20e2b8,_0x3741ae,_0x3d9e6f,_0x1d9f68,_0x42195e[_0x1baf49(0x22c)][_0x1baf49(0x1e9)]),_0x4ab57e[_0x1baf49(0x1d3)]({'code':0x0,'data':_0x37f4c7});}),router[_0x1753cd(0x1ce)](_0x1753cd(0x24e),(_0x1a4c46,_0x2718c2,_0x48c37f)=>{const _0x2c7d9d=_0x1753cd;let _0x284ed3=_0x1a4c46[_0x2c7d9d(0x18f)][_0x2c7d9d(0x1e5)];if(_0x284ed3=='add'||_0x284ed3==_0x2c7d9d(0x20b)){if(_0x1a4c46[_0x2c7d9d(0x22c)][_0x2c7d9d(0x210)]!=0x1)return _0x2718c2[_0x2c7d9d(0x1d3)]({'code':0x66});}if(_0x284ed3=='add'){let _0x3bd596=_0x1a4c46[_0x2c7d9d(0x18f)][_0x2c7d9d(0x235)],_0x171072=_0x1a4c46['body'][_0x2c7d9d(0x188)],_0x52e799=_0x1a4c46['body'][_0x2c7d9d(0x1e9)],_0x1bbc68=_0x1a4c46['body'][_0x2c7d9d(0x249)],_0x573ba6=_0x1a4c46[_0x2c7d9d(0x18f)][_0x2c7d9d(0x1e9)],_0x355adb=_0x1a4c46['body']['password'],_0x28f684=[_0x2c7d9d(0x184),_0x2c7d9d(0x1a4),_0x2c7d9d(0x1d8)];if(!_0x3bd596||!_0x171072||!_0x28f684['includes'](_0x3bd596))return _0x1a4c46[_0x2c7d9d(0x1b3)][_0x2c7d9d(0x211)](_0x2718c2,_0x2718c2['__'](_0x2c7d9d(0x227)));_0x3bd596=='local'&&fileStatUtil['localPathIsFolder'](_0x171072,()=>{const _0x42be21=_0x2c7d9d;fileStatUtil[_0x42be21(0x1dc)](_0x171072,()=>{const _0x535a47=_0x42be21,_0x58e95b=_0x535a47(0x1a3);return _0x1a4c46[_0x535a47(0x1b3)]['dbOther']['prepare'](_0x58e95b)['run'](_0x3bd596,_0x171072,_0x52e799,_0x573ba6,_0x355adb,_0x1bbc68),_0x2718c2[_0x535a47(0x1d3)]({'code':0x0});},()=>{const _0x26adce=_0x42be21;return _0x1a4c46[_0x26adce(0x1b3)][_0x26adce(0x211)](_0x2718c2,_0x2718c2['__']('noReadPermission'));});},()=>{const _0x2768e6=_0x2c7d9d;return _0x1a4c46[_0x2768e6(0x1b3)][_0x2768e6(0x211)](_0x2718c2,_0x2718c2['__'](_0x2768e6(0x250)));});}else{if(_0x284ed3==_0x2c7d9d(0x20b)){let _0xc079d0=_0x1a4c46[_0x2c7d9d(0x18f)]['id'];return _0x1a4c46[_0x2c7d9d(0x1b3)][_0x2c7d9d(0x199)][_0x2c7d9d(0x17f)](_0x2c7d9d(0x226))[_0x2c7d9d(0x185)](_0xc079d0),_0x2718c2[_0x2c7d9d(0x1d3)]({'code':0x0});}else{if(_0x284ed3==_0x2c7d9d(0x186)){let _0x2e9b2f=[],_0x3a37ef=_0x1a4c46[_0x2c7d9d(0x1b3)][_0x2c7d9d(0x199)][_0x2c7d9d(0x17f)](_0x2c7d9d(0x175))[_0x2c7d9d(0x176)]();if(_0x1a4c46[_0x2c7d9d(0x22c)][_0x2c7d9d(0x210)]==0x1)_0x2e9b2f=_0x3a37ef;else{let _0x2f63fb=dbUserTable[_0x2c7d9d(0x246)](_0x1a4c46[_0x2c7d9d(0x1b3)][_0x2c7d9d(0x199)],_0x1a4c46[_0x2c7d9d(0x22c)]['username'],'folder',_0x2c7d9d(0x1bf));for(let _0x10027d in _0x2f63fb){let _0x191c51=_0x2f63fb[_0x10027d][_0x2c7d9d(0x24b)][_0x2c7d9d(0x1e4)]();_0x191c51=path[_0x2c7d9d(0x1b5)](_0x191c51);for(let _0x31e32b in _0x3a37ef){try{if(_0x3a37ef[_0x31e32b][_0x2c7d9d(0x188)]&&_0x191c51){let _0x119aeb=_0x3a37ef[_0x31e32b][_0x2c7d9d(0x188)]['toLowerCase']();_0x119aeb['endsWith'](':')&&_0x119aeb[_0x2c7d9d(0x21f)]==0x2&&(_0x119aeb=_0x119aeb+path['sep']),_0x119aeb=path[_0x2c7d9d(0x1b5)](_0x119aeb)[_0x2c7d9d(0x1e4)](),(_0x191c51==_0x119aeb||_0x119aeb[_0x2c7d9d(0x1f7)](path[_0x2c7d9d(0x1b5)](_0x191c51+path['sep'])))&&_0x2e9b2f[_0x2c7d9d(0x1d0)](_0x3a37ef[_0x31e32b]);}}catch(_0x32ac66){continue;}}}}return _0x2718c2['json']({'code':0x0,'data':_0x2e9b2f});}}}});function getRandomString(_0x21ff44){const _0xa0335=_0x1753cd;let _0x2f4370='';const _0x42844f=_0xa0335(0x1ef),_0x254326=_0x42844f['length'];for(let _0xae0793=0x0;_0xae0793<_0x21ff44;_0xae0793++){_0x2f4370+=_0x42844f['charAt'](Math[_0xa0335(0x221)](Math[_0xa0335(0x19c)]()*_0x254326));}return _0x2f4370;}router[_0x1753cd(0x1ce)](_0x1753cd(0x192),(_0x2c6bc1,_0x145c05,_0x203c01)=>{const _0x37508b=_0x1753cd;let _0x4aee1b=[];return _0x2c6bc1[_0x37508b(0x22c)]['is_admin']==0x1?_0x4aee1b=_0x2c6bc1['app'][_0x37508b(0x199)]['prepare'](_0x37508b(0x216))[_0x37508b(0x176)]():_0x4aee1b=_0x2c6bc1[_0x37508b(0x1b3)][_0x37508b(0x199)][_0x37508b(0x17f)]('SELECT\x20*\x20FROM\x20share_temp\x20where\x20user_id=?')[_0x37508b(0x176)](_0x2c6bc1[_0x37508b(0x22c)]['id']),_0x145c05[_0x37508b(0x1d3)]({'code':0x0,'data':_0x4aee1b});}),router[_0x1753cd(0x1ce)](_0x1753cd(0x1e2),(_0x38d29e,_0x4b60c7,_0x43f3bf)=>{const _0x3366bd=_0x1753cd;let _0x15b4ba=_0x38d29e[_0x3366bd(0x18f)]['operationType'];if(_0x15b4ba==_0x3366bd(0x1eb))try{if(!_0x38d29e[_0x3366bd(0x18f)]['path'])return _0x38d29e[_0x3366bd(0x1b3)][_0x3366bd(0x211)](_0x4b60c7,'error');let _0xffb349=fileUtil['decodePath'](_0x38d29e[_0x3366bd(0x18f)]['path']);function _0x143d50(){const _0x510150=_0x3366bd;if(dbUserTable[_0x510150(0x1cf)](_0x38d29e,_0x4b60c7,'','power_get',_0xffb349)==!![]){let _0x582ce3=_0x38d29e[_0x510150(0x18f)][_0x510150(0x242)]?_0x38d29e[_0x510150(0x18f)][_0x510150(0x242)]:'',_0x2e9745=new Date()['getTime'](),_0x290143=getRandomString(0x5),_0x538274=_0x38d29e[_0x510150(0x1b3)]['dbOther']['prepare'](_0x510150(0x1b9))[_0x510150(0x186)](_0x290143);if(_0x538274)return _0x143d50();let _0x50fcd6=_0x38d29e[_0x510150(0x18f)][_0x510150(0x19f)]?_0x38d29e[_0x510150(0x18f)][_0x510150(0x19f)]:0x1e,_0x508ebc=0xe10*0x3e8*0x18*_0x50fcd6+_0x2e9745;return _0x38d29e[_0x510150(0x1b3)][_0x510150(0x199)]['prepare'](_0x510150(0x247))[_0x510150(0x185)](_0xffb349,_0x582ce3,_0x290143,_0x2e9745,_0x508ebc,_0x38d29e[_0x510150(0x22c)]['id']),_0x4b60c7[_0x510150(0x1d3)]({'code':0x0,'token':_0x290143});}}return _0x143d50();}catch(_0x80a6b0){return console[_0x3366bd(0x212)](_0x80a6b0),_0x38d29e[_0x3366bd(0x1b3)][_0x3366bd(0x211)](_0x4b60c7,_0x3366bd(0x217));}else{if(_0x15b4ba==_0x3366bd(0x20b)){let _0x45b5fb=_0x38d29e[_0x3366bd(0x18f)]['deleteId'];return _0x38d29e[_0x3366bd(0x22c)][_0x3366bd(0x210)]==0x1?_0x38d29e[_0x3366bd(0x1b3)]['dbOther'][_0x3366bd(0x17f)](_0x3366bd(0x1df))[_0x3366bd(0x185)](_0x45b5fb):_0x38d29e['app'][_0x3366bd(0x199)][_0x3366bd(0x17f)]('DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?\x20and\x20user_id=?')[_0x3366bd(0x185)](_0x45b5fb,_0x38d29e[_0x3366bd(0x22c)]['id']),_0x4b60c7[_0x3366bd(0x1d3)]({'code':0x0});}}}),router[_0x1753cd(0x1ce)](_0x1753cd(0x187),(_0x4d0ddf,_0x2dfbbb,_0x2bac48)=>{const _0x53ecff=_0x1753cd;let _0x3c87c0=_0x4d0ddf[_0x53ecff(0x18f)][_0x53ecff(0x1ed)]||_0x4d0ddf[_0x53ecff(0x18f)]['st'],_0x2b58ef=_0x4d0ddf[_0x53ecff(0x18f)][_0x53ecff(0x23c)],_0xb63037=_0x4d0ddf[_0x53ecff(0x18f)][_0x53ecff(0x242)],_0x16e83b=[],_0xdd775a=dbConfigTable[_0x53ecff(0x1cb)](_0x4d0ddf[_0x53ecff(0x1b3)]['dbOther'],['customLogoImage',_0x53ecff(0x17a)]),_0x5b7816={'code':0x0,'data':{'customConfig':_0xdd775a,'parent':_0x2b58ef,'children':_0x16e83b,'sep':path['sep'],'platform':platform}};if(!_0x3c87c0)return _0x2dfbbb[_0x53ecff(0x1d3)](_0x5b7816);let _0x4319c6=dbUserTable['getTempShareObj'](_0x4d0ddf[_0x53ecff(0x1b3)][_0x53ecff(0x199)],_0x3c87c0);if(!_0x4319c6)return _0x2dfbbb[_0x53ecff(0x1d3)](_0x5b7816);if(_0x4319c6[_0x53ecff(0x242)]){if(!_0xb63037)return _0x2dfbbb[_0x53ecff(0x1d3)]({'code':0x2});if(_0x4319c6[_0x53ecff(0x242)]!=_0xb63037)return _0x2dfbbb[_0x53ecff(0x1d3)]({'code':0x2,'message':_0x2dfbbb['__'](_0x53ecff(0x1f5))});}function _0x1a1ee8(){const _0x828b8d=_0x53ecff;fs[_0x828b8d(0x230)](_0x4319c6[_0x828b8d(0x24b)],(_0x5ca073,_0xb3b98b)=>{const _0xec72bb=_0x828b8d;if(_0x5ca073)return _0x2dfbbb[_0xec72bb(0x1d3)](_0x5b7816);return _0x5b7816[_0xec72bb(0x237)][_0xec72bb(0x1bc)][_0xec72bb(0x1d0)]({'type':_0xb3b98b[_0xec72bb(0x22d)]()?0x1:0x2,'name':path[_0xec72bb(0x1f1)](_0x4319c6[_0xec72bb(0x24b)]),'fileFullPath':_0x4319c6[_0xec72bb(0x24b)]}),_0x2dfbbb[_0xec72bb(0x1d3)](_0x5b7816);});}if(!_0x2b58ef)_0x1a1ee8();else{let _0x4ca9b8=dbUserTable[_0x53ecff(0x190)](_0x4d0ddf[_0x53ecff(0x1b3)][_0x53ecff(0x199)],_0x3c87c0,_0x2b58ef,_0xb63037);if(!_0x4ca9b8)return console[_0x53ecff(0x212)]('no\x20permission\x20',_0x2b58ef),_0x1a1ee8();fs[_0x53ecff(0x173)](_0x2b58ef,{'withFileTypes':!![]},(_0x4a1df6,_0x3be8ce)=>{const _0x2afdd0=_0x53ecff;if(_0x4a1df6)return _0x2dfbbb[_0x2afdd0(0x1d3)](_0x5b7816);let _0x46caaa=0x0;if(_0x3be8ce[_0x2afdd0(0x21f)]<0x1)return _0x2dfbbb[_0x2afdd0(0x1d3)](_0x5b7816);for(let _0x2181c8=0x0;_0x2181c8<_0x3be8ce[_0x2afdd0(0x21f)];_0x2181c8++){let _0x4a8aa0=_0x3be8ce[_0x2181c8],_0x3e7357=_0x3be8ce[_0x2181c8][_0x2afdd0(0x198)];if(_0x3e7357[_0x2afdd0(0x21f)]>0x0){if(_0x3e7357[0x0]=='.'){_0x46caaa+=0x1;if(_0x46caaa>=_0x3be8ce['length'])return _0x2dfbbb[_0x2afdd0(0x1d3)](_0x5b7816);continue;}if(/[A-Z]:\\/i[_0x2afdd0(0x1bd)](_0x2b58ef)&&_0x2b58ef[_0x2afdd0(0x21f)]<=0x3){if(win32ExcludeList[_0x2afdd0(0x18a)](_0x3e7357)||_0x3e7357[_0x2afdd0(0x1ee)](_0x2afdd0(0x1c0))||_0x3e7357['endsWith'](_0x2afdd0(0x20e))){_0x46caaa+=0x1;if(_0x46caaa>=_0x3be8ce[_0x2afdd0(0x21f)])return _0x2dfbbb[_0x2afdd0(0x1d3)](_0x5b7816);continue;}}}let _0x113bd5=path[_0x2afdd0(0x1b5)](_0x2b58ef,_0x3e7357);fs[_0x2afdd0(0x230)](_0x113bd5,(_0x36e355,_0x13c09e)=>{const _0x3ac0f4=_0x2afdd0;_0x46caaa+=0x1;let _0x7e6823=_0x4a8aa0['isFile'](),_0x354e3f=_0x4a8aa0[_0x3ac0f4(0x1c8)](),_0x511537={'name':_0x3e7357,'fileFullPath':_0x113bd5};!_0x36e355&&_0x13c09e&&(_0x511537[_0x3ac0f4(0x19a)]=_0x13c09e['size'],_0x511537['createTime']=_0x13c09e[_0x3ac0f4(0x238)]||_0x13c09e[_0x3ac0f4(0x195)]);_0x7e6823?_0x511537['type']=0x1:_0x511537[_0x3ac0f4(0x235)]=0x2;_0x5b7816[_0x3ac0f4(0x237)][_0x3ac0f4(0x1bc)][_0x3ac0f4(0x1d0)](_0x511537);if(_0x46caaa>=_0x3be8ce[_0x3ac0f4(0x21f)])return _0x2dfbbb[_0x3ac0f4(0x1d3)](_0x5b7816);});}});}}),module[_0x1753cd(0x20d)]=router;function _0x3a05(){const _0x2dcd07=['stack','ctimeMs','raw','normalize','name','dbOther','size','211544HOyPml','random','value','filename','days','trash','../../myConfig/config','6XBnusO','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20REPLACE\x20INTO\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path_mount(type,url,name,username,password,remark)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES(?,?,?,?,?,?)','webdav','attachment;\x20filename*=UTF-8\x27\x27','folderPath','../../db/dbSourceFolderTable','Documents\x20and\x20Settings','removeHeader','../../utils/fileStatUtil','STATE_FAIL','close','cwd','zip\x20error','TYPE_DELETE','fullPath','finalize','destroy','app','findByTitle','join','copy','atimeMs','zip','SELECT\x20*\x20FROM\x20share_temp\x20WHERE\x20token=?','W_OK','status','children','test','An\x20error\x20occurred\x20while\x20compressing\x20the\x20files.','power_get','.sys','R_OK','cannotCopyToSelf','toUpperCase','checkPath','sourceFolderBook','/addNewFolder','env','isDirectory','sameNameFileAlreadExist','then','findByTitleParamsList','../../utils/globalInfoUtil','cut','post','doUserCanGet','push','checkPower','folder','json','resolve','power_change','result','darwin','samba','parentPath','/getOperationRecord','176khjeqC','localPathIsReadable','power_delete','noReadPermission','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?','$WinREAgent','sizeStr','/tempShare','EXIST','toLowerCase','operationType','7iLlims','/getPathState','404','username','sourcePath','add','INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)','shareToken','endsWith','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','headersSent','basename','query','code','540dEabAl','login.pwdErr','getByPage','startsWith','../utils/sharpUtils','replace','putInSystemTrash','/customImageFile','level','.txt','folderName','Router','access','getTransSizeStr','sep','/zipFile/*','STATE_SUC','START_WORKER_FILE_OPERATION','folderNotExist','send','../../db/dbFileOperationRecord','utf8','/getPathTree','delete','sourcePathList','exports','.tmp','end','is_admin','returnErrMsg','log','noWritePermission','custom','173688epDjVa','SELECT\x20*\x20FROM\x20share_temp','error','deleteFileRecordAll','getWindowsDiskList','photo','movie','Convert\x20to\x20utf8\x20','FILE_OPERATION','create','length','root','floor','searchStr','zip\x20finish','download','unzip','delete\x20from\x20path_mount\x20where\x20id=?','operationFail','fileFullPath','pageSize','sha256','targetPath','currentUser','isFile','An\x20error\x20occurred\x20while\x20reading\x20the\x20directory.','pipe','stat','page','deleteSuccess','userDataFolder','unpipe','type','42760QBTgjZ','data','birthtimeMs','25pTUkwN','182442ydMaVk','sharp','parent','/zipFile','createReadStream','cachePathRoot','45768eoTbyK','returnFileError','password','../utils/fileUtils','sourceFolderPhoto','../../utils/encodingUtil','getUserPower','INSERT\x20INTO\x20share_temp(path,password,token,create_timestamp,end_timestamp,user_id)\x20VALUES(?,?,?,?,?,?)','addFileOperationRecord','pathName','mtimeMs','path','extname','statSync','/operationPathMount','Content-Disposition','targetPathInvalid','/operationFileList','directory','rename','.zip','../../db/dbUserTable','constants','/clearOperationRecord','win32','\x20->\x20','getUtf8FileStream','shell','sourceFolderMusic','$RECYCLE.BIN','LEVEL_MAIN_OPERATION','decodePath','readdir','sendFile','select\x20id,type,url,name,remark\x20from\x20path_mount','all','returnDealedFile','sort','313554RRrXHM','customHomeBgImage','fileRenameFail','72588EfkdzQ','message','$Recycle.Bin','prepare','TYPE_RENMAE','parse','/Users','setHeader','local','run','get','/getTempShareFiles','url','Unable\x20to\x20read\x20file','includes','getPathByType','stringify','existsSync','lastInsertRowid','body','doUserCanGetTempShare','power_add','/getTempShare','sourceFolderMovie'];_0x3a05=function(){return _0x2dcd07;};return _0x3a05();}