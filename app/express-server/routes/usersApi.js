const _0x5cd69b=_0x2513;(function(_0x426cd3,_0x2b299e){const _0x16dae8=_0x2513,_0x5b7b13=_0x426cd3();while(!![]){try{const _0xd86b8=-parseInt(_0x16dae8(0x17d))/0x1*(-parseInt(_0x16dae8(0x168))/0x2)+-parseInt(_0x16dae8(0x199))/0x3*(-parseInt(_0x16dae8(0x1ac))/0x4)+parseInt(_0x16dae8(0x15c))/0x5*(-parseInt(_0x16dae8(0x15e))/0x6)+parseInt(_0x16dae8(0x1d2))/0x7*(-parseInt(_0x16dae8(0x145))/0x8)+-parseInt(_0x16dae8(0x141))/0x9*(parseInt(_0x16dae8(0x18f))/0xa)+-parseInt(_0x16dae8(0x1dd))/0xb*(parseInt(_0x16dae8(0x19f))/0xc)+-parseInt(_0x16dae8(0x1f0))/0xd*(-parseInt(_0x16dae8(0x1a6))/0xe);if(_0xd86b8===_0x2b299e)break;else _0x5b7b13['push'](_0x5b7b13['shift']());}catch(_0x4558a0){_0x5b7b13['push'](_0x5b7b13['shift']());}}}(_0x480d,0x9fe38));let sha256=require(_0x5cd69b(0x14e)),express=require(_0x5cd69b(0x1f8)),router=express[_0x5cd69b(0x1e3)](),cryptoUtils=require(_0x5cd69b(0x1eb)),netUtils=require('../utils/netUtils'),config=require('../../myConfig/config'),pathUtil=require(_0x5cd69b(0x1ba)),checkUtil=require(_0x5cd69b(0x16a));function _0x2513(_0xe8bfb7,_0xad15e){const _0x480deb=_0x480d();return _0x2513=function(_0x2513c7,_0x47c928){_0x2513c7=_0x2513c7-0x11c;let _0x2f2fb6=_0x480deb[_0x2513c7];return _0x2f2fb6;},_0x2513(_0xe8bfb7,_0xad15e);}var package=require(_0x5cd69b(0x1fc));const OS=require('os'),urlConfig=require(_0x5cd69b(0x135)),dbUserTable=require(_0x5cd69b(0x133)),dbLoginTable=require(_0x5cd69b(0x13d)),dbConfigTable=require('../../db/dbConfigTable'),dbNoticeCenterTable=require(_0x5cd69b(0x123)),dbMusicIndexTable=require(_0x5cd69b(0x175)),fileUtil=require(_0x5cd69b(0x201)),fs=require('fs'),path=require('path'),dbMovieFavorite=require(_0x5cd69b(0x125)),dbMusicFavorite=require(_0x5cd69b(0x1cd));router[_0x5cd69b(0x14d)]('/hasAdmin',(_0x2bdb47,_0x4c236e,_0xc2d33d)=>{const _0x54bfd4=_0x5cd69b;let _0x5c4ec7=dbUserTable[_0x54bfd4(0x1c6)](_0x2bdb47[_0x54bfd4(0x150)][_0x54bfd4(0x1cc)]),_0x59a5b6=dbConfigTable[_0x54bfd4(0x121)](_0x2bdb47[_0x54bfd4(0x150)][_0x54bfd4(0x1cc)],['customLogoImage',_0x54bfd4(0x139),_0x54bfd4(0x15a),'customHomeBgImage']);_0x4c236e[_0x54bfd4(0x13e)]({'code':0x0,'hasAdmin':_0x5c4ec7?'1':'0','customConfig':_0x59a5b6,'pagePrivacyUrl':urlConfig[_0x54bfd4(0x167)](_0x2bdb47[_0x54bfd4(0x150)][_0x54bfd4(0x1cc)],_0x54bfd4(0x152)),'pageAgreementUrl':urlConfig[_0x54bfd4(0x167)](_0x2bdb47[_0x54bfd4(0x150)][_0x54bfd4(0x1cc)],'pageUrl_agreement')});});let banIpList=[];function getIpBanConfig(_0x1068eb,_0x3e5f99){const _0xa1ef6b=_0x5cd69b;let _0x2d23b7=![],_0x27def4=0x1,_0x2ddd7f=0x1;if(_0x3e5f99!='localhost'){let _0x1aaee4=dbConfigTable['findByTitle'](_0x1068eb[_0xa1ef6b(0x150)][_0xa1ef6b(0x1cc)],_0xa1ef6b(0x17b));_0x1aaee4&&(_0x1aaee4=JSON[_0xa1ef6b(0x12b)](_0x1aaee4[_0xa1ef6b(0x177)]),_0x1aaee4&&(_0x1aaee4[_0xa1ef6b(0x12f)]&&(_0x2d23b7=!![]),_0x27def4=_0x1aaee4[_0xa1ef6b(0x18b)],_0x2ddd7f=_0x1aaee4[_0xa1ef6b(0x190)]));}return{'enableBan':_0x2d23b7,'maxTestCount':_0x27def4,'banTimeMin':_0x2ddd7f};}function addBanIp(_0x193e70,_0x2f6a4e,_0x1751e4){const _0xaf163e=_0x5cd69b;let {enableBan:_0x498322,maxTestCount:_0x5cd3a9,banTimeMin:_0x5bd942}=getIpBanConfig(_0x193e70,_0x1751e4);if(_0x498322){let _0x3cf711=null;for(let _0x5b77ad in banIpList){banIpList[_0x5b77ad]['ip']==_0x1751e4&&(_0x3cf711=banIpList[_0x5b77ad],banIpList[_0x5b77ad][_0xaf163e(0x18b)]+=0x1);}!_0x3cf711&&(_0x3cf711={'ip':_0x1751e4,'testCount':0x1},banIpList[_0xaf163e(0x1cf)](_0x3cf711));if(_0x3cf711[_0xaf163e(0x18b)]>=_0x5cd3a9){let _0x3a408e=new Date()['getTime'](),_0x1b7226=_0x3a408e+_0x5bd942*0x3c*0x3e8;dbLoginTable[_0xaf163e(0x11e)](_0x193e70[_0xaf163e(0x150)][_0xaf163e(0x1cc)],_0xaf163e(0x1d6),_0x1751e4,_0x1b7226,_0x2f6a4e['__']('login.pwdErrCountTooMuch')),_0x193e70[_0xaf163e(0x150)][_0xaf163e(0x170)](),dbNoticeCenterTable[_0xaf163e(0x1f1)](_0x193e70['app']['dbOther'],{'title':_0x2f6a4e['__']('login.loginFailAlert'),'level':'error','content':_0x2f6a4e['__'](_0xaf163e(0x1c1))+('['+_0x1751e4+']')});for(let _0x23a8cb in banIpList){banIpList[_0x23a8cb]['ip']==_0x1751e4&&banIpList['splice'](_0x23a8cb,0x1);}}}}router[_0x5cd69b(0x14d)](_0x5cd69b(0x11f),(_0x11f38a,_0x1783fb,_0x15a4e0)=>{const _0x3f09ef=_0x5cd69b;let _0xf46de9=_0x11f38a['body']['username'],_0x42d0dc=_0x11f38a[_0x3f09ef(0x14f)]['password'];if(!_0xf46de9||!_0x42d0dc)return _0x1783fb[_0x3f09ef(0x1ce)](0x194)[_0x3f09ef(0x1c2)]();_0x42d0dc=fileUtil[_0x3f09ef(0x1ed)](_0x42d0dc);let _0x55f8ce=netUtils[_0x3f09ef(0x126)](_0x11f38a);cryptoUtils[_0x3f09ef(0x17e)](config['passwordKey'],_0x42d0dc)['then'](_0x4444ee=>{const _0x223435=_0x3f09ef;let _0x3d4081=dbUserTable[_0x223435(0x202)](_0x11f38a[_0x223435(0x150)][_0x223435(0x1cc)],_0xf46de9,_0x4444ee);if(_0x3d4081){function _0x10b9f3(){const _0x452e72=_0x223435;if(_0x55f8ce!='localhost'){let _0x748740=dbConfigTable[_0x452e72(0x18e)](_0x11f38a[_0x452e72(0x150)][_0x452e72(0x1cc)],_0x452e72(0x188));if(_0x748740&&_0x748740[_0x452e72(0x177)]=='1'){let _0x38b837=_0x11f38a[_0x452e72(0x14f)]['answer'];if(_0x38b837){_0x38b837=sha256(_0x38b837);let _0x2d5ddc=dbUserTable[_0x452e72(0x1d0)](_0x11f38a['app'][_0x452e72(0x1cc)],_0xf46de9,_0x38b837);if(!_0x2d5ddc)return _0x11f38a[_0x452e72(0x150)][_0x452e72(0x1ea)](_0x1783fb,_0x1783fb['__']('login.answerIsWrong'));}else return _0x1783fb[_0x452e72(0x13e)]({'code':0x2,'question':_0x3d4081['question']});}}dbLoginTable[_0x452e72(0x124)](_0x11f38a[_0x452e72(0x150)]['dbOther'],_0x452e72(0x202),_0xf46de9,_0x55f8ce,_0x11f38a[_0x452e72(0x14f)][_0x452e72(0x1ff)],_0x11f38a[_0x452e72(0x1c9)][_0x452e72(0x1fb)]);let _0x2f48ed=sha256(new Date()[_0x452e72(0x12c)]()+_0xf46de9+_0x4444ee);var _0x248de7=_0x11f38a[_0x452e72(0x1c9)][_0x452e72(0x1fb)];return dbUserTable['createToken'](_0x11f38a['app']['dbOther'],_0x3d4081['id'],_0x2f48ed,_0x55f8ce,_0x248de7),_0x3d4081[_0x452e72(0x196)]='',_0x3d4081[_0x452e72(0x128)]='',_0x1783fb[_0x452e72(0x13e)]({'code':0x0,'token':_0x2f48ed,'user':_0x3d4081,'version':package[_0x452e72(0x129)],'reqIp':_0x55f8ce});}return _0x10b9f3();}else return addBanIp(_0x11f38a,_0x1783fb,_0x55f8ce),dbLoginTable[_0x223435(0x124)](_0x11f38a['app'][_0x223435(0x1cc)],_0x1783fb['__'](_0x223435(0x14a)),_0xf46de9,_0x55f8ce,_0x11f38a['body'][_0x223435(0x1ff)],_0x11f38a[_0x223435(0x1c9)][_0x223435(0x1fb)]),_0x11f38a['app'][_0x223435(0x1ea)](_0x1783fb,_0x1783fb['__']('login.wrongNameOrPwd'));})[_0x3f09ef(0x19c)](_0x2bab7a=>{const _0x302b01=_0x3f09ef;return console['log'](_0x2bab7a),_0x11f38a[_0x302b01(0x150)][_0x302b01(0x1ea)](_0x1783fb,_0x1783fb['__'](_0x302b01(0x185)));});}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x1db),(_0x322208,_0x38c398,_0x3244d5)=>{const _0x2230ca=_0x5cd69b;let _0xd9b31f=netUtils[_0x2230ca(0x126)](_0x322208),_0x598cc6=_0x322208['body'][_0x2230ca(0x15f)];if(!_0x598cc6)return _0x322208[_0x2230ca(0x150)][_0x2230ca(0x1ea)](_0x38c398,'Need\x20token');let _0x2de0ad=dbUserTable[_0x2230ca(0x143)](_0x322208[_0x2230ca(0x150)][_0x2230ca(0x1cc)],_0x598cc6);if(!_0x2de0ad)return _0x322208[_0x2230ca(0x150)][_0x2230ca(0x1ea)](_0x38c398,_0x38c398['__'](_0x2230ca(0x17f)));return _0x2de0ad[_0x2230ca(0x196)]='',_0x2de0ad[_0x2230ca(0x128)]='',_0x38c398[_0x2230ca(0x13e)]({'code':0x0,'token':_0x598cc6,'user':_0x2de0ad,'reqIp':_0xd9b31f});}),router['post'](_0x5cd69b(0x1c7),(_0x167aae,_0x57dbb8,_0x239421)=>{const _0x38b6cb=_0x5cd69b;let _0x4cbcfd=_0x167aae['body']['password'];if(_0x167aae[_0x38b6cb(0x1f9)]&&_0x167aae[_0x38b6cb(0x1f9)][_0x38b6cb(0x1f4)]!=0x1)return _0x57dbb8['json']({'code':0x66});cryptoUtils[_0x38b6cb(0x17e)](config[_0x38b6cb(0x18d)],_0x4cbcfd)[_0x38b6cb(0x171)](_0x10d871=>{const _0x2ad099=_0x38b6cb;if(_0x167aae['currentUser'][_0x2ad099(0x196)]!=_0x10d871)return _0x57dbb8[_0x2ad099(0x13e)]({'code':0x1,'message':_0x57dbb8['__'](_0x2ad099(0x162))});fs['rm'](path['join'](config[_0x2ad099(0x12a)]),{'recursive':!![]},_0x274989=>{const _0x40495b=_0x2ad099;if(_0x274989)return _0x57dbb8[_0x40495b(0x13e)]({'code':0x1,'message':_0x40495b(0x186)});return _0x167aae['app'][_0x40495b(0x1cc)]['prepare'](_0x40495b(0x161))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x1cc)]['prepare']('DELETE\x20FROM\x20album')[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x1cc)][_0x40495b(0x203)](_0x40495b(0x1fe))[_0x40495b(0x1a8)](),_0x167aae['app']['dbOther'][_0x40495b(0x203)](_0x40495b(0x19d))['run'](),_0x167aae[_0x40495b(0x150)]['dbOther']['prepare'](_0x40495b(0x165))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)]['dbOther'][_0x40495b(0x203)](_0x40495b(0x1b0))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x1cc)]['prepare'](_0x40495b(0x120))[_0x40495b(0x1a8)](),_0x167aae['app']['dbOther'][_0x40495b(0x203)]('DELETE\x20FROM\x20file_operation_record')['run'](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x1cc)]['prepare'](_0x40495b(0x181))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)]['dbOther'][_0x40495b(0x203)](_0x40495b(0x172))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x1cc)]['prepare'](_0x40495b(0x1aa))[_0x40495b(0x1a8)](),_0x167aae['app']['dbOther'][_0x40495b(0x203)](_0x40495b(0x14c))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x1cc)]['prepare']('DELETE\x20FROM\x20login_record')[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x1cc)]['prepare'](_0x40495b(0x1bc))[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x1cc)][_0x40495b(0x203)](_0x40495b(0x1cb))[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x1cc)][_0x40495b(0x203)]('DELETE\x20FROM\x20private_space')['run'](),_0x167aae[_0x40495b(0x150)]['dbOther'][_0x40495b(0x203)](_0x40495b(0x1e1))[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x1cc)][_0x40495b(0x203)]('DELETE\x20FROM\x20share_temp')[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x1cc)][_0x40495b(0x203)](_0x40495b(0x183))[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x1cc)][_0x40495b(0x203)](_0x40495b(0x1b7))['run'](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x1cc)][_0x40495b(0x203)](_0x40495b(0x1e5))['run'](),_0x167aae['app'][_0x40495b(0x1cc)][_0x40495b(0x203)]('DELETE\x20FROM\x20user_power')[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x1d1))['run'](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x1bd))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)]['prepare']('DELETE\x20FROM\x20album_ordinary')[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x1de))['run'](),_0x167aae[_0x40495b(0x150)]['dbFileIndex'][_0x40495b(0x203)](_0x40495b(0x1ef))['run'](),_0x167aae['app'][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x187))['run'](),_0x167aae[_0x40495b(0x150)]['dbFileIndex'][_0x40495b(0x203)]('DELETE\x20FROM\x20file_index_music')[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)]['dbFileIndex']['prepare']('DELETE\x20FROM\x20file_index_book')[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)]['prepare'](_0x40495b(0x144))[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x18a)][_0x40495b(0x203)]('DELETE\x20FROM\x20photo_faces2index')[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x18a)]['prepare']('DELETE\x20FROM\x20movie_keys')[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x18a)][_0x40495b(0x203)]('DELETE\x20FROM\x20movie_collection')['run'](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)][_0x40495b(0x203)]('DELETE\x20FROM\x20movie_history')[_0x40495b(0x1a8)](),_0x167aae['app'][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x1a7))['run'](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)]['prepare'](_0x40495b(0x155))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)]['prepare']('DELETE\x20FROM\x20music_favorite')[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)]['dbFileIndex'][_0x40495b(0x203)](_0x40495b(0x178))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x160))['run'](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x157))[_0x40495b(0x1a8)](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x1d3))['run'](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)]['prepare'](_0x40495b(0x1a2))['run'](),_0x167aae[_0x40495b(0x150)][_0x40495b(0x18a)][_0x40495b(0x203)](_0x40495b(0x13a))[_0x40495b(0x1a8)](),process[_0x40495b(0x1e7)]({'type':'fileShareRestart','shareType':_0x40495b(0x1f7)}),process['send']({'type':_0x40495b(0x1e2),'shareType':_0x40495b(0x17a)}),process[_0x40495b(0x1e7)]({'type':_0x40495b(0x163)}),process[_0x40495b(0x1e7)]({'type':_0x40495b(0x137)}),_0x57dbb8[_0x40495b(0x13e)]({'code':0x0});});});}),router[_0x5cd69b(0x14d)]('/resetPwdInfo',(_0x5f1e5e,_0x4bed40,_0x1f9cb2)=>{const _0xee1bf2=_0x5cd69b;let _0x250edf=netUtils[_0xee1bf2(0x126)](_0x5f1e5e),_0x5b7a08=dbUserTable[_0xee1bf2(0x1c6)](_0x5f1e5e[_0xee1bf2(0x150)]['dbOther']),_0x20a565={};_0x250edf==_0xee1bf2(0x13c)&&(_0x20a565[_0xee1bf2(0x1df)]=_0x5b7a08[_0xee1bf2(0x1df)]),_0x20a565['question']=_0x5b7a08[_0xee1bf2(0x19b)],_0x4bed40['json']({'code':0x0,'data':_0x20a565});}),router[_0x5cd69b(0x1b1)]('/checkIsNasServer',(_0x1b0d81,_0x47d69c,_0xef10eb)=>{const _0x3f896f=_0x5cd69b;let _0xa2cdde={'code':0x0,'message':_0x3f896f(0x180),'version':package[_0x3f896f(0x129)],'hostName':OS[_0x3f896f(0x12e)]()},_0x46bbac=_0x1b0d81[_0x3f896f(0x130)][_0x3f896f(0x122)];if(_0x46bbac&&_0x46bbac==0x1)return _0x47d69c[_0x3f896f(0x13e)](_0xa2cdde);let _0x4df5b0=0x50,_0x31ece4=dbConfigTable[_0x3f896f(0x18e)](_0x1b0d81[_0x3f896f(0x150)][_0x3f896f(0x1cc)],_0x3f896f(0x1be));_0x31ece4&&_0x31ece4[_0x3f896f(0x177)]&&(_0x4df5b0=_0x31ece4['value']);let _0x2054a3=0x1bb,_0x2b4edf=dbConfigTable[_0x3f896f(0x18e)](_0x1b0d81[_0x3f896f(0x150)][_0x3f896f(0x1cc)],'apiPortHttps');_0x2b4edf&&_0x2b4edf[_0x3f896f(0x177)]&&_0x2b4edf[_0x3f896f(0x177)]>0x0&&_0x2b4edf[_0x3f896f(0x177)]<0xffff&&(_0x2054a3=_0x2b4edf[_0x3f896f(0x177)]);let _0x15576a=0x0,_0x1b8047=dbConfigTable['findByTitle'](_0x1b0d81[_0x3f896f(0x150)][_0x3f896f(0x1cc)],_0x3f896f(0x1dc));if(_0x1b8047&&_0x1b8047[_0x3f896f(0x177)])try{_0x1b8047=JSON[_0x3f896f(0x12b)](_0x1b8047[_0x3f896f(0x177)]),_0x1b8047[_0x3f896f(0x1d7)]==_0x3f896f(0x1a8)&&(_0x15576a=0x1);}catch(_0x268a85){}try{let _0x9d605c=dbConfigTable['findByTitle'](_0x1b0d81[_0x3f896f(0x150)][_0x3f896f(0x1cc)],_0x3f896f(0x191)),_0x32d087=dbConfigTable[_0x3f896f(0x18e)](_0x1b0d81['app'][_0x3f896f(0x1cc)],_0x3f896f(0x184));if(_0x9d605c){_0x9d605c=JSON['parse'](_0x9d605c[_0x3f896f(0x177)]);let _0x1d06e3=[];if(_0x32d087&&_0x32d087[_0x3f896f(0x177)]){for(let _0x2797bf in _0x9d605c){let _0x16df6d=_0x9d605c[_0x2797bf];_0x16df6d[_0x3f896f(0x16c)]==_0x3f896f(0x1a4)&&_0x1d06e3[_0x3f896f(0x1cf)](_0x16df6d);}_0x1d06e3[_0x3f896f(0x1cf)]({'type':_0x3f896f(0x147),'ip':_0x32d087[_0x3f896f(0x177)],'ddns':0x1}),_0x9d605c=_0x1d06e3;}}return _0xa2cdde[_0x3f896f(0x166)]=_0x9d605c,_0xa2cdde['apiPort']=parseInt(_0x4df5b0),_0xa2cdde[_0x3f896f(0x1ca)]=parseInt(_0x2054a3),_0xa2cdde[_0x3f896f(0x14b)]=_0x15576a,_0x47d69c[_0x3f896f(0x13e)](_0xa2cdde);}catch(_0x5212cc){return _0x47d69c[_0x3f896f(0x13e)](_0xa2cdde);}}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x17c),(_0xdb3950,_0x2c0ef0,_0x2a3000)=>{const _0x28ab33=_0x5cd69b;let _0xec3ff=_0xdb3950[_0x28ab33(0x14f)][_0x28ab33(0x1df)],_0x196af0=_0xdb3950[_0x28ab33(0x14f)]['password'],_0x436c6e=_0xdb3950['body'][_0x28ab33(0x128)],_0x85b829=_0xdb3950[_0x28ab33(0x150)][_0x28ab33(0x1cc)][_0x28ab33(0x203)]('SELECT\x20*\x20FROM\x20user\x20WHERE\x20username=?')[_0x28ab33(0x193)](_0xec3ff);if(!_0x85b829)return _0xdb3950[_0x28ab33(0x150)]['returnErrMsg'](_0x2c0ef0,_0x2c0ef0['__'](_0x28ab33(0x156)));try{_0x436c6e=sha256(_0x436c6e);let _0x3e209e=dbUserTable[_0x28ab33(0x1d0)](_0xdb3950[_0x28ab33(0x150)]['dbOther'],_0xec3ff,_0x436c6e);if(_0x3e209e)cryptoUtils[_0x28ab33(0x17e)](config[_0x28ab33(0x18d)],_0x196af0)[_0x28ab33(0x171)](_0x203b03=>{const _0x4c2e1a=_0x28ab33;dbUserTable[_0x4c2e1a(0x16f)](_0xdb3950[_0x4c2e1a(0x150)][_0x4c2e1a(0x1cc)],_0xec3ff,_0x4c2e1a(0x196),_0x203b03);let _0x113c90=sha256(new Date()[_0x4c2e1a(0x12c)]()+_0xec3ff+_0x196af0);dbUserTable[_0x4c2e1a(0x16f)](_0xdb3950[_0x4c2e1a(0x150)]['dbOther'],_0xec3ff,_0x4c2e1a(0x15f),_0x113c90),_0x2c0ef0[_0x4c2e1a(0x13e)]({'code':0x0});})[_0x28ab33(0x19c)](_0x2d355c=>{const _0x48eba1=_0x28ab33;return console['log']('error',_0x2d355c),_0xdb3950[_0x48eba1(0x150)][_0x48eba1(0x1ea)](_0x2c0ef0,_0x2c0ef0['__'](_0x48eba1(0x185)));});else return _0xdb3950[_0x28ab33(0x150)][_0x28ab33(0x1ea)](_0x2c0ef0,_0x2c0ef0['__'](_0x28ab33(0x1e6)));}catch(_0x472459){return console['log'](_0x28ab33(0x1f2),_0x472459),_0x2c0ef0['status'](0x194)['end']();}});function _0x480d(){const _0x11c0ba=['deletePowerByUsername','question','catch','DELETE\x20FROM\x20backup_task_msg','log','1788TGcXLO','dialog','createOrUpdatePower','DELETE\x20FROM\x20book_list_index','usernameAndPwdCannotBeSame','ipv4','/changePassword','28lTjWVS','DELETE\x20FROM\x20movie_library','run','changes','DELETE\x20FROM\x20file_share_user','includes','292MGMnoR','login.adminAdded','changePassword','exports','DELETE\x20FROM\x20bg_task','all','answerQuestionCannotBeSame','\x201=1','ceil','\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?','params\x20error','DELETE\x20FROM\x20user','\x20end_timestamp\x20is\x20not\x20null\x20and\x20end_timestamp<','/cancelUserPathPower','path','getIpListCountByWhere','DELETE\x20FROM\x20notice_center','DELETE\x20FROM\x20ai_classes2index','apiPort','orderField','getAllIpListByWhere','login.tooManyPwdTestIpBan','end','newQuestion','/getCurrentUserInfo','removeUserPlayList','getAdmin','/resetSystem','/logout','headers','apiPortHttps','DELETE\x20FROM\x20play_record','dbOther','../../db/dbMusicFavorite','status','push','checkAnswer','DELETE\x20FROM\x20ai_classes','3543883oftMDv','DELETE\x20FROM\x20book_list','127.0.0.1','cancelUserPathPower','black','state','find','\x20offset\x20','stat','/tokenLogin','apiServerHttps','40436THDBzx','DELETE\x20FROM\x20album_ordinary_index','username','menus','DELETE\x20FROM\x20private_space_token','fileShareRestart','Router','getUserPower','DELETE\x20FROM\x20user_token','login.answerIsWrong','send','/addIpToList','login.oldPwdErr','returnErrMsg','../utils/cryptoUtils','login.adminExist','decodeBase64','deleteFavoriteByUid','DELETE\x20FROM\x20file_index_movie','11273535FQfTss','create','err','isSameStr','is_admin','/removeUser','menuList','FTP','express','currentUser','/registAdmin','user-agent','../../../package.json','isAdmin','DELETE\x20FROM\x20backup_task','client','pwdCannotBeChinese','../utils/fileUtils','login','prepare','uid','length','addIpToList','/login','DELETE\x20FROM\x20config\x20where\x20title\x20in\x20(\x27nasAccountInfo\x27)','findByTitleParamsList','ignoreIp','../../db/dbNoticeCenterTable','addLoginRecord','../../db/dbMovieFavorite','getClientIp','need\x20username/menuList','answer','version','cacheParentPath','parse','getTime','isEasyUsername','hostname','enable','query','deleteUserTokenByWhere','sep','../../db/dbUserTable','exist','../../myConfig/urlConfig','username\x20error','createUserFolder','path.parentPathExist','customLoginTitle','DELETE\x20FROM\x20book_read_record','\x20type=?','localhost','../../db/dbLoginTable','json','/remarkUser','startsWith','171yCqQTv','join','getUserByToken','DELETE\x20FROM\x20photo_faces','8GKEEWc','error','ipv6','\x20id\x20in(SELECT\x20id\x20FROM\x20login_record\x20ORDER\x20BY\x20id\x20LIMIT\x20','pageSize','login.wrongNameOrPwd','httpsIsRunning','DELETE\x20FROM\x20login_ip_list','post','sha256','body','app','usernameReg','pageUrl_privacy','updateQuestionById','/setUserPower','DELETE\x20FROM\x20photo_phash_similar','userNotExist','DELETE\x20FROM\x20book_favorite','\x20WHERE\x20username\x20like\x20?\x20or\x20user_remark\x20like\x20?','language','customLoginImage','page','460ThBORE','\x20ORDER\x20BY\x20','72096jbEkQo','token','DELETE\x20FROM\x20music_playlist_index','DELETE\x20FROM\x20config','login.pwdErr','nasProxyRestart','add','DELETE\x20FROM\x20backup_task_record','ipList','getUrlByUrlKey','72122tDSyDN','newPassword','../utils/checkUtil','updateRemarkByUsername','type','/getIpList','region','updateByUsername','refreshIpList','then','DELETE\x20FROM\x20file_share','asc','security.thisIpCannotAddList','../../db/dbMusicIndexTable','usernameTooEasy','value','DELETE\x20FROM\x20music_playlist','getUserByUserName','WebDav','ipBan','/resetPwd','19xxoMpr','encryptString','TokenExpired','NodeNasServer','DELETE\x20FROM\x20file_record','/setUserMenu','DELETE\x20FROM\x20source_folder','ddnsIpv6Address','operationFail','Error','DELETE\x20FROM\x20file_index_photo','twoStepLogin','^[0-9a-zA-Z]*$','dbFileIndex','testCount','orderType','passwordKey','findByTitle','121430BzShBu','banTime','globalIpList','\x20order\x20by\x20id\x20desc\x20limit\x20','get','user_remark','/getAllUser','password','deleteIp','oldPassword','25707Fzfptc'];_0x480d=function(){return _0x11c0ba;};return _0x480d();}function newUserCheck(_0x59307b,_0x2ee761,_0x2f536d,_0x427a54,_0x14ba26,_0x2f50fd){const _0x20909d=_0x5cd69b;if(!_0x427a54||!_0x2f536d||!_0x59307b||!_0x2ee761)return _0x14ba26[_0x20909d(0x150)][_0x20909d(0x1ea)](_0x2f50fd,_0x2f50fd['__']('newUserParamsNull'));let _0x224008=new RegExp(_0x20909d(0x189));if(!_0x224008['test'](_0x59307b)||_0x59307b==config['publicUserName'])return _0x14ba26[_0x20909d(0x150)]['returnErrMsg'](_0x2f50fd,_0x2f50fd['__'](_0x20909d(0x151)));if(_0x59307b==_0x2ee761)return _0x14ba26[_0x20909d(0x150)][_0x20909d(0x1ea)](_0x2f50fd,_0x2f50fd['__'](_0x20909d(0x1a3)));if(checkUtil[_0x20909d(0x12d)](_0x59307b))return _0x14ba26[_0x20909d(0x150)]['returnErrMsg'](_0x2f50fd,_0x2f50fd['__'](_0x20909d(0x176)));if(_0x2f536d==_0x427a54)return _0x14ba26['app'][_0x20909d(0x1ea)](_0x2f50fd,_0x2f50fd['__'](_0x20909d(0x1b2)));if(checkUtil['isIncludeChinese'](_0x2ee761))return _0x14ba26[_0x20909d(0x150)][_0x20909d(0x1ea)](_0x2f50fd,_0x2f50fd['__'](_0x20909d(0x200)));return!![];}router['post'](_0x5cd69b(0x1fa),(_0x50d776,_0x28593b,_0x597113)=>{const _0x395aae=_0x5cd69b;let _0x10064a=_0x50d776[_0x395aae(0x14f)]['username'],_0x4fc5bc=_0x50d776[_0x395aae(0x14f)][_0x395aae(0x196)],_0x5c1d84=_0x50d776[_0x395aae(0x14f)][_0x395aae(0x19b)],_0x500886=_0x50d776[_0x395aae(0x14f)][_0x395aae(0x128)];if(!_0x500886||!_0x5c1d84||!_0x10064a||!_0x4fc5bc)return _0x28593b[_0x395aae(0x13e)]({'code':0x1,'message':_0x395aae(0x1b6)});let _0x3c8f6a=dbUserTable['getAdmin'](_0x50d776[_0x395aae(0x150)][_0x395aae(0x1cc)]);if(_0x3c8f6a)_0x28593b['json']({'code':0x1,'message':_0x28593b['__'](_0x395aae(0x1ec))});else{if(newUserCheck(_0x10064a,_0x4fc5bc,_0x5c1d84,_0x500886,_0x50d776,_0x28593b)!==!![])return;_0x500886=sha256(_0x500886),cryptoUtils[_0x395aae(0x17e)](config[_0x395aae(0x18d)],_0x4fc5bc)[_0x395aae(0x171)](_0x56d472=>{const _0x28c23e=_0x395aae;let _0x2a367c=dbUserTable['create'](_0x50d776[_0x28c23e(0x150)][_0x28c23e(0x1cc)],{'username':_0x10064a,'password':_0x56d472,'question':_0x5c1d84,'answer':_0x500886,'is_admin':0x1});if(_0x2a367c[_0x28c23e(0x1a9)]>0x0){let _0x3aa073=dbUserTable['getAdmin'](_0x50d776[_0x28c23e(0x150)][_0x28c23e(0x1cc)]),_0xf12633=sha256(new Date()[_0x28c23e(0x12c)]()+_0x10064a+_0x56d472),_0x69eee8=netUtils[_0x28c23e(0x126)](_0x50d776);var _0x22fc00=_0x50d776['headers'][_0x28c23e(0x1fb)];dbUserTable['createToken'](_0x50d776['app']['dbOther'],_0x3aa073['id'],_0xf12633,_0x69eee8,_0x22fc00),_0x3aa073[_0x28c23e(0x196)]='';let _0x397eb4=_0x50d776[_0x28c23e(0x14f)][_0x28c23e(0x159)],_0x2cc8b1=_0x50d776[_0x28c23e(0x14f)][_0x28c23e(0x16e)];return _0x397eb4&&dbConfigTable['create'](_0x50d776[_0x28c23e(0x150)][_0x28c23e(0x1cc)],{'title':'language','value':_0x397eb4}),_0x2cc8b1&&dbConfigTable[_0x28c23e(0x1f1)](_0x50d776[_0x28c23e(0x150)][_0x28c23e(0x1cc)],{'title':_0x28c23e(0x16e),'value':_0x2cc8b1}),_0x28593b[_0x28c23e(0x13e)]({'code':0x0,'token':_0xf12633,'user':_0x3aa073});}})[_0x395aae(0x19c)](_0x30e34f=>{const _0x9249b5=_0x395aae;return console[_0x9249b5(0x19e)](_0x9249b5(0x146),_0x30e34f),_0x50d776[_0x9249b5(0x150)]['returnErrMsg'](_0x28593b,_0x28593b['__'](_0x9249b5(0x185)));});}}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x13f),(_0x5c1d91,_0x4cd48c,_0x2367aa)=>{const _0x952ff4=_0x5cd69b;if(_0x5c1d91[_0x952ff4(0x1f9)][_0x952ff4(0x1f4)]!=0x1)return _0x4cd48c[_0x952ff4(0x13e)]({'code':0x66});let _0x36d343=_0x5c1d91['body'][_0x952ff4(0x1df)],_0x10bf09=_0x5c1d91[_0x952ff4(0x14f)]['remark'];return _0x36d343&&_0x10bf09&&dbUserTable[_0x952ff4(0x16b)](_0x5c1d91['app'][_0x952ff4(0x1cc)],_0x36d343,_0x10bf09),_0x4cd48c[_0x952ff4(0x13e)]({'code':0x0});}),router[_0x5cd69b(0x14d)]('/addUser',(_0x34de67,_0x45949a,_0x48d4d4)=>{const _0xbd2a08=_0x5cd69b;let _0x21753d=_0x34de67[_0xbd2a08(0x14f)][_0xbd2a08(0x1df)],_0x579462=_0x34de67['body'][_0xbd2a08(0x196)],_0x54205d=_0x34de67[_0xbd2a08(0x14f)][_0xbd2a08(0x19b)],_0x2c70b=_0x34de67[_0xbd2a08(0x14f)]['answer'],_0x95e521=_0x34de67['body']['remark'];if(newUserCheck(_0x21753d,_0x579462,_0x54205d,_0x2c70b,_0x34de67,_0x45949a)!==!![])return;let _0x2520e4=_0x34de67[_0xbd2a08(0x14f)][_0xbd2a08(0x16c)];if(dbUserTable[_0xbd2a08(0x1fd)](_0x34de67,_0x45949a)===!![]){if(_0x2520e4==_0xbd2a08(0x164)){let _0x1f780a=dbUserTable['findByUsername'](_0x34de67['app'][_0xbd2a08(0x1cc)],_0x21753d);if(_0x1f780a)return _0x34de67[_0xbd2a08(0x150)][_0xbd2a08(0x1ea)](_0x45949a,_0x45949a['__']('login.sameUsernameExist'));}cryptoUtils[_0xbd2a08(0x17e)](config['passwordKey'],_0x579462)[_0xbd2a08(0x171)](_0x22c641=>{const _0x2a9945=_0xbd2a08;let _0x262a0b=dbUserTable[_0x2a9945(0x1f1)](_0x34de67[_0x2a9945(0x150)]['dbOther'],{'username':_0x21753d,'password':_0x22c641,'question':_0x54205d,'answer':sha256(_0x2c70b),'remark':_0x95e521});return _0x262a0b[_0x2a9945(0x1a9)]>=0x1?_0x45949a[_0x2a9945(0x13e)]({'code':0x0}):_0x34de67[_0x2a9945(0x150)][_0x2a9945(0x1ea)](_0x45949a,_0x45949a['__']('operationFail'));})[_0xbd2a08(0x19c)](_0x4e10bd=>{const _0x1385fc=_0xbd2a08;return console[_0x1385fc(0x19e)](_0x1385fc(0x146),_0x4e10bd),_0x34de67[_0x1385fc(0x150)][_0x1385fc(0x1ea)](_0x45949a,_0x45949a['__']('operationFail'));});}}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x1f5),(_0x3c18a2,_0x1dd8af,_0x4e9dc7)=>{const _0x5d3910=_0x5cd69b;let _0x3b4002=_0x3c18a2['body'][_0x5d3910(0x11c)];if(dbUserTable[_0x5d3910(0x1fd)](_0x3c18a2,_0x1dd8af)===!![]){let _0xfc1452=dbUserTable[_0x5d3910(0x1d8)](_0x3c18a2[_0x5d3910(0x150)][_0x5d3910(0x1cc)],_0x3b4002);if(_0xfc1452&&_0xfc1452[_0x5d3910(0x1f4)]==0x1)return _0x1dd8af[_0x5d3910(0x13e)]({'code':0x1,'message':'You\x20can\x27t\x20delete\x20admin\x20account'});dbUserTable[_0x5d3910(0x19a)](_0x3c18a2[_0x5d3910(0x150)]['dbOther'],_0xfc1452[_0x5d3910(0x1df)]),dbMusicIndexTable[_0x5d3910(0x1c5)](_0x3c18a2[_0x5d3910(0x150)][_0x5d3910(0x18a)],_0xfc1452['id']),dbMusicFavorite[_0x5d3910(0x1ee)](_0x3c18a2['app'][_0x5d3910(0x18a)],_0xfc1452['id']),dbMovieFavorite['deleteFavoriteByUid'](_0x3c18a2[_0x5d3910(0x150)][_0x5d3910(0x18a)],_0xfc1452['id']);let _0x487b0d=dbUserTable['delete'](_0x3c18a2['app'][_0x5d3910(0x1cc)],_0x3b4002);return _0x487b0d['changes']>=0x1?_0x1dd8af[_0x5d3910(0x13e)]({'code':0x0}):_0x3c18a2[_0x5d3910(0x150)][_0x5d3910(0x1ea)](_0x1dd8af,_0x1dd8af['__'](_0x5d3910(0x185)));}}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x195),(_0x5bfd08,_0x4f85e9,_0x15ea5c)=>{const _0x1744ef=_0x5cd69b;if(dbUserTable[_0x1744ef(0x1fd)](_0x5bfd08,_0x4f85e9)===!![]){let _0x2bcf75=_0x5bfd08['body'][_0x1744ef(0x1bf)]||'id',_0x3fe131=_0x5bfd08['body'][_0x1744ef(0x18c)]||_0x1744ef(0x173),_0x18fa2e=_0x5bfd08[_0x1744ef(0x14f)]['searchKey'];(!['id','username',_0x1744ef(0x194)][_0x1744ef(0x1ab)](_0x2bcf75)||![_0x1744ef(0x173),'desc'][_0x1744ef(0x1ab)](_0x3fe131))&&(_0x2bcf75='id',_0x3fe131='asc');let _0x460897='SELECT\x20id,username,is_admin,user_remark\x20FROM\x20user\x20',_0xad7c27=[];_0x18fa2e&&(_0x460897+=_0x1744ef(0x158),_0xad7c27[_0x1744ef(0x1cf)]('%'+_0x18fa2e+'%','%'+_0x18fa2e+'%'));_0x460897+=_0x1744ef(0x15d)+_0x2bcf75+'\x20'+_0x3fe131;let _0x1fa3bb=_0x5bfd08['app'][_0x1744ef(0x1cc)]['prepare'](_0x460897)[_0x1744ef(0x1b1)](_0xad7c27);return _0x4f85e9[_0x1744ef(0x13e)]({'code':0x0,'userList':_0x1fa3bb});}}),router['post']('/getUserPower',(_0x3e3df5,_0x1a41a6,_0x772e81)=>{const _0x706290=_0x5cd69b;let _0x487182=_0x3e3df5[_0x706290(0x14f)]['username'],_0x91d1db=null;if(_0x487182!=config['publicUserName']){_0x91d1db=dbUserTable[_0x706290(0x179)](_0x3e3df5[_0x706290(0x150)][_0x706290(0x1cc)],_0x487182);if(!_0x91d1db)return _0x3e3df5[_0x706290(0x150)][_0x706290(0x1ea)](_0x1a41a6,_0x706290(0x136));}if(dbUserTable[_0x706290(0x1fd)](_0x3e3df5,_0x1a41a6)===!![]||_0x487182==_0x3e3df5['currentUser'][_0x706290(0x1df)]){let _0x3ef84a=dbUserTable['getUserPower'](_0x3e3df5['app'][_0x706290(0x1cc)],_0x487182,null,null,!![]),_0x484ccf=0x0;if(_0x3ef84a[_0x706290(0x11d)]<0x1)return _0x1a41a6[_0x706290(0x13e)]({'code':0x0,'userPower':_0x3ef84a,'userMenu':_0x91d1db?_0x91d1db[_0x706290(0x1e0)]:[]});for(let _0x2ee5e4=0x0;_0x2ee5e4<_0x3ef84a[_0x706290(0x11d)];_0x2ee5e4++){let _0x4ace46=_0x3ef84a[_0x2ee5e4][_0x706290(0x1ba)];fs[_0x706290(0x1da)](_0x4ace46,(_0x2a45dc,_0x35dce6)=>{const _0x41ef07=_0x706290;_0x484ccf+=0x1;_0x2a45dc?_0x3ef84a[_0x2ee5e4][_0x41ef07(0x134)]=0x0:_0x3ef84a[_0x2ee5e4][_0x41ef07(0x134)]=0x1;if(_0x484ccf==_0x3ef84a[_0x41ef07(0x11d)])return _0x1a41a6[_0x41ef07(0x13e)]({'code':0x0,'userPower':_0x3ef84a,'userMenu':_0x91d1db?_0x91d1db[_0x41ef07(0x1e0)]:[]});});}}}),router['post'](_0x5cd69b(0x154),(_0x53e040,_0x3aa5fd,_0x39c7bf)=>{const _0x33e937=_0x5cd69b;let _0x250d31=_0x53e040[_0x33e937(0x14f)][_0x33e937(0x1df)],_0x2e6179=_0x53e040[_0x33e937(0x14f)][_0x33e937(0x1ba)],_0x4b59ae=_0x53e040['body']['server_type'];if(!_0x250d31||!_0x2e6179||!_0x4b59ae)return _0x53e040['app'][_0x33e937(0x1ea)](_0x3aa5fd,_0x3aa5fd['__'](_0x33e937(0x185)));let _0xb21cdb=null;if(_0x250d31!=config['publicUserName']){_0xb21cdb=dbUserTable[_0x33e937(0x179)](_0x53e040[_0x33e937(0x150)]['dbOther'],_0x250d31);if(!_0xb21cdb)return _0x53e040[_0x33e937(0x150)][_0x33e937(0x1ea)](_0x3aa5fd,_0x33e937(0x136));}_0x2e6179=pathUtil[_0x33e937(0x142)](_0x2e6179);if(dbUserTable[_0x33e937(0x1fd)](_0x53e040,_0x3aa5fd)===!![]){let _0x410ced=dbUserTable[_0x33e937(0x1e4)](_0x53e040[_0x33e937(0x150)][_0x33e937(0x1cc)],_0x250d31,_0x4b59ae,null,!![]);for(let _0x74dcc2 of _0x410ced){let _0x30bfd1=_0x74dcc2[_0x33e937(0x1ba)];if(_0x2e6179['startsWith'](pathUtil['join'](_0x30bfd1,pathUtil['sep']))&&_0x2e6179!=_0x30bfd1)return _0x53e040[_0x33e937(0x150)][_0x33e937(0x1ea)](_0x3aa5fd,_0x3aa5fd['__'](_0x33e937(0x138))+_0x30bfd1,'dialog');if(_0x30bfd1[_0x33e937(0x140)](pathUtil[_0x33e937(0x142)](_0x2e6179,pathUtil[_0x33e937(0x132)]))&&_0x2e6179!=_0x30bfd1)return _0x53e040['app'][_0x33e937(0x1ea)](_0x3aa5fd,_0x3aa5fd['__']('path.parentPathExist')+_0x30bfd1,_0x33e937(0x1a0));}let _0x9d8bc1=dbUserTable[_0x33e937(0x1a1)](_0x53e040['app'][_0x33e937(0x1cc)],_0x53e040[_0x33e937(0x14f)]);return _0x3aa5fd['json']({'code':0x0,'result':_0x9d8bc1});}}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x182),(_0x1fab5c,_0xb96c8c,_0x37eaa)=>{const _0x4f50c0=_0x5cd69b;let _0x537180=_0x1fab5c[_0x4f50c0(0x14f)][_0x4f50c0(0x1df)],_0x277aee=_0x1fab5c[_0x4f50c0(0x14f)][_0x4f50c0(0x1f6)];if(!_0x537180||!(_0x277aee instanceof Array))return _0x1fab5c[_0x4f50c0(0x150)]['returnErrMsg'](_0xb96c8c,_0x4f50c0(0x127));let _0xc1748a=dbUserTable[_0x4f50c0(0x179)](_0x1fab5c[_0x4f50c0(0x150)][_0x4f50c0(0x1cc)],_0x537180);if(!_0xc1748a)return _0x1fab5c['app'][_0x4f50c0(0x1ea)](_0xb96c8c,_0x4f50c0(0x136));if(dbUserTable[_0x4f50c0(0x1fd)](_0x1fab5c,_0xb96c8c)===!![])return dbUserTable['updateByUsername'](_0x1fab5c['app'][_0x4f50c0(0x1cc)],_0x537180,'menus',JSON['stringify'](_0x277aee)),_0xb96c8c[_0x4f50c0(0x13e)]({'code':0x0});}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x1b9),(_0x414c6a,_0x5d6021,_0x4b620d)=>{const _0x3f0fe0=_0x5cd69b;let _0x1162b3=dbUserTable[_0x3f0fe0(0x1d5)](_0x414c6a[_0x3f0fe0(0x150)]['dbOther'],_0x414c6a[_0x3f0fe0(0x14f)]);return _0x1162b3['changes']>0x0?_0x5d6021['json']({'code':0x0}):_0x414c6a['app']['returnErrMsg'](_0x5d6021,_0x5d6021['__'](_0x3f0fe0(0x185)));}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x1a5),(_0x4cd35b,_0x21656d,_0x5e79e4)=>{const _0x2981b3=_0x5cd69b;let _0x17eeeb=_0x4cd35b[_0x2981b3(0x14f)][_0x2981b3(0x198)],_0x5adeb1=_0x4cd35b[_0x2981b3(0x14f)][_0x2981b3(0x169)];cryptoUtils[_0x2981b3(0x17e)](config['passwordKey'],_0x17eeeb)[_0x2981b3(0x171)](_0x218a12=>{const _0x582c76=_0x2981b3;if(_0x4cd35b[_0x582c76(0x1f9)]['password']!=_0x218a12)return _0x21656d['json']({'code':0x2,'message':_0x21656d['__'](_0x582c76(0x1e9))});else cryptoUtils[_0x582c76(0x17e)](config[_0x582c76(0x18d)],_0x5adeb1)[_0x582c76(0x171)](_0x541c5d=>{const _0x48e099=_0x582c76;dbUserTable['updateById'](_0x4cd35b['app']['dbOther'],_0x4cd35b[_0x48e099(0x1f9)]['id'],_0x48e099(0x196),_0x541c5d);let _0x25ed41=sha256(new Date()[_0x48e099(0x12c)]()+_0x4cd35b['currentUser']['username']+_0x4cd35b[_0x48e099(0x1f9)][_0x48e099(0x196)]);dbUserTable['updateById'](_0x4cd35b['app'][_0x48e099(0x1cc)],_0x4cd35b[_0x48e099(0x1f9)]['id'],_0x48e099(0x15f),_0x25ed41);let _0x40da33=netUtils[_0x48e099(0x126)](_0x4cd35b);return dbLoginTable[_0x48e099(0x124)](_0x4cd35b[_0x48e099(0x150)][_0x48e099(0x1cc)],_0x48e099(0x1ae),_0x4cd35b[_0x48e099(0x1f9)]['id'],_0x40da33,_0x4cd35b[_0x48e099(0x14f)]['client'],''),_0x21656d[_0x48e099(0x13e)]({'code':0x0});})[_0x582c76(0x19c)](_0x2458d4=>{const _0x1e2754=_0x582c76;return console[_0x1e2754(0x19e)](_0x1e2754(0x146),_0x2458d4),_0x4cd35b[_0x1e2754(0x150)][_0x1e2754(0x1ea)](_0x21656d,_0x21656d['__'](_0x1e2754(0x185)));});});}),router[_0x5cd69b(0x14d)]('/changeQuestion',(_0x35e3d9,_0x52bdf7,_0x127280)=>{const _0x178747=_0x5cd69b;let _0x3f1e16=_0x35e3d9['body'][_0x178747(0x1c3)],_0xa31106=_0x35e3d9['body'][_0x178747(0x128)];if(checkUtil[_0x178747(0x1f3)](_0xa31106))return _0x35e3d9['app'][_0x178747(0x1ea)](_0x52bdf7,_0x52bdf7['__']('answerNotSeqNumOrChar'));if(_0x3f1e16==_0xa31106)return _0x35e3d9['app']['returnErrMsg'](_0x52bdf7,_0x52bdf7['__'](_0x178747(0x1b2)));return dbUserTable[_0x178747(0x153)](_0x35e3d9[_0x178747(0x150)][_0x178747(0x1cc)],_0x35e3d9[_0x178747(0x1f9)]['id'],_0x3f1e16,sha256(_0xa31106)),_0x52bdf7[_0x178747(0x13e)]({'code':0x0});}),router['post'](_0x5cd69b(0x1c8),(_0x266562,_0x2cffa4,_0x2c7949)=>{const _0x281406=_0x5cd69b;let _0x1e533a=_0x266562[_0x281406(0x14f)]['token'];return _0x1e533a&&dbUserTable[_0x281406(0x131)](_0x266562[_0x281406(0x150)][_0x281406(0x1cc)],'\x20WHERE\x20token\x20=?',[_0x1e533a]),_0x2cffa4[_0x281406(0x13e)]({'code':0x0});}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x1c4),(_0x30a7e1,_0x13acaf,_0x3929a4)=>{const _0x141635=_0x5cd69b;let _0x169831=dbUserTable[_0x141635(0x1d8)](_0x30a7e1[_0x141635(0x150)][_0x141635(0x1cc)],_0x30a7e1[_0x141635(0x1f9)]['id']);return _0x169831?(_0x169831[_0x141635(0x196)]='',_0x169831['answer']='',_0x13acaf[_0x141635(0x13e)]({'code':0x0,'userInfo':_0x169831})):_0x13acaf[_0x141635(0x13e)]({'code':0x65});}),router['post'](_0x5cd69b(0x1e8),(_0x4e3c4d,_0x242fe7,_0x252f05)=>{const _0x39fb50=_0x5cd69b;if(_0x4e3c4d['currentUser']['is_admin']!=0x1)return _0x242fe7[_0x39fb50(0x13e)]({'code':0x66});let _0x3efc0b=_0x4e3c4d[_0x39fb50(0x14f)]['ip'];if(_0x3efc0b==_0x39fb50(0x13c)||_0x3efc0b==_0x39fb50(0x1d4))return _0x4e3c4d['app'][_0x39fb50(0x1ea)](_0x242fe7,_0x242fe7['__'](_0x39fb50(0x174)));let _0x2c4bef=_0x4e3c4d[_0x39fb50(0x14f)]['type'],_0xc335ab=_0x4e3c4d[_0x39fb50(0x14f)]['banTimeStamp'];return dbLoginTable[_0x39fb50(0x11e)](_0x4e3c4d['app'][_0x39fb50(0x1cc)],_0x2c4bef,_0x3efc0b,_0xc335ab,_0x242fe7['__'](_0x39fb50(0x1ad))),_0x4e3c4d['app'][_0x39fb50(0x170)](),_0x242fe7[_0x39fb50(0x13e)]({'code':0x0});}),router[_0x5cd69b(0x14d)]('/removeIp',(_0xc35c45,_0x437b08,_0x4fb44b)=>{const _0xa228c7=_0x5cd69b;if(_0xc35c45[_0xa228c7(0x1f9)][_0xa228c7(0x1f4)]!=0x1)return _0x437b08[_0xa228c7(0x13e)]({'code':0x66});let _0x30af60=_0xc35c45[_0xa228c7(0x14f)]['id'];return dbLoginTable[_0xa228c7(0x197)](_0xc35c45[_0xa228c7(0x150)]['dbOther'],_0x30af60),_0xc35c45[_0xa228c7(0x150)][_0xa228c7(0x170)](),_0x437b08['json']({'code':0x0});}),router[_0x5cd69b(0x14d)](_0x5cd69b(0x16d),(_0x36da2b,_0x3773b3,_0xd7153c)=>{const _0x554faf=_0x5cd69b;let _0x160354=_0x36da2b[_0x554faf(0x14f)][_0x554faf(0x15b)],_0x4181f0=_0x36da2b['body'][_0x554faf(0x149)],_0xdb653f=_0x36da2b[_0x554faf(0x14f)][_0x554faf(0x16c)],_0x4b5c1a=new Date()[_0x554faf(0x12c)]();dbLoginTable['deleteIpByWhere'](_0x36da2b[_0x554faf(0x150)][_0x554faf(0x1cc)],_0x554faf(0x1b8)+_0x4b5c1a);let _0x4ef28d='\x20type=\x27'+_0xdb653f+'\x27',_0x29ebee=dbLoginTable[_0x554faf(0x1bb)](_0x36da2b['app']['dbOther'],_0x4ef28d),_0x1857f1=(_0x160354-0x1)*_0x4181f0;_0x4ef28d+=_0x554faf(0x192)+_0x4181f0+_0x554faf(0x1d9)+_0x1857f1;let _0xd26f05=dbLoginTable[_0x554faf(0x1c0)](_0x36da2b[_0x554faf(0x150)][_0x554faf(0x1cc)],_0x4ef28d);return _0x3773b3[_0x554faf(0x13e)]({'code':0x0,'data':_0xd26f05,'pageCount':Math[_0x554faf(0x1b4)](_0x29ebee['count']/_0x4181f0)});}),router[_0x5cd69b(0x14d)]('/getRecordList',(_0x1584a6,_0x896de0,_0x235920)=>{const _0x3460dd=_0x5cd69b;if(_0x1584a6['currentUser'][_0x3460dd(0x1f4)]!=0x1)return _0x896de0['json']({'code':0x66});let _0xe0dac7=0x1388,_0x2d96f0=_0x1584a6[_0x3460dd(0x14f)][_0x3460dd(0x15b)],_0x1c1ee3=_0x1584a6['body'][_0x3460dd(0x149)],_0x5d542b=_0x1584a6[_0x3460dd(0x14f)]['type'],_0x50db4c='',_0x24e8e1=[];_0x5d542b?(_0x50db4c+=_0x3460dd(0x13b),_0x24e8e1['push'](_0x5d542b)):_0x50db4c=_0x3460dd(0x1b3);let _0x1147a9=dbLoginTable['getRecordCountByWhere'](_0x1584a6[_0x3460dd(0x150)][_0x3460dd(0x1cc)],_0x50db4c,_0x24e8e1)['count'];if(_0x1147a9>_0xe0dac7){let _0x4a3134=0x64,_0x2fd8b0=dbLoginTable['deleteRecordByWhere'](_0x1584a6[_0x3460dd(0x150)][_0x3460dd(0x1cc)],_0x3460dd(0x148)+_0x4a3134+')');_0x2fd8b0['changes']>0x0&&(_0x1147a9=_0x1147a9-_0x2fd8b0['changes']);}let _0xc45ac0=(_0x2d96f0-0x1)*_0x1c1ee3;_0x50db4c+=_0x3460dd(0x1b5),_0x24e8e1[_0x3460dd(0x1cf)](_0x1c1ee3),_0x24e8e1[_0x3460dd(0x1cf)](_0xc45ac0);let _0x296d88=dbLoginTable['getAllRecordByWhere'](_0x1584a6[_0x3460dd(0x150)][_0x3460dd(0x1cc)],_0x50db4c,_0x24e8e1);return _0x896de0[_0x3460dd(0x13e)]({'code':0x0,'data':_0x296d88,'pageCount':Math[_0x3460dd(0x1b4)](_0x1147a9/_0x1c1ee3)});}),module[_0x5cd69b(0x1af)]=router;