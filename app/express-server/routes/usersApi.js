const _0xbe142f=_0x424f;function _0x428a(){const _0x282ed2=['DELETE\x20FROM\x20book_list_index','ipBan','newPassword','sha256','post','userNotExist','DELETE\x20FROM\x20album_ordinary','type','returnErrMsg','\x20WHERE\x20username\x20like\x20?\x20or\x20user_remark\x20like\x20?','page','length','black','../utils/checkUtil','56684YDDcLn','Need\x20token','\x20type=\x27','includes','login.tooManyPwdTestIpBan','../utils/netUtils','/resetPwd','pwdCannotBeChinese','stringify','changes','security.thisIpCannotAddList','desc','dbFileIndex','DELETE\x20FROM\x20user','login','../../myConfig/urlConfig','getRecordCountByWhere','SELECT\x20*\x20FROM\x20user\x20WHERE\x20username=?','menuList','answerQuestionCannotBeSame','DELETE\x20FROM\x20album','1453266vzmMPq','localhost','body','asc','You\x20can\x27t\x20delete\x20admin\x20account','then','ipList','addLoginRecord','login.loginFailAlert','count','isEasyUsername','region','need\x20username/menuList','39qFWKNY','searchKey','DELETE\x20FROM\x20source_folder','DELETE\x20FROM\x20file_index_photo','remark','splice','json','query','dbOther','getTime','catch','login.wrongNameOrPwd','language','10190aUshrH','DELETE\x20FROM\x20album_ordinary_index','testCount','getClientIp','/removeIp','checkAnswer','is_admin','refreshIpList','findByTitleParamsList','login.pwdErr','\x20type=?','DELETE\x20FROM\x20movie_collection','/setUserMenu','state','answerNotSeqNumOrChar','login.oldPwdErr','createToken','NodeNasServer','changePassword','answer','login.adminExist','DELETE\x20FROM\x20file_record','DELETE\x20FROM\x20music_favorite','add','orderField','cancelUserPathPower','FTP','54egIUxl','send','user_remark','DELETE\x20FROM\x20login_ip_list','../../db/dbNoticeCenterTable','\x20order\x20by\x20id\x20desc\x20limit\x20','startsWith','createOrUpdatePower','DELETE\x20FROM\x20photo_phash_similar','getUrlByUrlKey','err','end','DELETE\x20FROM\x20backup_task','1716008JQbuEu','createUserFolder','prepare','/addIpToList','deletePowerByUsername','127.0.0.1','/getRecordList','status','DELETE\x20FROM\x20book_read_record','DELETE\x20FROM\x20share_temp','\x20id\x20in(SELECT\x20id\x20FROM\x20login_record\x20ORDER\x20BY\x20id\x20LIMIT\x20','join','publicUserName','globalIpList','banTime','getUserByToken','4489276uRoLln','DELETE\x20FROM\x20file_index_movie','dialog','ipv6','username','/checkIsNasServer','^[0-9a-zA-Z]*$','fileShareRestart','getAllIpListByWhere','/login','express','apiPort','encryptString','12IPVfpe','isSameStr','operationFail','user-agent','14UpPCMq','../../myConfig/config','SELECT\x20id,username,is_admin,user_remark\x20FROM\x20user\x20','username\x20error','/setUserPower','DELETE\x20FROM\x20play_record','passwordKey','Router','run','DELETE\x20FROM\x20backup_task_record','error','question','1020280TNHcsM','/changePassword','login.pwdErrCountTooMuch','currentUser','DELETE\x20FROM\x20file_share_user','all','getAdmin','DELETE\x20FROM\x20bg_task','WebDav','create','enable','pageUrl_privacy','../../db/dbLoginTable','deleteFavoriteByUid','deleteRecordByWhere','DELETE\x20FROM\x20photo_faces','../../db/dbMusicFavorite','customLoginImage','find','pageSize','DELETE\x20FROM\x20book_favorite','token','path','delete','customLoginTitle','getUserByUserName','69910gZInFr','get','login.answerIsWrong','/resetSystem','ceil','isAdmin','/hasAdmin','Error','menus','apiServerHttps','ignoreIp','decodeBase64','hostname','DELETE\x20FROM\x20movie_library','parse','TokenExpired','/getCurrentUserInfo','app','log','customLogoImage','params\x20error','/registAdmin','banTimeStamp','path.parentPathExist','DELETE\x20FROM\x20backup_task_msg','DELETE\x20FROM\x20music_playlist','DELETE\x20FROM\x20user_power','updateByUsername','DELETE\x20FROM\x20private_space_token','newUserParamsNull','getUserPower','exist','login.adminAdded','headers','DELETE\x20FROM\x20file_index_book','DELETE\x20FROM\x20config\x20where\x20title\x20in\x20(\x27nasAccountInfo\x27)','isIncludeChinese','getIpListCountByWhere','/logout','../utils/fileUtils','DELETE\x20FROM\x20private_space','newQuestion','client','\x20end_timestamp\x20is\x20not\x20null\x20and\x20end_timestamp<','getAllRecordByWhere','findByTitle','addIpToList','uid','usernameTooEasy','oldPassword','7CQzcFN','value','password','push','\x20WHERE\x20token\x20=?','stat'];_0x428a=function(){return _0x282ed2;};return _0x428a();}(function(_0x472be0,_0x343e33){const _0x2a9dd7=_0x424f,_0x54d803=_0x472be0();while(!![]){try{const _0x20dbf9=parseInt(_0x2a9dd7(0xec))/0x1*(parseInt(_0x2a9dd7(0x135))/0x2)+-parseInt(_0x2a9dd7(0xdf))/0x3*(-parseInt(_0x2a9dd7(0xbd))/0x4)+parseInt(_0x2a9dd7(0x141))/0x5+parseInt(_0x2a9dd7(0xd2))/0x6*(parseInt(_0x2a9dd7(0xa9))/0x7)+-parseInt(_0x2a9dd7(0x114))/0x8+parseInt(_0x2a9dd7(0x107))/0x9*(parseInt(_0x2a9dd7(0x15b))/0xa)+parseInt(_0x2a9dd7(0x124))/0xb*(-parseInt(_0x2a9dd7(0x131))/0xc);if(_0x20dbf9===_0x343e33)break;else _0x54d803['push'](_0x54d803['shift']());}catch(_0x99f963){_0x54d803['push'](_0x54d803['shift']());}}}(_0x428a,0x1d93d));let sha256=require(_0xbe142f(0xb2)),express=require(_0xbe142f(0x12e)),router=express[_0xbe142f(0x13c)](),cryptoUtils=require('../utils/cryptoUtils'),netUtils=require(_0xbe142f(0xc2)),config=require(_0xbe142f(0x136)),pathUtil=require('path'),checkUtil=require(_0xbe142f(0xbc));var package=require('../../../package.json');const OS=require('os'),urlConfig=require(_0xbe142f(0xcc)),dbUserTable=require('../../db/dbUserTable'),dbLoginTable=require(_0xbe142f(0x14d)),dbConfigTable=require('../../db/dbConfigTable'),dbNoticeCenterTable=require(_0xbe142f(0x10b)),dbMusicIndexTable=require('../../db/dbMusicIndexTable'),fileUtil=require(_0xbe142f(0x182)),fs=require('fs'),path=require(_0xbe142f(0x157)),dbMovieFavorite=require('../../db/dbMovieFavorite'),dbMusicFavorite=require(_0xbe142f(0x151));function _0x424f(_0x861232,_0x166aee){const _0x428a49=_0x428a();return _0x424f=function(_0x424f99,_0xc15230){_0x424f99=_0x424f99-0xa5;let _0x3dbadf=_0x428a49[_0x424f99];return _0x3dbadf;},_0x424f(_0x861232,_0x166aee);}router[_0xbe142f(0xb3)](_0xbe142f(0x161),(_0x272359,_0x4572c2,_0x26a343)=>{const _0x4f3a13=_0xbe142f;let _0x32ee4c=dbUserTable[_0x4f3a13(0x147)](_0x272359[_0x4f3a13(0x16c)][_0x4f3a13(0xe7)]),_0x351bf9=dbConfigTable[_0x4f3a13(0xf4)](_0x272359[_0x4f3a13(0x16c)]['dbOther'],[_0x4f3a13(0x16e),_0x4f3a13(0x159),_0x4f3a13(0x152),'customHomeBgImage']);_0x4572c2['json']({'code':0x0,'hasAdmin':_0x32ee4c?'1':'0','customConfig':_0x351bf9,'pagePrivacyUrl':urlConfig[_0x4f3a13(0x110)](_0x272359['app'][_0x4f3a13(0xe7)],_0x4f3a13(0x14c)),'pageAgreementUrl':urlConfig[_0x4f3a13(0x110)](_0x272359[_0x4f3a13(0x16c)][_0x4f3a13(0xe7)],'pageUrl_agreement')});});let banIpList=[];function getIpBanConfig(_0x37a6a0,_0x1cd279){const _0x2b0d0d=_0xbe142f;let _0x4eb398=![],_0x260d80=0x1,_0x36bafe=0x1;if(_0x1cd279!=_0x2b0d0d(0xd3)){let _0x50c257=dbConfigTable[_0x2b0d0d(0x188)](_0x37a6a0['app'][_0x2b0d0d(0xe7)],_0x2b0d0d(0xb0));_0x50c257&&(_0x50c257=JSON[_0x2b0d0d(0x169)](_0x50c257[_0x2b0d0d(0xaa)]),_0x50c257&&(_0x50c257[_0x2b0d0d(0x14b)]&&(_0x4eb398=!![]),_0x260d80=_0x50c257[_0x2b0d0d(0xee)],_0x36bafe=_0x50c257[_0x2b0d0d(0x122)]));}return{'enableBan':_0x4eb398,'maxTestCount':_0x260d80,'banTimeMin':_0x36bafe};}function addBanIp(_0x378558,_0x3b58ed,_0xd65570){const _0x13678e=_0xbe142f;let {enableBan:_0x37322c,maxTestCount:_0x50370a,banTimeMin:_0x196d49}=getIpBanConfig(_0x378558,_0xd65570);if(_0x37322c){let _0x535e82=null;for(let _0x597367 in banIpList){banIpList[_0x597367]['ip']==_0xd65570&&(_0x535e82=banIpList[_0x597367],banIpList[_0x597367][_0x13678e(0xee)]+=0x1);}!_0x535e82&&(_0x535e82={'ip':_0xd65570,'testCount':0x1},banIpList[_0x13678e(0xac)](_0x535e82));if(_0x535e82[_0x13678e(0xee)]>=_0x50370a){let _0x2eddb8=new Date()[_0x13678e(0xe8)](),_0x3279b2=_0x2eddb8+_0x196d49*0x3c*0x3e8;dbLoginTable[_0x13678e(0xa5)](_0x378558['app']['dbOther'],_0x13678e(0xbb),_0xd65570,_0x3279b2,_0x3b58ed['__'](_0x13678e(0x143))),_0x378558[_0x13678e(0x16c)][_0x13678e(0xf3)](),dbNoticeCenterTable['create'](_0x378558[_0x13678e(0x16c)]['dbOther'],{'title':_0x3b58ed['__'](_0x13678e(0xda)),'level':_0x13678e(0x13f),'content':_0x3b58ed['__'](_0x13678e(0xc1))+('['+_0xd65570+']')});for(let _0x2ee5b9 in banIpList){banIpList[_0x2ee5b9]['ip']==_0xd65570&&banIpList[_0x13678e(0xe4)](_0x2ee5b9,0x1);}}}}router['post'](_0xbe142f(0x12d),(_0x1fc501,_0x391bd3,_0x1371d3)=>{const _0x1a4206=_0xbe142f;let _0x13af33=_0x1fc501['body'][_0x1a4206(0x128)],_0xee77b0=_0x1fc501[_0x1a4206(0xd4)][_0x1a4206(0xab)];if(!_0x13af33||!_0xee77b0)return _0x391bd3[_0x1a4206(0x11b)](0x194)['end']();_0xee77b0=fileUtil[_0x1a4206(0x166)](_0xee77b0);let _0x405377=netUtils[_0x1a4206(0xef)](_0x1fc501);cryptoUtils[_0x1a4206(0x130)](config[_0x1a4206(0x13b)],_0xee77b0)[_0x1a4206(0xd7)](_0x8f80a0=>{const _0x2e2b9d=_0x1a4206;let _0x433b87=dbUserTable[_0x2e2b9d(0xcb)](_0x1fc501[_0x2e2b9d(0x16c)][_0x2e2b9d(0xe7)],_0x13af33,_0x8f80a0);if(_0x433b87){function _0x80f9b3(){const _0x458b64=_0x2e2b9d;if(_0x405377!=_0x458b64(0xd3)){let _0x34b836=dbConfigTable['findByTitle'](_0x1fc501[_0x458b64(0x16c)]['dbOther'],'twoStepLogin');if(_0x34b836&&_0x34b836[_0x458b64(0xaa)]=='1'){let _0x5a75b9=_0x1fc501[_0x458b64(0xd4)][_0x458b64(0xff)];if(_0x5a75b9){_0x5a75b9=sha256(_0x5a75b9);let _0xcb0bab=dbUserTable[_0x458b64(0xf1)](_0x1fc501[_0x458b64(0x16c)][_0x458b64(0xe7)],_0x13af33,_0x5a75b9);if(!_0xcb0bab)return _0x1fc501[_0x458b64(0x16c)]['returnErrMsg'](_0x391bd3,_0x391bd3['__'](_0x458b64(0x15d)));}else return _0x391bd3[_0x458b64(0xe5)]({'code':0x2,'question':_0x433b87['question']});}}dbLoginTable[_0x458b64(0xd9)](_0x1fc501['app'][_0x458b64(0xe7)],'login',_0x13af33,_0x405377,_0x1fc501['body'][_0x458b64(0x185)],_0x1fc501[_0x458b64(0x17c)][_0x458b64(0x134)]);let _0x7612=sha256(new Date()[_0x458b64(0xe8)]()+_0x13af33+_0x8f80a0);var _0x30b5ce=_0x1fc501[_0x458b64(0x17c)][_0x458b64(0x134)];return dbUserTable[_0x458b64(0xfc)](_0x1fc501['app'][_0x458b64(0xe7)],_0x433b87['id'],_0x7612,_0x405377,_0x30b5ce),_0x433b87[_0x458b64(0xab)]='',_0x433b87['answer']='',_0x391bd3[_0x458b64(0xe5)]({'code':0x0,'token':_0x7612,'user':_0x433b87,'version':package['version'],'reqIp':_0x405377});}return _0x80f9b3();}else return addBanIp(_0x1fc501,_0x391bd3,_0x405377),dbLoginTable[_0x2e2b9d(0xd9)](_0x1fc501[_0x2e2b9d(0x16c)][_0x2e2b9d(0xe7)],_0x391bd3['__']('login.wrongNameOrPwd'),_0x13af33,_0x405377,_0x1fc501[_0x2e2b9d(0xd4)][_0x2e2b9d(0x185)],_0x1fc501[_0x2e2b9d(0x17c)][_0x2e2b9d(0x134)]),_0x1fc501['app'][_0x2e2b9d(0xb7)](_0x391bd3,_0x391bd3['__'](_0x2e2b9d(0xea)));})[_0x1a4206(0xe9)](_0x37a5fd=>{const _0x51207a=_0x1a4206;return console[_0x51207a(0x16d)](_0x37a5fd),_0x1fc501['app']['returnErrMsg'](_0x391bd3,_0x391bd3['__'](_0x51207a(0x133)));});}),router['post']('/tokenLogin',(_0x419d58,_0x5a822f,_0x5bbd18)=>{const _0x3379c3=_0xbe142f;let _0x2c805c=netUtils[_0x3379c3(0xef)](_0x419d58),_0x1fd180=_0x419d58[_0x3379c3(0xd4)][_0x3379c3(0x156)];if(!_0x1fd180)return _0x419d58['app'][_0x3379c3(0xb7)](_0x5a822f,_0x3379c3(0xbe));let _0x2dcbe6=dbUserTable[_0x3379c3(0x123)](_0x419d58[_0x3379c3(0x16c)][_0x3379c3(0xe7)],_0x1fd180);if(!_0x2dcbe6)return _0x419d58['app'][_0x3379c3(0xb7)](_0x5a822f,_0x5a822f['__'](_0x3379c3(0x16a)));return _0x2dcbe6[_0x3379c3(0xab)]='',_0x2dcbe6[_0x3379c3(0xff)]='',_0x5a822f[_0x3379c3(0xe5)]({'code':0x0,'token':_0x1fd180,'user':_0x2dcbe6,'reqIp':_0x2c805c});}),router[_0xbe142f(0xb3)](_0xbe142f(0x15e),(_0x1da3b2,_0x113b53,_0x1e96b0)=>{const _0x39a3d0=_0xbe142f;let _0x5a411a=_0x1da3b2[_0x39a3d0(0xd4)][_0x39a3d0(0xab)];if(_0x1da3b2[_0x39a3d0(0x144)]&&_0x1da3b2[_0x39a3d0(0x144)][_0x39a3d0(0xf2)]!=0x1)return _0x113b53[_0x39a3d0(0xe5)]({'code':0x66});cryptoUtils['encryptString'](config[_0x39a3d0(0x13b)],_0x5a411a)[_0x39a3d0(0xd7)](_0x2d25d6=>{const _0x22c43f=_0x39a3d0;if(_0x1da3b2[_0x22c43f(0x144)][_0x22c43f(0xab)]!=_0x2d25d6)return _0x113b53['json']({'code':0x1,'message':_0x113b53['__'](_0x22c43f(0xf5))});fs['rm'](path[_0x22c43f(0x11f)](config['cacheParentPath']),{'recursive':!![]},_0x5ecea9=>{const _0x1c55f5=_0x22c43f;if(_0x5ecea9)return _0x113b53[_0x1c55f5(0xe5)]({'code':0x1,'message':_0x1c55f5(0x162)});return _0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)]['prepare']('DELETE\x20FROM\x20config')[_0x1c55f5(0x13d)](),_0x1da3b2['app']['dbOther'][_0x1c55f5(0x116)](_0x1c55f5(0xd1))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)][_0x1c55f5(0x116)](_0x1c55f5(0x113))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)][_0x1c55f5(0x116)](_0x1c55f5(0x173))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)]['prepare'](_0x1c55f5(0x13e))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)][_0x1c55f5(0x116)](_0x1c55f5(0x148))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)]['dbOther'][_0x1c55f5(0x116)](_0x1c55f5(0x17e))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)]['prepare']('DELETE\x20FROM\x20file_operation_record')[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)][_0x1c55f5(0x116)](_0x1c55f5(0x101))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)][_0x1c55f5(0x116)]('DELETE\x20FROM\x20file_share')[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)]['dbOther'][_0x1c55f5(0x116)](_0x1c55f5(0x145))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)]['dbOther']['prepare'](_0x1c55f5(0x10a))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)][_0x1c55f5(0x116)]('DELETE\x20FROM\x20login_record')[_0x1c55f5(0x13d)](),_0x1da3b2['app'][_0x1c55f5(0xe7)][_0x1c55f5(0x116)]('DELETE\x20FROM\x20notice_center')['run'](),_0x1da3b2[_0x1c55f5(0x16c)]['dbOther']['prepare'](_0x1c55f5(0x13a))[_0x1c55f5(0x13d)](),_0x1da3b2['app'][_0x1c55f5(0xe7)][_0x1c55f5(0x116)](_0x1c55f5(0x183))[_0x1c55f5(0x13d)](),_0x1da3b2['app'][_0x1c55f5(0xe7)]['prepare'](_0x1c55f5(0x177))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)]['dbOther'][_0x1c55f5(0x116)](_0x1c55f5(0x11d))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)][_0x1c55f5(0x116)](_0x1c55f5(0xe1))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)]['dbOther']['prepare'](_0x1c55f5(0xca))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xe7)]['prepare']('DELETE\x20FROM\x20user_token')[_0x1c55f5(0x13d)](),_0x1da3b2['app'][_0x1c55f5(0xe7)][_0x1c55f5(0x116)](_0x1c55f5(0x175))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)]['dbFileIndex']['prepare']('DELETE\x20FROM\x20ai_classes')[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)]('DELETE\x20FROM\x20ai_classes2index')[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0xb5))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0xed))['run'](),_0x1da3b2[_0x1c55f5(0x16c)]['dbFileIndex']['prepare'](_0x1c55f5(0x125))[_0x1c55f5(0x13d)](),_0x1da3b2['app'][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0xe2))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)]['prepare']('DELETE\x20FROM\x20file_index_music')['run'](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0x17d))['run'](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0x150))['run'](),_0x1da3b2[_0x1c55f5(0x16c)]['dbFileIndex']['prepare']('DELETE\x20FROM\x20photo_faces2index')[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)]['prepare']('DELETE\x20FROM\x20movie_keys')['run'](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0xf7))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)]('DELETE\x20FROM\x20movie_history')[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)]['dbFileIndex'][_0x1c55f5(0x116)](_0x1c55f5(0x168))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0x10f))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0x102))[_0x1c55f5(0x13d)](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0x174))['run'](),_0x1da3b2['app'][_0x1c55f5(0xc9)][_0x1c55f5(0x116)]('DELETE\x20FROM\x20music_playlist_index')['run'](),_0x1da3b2['app'][_0x1c55f5(0xc9)][_0x1c55f5(0x116)](_0x1c55f5(0x155))['run'](),_0x1da3b2[_0x1c55f5(0x16c)][_0x1c55f5(0xc9)][_0x1c55f5(0x116)]('DELETE\x20FROM\x20book_list')[_0x1c55f5(0x13d)](),_0x1da3b2['app']['dbFileIndex'][_0x1c55f5(0x116)](_0x1c55f5(0xaf))['run'](),_0x1da3b2['app']['dbFileIndex']['prepare'](_0x1c55f5(0x11c))[_0x1c55f5(0x13d)](),process['send']({'type':_0x1c55f5(0x12b),'shareType':_0x1c55f5(0x106)}),process[_0x1c55f5(0x108)]({'type':_0x1c55f5(0x12b),'shareType':_0x1c55f5(0x149)}),process['send']({'type':'nasProxyRestart'}),process[_0x1c55f5(0x108)]({'type':_0x1c55f5(0x115)}),_0x113b53['json']({'code':0x0});});});}),router[_0xbe142f(0xb3)]('/resetPwdInfo',(_0x4bde6c,_0x337d0e,_0x5ef894)=>{const _0x4bc5ae=_0xbe142f;let _0x4cbdd2=netUtils['getClientIp'](_0x4bde6c),_0x11f5ea=dbUserTable[_0x4bc5ae(0x147)](_0x4bde6c[_0x4bc5ae(0x16c)]['dbOther']),_0x5ad0a4={};_0x4cbdd2==_0x4bc5ae(0xd3)&&(_0x5ad0a4['username']=_0x11f5ea['username']),_0x5ad0a4[_0x4bc5ae(0x140)]=_0x11f5ea[_0x4bc5ae(0x140)],_0x337d0e[_0x4bc5ae(0xe5)]({'code':0x0,'data':_0x5ad0a4});}),router[_0xbe142f(0x146)](_0xbe142f(0x129),(_0x8e5b4d,_0x1f62d0,_0x262a84)=>{const _0x4f30ad=_0xbe142f;let _0x4334eb={'code':0x0,'message':_0x4f30ad(0xfd),'version':package['version'],'hostName':OS[_0x4f30ad(0x167)]()},_0x1c5c78=_0x8e5b4d[_0x4f30ad(0xe6)][_0x4f30ad(0x165)];if(_0x1c5c78&&_0x1c5c78==0x1)return _0x1f62d0['json'](_0x4334eb);let _0x2fb6cf=0x50,_0x51cd58=dbConfigTable[_0x4f30ad(0x188)](_0x8e5b4d['app']['dbOther'],_0x4f30ad(0x12f));_0x51cd58&&_0x51cd58['value']&&(_0x2fb6cf=_0x51cd58[_0x4f30ad(0xaa)]);let _0x2ac8bf=0x1bb,_0x4c380b=dbConfigTable[_0x4f30ad(0x188)](_0x8e5b4d['app']['dbOther'],'apiPortHttps');_0x4c380b&&_0x4c380b[_0x4f30ad(0xaa)]&&_0x4c380b[_0x4f30ad(0xaa)]>0x0&&_0x4c380b[_0x4f30ad(0xaa)]<0xffff&&(_0x2ac8bf=_0x4c380b[_0x4f30ad(0xaa)]);let _0x75facd=0x0,_0x2d8562=dbConfigTable[_0x4f30ad(0x188)](_0x8e5b4d['app'][_0x4f30ad(0xe7)],_0x4f30ad(0x164));if(_0x2d8562&&_0x2d8562[_0x4f30ad(0xaa)])try{_0x2d8562=JSON['parse'](_0x2d8562[_0x4f30ad(0xaa)]),_0x2d8562[_0x4f30ad(0xf9)]==_0x4f30ad(0x13d)&&(_0x75facd=0x1);}catch(_0x1b4c66){}try{let _0x2fc23a=dbConfigTable[_0x4f30ad(0x188)](_0x8e5b4d[_0x4f30ad(0x16c)][_0x4f30ad(0xe7)],_0x4f30ad(0x121)),_0x2259a8=dbConfigTable['findByTitle'](_0x8e5b4d[_0x4f30ad(0x16c)][_0x4f30ad(0xe7)],'ddnsIpv6Address');if(_0x2fc23a){_0x2fc23a=JSON['parse'](_0x2fc23a['value']);let _0x326902=[];if(_0x2259a8&&_0x2259a8['value']){for(let _0x397a83 in _0x2fc23a){let _0x156737=_0x2fc23a[_0x397a83];_0x156737[_0x4f30ad(0xb6)]=='ipv4'&&_0x326902[_0x4f30ad(0xac)](_0x156737);}_0x326902[_0x4f30ad(0xac)]({'type':_0x4f30ad(0x127),'ip':_0x2259a8[_0x4f30ad(0xaa)],'ddns':0x1}),_0x2fc23a=_0x326902;}}return _0x4334eb[_0x4f30ad(0xd8)]=_0x2fc23a,_0x4334eb[_0x4f30ad(0x12f)]=parseInt(_0x2fb6cf),_0x4334eb['apiPortHttps']=parseInt(_0x2ac8bf),_0x4334eb['httpsIsRunning']=_0x75facd,_0x1f62d0['json'](_0x4334eb);}catch(_0xae296c){return _0x1f62d0[_0x4f30ad(0xe5)](_0x4334eb);}}),router[_0xbe142f(0xb3)](_0xbe142f(0xc3),(_0x478f54,_0x3c6448,_0xe28065)=>{const _0x208a41=_0xbe142f;let _0x4d1521=_0x478f54['body'][_0x208a41(0x128)],_0x4dc987=_0x478f54['body'][_0x208a41(0xab)],_0x20ad77=_0x478f54[_0x208a41(0xd4)][_0x208a41(0xff)],_0xb04cf3=_0x478f54['app'][_0x208a41(0xe7)]['prepare'](_0x208a41(0xce))[_0x208a41(0x15c)](_0x4d1521);if(!_0xb04cf3)return _0x478f54['app'][_0x208a41(0xb7)](_0x3c6448,_0x3c6448['__'](_0x208a41(0xb4)));try{_0x20ad77=sha256(_0x20ad77);let _0x215d97=dbUserTable['checkAnswer'](_0x478f54[_0x208a41(0x16c)][_0x208a41(0xe7)],_0x4d1521,_0x20ad77);if(_0x215d97)cryptoUtils['encryptString'](config[_0x208a41(0x13b)],_0x4dc987)[_0x208a41(0xd7)](_0x3ec8dc=>{const _0x51907a=_0x208a41;dbUserTable['updateByUsername'](_0x478f54[_0x51907a(0x16c)][_0x51907a(0xe7)],_0x4d1521,'password',_0x3ec8dc);let _0x3122cd=sha256(new Date()[_0x51907a(0xe8)]()+_0x4d1521+_0x4dc987);dbUserTable['updateByUsername'](_0x478f54[_0x51907a(0x16c)][_0x51907a(0xe7)],_0x4d1521,_0x51907a(0x156),_0x3122cd),_0x3c6448['json']({'code':0x0});})[_0x208a41(0xe9)](_0x3cde56=>{const _0x3e5721=_0x208a41;return console[_0x3e5721(0x16d)]('error',_0x3cde56),_0x478f54[_0x3e5721(0x16c)][_0x3e5721(0xb7)](_0x3c6448,_0x3c6448['__'](_0x3e5721(0x133)));});else return _0x478f54['app'][_0x208a41(0xb7)](_0x3c6448,_0x3c6448['__']('login.answerIsWrong'));}catch(_0x21ceff){return console[_0x208a41(0x16d)](_0x208a41(0x111),_0x21ceff),_0x3c6448['status'](0x194)[_0x208a41(0x112)]();}});function newUserCheck(_0x2b6673,_0x5e29b1,_0xb3f605,_0xdb0421,_0x86cff7,_0x24ac26){const _0x5744f3=_0xbe142f;if(!_0xdb0421||!_0xb3f605||!_0x2b6673||!_0x5e29b1)return _0x86cff7[_0x5744f3(0x16c)]['returnErrMsg'](_0x24ac26,_0x24ac26['__'](_0x5744f3(0x178)));let _0x431e4f=new RegExp(_0x5744f3(0x12a));if(!_0x431e4f['test'](_0x2b6673)||_0x2b6673==config[_0x5744f3(0x120)])return _0x86cff7[_0x5744f3(0x16c)][_0x5744f3(0xb7)](_0x24ac26,_0x24ac26['__']('usernameReg'));if(_0x2b6673==_0x5e29b1)return _0x86cff7[_0x5744f3(0x16c)][_0x5744f3(0xb7)](_0x24ac26,_0x24ac26['__']('usernameAndPwdCannotBeSame'));if(checkUtil[_0x5744f3(0xdc)](_0x2b6673))return _0x86cff7[_0x5744f3(0x16c)][_0x5744f3(0xb7)](_0x24ac26,_0x24ac26['__'](_0x5744f3(0xa7)));if(_0xb3f605==_0xdb0421)return _0x86cff7['app'][_0x5744f3(0xb7)](_0x24ac26,_0x24ac26['__']('answerQuestionCannotBeSame'));if(checkUtil[_0x5744f3(0x17f)](_0x5e29b1))return _0x86cff7['app'][_0x5744f3(0xb7)](_0x24ac26,_0x24ac26['__'](_0x5744f3(0xc4)));return!![];}router[_0xbe142f(0xb3)](_0xbe142f(0x170),(_0x5e5d74,_0x1f002e,_0x41c51a)=>{const _0x34d3dc=_0xbe142f;let _0x427285=_0x5e5d74[_0x34d3dc(0xd4)][_0x34d3dc(0x128)],_0x1f74af=_0x5e5d74[_0x34d3dc(0xd4)][_0x34d3dc(0xab)],_0x513b10=_0x5e5d74[_0x34d3dc(0xd4)][_0x34d3dc(0x140)],_0x2828cf=_0x5e5d74['body'][_0x34d3dc(0xff)];if(!_0x2828cf||!_0x513b10||!_0x427285||!_0x1f74af)return _0x1f002e[_0x34d3dc(0xe5)]({'code':0x1,'message':_0x34d3dc(0x16f)});let _0x5e3cd1=dbUserTable[_0x34d3dc(0x147)](_0x5e5d74[_0x34d3dc(0x16c)]['dbOther']);if(_0x5e3cd1)_0x1f002e['json']({'code':0x1,'message':_0x1f002e['__'](_0x34d3dc(0x100))});else{if(newUserCheck(_0x427285,_0x1f74af,_0x513b10,_0x2828cf,_0x5e5d74,_0x1f002e)!==!![])return;_0x2828cf=sha256(_0x2828cf),cryptoUtils['encryptString'](config[_0x34d3dc(0x13b)],_0x1f74af)[_0x34d3dc(0xd7)](_0x41e308=>{const _0x290bc0=_0x34d3dc;let _0x134f6a=dbUserTable[_0x290bc0(0x14a)](_0x5e5d74[_0x290bc0(0x16c)][_0x290bc0(0xe7)],{'username':_0x427285,'password':_0x41e308,'question':_0x513b10,'answer':_0x2828cf,'is_admin':0x1});if(_0x134f6a[_0x290bc0(0xc6)]>0x0){let _0x1da461=dbUserTable[_0x290bc0(0x147)](_0x5e5d74[_0x290bc0(0x16c)][_0x290bc0(0xe7)]),_0x5f28b8=sha256(new Date()[_0x290bc0(0xe8)]()+_0x427285+_0x41e308),_0x58327f=netUtils[_0x290bc0(0xef)](_0x5e5d74);var _0x1b8666=_0x5e5d74[_0x290bc0(0x17c)]['user-agent'];dbUserTable[_0x290bc0(0xfc)](_0x5e5d74[_0x290bc0(0x16c)][_0x290bc0(0xe7)],_0x1da461['id'],_0x5f28b8,_0x58327f,_0x1b8666),_0x1da461['password']='';let _0x4ca639=_0x5e5d74[_0x290bc0(0xd4)][_0x290bc0(0xeb)],_0x5cec95=_0x5e5d74[_0x290bc0(0xd4)][_0x290bc0(0xdd)];return _0x4ca639&&dbConfigTable[_0x290bc0(0x14a)](_0x5e5d74[_0x290bc0(0x16c)][_0x290bc0(0xe7)],{'title':_0x290bc0(0xeb),'value':_0x4ca639}),_0x5cec95&&dbConfigTable['create'](_0x5e5d74[_0x290bc0(0x16c)]['dbOther'],{'title':_0x290bc0(0xdd),'value':_0x5cec95}),_0x1f002e[_0x290bc0(0xe5)]({'code':0x0,'token':_0x5f28b8,'user':_0x1da461});}})[_0x34d3dc(0xe9)](_0x53fce3=>{const _0x30ec79=_0x34d3dc;return console['log'](_0x30ec79(0x13f),_0x53fce3),_0x5e5d74[_0x30ec79(0x16c)]['returnErrMsg'](_0x1f002e,_0x1f002e['__'](_0x30ec79(0x133)));});}}),router[_0xbe142f(0xb3)]('/remarkUser',(_0x5b2395,_0x323282,_0x913500)=>{const _0xd555f3=_0xbe142f;if(_0x5b2395[_0xd555f3(0x144)][_0xd555f3(0xf2)]!=0x1)return _0x323282[_0xd555f3(0xe5)]({'code':0x66});let _0x304336=_0x5b2395['body']['username'],_0xff1174=_0x5b2395[_0xd555f3(0xd4)]['remark'];return _0x304336&&_0xff1174&&dbUserTable['updateRemarkByUsername'](_0x5b2395[_0xd555f3(0x16c)][_0xd555f3(0xe7)],_0x304336,_0xff1174),_0x323282[_0xd555f3(0xe5)]({'code':0x0});}),router[_0xbe142f(0xb3)]('/addUser',(_0x866af4,_0x35ad64,_0x2a1929)=>{const _0xc2d711=_0xbe142f;let _0x110358=_0x866af4[_0xc2d711(0xd4)][_0xc2d711(0x128)],_0x4a810a=_0x866af4[_0xc2d711(0xd4)]['password'],_0x32e769=_0x866af4['body'][_0xc2d711(0x140)],_0x4bf84e=_0x866af4[_0xc2d711(0xd4)][_0xc2d711(0xff)],_0x3d1d75=_0x866af4[_0xc2d711(0xd4)][_0xc2d711(0xe3)];if(newUserCheck(_0x110358,_0x4a810a,_0x32e769,_0x4bf84e,_0x866af4,_0x35ad64)!==!![])return;let _0x173bf5=_0x866af4[_0xc2d711(0xd4)]['type'];if(dbUserTable[_0xc2d711(0x160)](_0x866af4,_0x35ad64)===!![]){if(_0x173bf5==_0xc2d711(0x103)){let _0x427342=dbUserTable['findByUsername'](_0x866af4[_0xc2d711(0x16c)][_0xc2d711(0xe7)],_0x110358);if(_0x427342)return _0x866af4['app'][_0xc2d711(0xb7)](_0x35ad64,_0x35ad64['__']('login.sameUsernameExist'));}cryptoUtils[_0xc2d711(0x130)](config[_0xc2d711(0x13b)],_0x4a810a)[_0xc2d711(0xd7)](_0x4b0a5e=>{const _0x3db02c=_0xc2d711;let _0x2591d7=dbUserTable[_0x3db02c(0x14a)](_0x866af4[_0x3db02c(0x16c)][_0x3db02c(0xe7)],{'username':_0x110358,'password':_0x4b0a5e,'question':_0x32e769,'answer':sha256(_0x4bf84e),'remark':_0x3d1d75});return _0x2591d7[_0x3db02c(0xc6)]>=0x1?_0x35ad64[_0x3db02c(0xe5)]({'code':0x0}):_0x866af4[_0x3db02c(0x16c)][_0x3db02c(0xb7)](_0x35ad64,_0x35ad64['__'](_0x3db02c(0x133)));})[_0xc2d711(0xe9)](_0x492af2=>{const _0x2fea4b=_0xc2d711;return console[_0x2fea4b(0x16d)](_0x2fea4b(0x13f),_0x492af2),_0x866af4[_0x2fea4b(0x16c)][_0x2fea4b(0xb7)](_0x35ad64,_0x35ad64['__'](_0x2fea4b(0x133)));});}}),router[_0xbe142f(0xb3)]('/removeUser',(_0x9eca29,_0x2557ac,_0x5149dc)=>{const _0x47eebe=_0xbe142f;let _0x3dd4e6=_0x9eca29[_0x47eebe(0xd4)][_0x47eebe(0xa6)];if(dbUserTable[_0x47eebe(0x160)](_0x9eca29,_0x2557ac)===!![]){let _0x3ab433=dbUserTable[_0x47eebe(0x153)](_0x9eca29[_0x47eebe(0x16c)][_0x47eebe(0xe7)],_0x3dd4e6);if(_0x3ab433&&_0x3ab433[_0x47eebe(0xf2)]==0x1)return _0x2557ac[_0x47eebe(0xe5)]({'code':0x1,'message':_0x47eebe(0xd6)});dbUserTable[_0x47eebe(0x118)](_0x9eca29[_0x47eebe(0x16c)][_0x47eebe(0xe7)],_0x3ab433['username']),dbMusicIndexTable['removeUserPlayList'](_0x9eca29[_0x47eebe(0x16c)][_0x47eebe(0xc9)],_0x3ab433['id']),dbMusicFavorite[_0x47eebe(0x14e)](_0x9eca29[_0x47eebe(0x16c)][_0x47eebe(0xc9)],_0x3ab433['id']),dbMovieFavorite[_0x47eebe(0x14e)](_0x9eca29['app'][_0x47eebe(0xc9)],_0x3ab433['id']);let _0x3f039e=dbUserTable[_0x47eebe(0x158)](_0x9eca29[_0x47eebe(0x16c)][_0x47eebe(0xe7)],_0x3dd4e6);return _0x3f039e['changes']>=0x1?_0x2557ac[_0x47eebe(0xe5)]({'code':0x0}):_0x9eca29[_0x47eebe(0x16c)]['returnErrMsg'](_0x2557ac,_0x2557ac['__'](_0x47eebe(0x133)));}}),router[_0xbe142f(0xb3)]('/getAllUser',(_0x5f3da3,_0x2d9922,_0x3974b7)=>{const _0x47792a=_0xbe142f;if(dbUserTable[_0x47792a(0x160)](_0x5f3da3,_0x2d9922)===!![]){let _0x10ceae=_0x5f3da3[_0x47792a(0xd4)][_0x47792a(0x104)]||'id',_0x5247fa=_0x5f3da3[_0x47792a(0xd4)]['orderType']||_0x47792a(0xd5),_0x2f4840=_0x5f3da3[_0x47792a(0xd4)][_0x47792a(0xe0)];(!['id','username',_0x47792a(0x109)]['includes'](_0x10ceae)||![_0x47792a(0xd5),_0x47792a(0xc8)][_0x47792a(0xc0)](_0x5247fa))&&(_0x10ceae='id',_0x5247fa=_0x47792a(0xd5));let _0x58aac0=_0x47792a(0x137),_0x5b5409=[];_0x2f4840&&(_0x58aac0+=_0x47792a(0xb8),_0x5b5409[_0x47792a(0xac)]('%'+_0x2f4840+'%','%'+_0x2f4840+'%'));_0x58aac0+='\x20ORDER\x20BY\x20'+_0x10ceae+'\x20'+_0x5247fa;let _0x9baddb=_0x5f3da3[_0x47792a(0x16c)]['dbOther'][_0x47792a(0x116)](_0x58aac0)['all'](_0x5b5409);return _0x2d9922['json']({'code':0x0,'userList':_0x9baddb});}}),router['post']('/getUserPower',(_0x72ac3,_0x51707f,_0x25c7b5)=>{const _0x529558=_0xbe142f;let _0x18dd3d=_0x72ac3['body'][_0x529558(0x128)],_0x2eab38=null;if(_0x18dd3d!=config[_0x529558(0x120)]){_0x2eab38=dbUserTable[_0x529558(0x15a)](_0x72ac3[_0x529558(0x16c)]['dbOther'],_0x18dd3d);if(!_0x2eab38)return _0x72ac3[_0x529558(0x16c)]['returnErrMsg'](_0x51707f,_0x529558(0x138));}if(dbUserTable['isAdmin'](_0x72ac3,_0x51707f)===!![]||_0x18dd3d==_0x72ac3[_0x529558(0x144)][_0x529558(0x128)]){let _0x27016c=dbUserTable['getUserPower'](_0x72ac3['app'][_0x529558(0xe7)],_0x18dd3d,null,null,!![]),_0x55fe3a=0x0;if(_0x27016c[_0x529558(0xba)]<0x1)return _0x51707f['json']({'code':0x0,'userPower':_0x27016c,'userMenu':_0x2eab38?_0x2eab38['menus']:[]});for(let _0x42437f=0x0;_0x42437f<_0x27016c[_0x529558(0xba)];_0x42437f++){let _0x202f71=_0x27016c[_0x42437f][_0x529558(0x157)];fs[_0x529558(0xae)](_0x202f71,(_0x33c9f6,_0x22ffed)=>{const _0xc0e0ce=_0x529558;_0x55fe3a+=0x1;_0x33c9f6?_0x27016c[_0x42437f][_0xc0e0ce(0x17a)]=0x0:_0x27016c[_0x42437f][_0xc0e0ce(0x17a)]=0x1;if(_0x55fe3a==_0x27016c[_0xc0e0ce(0xba)])return _0x51707f[_0xc0e0ce(0xe5)]({'code':0x0,'userPower':_0x27016c,'userMenu':_0x2eab38?_0x2eab38['menus']:[]});});}}}),router[_0xbe142f(0xb3)](_0xbe142f(0x139),(_0x12cfe3,_0x352d20,_0x5421e4)=>{const _0xd08c19=_0xbe142f;let _0x3036b9=_0x12cfe3['body'][_0xd08c19(0x128)],_0x5bbd00=_0x12cfe3[_0xd08c19(0xd4)][_0xd08c19(0x157)],_0x4c6246=_0x12cfe3[_0xd08c19(0xd4)]['server_type'];if(!_0x3036b9||!_0x5bbd00||!_0x4c6246)return _0x12cfe3[_0xd08c19(0x16c)][_0xd08c19(0xb7)](_0x352d20,_0x352d20['__']('operationFail'));let _0x361662=null;if(_0x3036b9!=config[_0xd08c19(0x120)]){_0x361662=dbUserTable[_0xd08c19(0x15a)](_0x12cfe3['app'][_0xd08c19(0xe7)],_0x3036b9);if(!_0x361662)return _0x12cfe3[_0xd08c19(0x16c)][_0xd08c19(0xb7)](_0x352d20,_0xd08c19(0x138));}_0x5bbd00=pathUtil[_0xd08c19(0x11f)](_0x5bbd00);if(dbUserTable['isAdmin'](_0x12cfe3,_0x352d20)===!![]){let _0x5145ee=dbUserTable[_0xd08c19(0x179)](_0x12cfe3[_0xd08c19(0x16c)][_0xd08c19(0xe7)],_0x3036b9,_0x4c6246,null,!![]);for(let _0x1a4c67 of _0x5145ee){let _0x979d03=_0x1a4c67['path'];if(_0x5bbd00[_0xd08c19(0x10d)](pathUtil[_0xd08c19(0x11f)](_0x979d03,pathUtil['sep']))&&_0x5bbd00!=_0x979d03)return _0x12cfe3[_0xd08c19(0x16c)][_0xd08c19(0xb7)](_0x352d20,_0x352d20['__'](_0xd08c19(0x172))+_0x979d03,'dialog');if(_0x979d03[_0xd08c19(0x10d)](pathUtil[_0xd08c19(0x11f)](_0x5bbd00,pathUtil['sep']))&&_0x5bbd00!=_0x979d03)return _0x12cfe3[_0xd08c19(0x16c)][_0xd08c19(0xb7)](_0x352d20,_0x352d20['__'](_0xd08c19(0x172))+_0x979d03,_0xd08c19(0x126));}let _0x470c9a=dbUserTable[_0xd08c19(0x10e)](_0x12cfe3['app'][_0xd08c19(0xe7)],_0x12cfe3['body']);return _0x352d20[_0xd08c19(0xe5)]({'code':0x0,'result':_0x470c9a});}}),router[_0xbe142f(0xb3)](_0xbe142f(0xf8),(_0x5a7411,_0xaa7c54,_0x50e252)=>{const _0x3d77bf=_0xbe142f;let _0xdc2c73=_0x5a7411['body'][_0x3d77bf(0x128)],_0x557bd9=_0x5a7411[_0x3d77bf(0xd4)][_0x3d77bf(0xcf)];if(!_0xdc2c73||!(_0x557bd9 instanceof Array))return _0x5a7411[_0x3d77bf(0x16c)][_0x3d77bf(0xb7)](_0xaa7c54,_0x3d77bf(0xde));let _0x39add7=dbUserTable[_0x3d77bf(0x15a)](_0x5a7411['app'][_0x3d77bf(0xe7)],_0xdc2c73);if(!_0x39add7)return _0x5a7411[_0x3d77bf(0x16c)][_0x3d77bf(0xb7)](_0xaa7c54,_0x3d77bf(0x138));if(dbUserTable[_0x3d77bf(0x160)](_0x5a7411,_0xaa7c54)===!![])return dbUserTable[_0x3d77bf(0x176)](_0x5a7411[_0x3d77bf(0x16c)]['dbOther'],_0xdc2c73,_0x3d77bf(0x163),JSON[_0x3d77bf(0xc5)](_0x557bd9)),_0xaa7c54[_0x3d77bf(0xe5)]({'code':0x0});}),router[_0xbe142f(0xb3)]('/cancelUserPathPower',(_0x347691,_0x5c14ec,_0x4b36e6)=>{const _0xdc641a=_0xbe142f;let _0x326634=dbUserTable[_0xdc641a(0x105)](_0x347691['app'][_0xdc641a(0xe7)],_0x347691['body']);return _0x326634[_0xdc641a(0xc6)]>0x0?_0x5c14ec['json']({'code':0x0}):_0x347691[_0xdc641a(0x16c)][_0xdc641a(0xb7)](_0x5c14ec,_0x5c14ec['__'](_0xdc641a(0x133)));}),router[_0xbe142f(0xb3)](_0xbe142f(0x142),(_0x2c1d76,_0x278de1,_0x1683a0)=>{const _0x34b0ca=_0xbe142f;let _0x1fb8d4=_0x2c1d76['body'][_0x34b0ca(0xa8)],_0x22c578=_0x2c1d76[_0x34b0ca(0xd4)][_0x34b0ca(0xb1)];cryptoUtils['encryptString'](config[_0x34b0ca(0x13b)],_0x1fb8d4)[_0x34b0ca(0xd7)](_0x32f335=>{const _0x10df52=_0x34b0ca;if(_0x2c1d76[_0x10df52(0x144)][_0x10df52(0xab)]!=_0x32f335)return _0x278de1['json']({'code':0x2,'message':_0x278de1['__'](_0x10df52(0xfb))});else cryptoUtils[_0x10df52(0x130)](config[_0x10df52(0x13b)],_0x22c578)[_0x10df52(0xd7)](_0x255b3a=>{const _0x504fc5=_0x10df52;dbUserTable['updateById'](_0x2c1d76[_0x504fc5(0x16c)][_0x504fc5(0xe7)],_0x2c1d76[_0x504fc5(0x144)]['id'],_0x504fc5(0xab),_0x255b3a);let _0x2afb10=sha256(new Date()['getTime']()+_0x2c1d76[_0x504fc5(0x144)][_0x504fc5(0x128)]+_0x2c1d76[_0x504fc5(0x144)][_0x504fc5(0xab)]);dbUserTable['updateById'](_0x2c1d76[_0x504fc5(0x16c)][_0x504fc5(0xe7)],_0x2c1d76['currentUser']['id'],_0x504fc5(0x156),_0x2afb10);let _0xd5a5bc=netUtils[_0x504fc5(0xef)](_0x2c1d76);return dbLoginTable[_0x504fc5(0xd9)](_0x2c1d76[_0x504fc5(0x16c)][_0x504fc5(0xe7)],_0x504fc5(0xfe),_0x2c1d76[_0x504fc5(0x144)]['id'],_0xd5a5bc,_0x2c1d76['body']['client'],''),_0x278de1[_0x504fc5(0xe5)]({'code':0x0});})['catch'](_0x1e890d=>{const _0x420e10=_0x10df52;return console[_0x420e10(0x16d)](_0x420e10(0x13f),_0x1e890d),_0x2c1d76['app'][_0x420e10(0xb7)](_0x278de1,_0x278de1['__']('operationFail'));});});}),router[_0xbe142f(0xb3)]('/changeQuestion',(_0x516d58,_0x44f24d,_0x415863)=>{const _0x598c21=_0xbe142f;let _0x3ce13f=_0x516d58[_0x598c21(0xd4)][_0x598c21(0x184)],_0x5b9479=_0x516d58[_0x598c21(0xd4)]['answer'];if(checkUtil[_0x598c21(0x132)](_0x5b9479))return _0x516d58[_0x598c21(0x16c)]['returnErrMsg'](_0x44f24d,_0x44f24d['__'](_0x598c21(0xfa)));if(_0x3ce13f==_0x5b9479)return _0x516d58['app'][_0x598c21(0xb7)](_0x44f24d,_0x44f24d['__'](_0x598c21(0xd0)));return dbUserTable['updateQuestionById'](_0x516d58[_0x598c21(0x16c)][_0x598c21(0xe7)],_0x516d58[_0x598c21(0x144)]['id'],_0x3ce13f,sha256(_0x5b9479)),_0x44f24d[_0x598c21(0xe5)]({'code':0x0});}),router[_0xbe142f(0xb3)](_0xbe142f(0x181),(_0x38357d,_0x346852,_0x295988)=>{const _0x2d08c7=_0xbe142f;let _0x104eea=_0x38357d[_0x2d08c7(0xd4)][_0x2d08c7(0x156)];return _0x104eea&&dbUserTable['deleteUserTokenByWhere'](_0x38357d['app'][_0x2d08c7(0xe7)],_0x2d08c7(0xad),[_0x104eea]),_0x346852['json']({'code':0x0});}),router[_0xbe142f(0xb3)](_0xbe142f(0x16b),(_0x28b365,_0x465d22,_0x52f0e1)=>{const _0x15e70f=_0xbe142f;let _0x38d9c1=dbUserTable['find'](_0x28b365[_0x15e70f(0x16c)][_0x15e70f(0xe7)],_0x28b365[_0x15e70f(0x144)]['id']);return _0x38d9c1?(_0x38d9c1[_0x15e70f(0xab)]='',_0x38d9c1[_0x15e70f(0xff)]='',_0x465d22['json']({'code':0x0,'userInfo':_0x38d9c1})):_0x465d22[_0x15e70f(0xe5)]({'code':0x65});}),router[_0xbe142f(0xb3)](_0xbe142f(0x117),(_0x564ed0,_0x9ad61,_0x5e3536)=>{const _0x12379d=_0xbe142f;if(_0x564ed0[_0x12379d(0x144)][_0x12379d(0xf2)]!=0x1)return _0x9ad61[_0x12379d(0xe5)]({'code':0x66});let _0x4b6b62=_0x564ed0['body']['ip'];if(_0x4b6b62==_0x12379d(0xd3)||_0x4b6b62==_0x12379d(0x119))return _0x564ed0['app'][_0x12379d(0xb7)](_0x9ad61,_0x9ad61['__'](_0x12379d(0xc7)));let _0x5cce06=_0x564ed0[_0x12379d(0xd4)]['type'],_0x626860=_0x564ed0[_0x12379d(0xd4)][_0x12379d(0x171)];return dbLoginTable['addIpToList'](_0x564ed0['app'][_0x12379d(0xe7)],_0x5cce06,_0x4b6b62,_0x626860,_0x9ad61['__'](_0x12379d(0x17b))),_0x564ed0[_0x12379d(0x16c)]['refreshIpList'](),_0x9ad61['json']({'code':0x0});}),router[_0xbe142f(0xb3)](_0xbe142f(0xf0),(_0x5e7437,_0x4cdb36,_0x36d030)=>{const _0x2b3348=_0xbe142f;if(_0x5e7437[_0x2b3348(0x144)][_0x2b3348(0xf2)]!=0x1)return _0x4cdb36[_0x2b3348(0xe5)]({'code':0x66});let _0x117d3f=_0x5e7437[_0x2b3348(0xd4)]['id'];return dbLoginTable['deleteIp'](_0x5e7437[_0x2b3348(0x16c)]['dbOther'],_0x117d3f),_0x5e7437[_0x2b3348(0x16c)][_0x2b3348(0xf3)](),_0x4cdb36[_0x2b3348(0xe5)]({'code':0x0});}),router[_0xbe142f(0xb3)]('/getIpList',(_0xde6cb6,_0x4b7a8e,_0x2ec043)=>{const _0x4b88d6=_0xbe142f;let _0x5a37ee=_0xde6cb6['body'][_0x4b88d6(0xb9)],_0x457049=_0xde6cb6[_0x4b88d6(0xd4)][_0x4b88d6(0x154)],_0x211a69=_0xde6cb6[_0x4b88d6(0xd4)][_0x4b88d6(0xb6)],_0x51e5d3=new Date()[_0x4b88d6(0xe8)]();dbLoginTable['deleteIpByWhere'](_0xde6cb6[_0x4b88d6(0x16c)][_0x4b88d6(0xe7)],_0x4b88d6(0x186)+_0x51e5d3);let _0x5a6ff6=_0x4b88d6(0xbf)+_0x211a69+'\x27',_0x5941aa=dbLoginTable[_0x4b88d6(0x180)](_0xde6cb6[_0x4b88d6(0x16c)][_0x4b88d6(0xe7)],_0x5a6ff6),_0x4e6e0=(_0x5a37ee-0x1)*_0x457049;_0x5a6ff6+=_0x4b88d6(0x10c)+_0x457049+'\x20offset\x20'+_0x4e6e0;let _0x571a4d=dbLoginTable[_0x4b88d6(0x12c)](_0xde6cb6[_0x4b88d6(0x16c)][_0x4b88d6(0xe7)],_0x5a6ff6);return _0x4b7a8e[_0x4b88d6(0xe5)]({'code':0x0,'data':_0x571a4d,'pageCount':Math[_0x4b88d6(0x15f)](_0x5941aa['count']/_0x457049)});}),router[_0xbe142f(0xb3)](_0xbe142f(0x11a),(_0x21bbf1,_0x136710,_0x3ebef1)=>{const _0x490d3b=_0xbe142f;if(_0x21bbf1[_0x490d3b(0x144)]['is_admin']!=0x1)return _0x136710['json']({'code':0x66});let _0x703a9d=0x1388,_0x59564c=_0x21bbf1['body']['page'],_0x1b1e9b=_0x21bbf1[_0x490d3b(0xd4)][_0x490d3b(0x154)],_0x161342=_0x21bbf1[_0x490d3b(0xd4)][_0x490d3b(0xb6)],_0x59aed3='',_0x23d10d=[];_0x161342?(_0x59aed3+=_0x490d3b(0xf6),_0x23d10d[_0x490d3b(0xac)](_0x161342)):_0x59aed3='\x201=1';let _0x58d75b=dbLoginTable[_0x490d3b(0xcd)](_0x21bbf1['app']['dbOther'],_0x59aed3,_0x23d10d)[_0x490d3b(0xdb)];if(_0x58d75b>_0x703a9d){let _0x17541b=0x64,_0x29ef89=dbLoginTable[_0x490d3b(0x14f)](_0x21bbf1[_0x490d3b(0x16c)]['dbOther'],_0x490d3b(0x11e)+_0x17541b+')');_0x29ef89[_0x490d3b(0xc6)]>0x0&&(_0x58d75b=_0x58d75b-_0x29ef89[_0x490d3b(0xc6)]);}let _0x4cf3f6=(_0x59564c-0x1)*_0x1b1e9b;_0x59aed3+='\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?',_0x23d10d[_0x490d3b(0xac)](_0x1b1e9b),_0x23d10d[_0x490d3b(0xac)](_0x4cf3f6);let _0x362cf5=dbLoginTable[_0x490d3b(0x187)](_0x21bbf1[_0x490d3b(0x16c)]['dbOther'],_0x59aed3,_0x23d10d);return _0x136710['json']({'code':0x0,'data':_0x362cf5,'pageCount':Math[_0x490d3b(0x15f)](_0x58d75b/_0x1b1e9b)});}),module['exports']=router;