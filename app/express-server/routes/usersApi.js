const _0x5b4749=_0xf576;(function(_0x453c0b,_0x2decce){const _0x2d3d54=_0xf576,_0x53e101=_0x453c0b();while(!![]){try{const _0x264629=parseInt(_0x2d3d54(0x1ee))/0x1*(-parseInt(_0x2d3d54(0x1a1))/0x2)+parseInt(_0x2d3d54(0x21b))/0x3+parseInt(_0x2d3d54(0x22e))/0x4+parseInt(_0x2d3d54(0x1b9))/0x5+parseInt(_0x2d3d54(0x1c0))/0x6*(-parseInt(_0x2d3d54(0x20b))/0x7)+-parseInt(_0x2d3d54(0x18b))/0x8+-parseInt(_0x2d3d54(0x166))/0x9*(-parseInt(_0x2d3d54(0x16a))/0xa);if(_0x264629===_0x2decce)break;else _0x53e101['push'](_0x53e101['shift']());}catch(_0x158b6e){_0x53e101['push'](_0x53e101['shift']());}}}(_0x51dc,0x5a84b));let sha256=require('sha256'),express=require('express'),router=express[_0x5b4749(0x189)](),cryptoUtils=require(_0x5b4749(0x19d)),netUtils=require(_0x5b4749(0x23d)),config=require(_0x5b4749(0x1bd)),pathUtil=require(_0x5b4749(0x15b)),checkUtil=require(_0x5b4749(0x238));var package=require(_0x5b4749(0x188));const OS=require('os'),urlConfig=require(_0x5b4749(0x1c4)),dbUserTable=require('../../db/dbUserTable'),dbLoginTable=require(_0x5b4749(0x199)),dbConfigTable=require(_0x5b4749(0x1b6)),dbNoticeCenterTable=require(_0x5b4749(0x1e4)),dbMusicIndexTable=require(_0x5b4749(0x15c)),fileUtil=require(_0x5b4749(0x170)),fs=require('fs'),path=require(_0x5b4749(0x15b)),dbMovieFavorite=require(_0x5b4749(0x1dc)),dbMusicFavorite=require(_0x5b4749(0x23e));function _0xf576(_0x903f67,_0x23b2a4){const _0x51dca8=_0x51dc();return _0xf576=function(_0xf576f0,_0xac47c9){_0xf576f0=_0xf576f0-0x15b;let _0x436a40=_0x51dca8[_0xf576f0];return _0x436a40;},_0xf576(_0x903f67,_0x23b2a4);}function _0x51dc(){const _0x2d97dd=['asc','DELETE\x20FROM\x20movie_history','app','pageSize','Need\x20token','isEasyUsername','testCount','DELETE\x20FROM\x20notice_center','splice','menuList','login.pwdErr','DELETE\x20FROM\x20album','/login','headers','../../../package.json','Router','send','1336696KJMHqQ','DELETE\x20FROM\x20file_operation_record','DELETE\x20FROM\x20login_ip_list','/removeIp','then','fileShareRestart','login.loginFailAlert','createUserFolder','refreshIpList','/remarkUser','username','/setUserMenu','/logout','getUrlByUrlKey','../../db/dbLoginTable','token','login','value','../utils/cryptoUtils','encryptString','page','exports','32282vwByir','apiPort','returnErrMsg','/getRecordList','\x201=1','remark','getClientIp','DELETE\x20FROM\x20music_favorite','passwordKey','username\x20error','create','uid','language','login.answerIsWrong','client','apiPortHttps','length','cacheParentPath','pageUrl_privacy','getAdmin','all','../../db/dbConfigTable','parse','add','2889765LEfMsO','deleteIpByWhere','state','createOrUpdatePower','../../myConfig/config','changePassword','DELETE\x20FROM\x20music_playlist','4146azwmNY','checkAnswer','/registAdmin','dialog','../../myConfig/urlConfig','searchKey','DELETE\x20FROM\x20movie_keys','^[0-9a-zA-Z]*$','addLoginRecord','DELETE\x20FROM\x20backup_task','post','enable','server_type','test','security.thisIpCannotAddList','dbOther','error','NodeNasServer','DELETE\x20FROM\x20movie_collection','status','DELETE\x20FROM\x20book_list','getAllRecordByWhere','ceil','login.adminExist','apiServerHttps','json','DELETE\x20FROM\x20file_index_movie','dbFileIndex','../../db/dbMovieFavorite','startsWith','ipBan','DELETE\x20FROM\x20book_read_record','isAdmin','findByUsername','DELETE\x20FROM\x20music_playlist_index','\x20offset\x20','../../db/dbNoticeCenterTable','getAllIpListByWhere','query','getUserByToken','DELETE\x20FROM\x20share_temp','\x20end_timestamp\x20is\x20not\x20null\x20and\x20end_timestamp<','\x20type=?','orderType','/changePassword','is_admin','9mbzRlY','isSameStr','region','DELETE\x20FROM\x20album_ordinary','stat','DELETE\x20FROM\x20book_list_index','getTime','DELETE\x20FROM\x20user','banTime','catch','customLoginImage','SELECT\x20*\x20FROM\x20user\x20WHERE\x20username=?','menus','You\x20can\x27t\x20delete\x20admin\x20account','join','WebDav','ipList','\x20type=\x27','run','body','FTP','ipv4','count','DELETE\x20FROM\x20photo_phash_similar','DELETE\x20FROM\x20private_space','path.parentPathExist','DELETE\x20FROM\x20file_record','ignoreIp','/cancelUserPathPower','6937UvjERp','exist','currentUser','usernameTooEasy','findByTitle','answerQuestionCannotBeSame','/getIpList','login.wrongNameOrPwd','err','customLogoImage','/removeUser','includes','oldPassword','operationFail','/addUser','/tokenLogin','1329303jmFmpY','question','deleteFavoriteByUid','updateQuestionById','newQuestion','\x20WHERE\x20username\x20like\x20?\x20or\x20user_remark\x20like\x20?','removeUserPlayList','DELETE\x20FROM\x20source_folder','newPassword','DELETE\x20FROM\x20file_index_book','addIpToList','DELETE\x20FROM\x20file_share_user','findByTitleParamsList','TokenExpired','getUserPower','usernameReg','\x20WHERE\x20token\x20=?','login.tooManyPwdTestIpBan','/addIpToList','901380qUGbrZ','pageUrl_agreement','localhost','/resetPwd','updateById','DELETE\x20FROM\x20private_space_token','updateRemarkByUsername','\x20id\x20in(SELECT\x20id\x20FROM\x20login_record\x20ORDER\x20BY\x20id\x20LIMIT\x20','getUserByUserName','createToken','../utils/checkUtil','DELETE\x20FROM\x20config\x20where\x20title\x20in\x20(\x27nasAccountInfo\x27)','answer','hostname','DELETE\x20FROM\x20ai_classes','../utils/netUtils','../../db/dbMusicFavorite','DELETE\x20FROM\x20book_favorite','type','path','../../db/dbMusicIndexTable','updateByUsername','127.0.0.1','DELETE\x20FROM\x20user_token','/getAllUser','find','DELETE\x20FROM\x20movie_library','user-agent','nasProxyRestart','/resetSystem','1093509iGYCHK','changes','params\x20error','customHomeBgImage','10HDnGPs','publicUserName','need\x20username/menuList','getIpListCountByWhere','push','deletePowerByUsername','../utils/fileUtils','userNotExist','\x20order\x20by\x20id\x20desc\x20limit\x20','sep','prepare','end','desc','log','usernameAndPwdCannotBeSame','password'];_0x51dc=function(){return _0x2d97dd;};return _0x51dc();}router[_0x5b4749(0x1ca)]('/hasAdmin',(_0x5ee188,_0x107e19,_0x157cf9)=>{const _0x2d9829=_0x5b4749;let _0xd549ee=dbUserTable['getAdmin'](_0x5ee188[_0x2d9829(0x17c)][_0x2d9829(0x1cf)]),_0x5066ac=dbConfigTable[_0x2d9829(0x227)](_0x5ee188['app']['dbOther'],[_0x2d9829(0x214),'customLoginTitle',_0x2d9829(0x1f8),_0x2d9829(0x169)]);_0x107e19[_0x2d9829(0x1d9)]({'code':0x0,'hasAdmin':_0xd549ee?'1':'0','customConfig':_0x5066ac,'pagePrivacyUrl':urlConfig[_0x2d9829(0x198)](_0x5ee188[_0x2d9829(0x17c)]['dbOther'],_0x2d9829(0x1b3)),'pageAgreementUrl':urlConfig['getUrlByUrlKey'](_0x5ee188[_0x2d9829(0x17c)][_0x2d9829(0x1cf)],_0x2d9829(0x22f))});});let banIpList=[];function getIpBanConfig(_0x471859,_0x173c7e){const _0x4a545c=_0x5b4749;let _0x494876=![],_0x4850fb=0x1,_0xdf9291=0x1;if(_0x173c7e!=_0x4a545c(0x230)){let _0x3800db=dbConfigTable['findByTitle'](_0x471859['app']['dbOther'],_0x4a545c(0x1de));_0x3800db&&(_0x3800db=JSON[_0x4a545c(0x1b7)](_0x3800db[_0x4a545c(0x19c)]),_0x3800db&&(_0x3800db[_0x4a545c(0x1cb)]&&(_0x494876=!![]),_0x4850fb=_0x3800db[_0x4a545c(0x180)],_0xdf9291=_0x3800db[_0x4a545c(0x1f6)]));}return{'enableBan':_0x494876,'maxTestCount':_0x4850fb,'banTimeMin':_0xdf9291};}function addBanIp(_0x4a67dd,_0x203a10,_0x5ce137){const _0x3254d1=_0x5b4749;let {enableBan:_0x4e1435,maxTestCount:_0x2171a7,banTimeMin:_0x4fcb08}=getIpBanConfig(_0x4a67dd,_0x5ce137);if(_0x4e1435){let _0x5cdfe9=null;for(let _0x34dca9 in banIpList){banIpList[_0x34dca9]['ip']==_0x5ce137&&(_0x5cdfe9=banIpList[_0x34dca9],banIpList[_0x34dca9]['testCount']+=0x1);}!_0x5cdfe9&&(_0x5cdfe9={'ip':_0x5ce137,'testCount':0x1},banIpList[_0x3254d1(0x16e)](_0x5cdfe9));if(_0x5cdfe9['testCount']>=_0x2171a7){let _0x9509b3=new Date()[_0x3254d1(0x1f4)](),_0x32983f=_0x9509b3+_0x4fcb08*0x3c*0x3e8;dbLoginTable[_0x3254d1(0x225)](_0x4a67dd[_0x3254d1(0x17c)][_0x3254d1(0x1cf)],'black',_0x5ce137,_0x32983f,_0x203a10['__']('login.pwdErrCountTooMuch')),_0x4a67dd['app'][_0x3254d1(0x193)](),dbNoticeCenterTable[_0x3254d1(0x1ab)](_0x4a67dd[_0x3254d1(0x17c)][_0x3254d1(0x1cf)],{'title':_0x203a10['__'](_0x3254d1(0x191)),'level':'error','content':_0x203a10['__'](_0x3254d1(0x22c))+('['+_0x5ce137+']')});for(let _0x5f44b6 in banIpList){banIpList[_0x5f44b6]['ip']==_0x5ce137&&banIpList[_0x3254d1(0x182)](_0x5f44b6,0x1);}}}}router[_0x5b4749(0x1ca)](_0x5b4749(0x186),(_0x464a05,_0x38069d,_0x433069)=>{const _0x50d92e=_0x5b4749;let _0x1984d3=_0x464a05['body']['username'],_0x1d4ce7=_0x464a05[_0x50d92e(0x201)][_0x50d92e(0x179)];if(!_0x1984d3||!_0x1d4ce7)return _0x38069d[_0x50d92e(0x1d3)](0x194)[_0x50d92e(0x175)]();_0x1d4ce7=fileUtil['decodeBase64'](_0x1d4ce7);let _0x5588c7=netUtils[_0x50d92e(0x1a7)](_0x464a05);cryptoUtils[_0x50d92e(0x19e)](config['passwordKey'],_0x1d4ce7)[_0x50d92e(0x18f)](_0x48d4e6=>{const _0x1b2c28=_0x50d92e;let _0x1870dd=dbUserTable[_0x1b2c28(0x19b)](_0x464a05[_0x1b2c28(0x17c)]['dbOther'],_0x1984d3,_0x48d4e6);if(_0x1870dd){function _0x551a0b(){const _0x10edd2=_0x1b2c28;if(_0x5588c7!=_0x10edd2(0x230)){let _0x2bc5af=dbConfigTable['findByTitle'](_0x464a05[_0x10edd2(0x17c)][_0x10edd2(0x1cf)],'twoStepLogin');if(_0x2bc5af&&_0x2bc5af[_0x10edd2(0x19c)]=='1'){let _0x12c6f3=_0x464a05[_0x10edd2(0x201)][_0x10edd2(0x23a)];if(_0x12c6f3){_0x12c6f3=sha256(_0x12c6f3);let _0x4accd4=dbUserTable[_0x10edd2(0x1c1)](_0x464a05['app'][_0x10edd2(0x1cf)],_0x1984d3,_0x12c6f3);if(!_0x4accd4)return _0x464a05['app'][_0x10edd2(0x1a3)](_0x38069d,_0x38069d['__'](_0x10edd2(0x1ae)));}else return _0x38069d[_0x10edd2(0x1d9)]({'code':0x2,'question':_0x1870dd[_0x10edd2(0x21c)]});}}dbLoginTable[_0x10edd2(0x1c8)](_0x464a05[_0x10edd2(0x17c)][_0x10edd2(0x1cf)],_0x10edd2(0x19b),_0x1984d3,_0x5588c7,_0x464a05[_0x10edd2(0x201)][_0x10edd2(0x1af)],_0x464a05[_0x10edd2(0x187)][_0x10edd2(0x163)]);let _0x15fe58=sha256(new Date()[_0x10edd2(0x1f4)]()+_0x1984d3+_0x48d4e6);var _0x4b3ef7=_0x464a05[_0x10edd2(0x187)][_0x10edd2(0x163)];return dbUserTable[_0x10edd2(0x237)](_0x464a05['app'][_0x10edd2(0x1cf)],_0x1870dd['id'],_0x15fe58,_0x5588c7,_0x4b3ef7),_0x1870dd[_0x10edd2(0x179)]='',_0x1870dd[_0x10edd2(0x23a)]='',_0x38069d[_0x10edd2(0x1d9)]({'code':0x0,'token':_0x15fe58,'user':_0x1870dd,'version':package['version'],'reqIp':_0x5588c7});}return _0x551a0b();}else return addBanIp(_0x464a05,_0x38069d,_0x5588c7),dbLoginTable[_0x1b2c28(0x1c8)](_0x464a05[_0x1b2c28(0x17c)][_0x1b2c28(0x1cf)],_0x38069d['__']('login.wrongNameOrPwd'),_0x1984d3,_0x5588c7,_0x464a05[_0x1b2c28(0x201)][_0x1b2c28(0x1af)],_0x464a05[_0x1b2c28(0x187)]['user-agent']),_0x464a05[_0x1b2c28(0x17c)]['returnErrMsg'](_0x38069d,_0x38069d['__'](_0x1b2c28(0x212)));})['catch'](_0x2c9797=>{const _0xe86918=_0x50d92e;return console[_0xe86918(0x177)](_0x2c9797),_0x464a05[_0xe86918(0x17c)]['returnErrMsg'](_0x38069d,_0x38069d['__'](_0xe86918(0x218)));});}),router['post'](_0x5b4749(0x21a),(_0x466a47,_0xbb6023,_0xeef869)=>{const _0x10f615=_0x5b4749;let _0x2c294a=netUtils[_0x10f615(0x1a7)](_0x466a47),_0x743193=_0x466a47[_0x10f615(0x201)][_0x10f615(0x19a)];if(!_0x743193)return _0x466a47[_0x10f615(0x17c)]['returnErrMsg'](_0xbb6023,_0x10f615(0x17e));let _0x129d19=dbUserTable[_0x10f615(0x1e7)](_0x466a47[_0x10f615(0x17c)]['dbOther'],_0x743193);if(!_0x129d19)return _0x466a47[_0x10f615(0x17c)][_0x10f615(0x1a3)](_0xbb6023,_0xbb6023['__'](_0x10f615(0x228)));return _0x129d19['password']='',_0x129d19[_0x10f615(0x23a)]='',_0xbb6023[_0x10f615(0x1d9)]({'code':0x0,'token':_0x743193,'user':_0x129d19,'reqIp':_0x2c294a});}),router['post'](_0x5b4749(0x165),(_0x2d346d,_0x3b5f62,_0x210137)=>{const _0x13af36=_0x5b4749;let _0x7a1a2=_0x2d346d[_0x13af36(0x201)][_0x13af36(0x179)];if(_0x2d346d['currentUser']&&_0x2d346d[_0x13af36(0x20d)]['is_admin']!=0x1)return _0x3b5f62['json']({'code':0x66});cryptoUtils[_0x13af36(0x19e)](config[_0x13af36(0x1a9)],_0x7a1a2)['then'](_0x1d7ae9=>{const _0x439c79=_0x13af36;if(_0x2d346d['currentUser'][_0x439c79(0x179)]!=_0x1d7ae9)return _0x3b5f62[_0x439c79(0x1d9)]({'code':0x1,'message':_0x3b5f62['__'](_0x439c79(0x184))});fs['rm'](path[_0x439c79(0x1fc)](config[_0x439c79(0x1b2)]),{'recursive':!![]},_0x158a1a=>{const _0x3bd748=_0x439c79;if(_0x158a1a)return _0x3b5f62['json']({'code':0x1,'message':'Error'});return _0x2d346d[_0x3bd748(0x17c)]['dbOther'][_0x3bd748(0x174)]('DELETE\x20FROM\x20config')['run'](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)](_0x3bd748(0x185))['run'](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)]['prepare'](_0x3bd748(0x1c9))[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1cf)]['prepare']('DELETE\x20FROM\x20backup_task_msg')[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1cf)][_0x3bd748(0x174)]('DELETE\x20FROM\x20backup_task_record')['run'](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)]('DELETE\x20FROM\x20bg_task')['run'](),_0x2d346d['app'][_0x3bd748(0x1cf)]['prepare'](_0x3bd748(0x239))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)](_0x3bd748(0x18c))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)](_0x3bd748(0x208))[_0x3bd748(0x200)](),_0x2d346d['app']['dbOther'][_0x3bd748(0x174)]('DELETE\x20FROM\x20file_share')[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)](_0x3bd748(0x226))[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1cf)]['prepare'](_0x3bd748(0x18d))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)]['dbOther'][_0x3bd748(0x174)]('DELETE\x20FROM\x20login_record')[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)]['dbOther'][_0x3bd748(0x174)](_0x3bd748(0x181))['run'](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)]('DELETE\x20FROM\x20play_record')['run'](),_0x2d346d['app'][_0x3bd748(0x1cf)][_0x3bd748(0x174)](_0x3bd748(0x206))['run'](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)](_0x3bd748(0x233))[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1cf)]['prepare'](_0x3bd748(0x1e8))[_0x3bd748(0x200)](),_0x2d346d['app']['dbOther'][_0x3bd748(0x174)](_0x3bd748(0x222))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)](_0x3bd748(0x1f5))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)](_0x3bd748(0x15f))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1cf)][_0x3bd748(0x174)]('DELETE\x20FROM\x20user_power')['run'](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x23c))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)]('DELETE\x20FROM\x20ai_classes2index')[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x1f1))['run'](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)]('DELETE\x20FROM\x20album_ordinary_index')[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x1da))[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1db)][_0x3bd748(0x174)]('DELETE\x20FROM\x20file_index_photo')[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)]('DELETE\x20FROM\x20file_index_music')[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x224))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)]('DELETE\x20FROM\x20photo_faces')[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)]['dbFileIndex']['prepare']('DELETE\x20FROM\x20photo_faces2index')[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x1c6))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x1d2))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x17b))[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x162))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x205))[_0x3bd748(0x200)](),_0x2d346d['app'][_0x3bd748(0x1db)]['prepare'](_0x3bd748(0x1a8))['run'](),_0x2d346d['app'][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x1bf))[_0x3bd748(0x200)](),_0x2d346d['app']['dbFileIndex'][_0x3bd748(0x174)](_0x3bd748(0x1e2))[_0x3bd748(0x200)](),_0x2d346d['app']['dbFileIndex'][_0x3bd748(0x174)](_0x3bd748(0x23f))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x1d4))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)]['prepare'](_0x3bd748(0x1f3))[_0x3bd748(0x200)](),_0x2d346d[_0x3bd748(0x17c)][_0x3bd748(0x1db)][_0x3bd748(0x174)](_0x3bd748(0x1df))[_0x3bd748(0x200)](),process['send']({'type':_0x3bd748(0x190),'shareType':_0x3bd748(0x202)}),process[_0x3bd748(0x18a)]({'type':_0x3bd748(0x190),'shareType':_0x3bd748(0x1fd)}),process[_0x3bd748(0x18a)]({'type':_0x3bd748(0x164)}),process[_0x3bd748(0x18a)]({'type':_0x3bd748(0x192)}),_0x3b5f62[_0x3bd748(0x1d9)]({'code':0x0});});});}),router[_0x5b4749(0x1ca)]('/resetPwdInfo',(_0x3fd93c,_0x2f621a,_0x399583)=>{const _0x26cc8c=_0x5b4749;let _0x1987e1=netUtils[_0x26cc8c(0x1a7)](_0x3fd93c),_0x7959c2=dbUserTable[_0x26cc8c(0x1b4)](_0x3fd93c[_0x26cc8c(0x17c)][_0x26cc8c(0x1cf)]),_0x507ead={};_0x1987e1=='localhost'&&(_0x507ead[_0x26cc8c(0x195)]=_0x7959c2[_0x26cc8c(0x195)]),_0x507ead[_0x26cc8c(0x21c)]=_0x7959c2[_0x26cc8c(0x21c)],_0x2f621a[_0x26cc8c(0x1d9)]({'code':0x0,'data':_0x507ead});}),router[_0x5b4749(0x1b5)]('/checkIsNasServer',(_0x36310a,_0x31d8f5,_0x5bfdb3)=>{const _0x1a6e47=_0x5b4749;let _0x4606b6={'code':0x0,'message':_0x1a6e47(0x1d1),'version':package['version'],'hostName':OS[_0x1a6e47(0x23b)]()},_0x39413a=_0x36310a[_0x1a6e47(0x1e6)][_0x1a6e47(0x209)];if(_0x39413a&&_0x39413a==0x1)return _0x31d8f5[_0x1a6e47(0x1d9)](_0x4606b6);let _0x3a4217=0x50,_0x5337a4=dbConfigTable[_0x1a6e47(0x20f)](_0x36310a['app'][_0x1a6e47(0x1cf)],_0x1a6e47(0x1a2));_0x5337a4&&_0x5337a4[_0x1a6e47(0x19c)]&&(_0x3a4217=_0x5337a4[_0x1a6e47(0x19c)]);let _0x1feacb=0x1bb,_0x4c9bea=dbConfigTable[_0x1a6e47(0x20f)](_0x36310a['app'][_0x1a6e47(0x1cf)],'apiPortHttps');_0x4c9bea&&_0x4c9bea[_0x1a6e47(0x19c)]&&_0x4c9bea[_0x1a6e47(0x19c)]>0x0&&_0x4c9bea[_0x1a6e47(0x19c)]<0xffff&&(_0x1feacb=_0x4c9bea[_0x1a6e47(0x19c)]);let _0x55f6e=0x0,_0x20ceb2=dbConfigTable['findByTitle'](_0x36310a[_0x1a6e47(0x17c)][_0x1a6e47(0x1cf)],_0x1a6e47(0x1d8));if(_0x20ceb2&&_0x20ceb2[_0x1a6e47(0x19c)])try{_0x20ceb2=JSON[_0x1a6e47(0x1b7)](_0x20ceb2[_0x1a6e47(0x19c)]),_0x20ceb2[_0x1a6e47(0x1bb)]==_0x1a6e47(0x200)&&(_0x55f6e=0x1);}catch(_0x52689c){}try{let _0x24f559=dbConfigTable[_0x1a6e47(0x20f)](_0x36310a['app'][_0x1a6e47(0x1cf)],'globalIpList'),_0xf3b80b=dbConfigTable['findByTitle'](_0x36310a[_0x1a6e47(0x17c)][_0x1a6e47(0x1cf)],'ddnsIpv6Address');if(_0x24f559){_0x24f559=JSON[_0x1a6e47(0x1b7)](_0x24f559[_0x1a6e47(0x19c)]);let _0x161b3e=[];if(_0xf3b80b&&_0xf3b80b[_0x1a6e47(0x19c)]){for(let _0x54fea1 in _0x24f559){let _0x12c240=_0x24f559[_0x54fea1];_0x12c240[_0x1a6e47(0x240)]==_0x1a6e47(0x203)&&_0x161b3e['push'](_0x12c240);}_0x161b3e[_0x1a6e47(0x16e)]({'type':'ipv6','ip':_0xf3b80b['value'],'ddns':0x1}),_0x24f559=_0x161b3e;}}return _0x4606b6[_0x1a6e47(0x1fe)]=_0x24f559,_0x4606b6[_0x1a6e47(0x1a2)]=parseInt(_0x3a4217),_0x4606b6[_0x1a6e47(0x1b0)]=parseInt(_0x1feacb),_0x4606b6['httpsIsRunning']=_0x55f6e,_0x31d8f5[_0x1a6e47(0x1d9)](_0x4606b6);}catch(_0x231dca){return _0x31d8f5[_0x1a6e47(0x1d9)](_0x4606b6);}}),router[_0x5b4749(0x1ca)](_0x5b4749(0x231),(_0x3f331a,_0xc535f3,_0x1757c5)=>{const _0x1be20f=_0x5b4749;let _0x4a668c=_0x3f331a[_0x1be20f(0x201)][_0x1be20f(0x195)],_0x24b62e=_0x3f331a['body'][_0x1be20f(0x179)],_0x59f5b=_0x3f331a[_0x1be20f(0x201)]['answer'],_0x14fd66=_0x3f331a['app'][_0x1be20f(0x1cf)]['prepare'](_0x1be20f(0x1f9))['get'](_0x4a668c);if(!_0x14fd66)return _0x3f331a[_0x1be20f(0x17c)]['returnErrMsg'](_0xc535f3,_0xc535f3['__'](_0x1be20f(0x171)));try{_0x59f5b=sha256(_0x59f5b);let _0x250773=dbUserTable[_0x1be20f(0x1c1)](_0x3f331a[_0x1be20f(0x17c)][_0x1be20f(0x1cf)],_0x4a668c,_0x59f5b);if(_0x250773)cryptoUtils[_0x1be20f(0x19e)](config[_0x1be20f(0x1a9)],_0x24b62e)[_0x1be20f(0x18f)](_0x51346e=>{const _0x5480bb=_0x1be20f;dbUserTable['updateByUsername'](_0x3f331a[_0x5480bb(0x17c)]['dbOther'],_0x4a668c,_0x5480bb(0x179),_0x51346e);let _0x7ad517=sha256(new Date()[_0x5480bb(0x1f4)]()+_0x4a668c+_0x24b62e);dbUserTable[_0x5480bb(0x15d)](_0x3f331a[_0x5480bb(0x17c)][_0x5480bb(0x1cf)],_0x4a668c,_0x5480bb(0x19a),_0x7ad517),_0xc535f3['json']({'code':0x0});})[_0x1be20f(0x1f7)](_0x25bb30=>{const _0x2e31e7=_0x1be20f;return console[_0x2e31e7(0x177)](_0x2e31e7(0x1d0),_0x25bb30),_0x3f331a[_0x2e31e7(0x17c)][_0x2e31e7(0x1a3)](_0xc535f3,_0xc535f3['__']('operationFail'));});else return _0x3f331a[_0x1be20f(0x17c)][_0x1be20f(0x1a3)](_0xc535f3,_0xc535f3['__'](_0x1be20f(0x1ae)));}catch(_0x46c665){return console[_0x1be20f(0x177)](_0x1be20f(0x213),_0x46c665),_0xc535f3[_0x1be20f(0x1d3)](0x194)['end']();}});function newUserCheck(_0x24164c,_0x1a50bc,_0x3d2c1a,_0x49a953,_0x43803d,_0xbdb650){const _0x5c8cf2=_0x5b4749;if(!_0x49a953||!_0x3d2c1a||!_0x24164c||!_0x1a50bc)return _0x43803d[_0x5c8cf2(0x17c)][_0x5c8cf2(0x1a3)](_0xbdb650,_0xbdb650['__']('newUserParamsNull'));let _0x4c000d=new RegExp(_0x5c8cf2(0x1c7));if(!_0x4c000d[_0x5c8cf2(0x1cd)](_0x24164c)||_0x24164c==config['publicUserName'])return _0x43803d[_0x5c8cf2(0x17c)]['returnErrMsg'](_0xbdb650,_0xbdb650['__'](_0x5c8cf2(0x22a)));if(_0x24164c==_0x1a50bc)return _0x43803d[_0x5c8cf2(0x17c)][_0x5c8cf2(0x1a3)](_0xbdb650,_0xbdb650['__'](_0x5c8cf2(0x178)));if(checkUtil[_0x5c8cf2(0x17f)](_0x24164c))return _0x43803d[_0x5c8cf2(0x17c)][_0x5c8cf2(0x1a3)](_0xbdb650,_0xbdb650['__'](_0x5c8cf2(0x20e)));if(_0x3d2c1a==_0x49a953)return _0x43803d['app'][_0x5c8cf2(0x1a3)](_0xbdb650,_0xbdb650['__'](_0x5c8cf2(0x210)));if(checkUtil['isIncludeChinese'](_0x1a50bc))return _0x43803d[_0x5c8cf2(0x17c)][_0x5c8cf2(0x1a3)](_0xbdb650,_0xbdb650['__']('pwdCannotBeChinese'));return!![];}router[_0x5b4749(0x1ca)](_0x5b4749(0x1c2),(_0x367366,_0x29c843,_0x333f45)=>{const _0x5ceb71=_0x5b4749;let _0x4fdf59=_0x367366[_0x5ceb71(0x201)]['username'],_0x36bc7f=_0x367366[_0x5ceb71(0x201)][_0x5ceb71(0x179)],_0x58c04a=_0x367366[_0x5ceb71(0x201)][_0x5ceb71(0x21c)],_0x302cbd=_0x367366['body'][_0x5ceb71(0x23a)];if(!_0x302cbd||!_0x58c04a||!_0x4fdf59||!_0x36bc7f)return _0x29c843[_0x5ceb71(0x1d9)]({'code':0x1,'message':_0x5ceb71(0x168)});let _0x14cb41=dbUserTable['getAdmin'](_0x367366[_0x5ceb71(0x17c)]['dbOther']);if(_0x14cb41)_0x29c843['json']({'code':0x1,'message':_0x29c843['__'](_0x5ceb71(0x1d7))});else{if(newUserCheck(_0x4fdf59,_0x36bc7f,_0x58c04a,_0x302cbd,_0x367366,_0x29c843)!==!![])return;_0x302cbd=sha256(_0x302cbd),cryptoUtils[_0x5ceb71(0x19e)](config['passwordKey'],_0x36bc7f)[_0x5ceb71(0x18f)](_0x234625=>{const _0x53fd8d=_0x5ceb71;let _0x2d2480=dbUserTable[_0x53fd8d(0x1ab)](_0x367366[_0x53fd8d(0x17c)][_0x53fd8d(0x1cf)],{'username':_0x4fdf59,'password':_0x234625,'question':_0x58c04a,'answer':_0x302cbd,'is_admin':0x1});if(_0x2d2480['changes']>0x0){let _0x14eb4d=dbUserTable[_0x53fd8d(0x1b4)](_0x367366['app'][_0x53fd8d(0x1cf)]),_0x5a5627=sha256(new Date()[_0x53fd8d(0x1f4)]()+_0x4fdf59+_0x234625),_0x1ec6d3=netUtils[_0x53fd8d(0x1a7)](_0x367366);var _0x2e33e2=_0x367366['headers']['user-agent'];dbUserTable['createToken'](_0x367366[_0x53fd8d(0x17c)][_0x53fd8d(0x1cf)],_0x14eb4d['id'],_0x5a5627,_0x1ec6d3,_0x2e33e2),_0x14eb4d[_0x53fd8d(0x179)]='';let _0x5ec2e7=_0x367366[_0x53fd8d(0x201)][_0x53fd8d(0x1ad)],_0x43f34e=_0x367366[_0x53fd8d(0x201)]['region'];return _0x5ec2e7&&dbConfigTable[_0x53fd8d(0x1ab)](_0x367366[_0x53fd8d(0x17c)][_0x53fd8d(0x1cf)],{'title':'language','value':_0x5ec2e7}),_0x43f34e&&dbConfigTable[_0x53fd8d(0x1ab)](_0x367366[_0x53fd8d(0x17c)]['dbOther'],{'title':_0x53fd8d(0x1f0),'value':_0x43f34e}),_0x29c843[_0x53fd8d(0x1d9)]({'code':0x0,'token':_0x5a5627,'user':_0x14eb4d});}})['catch'](_0x3b9a3c=>{const _0xe0a4ff=_0x5ceb71;return console[_0xe0a4ff(0x177)](_0xe0a4ff(0x1d0),_0x3b9a3c),_0x367366[_0xe0a4ff(0x17c)][_0xe0a4ff(0x1a3)](_0x29c843,_0x29c843['__'](_0xe0a4ff(0x218)));});}}),router[_0x5b4749(0x1ca)](_0x5b4749(0x194),(_0x8747b0,_0xd62954,_0x1adda8)=>{const _0x4ee7fa=_0x5b4749;if(_0x8747b0['currentUser'][_0x4ee7fa(0x1ed)]!=0x1)return _0xd62954[_0x4ee7fa(0x1d9)]({'code':0x66});let _0x15efc1=_0x8747b0['body'][_0x4ee7fa(0x195)],_0x145232=_0x8747b0['body'][_0x4ee7fa(0x1a6)];return _0x15efc1&&_0x145232&&dbUserTable[_0x4ee7fa(0x234)](_0x8747b0['app'][_0x4ee7fa(0x1cf)],_0x15efc1,_0x145232),_0xd62954[_0x4ee7fa(0x1d9)]({'code':0x0});}),router[_0x5b4749(0x1ca)](_0x5b4749(0x219),(_0x533828,_0x4dd49d,_0x1d4e8a)=>{const _0x14ed84=_0x5b4749;let _0x5335a8=_0x533828[_0x14ed84(0x201)][_0x14ed84(0x195)],_0x223f65=_0x533828[_0x14ed84(0x201)]['password'],_0x36c0b5=_0x533828[_0x14ed84(0x201)]['question'],_0x5c32d0=_0x533828['body'][_0x14ed84(0x23a)],_0x166b11=_0x533828[_0x14ed84(0x201)][_0x14ed84(0x1a6)];if(newUserCheck(_0x5335a8,_0x223f65,_0x36c0b5,_0x5c32d0,_0x533828,_0x4dd49d)!==!![])return;let _0xc02875=_0x533828[_0x14ed84(0x201)][_0x14ed84(0x240)];if(dbUserTable[_0x14ed84(0x1e0)](_0x533828,_0x4dd49d)===!![]){if(_0xc02875==_0x14ed84(0x1b8)){let _0x16e09c=dbUserTable[_0x14ed84(0x1e1)](_0x533828[_0x14ed84(0x17c)][_0x14ed84(0x1cf)],_0x5335a8);if(_0x16e09c)return _0x533828[_0x14ed84(0x17c)]['returnErrMsg'](_0x4dd49d,_0x4dd49d['__']('login.sameUsernameExist'));}cryptoUtils[_0x14ed84(0x19e)](config[_0x14ed84(0x1a9)],_0x223f65)[_0x14ed84(0x18f)](_0x135850=>{const _0x4473a9=_0x14ed84;let _0x3a87e2=dbUserTable[_0x4473a9(0x1ab)](_0x533828[_0x4473a9(0x17c)][_0x4473a9(0x1cf)],{'username':_0x5335a8,'password':_0x135850,'question':_0x36c0b5,'answer':sha256(_0x5c32d0),'remark':_0x166b11});return _0x3a87e2[_0x4473a9(0x167)]>=0x1?_0x4dd49d[_0x4473a9(0x1d9)]({'code':0x0}):_0x533828['app'][_0x4473a9(0x1a3)](_0x4dd49d,_0x4dd49d['__'](_0x4473a9(0x218)));})[_0x14ed84(0x1f7)](_0x1bcce3=>{const _0x1c4901=_0x14ed84;return console[_0x1c4901(0x177)](_0x1c4901(0x1d0),_0x1bcce3),_0x533828['app'][_0x1c4901(0x1a3)](_0x4dd49d,_0x4dd49d['__'](_0x1c4901(0x218)));});}}),router[_0x5b4749(0x1ca)](_0x5b4749(0x215),(_0xba9201,_0x33d4cf,_0x59b739)=>{const _0x3272dc=_0x5b4749;let _0x4502b0=_0xba9201[_0x3272dc(0x201)][_0x3272dc(0x1ac)];if(dbUserTable[_0x3272dc(0x1e0)](_0xba9201,_0x33d4cf)===!![]){let _0x5f34f9=dbUserTable[_0x3272dc(0x161)](_0xba9201['app'][_0x3272dc(0x1cf)],_0x4502b0);if(_0x5f34f9&&_0x5f34f9[_0x3272dc(0x1ed)]==0x1)return _0x33d4cf[_0x3272dc(0x1d9)]({'code':0x1,'message':_0x3272dc(0x1fb)});dbUserTable[_0x3272dc(0x16f)](_0xba9201[_0x3272dc(0x17c)][_0x3272dc(0x1cf)],_0x5f34f9[_0x3272dc(0x195)]),dbMusicIndexTable[_0x3272dc(0x221)](_0xba9201['app'][_0x3272dc(0x1db)],_0x5f34f9['id']),dbMusicFavorite[_0x3272dc(0x21d)](_0xba9201['app'][_0x3272dc(0x1db)],_0x5f34f9['id']),dbMovieFavorite['deleteFavoriteByUid'](_0xba9201['app'][_0x3272dc(0x1db)],_0x5f34f9['id']);let _0x4c24df=dbUserTable['delete'](_0xba9201['app'][_0x3272dc(0x1cf)],_0x4502b0);return _0x4c24df[_0x3272dc(0x167)]>=0x1?_0x33d4cf[_0x3272dc(0x1d9)]({'code':0x0}):_0xba9201[_0x3272dc(0x17c)][_0x3272dc(0x1a3)](_0x33d4cf,_0x33d4cf['__'](_0x3272dc(0x218)));}}),router[_0x5b4749(0x1ca)](_0x5b4749(0x160),(_0x326bd0,_0xe1fc7c,_0x5e9fe9)=>{const _0x78189=_0x5b4749;if(dbUserTable[_0x78189(0x1e0)](_0x326bd0,_0xe1fc7c)===!![]){let _0x458be1=_0x326bd0[_0x78189(0x201)]['orderField']||'id',_0x1fa3e8=_0x326bd0[_0x78189(0x201)][_0x78189(0x1eb)]||'asc',_0x1bdc56=_0x326bd0['body'][_0x78189(0x1c5)];(!['id',_0x78189(0x195),'user_remark'][_0x78189(0x216)](_0x458be1)||!['asc',_0x78189(0x176)]['includes'](_0x1fa3e8))&&(_0x458be1='id',_0x1fa3e8=_0x78189(0x17a));let _0x416265='SELECT\x20id,username,is_admin,user_remark\x20FROM\x20user\x20',_0x388a12=[];_0x1bdc56&&(_0x416265+=_0x78189(0x220),_0x388a12[_0x78189(0x16e)]('%'+_0x1bdc56+'%','%'+_0x1bdc56+'%'));_0x416265+='\x20ORDER\x20BY\x20'+_0x458be1+'\x20'+_0x1fa3e8;let _0x56e5b6=_0x326bd0['app']['dbOther'][_0x78189(0x174)](_0x416265)[_0x78189(0x1b5)](_0x388a12);return _0xe1fc7c[_0x78189(0x1d9)]({'code':0x0,'userList':_0x56e5b6});}}),router[_0x5b4749(0x1ca)]('/getUserPower',(_0x340468,_0x48da2e,_0x5c926d)=>{const _0x3d15f7=_0x5b4749;let _0xfe2626=_0x340468['body'][_0x3d15f7(0x195)],_0x3568dc=null;if(_0xfe2626!=config[_0x3d15f7(0x16b)]){_0x3568dc=dbUserTable[_0x3d15f7(0x236)](_0x340468[_0x3d15f7(0x17c)][_0x3d15f7(0x1cf)],_0xfe2626);if(!_0x3568dc)return _0x340468['app'][_0x3d15f7(0x1a3)](_0x48da2e,_0x3d15f7(0x1aa));}if(dbUserTable[_0x3d15f7(0x1e0)](_0x340468,_0x48da2e)===!![]||_0xfe2626==_0x340468[_0x3d15f7(0x20d)][_0x3d15f7(0x195)]){let _0x38c418=dbUserTable[_0x3d15f7(0x229)](_0x340468[_0x3d15f7(0x17c)][_0x3d15f7(0x1cf)],_0xfe2626,null,null,!![]),_0x53942c=0x0;if(_0x38c418['length']<0x1)return _0x48da2e[_0x3d15f7(0x1d9)]({'code':0x0,'userPower':_0x38c418,'userMenu':_0x3568dc?_0x3568dc[_0x3d15f7(0x1fa)]:[]});for(let _0x15aa19=0x0;_0x15aa19<_0x38c418['length'];_0x15aa19++){let _0x2892e2=_0x38c418[_0x15aa19][_0x3d15f7(0x15b)];fs[_0x3d15f7(0x1f2)](_0x2892e2,(_0x27428a,_0x5d010b)=>{const _0x2552d7=_0x3d15f7;_0x53942c+=0x1;_0x27428a?_0x38c418[_0x15aa19][_0x2552d7(0x20c)]=0x0:_0x38c418[_0x15aa19][_0x2552d7(0x20c)]=0x1;if(_0x53942c==_0x38c418[_0x2552d7(0x1b1)])return _0x48da2e['json']({'code':0x0,'userPower':_0x38c418,'userMenu':_0x3568dc?_0x3568dc[_0x2552d7(0x1fa)]:[]});});}}}),router['post']('/setUserPower',(_0x55ac69,_0x412660,_0x311b7b)=>{const _0x599439=_0x5b4749;let _0x530309=_0x55ac69[_0x599439(0x201)][_0x599439(0x195)],_0x2123ef=_0x55ac69['body'][_0x599439(0x15b)],_0x7fa8ff=_0x55ac69['body'][_0x599439(0x1cc)];if(!_0x530309||!_0x2123ef||!_0x7fa8ff)return _0x55ac69[_0x599439(0x17c)]['returnErrMsg'](_0x412660,_0x412660['__'](_0x599439(0x218)));let _0x3dd1a8=null;if(_0x530309!=config[_0x599439(0x16b)]){_0x3dd1a8=dbUserTable['getUserByUserName'](_0x55ac69[_0x599439(0x17c)][_0x599439(0x1cf)],_0x530309);if(!_0x3dd1a8)return _0x55ac69['app'][_0x599439(0x1a3)](_0x412660,_0x599439(0x1aa));}_0x2123ef=pathUtil[_0x599439(0x1fc)](_0x2123ef);if(dbUserTable[_0x599439(0x1e0)](_0x55ac69,_0x412660)===!![]){let _0x3a6af7=dbUserTable[_0x599439(0x229)](_0x55ac69['app'][_0x599439(0x1cf)],_0x530309,_0x7fa8ff,null,!![]);for(let _0x3ad247 of _0x3a6af7){let _0x207939=_0x3ad247[_0x599439(0x15b)];if(_0x2123ef[_0x599439(0x1dd)](pathUtil[_0x599439(0x1fc)](_0x207939,pathUtil[_0x599439(0x173)]))&&_0x2123ef!=_0x207939)return _0x55ac69[_0x599439(0x17c)][_0x599439(0x1a3)](_0x412660,_0x412660['__']('path.parentPathExist')+_0x207939,_0x599439(0x1c3));if(_0x207939[_0x599439(0x1dd)](pathUtil[_0x599439(0x1fc)](_0x2123ef,pathUtil[_0x599439(0x173)]))&&_0x2123ef!=_0x207939)return _0x55ac69[_0x599439(0x17c)]['returnErrMsg'](_0x412660,_0x412660['__'](_0x599439(0x207))+_0x207939,_0x599439(0x1c3));}let _0x39bf24=dbUserTable[_0x599439(0x1bc)](_0x55ac69[_0x599439(0x17c)]['dbOther'],_0x55ac69['body']);return _0x412660['json']({'code':0x0,'result':_0x39bf24});}}),router[_0x5b4749(0x1ca)](_0x5b4749(0x196),(_0x534566,_0xa8ecc0,_0x470f)=>{const _0x1ca308=_0x5b4749;let _0x100374=_0x534566[_0x1ca308(0x201)][_0x1ca308(0x195)],_0x4d531b=_0x534566[_0x1ca308(0x201)][_0x1ca308(0x183)];if(!_0x100374||!(_0x4d531b instanceof Array))return _0x534566[_0x1ca308(0x17c)][_0x1ca308(0x1a3)](_0xa8ecc0,_0x1ca308(0x16c));let _0x58d147=dbUserTable[_0x1ca308(0x236)](_0x534566['app']['dbOther'],_0x100374);if(!_0x58d147)return _0x534566[_0x1ca308(0x17c)]['returnErrMsg'](_0xa8ecc0,_0x1ca308(0x1aa));if(dbUserTable[_0x1ca308(0x1e0)](_0x534566,_0xa8ecc0)===!![])return dbUserTable[_0x1ca308(0x15d)](_0x534566['app']['dbOther'],_0x100374,_0x1ca308(0x1fa),JSON['stringify'](_0x4d531b)),_0xa8ecc0['json']({'code':0x0});}),router[_0x5b4749(0x1ca)](_0x5b4749(0x20a),(_0xf9290b,_0x45c510,_0x1683c7)=>{const _0x10d602=_0x5b4749;let _0x3ecfdb=dbUserTable['cancelUserPathPower'](_0xf9290b[_0x10d602(0x17c)][_0x10d602(0x1cf)],_0xf9290b[_0x10d602(0x201)]);return _0x3ecfdb[_0x10d602(0x167)]>0x0?_0x45c510[_0x10d602(0x1d9)]({'code':0x0}):_0xf9290b[_0x10d602(0x17c)][_0x10d602(0x1a3)](_0x45c510,_0x45c510['__'](_0x10d602(0x218)));}),router[_0x5b4749(0x1ca)](_0x5b4749(0x1ec),(_0x4442ce,_0x4517e4,_0x321802)=>{const _0x1c207e=_0x5b4749;let _0x436440=_0x4442ce[_0x1c207e(0x201)][_0x1c207e(0x217)],_0x571ee1=_0x4442ce['body'][_0x1c207e(0x223)];cryptoUtils[_0x1c207e(0x19e)](config[_0x1c207e(0x1a9)],_0x436440)[_0x1c207e(0x18f)](_0x40c21b=>{const _0x10c179=_0x1c207e;if(_0x4442ce[_0x10c179(0x20d)][_0x10c179(0x179)]!=_0x40c21b)return _0x4517e4['json']({'code':0x2,'message':_0x4517e4['__']('login.oldPwdErr')});else cryptoUtils[_0x10c179(0x19e)](config[_0x10c179(0x1a9)],_0x571ee1)[_0x10c179(0x18f)](_0x5368a9=>{const _0x42fb66=_0x10c179;dbUserTable[_0x42fb66(0x232)](_0x4442ce[_0x42fb66(0x17c)]['dbOther'],_0x4442ce[_0x42fb66(0x20d)]['id'],_0x42fb66(0x179),_0x5368a9);let _0x1238d5=sha256(new Date()[_0x42fb66(0x1f4)]()+_0x4442ce['currentUser'][_0x42fb66(0x195)]+_0x4442ce[_0x42fb66(0x20d)]['password']);dbUserTable[_0x42fb66(0x232)](_0x4442ce[_0x42fb66(0x17c)][_0x42fb66(0x1cf)],_0x4442ce[_0x42fb66(0x20d)]['id'],_0x42fb66(0x19a),_0x1238d5);let _0x10a1d5=netUtils['getClientIp'](_0x4442ce);return dbLoginTable['addLoginRecord'](_0x4442ce['app'][_0x42fb66(0x1cf)],_0x42fb66(0x1be),_0x4442ce[_0x42fb66(0x20d)]['id'],_0x10a1d5,_0x4442ce[_0x42fb66(0x201)][_0x42fb66(0x1af)],''),_0x4517e4['json']({'code':0x0});})[_0x10c179(0x1f7)](_0x16323e=>{const _0x15209f=_0x10c179;return console['log'](_0x15209f(0x1d0),_0x16323e),_0x4442ce[_0x15209f(0x17c)][_0x15209f(0x1a3)](_0x4517e4,_0x4517e4['__'](_0x15209f(0x218)));});});}),router[_0x5b4749(0x1ca)]('/changeQuestion',(_0x4e9171,_0xf4cba1,_0x55f2d6)=>{const _0x4594f3=_0x5b4749;let _0x58e3f3=_0x4e9171[_0x4594f3(0x201)][_0x4594f3(0x21f)],_0x3753b9=_0x4e9171[_0x4594f3(0x201)][_0x4594f3(0x23a)];if(checkUtil[_0x4594f3(0x1ef)](_0x3753b9))return _0x4e9171[_0x4594f3(0x17c)]['returnErrMsg'](_0xf4cba1,_0xf4cba1['__']('answerNotSeqNumOrChar'));if(_0x58e3f3==_0x3753b9)return _0x4e9171[_0x4594f3(0x17c)][_0x4594f3(0x1a3)](_0xf4cba1,_0xf4cba1['__'](_0x4594f3(0x210)));return dbUserTable[_0x4594f3(0x21e)](_0x4e9171[_0x4594f3(0x17c)][_0x4594f3(0x1cf)],_0x4e9171[_0x4594f3(0x20d)]['id'],_0x58e3f3,sha256(_0x3753b9)),_0xf4cba1[_0x4594f3(0x1d9)]({'code':0x0});}),router[_0x5b4749(0x1ca)](_0x5b4749(0x197),(_0x304b2d,_0x5b7fce,_0x5f514a)=>{const _0xeb9fd7=_0x5b4749;let _0x7ef563=_0x304b2d[_0xeb9fd7(0x201)][_0xeb9fd7(0x19a)];return _0x7ef563&&dbUserTable['deleteUserTokenByWhere'](_0x304b2d[_0xeb9fd7(0x17c)][_0xeb9fd7(0x1cf)],_0xeb9fd7(0x22b),[_0x7ef563]),_0x5b7fce['json']({'code':0x0});}),router[_0x5b4749(0x1ca)]('/getCurrentUserInfo',(_0x4547c0,_0x5d37f7,_0x344fc0)=>{const _0x32e68f=_0x5b4749;let _0x2ef022=dbUserTable[_0x32e68f(0x161)](_0x4547c0[_0x32e68f(0x17c)][_0x32e68f(0x1cf)],_0x4547c0[_0x32e68f(0x20d)]['id']);return _0x2ef022?(_0x2ef022[_0x32e68f(0x179)]='',_0x2ef022[_0x32e68f(0x23a)]='',_0x5d37f7['json']({'code':0x0,'userInfo':_0x2ef022})):_0x5d37f7['json']({'code':0x65});}),router[_0x5b4749(0x1ca)](_0x5b4749(0x22d),(_0x683c69,_0x49d2d7,_0x228f6a)=>{const _0x1e2a49=_0x5b4749;if(_0x683c69['currentUser'][_0x1e2a49(0x1ed)]!=0x1)return _0x49d2d7['json']({'code':0x66});let _0x4936fc=_0x683c69['body']['ip'];if(_0x4936fc==_0x1e2a49(0x230)||_0x4936fc==_0x1e2a49(0x15e))return _0x683c69[_0x1e2a49(0x17c)][_0x1e2a49(0x1a3)](_0x49d2d7,_0x49d2d7['__'](_0x1e2a49(0x1ce)));let _0xf26554=_0x683c69['body'][_0x1e2a49(0x240)],_0x1de182=_0x683c69['body']['banTimeStamp'];return dbLoginTable[_0x1e2a49(0x225)](_0x683c69[_0x1e2a49(0x17c)][_0x1e2a49(0x1cf)],_0xf26554,_0x4936fc,_0x1de182,_0x49d2d7['__']('login.adminAdded')),_0x683c69[_0x1e2a49(0x17c)][_0x1e2a49(0x193)](),_0x49d2d7[_0x1e2a49(0x1d9)]({'code':0x0});}),router[_0x5b4749(0x1ca)](_0x5b4749(0x18e),(_0x3fc4fd,_0x57227d,_0x47fd96)=>{const _0x4a8876=_0x5b4749;if(_0x3fc4fd[_0x4a8876(0x20d)]['is_admin']!=0x1)return _0x57227d[_0x4a8876(0x1d9)]({'code':0x66});let _0x3fe12e=_0x3fc4fd[_0x4a8876(0x201)]['id'];return dbLoginTable['deleteIp'](_0x3fc4fd[_0x4a8876(0x17c)][_0x4a8876(0x1cf)],_0x3fe12e),_0x3fc4fd[_0x4a8876(0x17c)]['refreshIpList'](),_0x57227d[_0x4a8876(0x1d9)]({'code':0x0});}),router[_0x5b4749(0x1ca)](_0x5b4749(0x211),(_0x27d9d7,_0x5145a,_0x5b5116)=>{const _0x467270=_0x5b4749;let _0xd3bf79=_0x27d9d7[_0x467270(0x201)][_0x467270(0x19f)],_0x5f4bd8=_0x27d9d7[_0x467270(0x201)][_0x467270(0x17d)],_0x42fefc=_0x27d9d7[_0x467270(0x201)]['type'],_0x2fa048=new Date()[_0x467270(0x1f4)]();dbLoginTable[_0x467270(0x1ba)](_0x27d9d7[_0x467270(0x17c)][_0x467270(0x1cf)],_0x467270(0x1e9)+_0x2fa048);let _0x74efc4=_0x467270(0x1ff)+_0x42fefc+'\x27',_0x32d4cf=dbLoginTable[_0x467270(0x16d)](_0x27d9d7[_0x467270(0x17c)][_0x467270(0x1cf)],_0x74efc4),_0x522155=(_0xd3bf79-0x1)*_0x5f4bd8;_0x74efc4+=_0x467270(0x172)+_0x5f4bd8+_0x467270(0x1e3)+_0x522155;let _0x57bc8e=dbLoginTable[_0x467270(0x1e5)](_0x27d9d7['app']['dbOther'],_0x74efc4);return _0x5145a[_0x467270(0x1d9)]({'code':0x0,'data':_0x57bc8e,'pageCount':Math[_0x467270(0x1d6)](_0x32d4cf[_0x467270(0x204)]/_0x5f4bd8)});}),router[_0x5b4749(0x1ca)](_0x5b4749(0x1a4),(_0x330891,_0x13abaf,_0x416016)=>{const _0x292a94=_0x5b4749;if(_0x330891['currentUser'][_0x292a94(0x1ed)]!=0x1)return _0x13abaf[_0x292a94(0x1d9)]({'code':0x66});let _0x34de11=0x1388,_0x2eb5ac=_0x330891[_0x292a94(0x201)]['page'],_0x2ff90c=_0x330891[_0x292a94(0x201)]['pageSize'],_0x42e8da=_0x330891[_0x292a94(0x201)][_0x292a94(0x240)],_0x5c6ba0='',_0x355d52=[];_0x42e8da?(_0x5c6ba0+=_0x292a94(0x1ea),_0x355d52['push'](_0x42e8da)):_0x5c6ba0=_0x292a94(0x1a5);let _0x3f9e44=dbLoginTable['getRecordCountByWhere'](_0x330891[_0x292a94(0x17c)]['dbOther'],_0x5c6ba0,_0x355d52)['count'];if(_0x3f9e44>_0x34de11){let _0x1bc4f3=0x64,_0x2d63a3=dbLoginTable['deleteRecordByWhere'](_0x330891[_0x292a94(0x17c)][_0x292a94(0x1cf)],_0x292a94(0x235)+_0x1bc4f3+')');_0x2d63a3[_0x292a94(0x167)]>0x0&&(_0x3f9e44=_0x3f9e44-_0x2d63a3[_0x292a94(0x167)]);}let _0x16ff8f=(_0x2eb5ac-0x1)*_0x2ff90c;_0x5c6ba0+='\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?',_0x355d52['push'](_0x2ff90c),_0x355d52[_0x292a94(0x16e)](_0x16ff8f);let _0x1b9a12=dbLoginTable[_0x292a94(0x1d5)](_0x330891['app'][_0x292a94(0x1cf)],_0x5c6ba0,_0x355d52);return _0x13abaf[_0x292a94(0x1d9)]({'code':0x0,'data':_0x1b9a12,'pageCount':Math['ceil'](_0x3f9e44/_0x2ff90c)});}),module[_0x5b4749(0x1a0)]=router;