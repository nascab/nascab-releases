const _0x20520e=_0x483f;function _0x483f(_0x3a4ea9,_0x47632e){const _0x40d7b7=_0x40d7();return _0x483f=function(_0x483f08,_0x56130a){_0x483f08=_0x483f08-0x17f;let _0x4f9f1f=_0x40d7b7[_0x483f08];return _0x4f9f1f;},_0x483f(_0x3a4ea9,_0x47632e);}(function(_0x125ce9,_0x1bd440){const _0x38b55b=_0x483f,_0x584d0e=_0x125ce9();while(!![]){try{const _0x48695b=-parseInt(_0x38b55b(0x188))/0x1*(-parseInt(_0x38b55b(0x1c3))/0x2)+-parseInt(_0x38b55b(0x1c9))/0x3+-parseInt(_0x38b55b(0x1af))/0x4*(parseInt(_0x38b55b(0x18c))/0x5)+-parseInt(_0x38b55b(0x182))/0x6*(-parseInt(_0x38b55b(0x186))/0x7)+-parseInt(_0x38b55b(0x1ae))/0x8+parseInt(_0x38b55b(0x1c8))/0x9*(-parseInt(_0x38b55b(0x1bd))/0xa)+-parseInt(_0x38b55b(0x185))/0xb*(-parseInt(_0x38b55b(0x1c6))/0xc);if(_0x48695b===_0x1bd440)break;else _0x584d0e['push'](_0x584d0e['shift']());}catch(_0x3059a0){_0x584d0e['push'](_0x584d0e['shift']());}}}(_0x40d7,0x6de53));let express=require(_0x20520e(0x1cd)),router=express[_0x20520e(0x19e)](),uploadUtil=require(_0x20520e(0x17f));const dbUserTable=require(_0x20520e(0x1ac));function _0x40d7(){const _0x36e898=['bookIndexId','2LyHOrg','uploadSubtitle','tempMediaToolsUpload','noPermission','1350190uXhPvR','ImageCompress','targetFolderNotExist','INDEX_TABLE_NAME_BOOK','encodeFilename','power_add','decodePath','../../myConfig/config','returnErrMsg','W_OK','post','existsSync','书籍封面保存目录','exports','../../db/dbFileIndexTable','query','json','extname','Router','uploadFile','need\x20book\x20index\x20id','body','returnFileError','log','headers','filename','savePath','app','uploadBookCover','includes','join','now','../../db/dbUserTable','constants','1872696AyhIrF','4lsqGiG','save_path','mkdirSync','lastIndexOf','stat','/regularUpload','username','overMode','over_mode','substring','imgZipTmpUpload','imgZip','../utils/fileUtils','doUserCanGet','10NuhRbB','sameNameFileAlreadExist','dirname','path','power_get','basename','138124CiMBen','nascab_torrentSavePath','currentUser','12TvuucT','.jpg','4491657gQSWRG','358110GtYPlN','uploadStartTime','relativePath','imgTypeList','express','../utils/uploadUtils','access','dbFileIndex','728436bBnoen','error\x20book\x20index\x20id','onlySupportImage','11773927afNVSI','21Gddoja'];_0x40d7=function(){return _0x36e898;};return _0x40d7();}let fs=require('fs'),fileUtil=require(_0x20520e(0x1bb)),path=require('path'),config=require(_0x20520e(0x193));const dbFileIndexTable=require(_0x20520e(0x19a));router[_0x20520e(0x196)]('/folderExist',function(_0x75d61a,_0x348367){const _0x2a75b3=_0x20520e;let _0x35af03=_0x75d61a['body'][_0x2a75b3(0x1a6)];fs[_0x2a75b3(0x1b3)](_0x35af03,(_0x23c150,_0x1f316d)=>{const _0x352969=_0x2a75b3;return _0x23c150?_0x75d61a['app'][_0x352969(0x194)](_0x348367,_0x348367['__'](_0x352969(0x18e))):_0x348367[_0x352969(0x19c)]({'code':0x0});});}),router[_0x20520e(0x196)](_0x20520e(0x1b4),function(_0x4f35a1,_0x191567){const _0x423e68=_0x20520e;if(_0x4f35a1['headers'][_0x423e68(0x1b0)]){let _0x2101c4=decodeURIComponent(_0x4f35a1[_0x423e68(0x1a4)][_0x423e68(0x1b0)]);_0x4f35a1[_0x423e68(0x1a1)][_0x423e68(0x1a6)]=_0x2101c4,_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1a6)]=_0x2101c4;}_0x4f35a1['headers'][_0x423e68(0x1b7)]&&(_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1b6)]=_0x4f35a1[_0x423e68(0x1a4)][_0x423e68(0x1b7)]);let _0x56d590,_0x2bd92a,_0x11dc50=!![];try{_0x4f35a1['query'][_0x423e68(0x1a6)]&&(_0x56d590=fileUtil[_0x423e68(0x192)](_0x4f35a1[_0x423e68(0x19b)]['savePath']));if(_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1a8)]==0x1){let _0x276e20=_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x187)];if(!_0x276e20)return _0x4f35a1[_0x423e68(0x1a7)][_0x423e68(0x194)](_0x191567,_0x423e68(0x1a0));let _0x45946d=dbFileIndexTable['getById'](_0x4f35a1[_0x423e68(0x1a7)][_0x423e68(0x181)],_0x276e20,dbFileIndexTable[_0x423e68(0x18f)]);if(!_0x45946d)return _0x4f35a1[_0x423e68(0x1a7)][_0x423e68(0x194)](_0x191567,_0x423e68(0x183));_0x56d590=_0x45946d[_0x423e68(0x1c0)],_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1a6)]=_0x45946d[_0x423e68(0x1c0)],_0x4f35a1['query'][_0x423e68(0x1b6)]='over',_0x11dc50=![];let _0x10a772=path[_0x423e68(0x1aa)](_0x45946d[_0x423e68(0x1c0)],_0x45946d['filename']),_0x5e0383=_0x10a772[_0x423e68(0x1b8)](0x0,_0x10a772[_0x423e68(0x1b2)]('.'))+_0x423e68(0x1c7),_0x40c333=path[_0x423e68(0x1c2)](_0x5e0383);_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1a5)]=encodeURIComponent(_0x40c333),console[_0x423e68(0x1a3)](_0x423e68(0x198),_0x56d590,_0x4f35a1[_0x423e68(0x19b)]['filename']);}if(_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1cb)]){_0x2bd92a=fileUtil[_0x423e68(0x192)](_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1cb)]);let _0x2b5411=path[_0x423e68(0x1bf)](path[_0x423e68(0x1aa)](_0x56d590,_0x2bd92a));!fs[_0x423e68(0x197)](_0x2b5411)&&fs[_0x423e68(0x1b1)](_0x2b5411,{'recursive':!![]}),_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1a6)]=_0x2b5411,_0x11dc50=![];}let _0x184e6a=Date[_0x423e68(0x1ab)]();_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1ca)]=_0x184e6a;if(_0x4f35a1['query'][_0x423e68(0x1ba)]==0x1){if(dbUserTable[_0x423e68(0x1bc)](_0x4f35a1,_0x191567,_0x423e68(0x18d),_0x423e68(0x1c1),'',!![])==!![])_0x56d590=path[_0x423e68(0x1aa)](config[_0x423e68(0x18a)],_0x4f35a1[_0x423e68(0x1c5)][_0x423e68(0x1b5)],_0x423e68(0x1b9),_0x184e6a+''),!fs[_0x423e68(0x197)](_0x56d590)&&fs[_0x423e68(0x1b1)](_0x56d590,{'recursive':!![]}),_0x11dc50=![],_0x4f35a1['body'][_0x423e68(0x1a6)]=_0x56d590;else return _0x4f35a1['app'][_0x423e68(0x194)](_0x191567,_0x191567['__']('noPermission'));}if(_0x4f35a1['query']['encodeFilename']){_0x4f35a1['query'][_0x423e68(0x1a5)]=fileUtil[_0x423e68(0x192)](_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x190)]);let _0x315862=path[_0x423e68(0x1aa)](_0x56d590,_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1a5)]);if(_0x4f35a1[_0x423e68(0x19b)]['saveByDate']!=0x1&&_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1b6)]&&_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1b6)]=='skip'&&fs[_0x423e68(0x197)](_0x315862))return _0x191567[_0x423e68(0x19c)]({'code':0x1,'remark':'SAMENAME','message':_0x191567['__'](_0x423e68(0x1be))});}if(_0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x1ba)]==0x1){let _0x54aa27=path[_0x423e68(0x19d)](_0x4f35a1['query']['filename']);if(!config[_0x423e68(0x1cc)][_0x423e68(0x1a9)](_0x54aa27['toLowerCase']()))return _0x4f35a1[_0x423e68(0x1a7)][_0x423e68(0x194)](_0x191567,_0x191567['__'](_0x423e68(0x184)));}}catch(_0x1b0b65){return console[_0x423e68(0x1a3)](_0x1b0b65),_0x4f35a1[_0x423e68(0x1a7)][_0x423e68(0x194)](_0x191567,_0x191567['__']('operationFail'));}if(_0x56d590&&_0x56d590!=_0x423e68(0x1c4))fs[_0x423e68(0x180)](_0x56d590,fs[_0x423e68(0x1ad)][_0x423e68(0x195)]|fs[_0x423e68(0x1ad)]['R_OK'],_0x11bd73=>{const _0x21a229=_0x423e68;if(_0x11bd73)return fileUtil[_0x21a229(0x1a2)](_0x191567,_0x11bd73);if(dbUserTable[_0x21a229(0x1bc)](_0x4f35a1,_0x191567,'folder',_0x21a229(0x191),_0x56d590,!![])==!![])uploadUtil['uploadFile'](_0x4f35a1,_0x191567,_0x11dc50);else return _0x4f35a1[_0x21a229(0x1a7)][_0x21a229(0x194)](_0x191567,_0x191567['__'](_0x21a229(0x18b)));});else _0x4f35a1[_0x423e68(0x19b)][_0x423e68(0x189)]==0x1?uploadUtil[_0x423e68(0x19f)](_0x4f35a1,_0x191567,_0x11dc50):uploadUtil[_0x423e68(0x19f)](_0x4f35a1,_0x191567,_0x11dc50);}),module[_0x20520e(0x199)]=router;