function _0x153e(){const _0x82ff9f=['filename','returnErrMsg','over_mode','imgZip','log','substring','nascab_torrentSavePath','skip','post','1738236SUTqXh','app','../../db/dbUserTable','power_add','error\x20book\x20index\x20id','5204alQfYl','Router','书籍封面保存目录','body','access','bookIndexId','targetFolderNotExist','mkdirSync','SAMENAME','onlySupportImage','relativePath','decodePath','../../db/dbFileIndexTable','imgTypeList','225bWnktC','5606946ICnoYX','uploadStartTime','exports','join','saveByDate','1065730gtEhtw','../utils/uploadUtils','toLowerCase','/folderExist','path','operationFail','encodeFilename','ImageCompress','constants','username','574056XzVwuU','need\x20book\x20index\x20id','INDEX_TABLE_NAME_BOOK','overMode','lastIndexOf','express','sameNameFileAlreadExist','basename','1644251HxJsAY','doUserCanGet','W_OK','includes','getById','.jpg','now','2368305rTAUFD','dirname','json','query','noPermission','../utils/fileUtils','savePath','uploadFile','8qahEDY','/regularUpload','headers','returnFileError','existsSync','tempMediaToolsUpload','uploadBookCover','save_path'];_0x153e=function(){return _0x82ff9f;};return _0x153e();}const _0x5d5ef2=_0x372a;(function(_0x327788,_0x599105){const _0x7196df=_0x372a,_0x427414=_0x327788();while(!![]){try{const _0x1a210f=parseInt(_0x7196df(0x154))/0x1+parseInt(_0x7196df(0x186))/0x2+-parseInt(_0x7196df(0x199))/0x3*(-parseInt(_0x7196df(0x18b))/0x4)+-parseInt(_0x7196df(0x16d))/0x5+-parseInt(_0x7196df(0x15e))/0x6+parseInt(_0x7196df(0x166))/0x7*(-parseInt(_0x7196df(0x175))/0x8)+-parseInt(_0x7196df(0x19a))/0x9;if(_0x1a210f===_0x599105)break;else _0x427414['push'](_0x427414['shift']());}catch(_0x5084fa){_0x427414['push'](_0x427414['shift']());}}}(_0x153e,0x93c0f));let express=require(_0x5d5ef2(0x163)),router=express[_0x5d5ef2(0x18c)](),uploadUtil=require(_0x5d5ef2(0x155));const dbUserTable=require(_0x5d5ef2(0x188));let fs=require('fs'),fileUtil=require(_0x5d5ef2(0x172)),path=require(_0x5d5ef2(0x158)),config=require('../../myConfig/config');function _0x372a(_0x2266cd,_0x2d578e){const _0x153e1a=_0x153e();return _0x372a=function(_0x372ad5,_0x32b7ea){_0x372ad5=_0x372ad5-0x152;let _0x14dd0c=_0x153e1a[_0x372ad5];return _0x14dd0c;},_0x372a(_0x2266cd,_0x2d578e);}const dbFileIndexTable=require(_0x5d5ef2(0x197));router[_0x5d5ef2(0x185)](_0x5d5ef2(0x157),function(_0x46cc3b,_0x4b1350){const _0x256949=_0x5d5ef2;let _0x4f26bc=_0x46cc3b[_0x256949(0x18e)]['savePath'];fs['stat'](_0x4f26bc,(_0x4e1633,_0x849a97)=>{const _0x8433b8=_0x256949;return _0x4e1633?_0x46cc3b['app'][_0x8433b8(0x17e)](_0x4b1350,_0x4b1350['__'](_0x8433b8(0x191))):_0x4b1350[_0x8433b8(0x16f)]({'code':0x0});});}),router[_0x5d5ef2(0x185)](_0x5d5ef2(0x176),function(_0x381e35,_0x3675e5){const _0x59382a=_0x5d5ef2;if(_0x381e35[_0x59382a(0x177)][_0x59382a(0x17c)]){let _0x3146a9=decodeURIComponent(_0x381e35[_0x59382a(0x177)][_0x59382a(0x17c)]);_0x381e35[_0x59382a(0x18e)][_0x59382a(0x173)]=_0x3146a9,_0x381e35[_0x59382a(0x170)][_0x59382a(0x173)]=_0x3146a9;}_0x381e35['headers'][_0x59382a(0x17f)]&&(_0x381e35['query'][_0x59382a(0x161)]=_0x381e35[_0x59382a(0x177)][_0x59382a(0x17f)]);let _0x49e268,_0x5e217f,_0x3ff1f9=!![];try{_0x381e35[_0x59382a(0x170)][_0x59382a(0x173)]&&(_0x49e268=fileUtil['decodePath'](_0x381e35[_0x59382a(0x170)][_0x59382a(0x173)]));if(_0x381e35[_0x59382a(0x170)][_0x59382a(0x17b)]==0x1){let _0xef9119=_0x381e35[_0x59382a(0x170)][_0x59382a(0x190)];if(!_0xef9119)return _0x381e35[_0x59382a(0x187)]['returnErrMsg'](_0x3675e5,_0x59382a(0x15f));let _0x4b05ab=dbFileIndexTable[_0x59382a(0x16a)](_0x381e35[_0x59382a(0x187)]['dbFileIndex'],_0xef9119,dbFileIndexTable[_0x59382a(0x160)]);if(!_0x4b05ab)return _0x381e35['app'][_0x59382a(0x17e)](_0x3675e5,_0x59382a(0x18a));_0x49e268=_0x4b05ab[_0x59382a(0x158)],_0x381e35[_0x59382a(0x170)][_0x59382a(0x173)]=_0x4b05ab[_0x59382a(0x158)],_0x381e35[_0x59382a(0x170)][_0x59382a(0x161)]='over',_0x3ff1f9=![];let _0x2c5971=path[_0x59382a(0x152)](_0x4b05ab[_0x59382a(0x158)],_0x4b05ab[_0x59382a(0x17d)]),_0x5c4375=_0x2c5971[_0x59382a(0x182)](0x0,_0x2c5971[_0x59382a(0x162)]('.'))+_0x59382a(0x16b),_0x26e399=path[_0x59382a(0x165)](_0x5c4375);_0x381e35['query'][_0x59382a(0x17d)]=encodeURIComponent(_0x26e399),console[_0x59382a(0x181)](_0x59382a(0x18d),_0x49e268,_0x381e35[_0x59382a(0x170)]['filename']);}if(_0x381e35[_0x59382a(0x170)][_0x59382a(0x195)]){_0x5e217f=fileUtil[_0x59382a(0x196)](_0x381e35[_0x59382a(0x170)][_0x59382a(0x195)]);let _0x2fd4ec=path[_0x59382a(0x16e)](path[_0x59382a(0x152)](_0x49e268,_0x5e217f));!fs[_0x59382a(0x179)](_0x2fd4ec)&&fs['mkdirSync'](_0x2fd4ec,{'recursive':!![]}),_0x381e35['query'][_0x59382a(0x173)]=_0x2fd4ec,_0x3ff1f9=![];}let _0x637389=Date[_0x59382a(0x16c)]();_0x381e35[_0x59382a(0x170)][_0x59382a(0x19b)]=_0x637389;if(_0x381e35['query'][_0x59382a(0x180)]==0x1){if(dbUserTable[_0x59382a(0x167)](_0x381e35,_0x3675e5,_0x59382a(0x15b),'power_get','',!![])==!![])_0x49e268=path[_0x59382a(0x152)](config[_0x59382a(0x17a)],_0x381e35['currentUser'][_0x59382a(0x15d)],'imgZipTmpUpload',_0x637389+''),!fs[_0x59382a(0x179)](_0x49e268)&&fs[_0x59382a(0x192)](_0x49e268,{'recursive':!![]}),_0x3ff1f9=![],_0x381e35['body'][_0x59382a(0x173)]=_0x49e268;else return _0x381e35['app'][_0x59382a(0x17e)](_0x3675e5,_0x3675e5['__'](_0x59382a(0x171)));}if(_0x381e35[_0x59382a(0x170)][_0x59382a(0x15a)]){_0x381e35[_0x59382a(0x170)]['filename']=fileUtil[_0x59382a(0x196)](_0x381e35[_0x59382a(0x170)][_0x59382a(0x15a)]);let _0xa0521d=path[_0x59382a(0x152)](_0x49e268,_0x381e35[_0x59382a(0x170)][_0x59382a(0x17d)]);if(_0x381e35['query'][_0x59382a(0x153)]!=0x1&&_0x381e35[_0x59382a(0x170)][_0x59382a(0x161)]&&_0x381e35[_0x59382a(0x170)][_0x59382a(0x161)]==_0x59382a(0x184)&&fs[_0x59382a(0x179)](_0xa0521d))return _0x3675e5['json']({'code':0x1,'remark':_0x59382a(0x193),'message':_0x3675e5['__'](_0x59382a(0x164))});}if(_0x381e35[_0x59382a(0x170)]['imgZip']==0x1){let _0x53df74=path['extname'](_0x381e35[_0x59382a(0x170)][_0x59382a(0x17d)]);if(!config[_0x59382a(0x198)][_0x59382a(0x169)](_0x53df74[_0x59382a(0x156)]()))return _0x381e35[_0x59382a(0x187)]['returnErrMsg'](_0x3675e5,_0x3675e5['__'](_0x59382a(0x194)));}}catch(_0x8c7a11){return console['log'](_0x8c7a11),_0x381e35[_0x59382a(0x187)]['returnErrMsg'](_0x3675e5,_0x3675e5['__'](_0x59382a(0x159)));}if(_0x49e268&&_0x49e268!=_0x59382a(0x183))fs[_0x59382a(0x18f)](_0x49e268,fs['constants'][_0x59382a(0x168)]|fs[_0x59382a(0x15c)]['R_OK'],_0x4138ea=>{const _0x53fd99=_0x59382a;if(_0x4138ea)return fileUtil[_0x53fd99(0x178)](_0x3675e5,_0x4138ea);if(dbUserTable[_0x53fd99(0x167)](_0x381e35,_0x3675e5,'folder',_0x53fd99(0x189),_0x49e268,!![])==!![])uploadUtil['uploadFile'](_0x381e35,_0x3675e5,_0x3ff1f9);else return _0x381e35['app']['returnErrMsg'](_0x3675e5,_0x3675e5['__']('noPermission'));});else _0x381e35[_0x59382a(0x170)]['uploadSubtitle']==0x1?uploadUtil[_0x59382a(0x174)](_0x381e35,_0x3675e5,_0x3ff1f9):uploadUtil[_0x59382a(0x174)](_0x381e35,_0x3675e5,_0x3ff1f9);}),module[_0x5d5ef2(0x19c)]=router;