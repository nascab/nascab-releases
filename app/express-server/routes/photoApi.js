const _0x3e7c88=_0x3860;(function(_0x5d9a22,_0xb07f66){const _0x506985=_0x3860,_0x51d1ca=_0x5d9a22();while(!![]){try{const _0x3b04a5=parseInt(_0x506985(0xbf))/0x1*(-parseInt(_0x506985(0x10e))/0x2)+-parseInt(_0x506985(0x15d))/0x3*(parseInt(_0x506985(0x1b1))/0x4)+-parseInt(_0x506985(0xab))/0x5+-parseInt(_0x506985(0x109))/0x6*(parseInt(_0x506985(0x16f))/0x7)+-parseInt(_0x506985(0x1aa))/0x8+-parseInt(_0x506985(0x168))/0x9*(-parseInt(_0x506985(0x14c))/0xa)+parseInt(_0x506985(0xd7))/0xb;if(_0x3b04a5===_0xb07f66)break;else _0x51d1ca['push'](_0x51d1ca['shift']());}catch(_0x1a8cff){_0x51d1ca['push'](_0x51d1ca['shift']());}}}(_0x31ec,0xbf52e));let express=require(_0x3e7c88(0xf4)),router=express['Router'](),path=require(_0x3e7c88(0x159));const config=require('../../myConfig/config'),dbFileIndexTable=require(_0x3e7c88(0x1de)),dbSourceFolderTable=require(_0x3e7c88(0x82)),dbFileOperationRecord=require(_0x3e7c88(0x18a)),sqliteUtil=require(_0x3e7c88(0x1dc)),exifUtils=require(_0x3e7c88(0xc0)),dbUserTable=require(_0x3e7c88(0xca)),dbAlbumTable=require(_0x3e7c88(0x181));function _0x31ec(){const _0x3b76bc=['sortType','ExifIFD','getList','\x20AND\x20geohash3!=\x27undefined\x27\x20GROUP\x20BY\x20geohash3','getPathWhere','5464145SQMQRz','getSharpInstanceFromInput','facesPath','deleteRawTempFile','excludeFilenamePhoto','value','GPSIFD','sortField','isFile','face_img_path','imagePreviewSize','endsWith','/clearTrashBin','zoom','\x20is_file,id,path,filename,ext,type,width,height,duration,size,original_date,original_time,latitude,longitude\x20','geohash5\x20=\x20?','geohash3\x20=\x20?','/updatePhotoFace','/getFaceImg/*','f2x','3719cvKDXZ','../../utils/exifUtils','rotate','\x20AND\x20','faceApiWaitDealCount','\x20type=1\x20','getUserPathWhere','getPhotoByParams','get','GPSDateStamp','getUserPower','../../db/dbUserTable','../utils/sharpUtils','power_get','basename','count','.MP4','whereStr','includes','SELECT\x20index_id\x20FROM\x20photo_phash_similar\x20group\x20by\x20index_id','album.sameNameExist','error\x20data','geoHashList','\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)','72983889PzTcZP','GPSLongitudeRef','startFaceAiWork','filename','parent','/switchFaceId','\x20AND\x20(type=1\x20or\x20type=2)\x20AND\x20in_trash=0','DELETE\x20FROM\x20photo_faces2index\x20where\x20face_id=?\x20and\x20photo_index_id\x20=?','ERROR\x20GPS\x20LOCATION','\x20and\x20face_id=','writeFile','\x20AND\x20filename\x20LIKE\x20?\x20','imagePreviewType','type','newDate','/getIndexDetail','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20phash\x20is\x20null\x20and\x20type=1','similar_index_id','stringify','chi','mtime','end','showFileType','checkSqlInjection','dbFileIndex','SELECT\x20*\x20FROM\x20photo_library\x20','join','keepIndexList','faceIdList','express','create','ADD','similar','faceName','\x20is_file,id,path,filename,ext,type,width,height,duration,size,original_date,original_time\x20','getDate','getTimeLineDateList','locationList','aiSimilarPhotoEnable','isIndexing','faceapi','\x20AND\x20\x20is_file=1\x20','pathList','cacheDeleteFail','SELECT\x20*\x20from\x20photo_phash_similar\x20where\x20index_id=','desc','deleteList','parse','is_file','raw_filename','117300NtNVWD','/getAiDealState','getMonth','ordinaryAlbumId','photoPreviewType','470nuFbfr','imgList','SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20disabled=0\x20and\x20belong_face_id\x20is\x20null\x20and\x20face_photo_count>=?\x20order\x20by\x20face_photo_count\x20desc\x20limit\x20500','app','INDEX_TABLE_NAME_MUSIC','dealList','toFile','EDIT','.HEIC','/getBoundsPhoto','dbOther','geohash2\x20=\x20?','sendFile','original_time','original_date','/editExifByIndexId','UPDATE\x20photo_faces2index\x20SET\x20face_id=?\x20WHERE\x20face_id=?\x20and\x20photo_index_id=?','UPDATE\x20photo_faces2index\x20SET\x20is_face_poster=0\x20where\x20is_face_poster=1\x20and\x20face_id\x20in\x20','replace','maxLat','round','UPDATE\x20photo_faces\x20SET\x20face_img_path=\x27\x27\x20where\x20id=','indexFullPath','photoSavedAsNewFile','photoPreviewSize','run','longitude','delete','\x20type=2\x20\x20','\x20AND\x20geohash2!=\x27undefined\x27\x20GROUP\x20BY\x20geohash2','/addAlbum','error\x20pathList','updateBySql','/resetSimilarPhotoAi','\x20SET\x20in_trash=1,in_trash_time=','/searchMode','minIndexId','photo','doUserCanGet','resize','\x20order\x20by\x20f.original_time\x20desc\x20limit\x201','/dealSimilarPhoto','excludePathPhoto','from','getByName','SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20id=?','id,is_file,is_livephoto,path,filename,raw_filename,is_raw','getAllByWhereAndField','minLng','delete\x20from\x20photo_phash_similar\x20where\x20index_id=','/getSimilarPhoto','share_uid','user_list','transSpcielFormat','trash','dbCity','editId','../../db/dbConfigTable','cachePath','UPDATE\x20photo_faces\x20SET\x20face_name=?\x20where\x20id\x20=\x20?','RAW','dump','160mXvbpC','paramsList','\x20in_trash=1\x20and\x20is_file=1\x20','COCO_CLASS_MIN_SCORE','sep','trim','geohash4\x20=\x20?','file_index_photo-indexing','asc','startSimilarPhotoWork','GPSLatitude','getFaceInSql','UPDATE\x20file_index_photo\x20SET\x20is_show=0\x20WHERE\x20path=?\x20AND\x20filename\x20=?','path','returnErrMsg','SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20face_name=?\x20and\x20belong_face_id\x20is\x20null','SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20share_for_subuser=1','933eYGrGR','close','disabled','stat','power_add','create_time','f2y','folderNotExist','putInSystemTrash','\x20WHERE\x20id\x20=\x20','title','278838ZNsGiS','SELECT\x20index_id\x20FROM\x20photo_phash_similar\x20group\x20by\x20index_id\x20limit\x20','excludeIds','delete\x20from\x20photo_faces\x20where\x201=1','operationFail','./photoApiUtils','libraryId','560rvZSSH','load','log','udpateName','UPDATE\x20photo_faces\x20SET\x20belong_face_id=?\x20where\x20id\x20=\x20?\x20or\x20belong_face_id=?','existsSync','extname','getByWhere','isAdmin','SELECT\x20*\x20FROM\x20file_index_photo\x20WHERE\x20in_trash=1\x20AND\x20is_file=1\x20AND\x20raw_filename\x20is\x20not\x20null\x20AND\x20raw_filename!=\x27\x27\x20AND\x20type=1','aiClassId','getById','indexOf','Exif','data','push','jpeg','getCountByWhere','../../db/dbAlbumTable','/getPhotoFaces','utimes','operation\x20fail','/getPhotoByTime','/restoreTrashBinFiles','UPDATE\x20photo_faces\x20SET\x20belong_face_id=?\x20where\x20id\x20=\x20?','book','CUSTOM','../../db/dbFileOperationRecord','setFaceId','photo_index_id','f2height','searchStr','\x20and\x20a.is_face_poster=1\x20limit\x201','length','orderField','floor','face_id','addFileOperationRecord','is_admin','INDEX_TABLE_NAME_PHOTO','shareForSubUser','query','send','cocossd','exports','getAllByWhere','substring','\x20is_file,id,path,filename,ext,duration,size\x20','UPDATE\x20photo_library\x20SET\x20title=?,path_list=?,share_for_subuser=?,share_uid=?\x20WHERE\x20id=?','dialog','abs','INDEX_TABLE_NAME_MOVIE','SELECT\x20*\x20FROM\x20photo_faces\x20where\x20id\x20=?','json','STATE_FAIL','/updateAlbum','UPDATE\x20','getAlbumWhereStr','\x20id,geohash,latitude,longitude,original_time\x20','12024904nrvvjI','binary','piexifjs','id,username','orderType','index_id','operation','16888WeuHxh','/getTimeLineDateList','sourceFolderList','\x20AND\x20geohash\x20LIKE\x20?\x20','shell','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20ai_face_detect_state=0\x20and\x20(type=1\x20or\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20','findByTitle','\x20is_file=0\x20','/deleteAlbum','readFile','bboxes','getFullYear','SELECT\x20f.id\x20as\x20photo_index_id\x20FROM\x20ai_classes2index\x20as\x20a\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20ON\x20a.photo_index_id=f.id\x20WHERE\x20a.class_id=?\x20and\x20score>?\x20and\x20\x20f.in_trash=0\x20\x20and\x20f.tiny_path\x20is\x20not\x20null\x20AND\x20f.tiny_path\x20!=\x20\x270\x27\x20\x20','latitude','changes','f2id','.jpg','data_value','offset','LEVEL_MAIN_OPERATION','存在livephoto','similarIndexList','insert','toLowerCase','path_list','is_livephoto','status','\x20(((type=1\x20or\x20type=2)\x20\x20)\x20OR\x20is_file=0\x20)\x20','/removeFromFace','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20ai_class_state=0\x20and\x20(type=1\x20or\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27','searchValue','update','name','\x20order\x20by\x20score\x20desc','timestamp','year','size','SELECT\x20*\x20FROM\x20ai_classes\x20where\x20\x20class_name\x20not\x20in\x20','rawFile','shareUidList','delete\x20from\x20photo_faces2index\x20where\x201=1','indexId','/getPhotoClasses','../utils/sqliteUtil','f2width','../../db/dbFileIndexTable','getIndexTableNameByType','TYPE_DELETE','\x20and\x20title\x20like\x20?','body','GPS','serveType','serverType','\x20latitude=?,longitude=?,geohash=?,geohash5=?,geohash4=?,geohash3=?,geohash2=?\x20','GPSLongitude','SELECT\x20id,path,filename,original_date,size\x20FROM\x20file_index_photo\x20where\x20id=','resolve','\x20SET\x20in_trash=0\x20WHERE\x20in_trash=1','SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20id=?','\x20AND\x20geohash5!=\x27undefined\x27\x20GROUP\x20BY\x20geohash5','GET','albumId','cocossdWaitDealCount','dataPreview','movie','faceApiWaitCompareCount','\x20path=\x20?\x20AND\x20','faceId','/getFileTreePhoto','fileExist','getAllByWhereAndFieldFromOrdinaryAlbum','\x20size=?,ctime=?\x20','platform','rawFaceIndexIdList','../../db/dbSourceFolderTable','REPLACE\x20INTO\x20photo_library(title,path_list,share_for_subuser,share_uid,user_id)\x20VALUES(\x20?,?,?,?,?)','similarWaitDealCount','.JPG','defaultTranscodeResolution','concat','getFileHashName','moviePlaylongPressRate','/getAllAlbum','timeOrder','targetFaceId','post','indexObj','toString','DateTimeOriginal','all','maxLng','update\x20file_index_photo\x20set\x20phash=null,phash_compare=0','ctimeMs','currentUser','encode','Image\x20format\x20not\x20support','DELETE\x20FROM\x20photo_library\x20\x20WHERE\x20id=?','Cleaning\x20out\x20the\x20recycle\x20bin\x20:\x20','timeType','\x20\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)\x20','\x20OFFSET\x20','dirname','prepare','power_change','\x20original_time=?,original_date=?\x20','geohash','UPDATE\x20photo_faces\x20SET\x20face_name=null\x20where\x20face_name\x20=\x20?','moviePreferLanguage','/setFacePoster','getTime'];_0x31ec=function(){return _0x3b76bc;};return _0x31ec();}let geohash=require('ngeohash'),fs=require('fs');const dbConfigTable=require(_0x3e7c88(0x147));let sharpUtil=require(_0x3e7c88(0xcb));const photoApiUtil=require(_0x3e7c88(0x16d)),platform=require('os')[_0x3e7c88(0x80)]();let piexif=require(_0x3e7c88(0x1ac));router[_0x3e7c88(0x8d)](_0x3e7c88(0x1b2),(_0x542591,_0xa18273,_0xf721a2)=>{const _0x1ac5a1=_0x3e7c88;if(dbUserTable[_0x1ac5a1(0x134)](_0x542591,_0xa18273,_0x1ac5a1(0x133),_0x1ac5a1(0xcc))==!![]){let _0x48cbd7=_0x542591[_0x1ac5a1(0x1e2)][_0x1ac5a1(0x1d4)],_0x432b90=_0x542591[_0x1ac5a1(0x1e2)]['type'],_0x296f26=_0x542591[_0x1ac5a1(0x1e2)][_0x1ac5a1(0xa1)],_0x1709d9=_0x542591[_0x1ac5a1(0x1e2)][_0x1ac5a1(0x1ee)],_0x26e75c=_0x542591[_0x1ac5a1(0x1e2)]['searchStr'],_0xc003fd=_0x542591[_0x1ac5a1(0x1e2)][_0x1ac5a1(0x10c)],_0x47bb87=_0x542591[_0x1ac5a1(0x1e2)][_0x1ac5a1(0x179)],_0x12fcfa=_0x542591[_0x1ac5a1(0x1e2)][_0x1ac5a1(0x16e)],_0x5e0483=_0x542591[_0x1ac5a1(0x1e2)][_0x1ac5a1(0x7b)],_0x233480=_0x542591[_0x1ac5a1(0x1e2)][_0x1ac5a1(0x8b)],_0x1c8f09=_0x542591['body'][_0x1ac5a1(0x1b3)],_0x412319=dbUserTable[_0x1ac5a1(0xc5)](_0x542591,_0x1ac5a1(0x133),_0x1ac5a1(0xcc),!![],_0x1c8f09),_0x5f6579=_0x412319['whereStr'],_0x1b1a32=[..._0x412319[_0x1ac5a1(0x14d)]];_0x296f26&&(_0x5f6579+=_0x1ac5a1(0x1b4),_0x1b1a32[_0x1ac5a1(0x17e)](_0x296f26+'%'));let _0x46f622=dbSourceFolderTable['getExcludePathWhereStr'](_0x542591[_0x1ac5a1(0x111)][_0x1ac5a1(0x118)],'path',_0x1ac5a1(0x138));_0x46f622&&(_0x5f6579+=_0x1ac5a1(0xc2)+_0x46f622);let _0x2b6f53=dbSourceFolderTable['getExcludePathWhereStr'](_0x542591[_0x1ac5a1(0x111)][_0x1ac5a1(0x118)],'filename',_0x1ac5a1(0xaf));_0x2b6f53&&(_0x5f6579+=_0x1ac5a1(0xc2)+_0x2b6f53);if(_0x12fcfa){let _0x503850=_0x542591[_0x1ac5a1(0x111)][_0x1ac5a1(0xef)][_0x1ac5a1(0x9e)](_0x1ac5a1(0x1eb))['get'](_0x12fcfa);if(_0x503850)try{let _0x2c601c=JSON[_0x1ac5a1(0x106)](_0x503850[_0x1ac5a1(0x1c9)]),_0x50e2c7=dbUserTable[_0x1ac5a1(0xaa)](!![],_0x2c601c);_0x5f6579+=_0x50e2c7[_0x1ac5a1(0xd0)],_0x1b1a32=_0x1b1a32[_0x1ac5a1(0x87)](_0x50e2c7[_0x1ac5a1(0x14d)]);}catch(_0x2d3e16){console[_0x1ac5a1(0x171)](_0x2d3e16);}}if(_0x1709d9){let _0x2cab71=dbAlbumTable[_0x1ac5a1(0x1a8)](_0x542591['app']['dbOther'],_0x1709d9);_0x2cab71&&(_0x5f6579+=_0x1ac5a1(0xc2)+_0x2cab71);}_0x26e75c&&(_0x5f6579+=_0x1ac5a1(0xd6),_0x1b1a32[_0x1ac5a1(0x17e)]('%'+_0x26e75c+'%'),_0x1b1a32[_0x1ac5a1(0x17e)]('%'+_0x26e75c+'%'));_0x5f6579+='\x20\x20\x20AND\x20in_trash!=1\x20';let _0x4d8996=dbFileIndexTable[_0x1ac5a1(0xfb)](_0x542591['app']['dbFileIndex'],_0x48cbd7,_0x432b90,_0x5f6579,_0xc003fd,_0x47bb87,_0x5e0483,_0x1b1a32,_0x233480);_0xa18273[_0x1ac5a1(0x1a4)]({'code':0x0,'data':_0x4d8996});}});let geoDbCache={};function _0x3860(_0x158882,_0x10115c){const _0x31ec69=_0x31ec();return _0x3860=function(_0x3860d4,_0x331967){_0x3860d4=_0x3860d4-0x7b;let _0x470ae2=_0x31ec69[_0x3860d4];return _0x470ae2;},_0x3860(_0x158882,_0x10115c);}router[_0x3e7c88(0x8d)](_0x3e7c88(0x185),(_0x48f3f4,_0x4422f7,_0x32f71a)=>{const _0x37c764=_0x3e7c88;if(dbUserTable[_0x37c764(0x134)](_0x48f3f4,_0x4422f7,'photo',_0x37c764(0xcc))==!![]){result=photoApiUtil[_0x37c764(0xc6)](_0x48f3f4,_0x4422f7);let _0x3df79a=[],_0x25bc82=[];try{if(result&&result[_0x37c764(0x190)]>0x0){for(let _0x432fd1 of result){!_0x3df79a[_0x37c764(0xd1)](_0x432fd1['original_date'])&&(_0x3df79a[_0x37c764(0x17e)](_0x432fd1[_0x37c764(0x11c)]),_0x25bc82[_0x37c764(0x17e)]({'date':_0x432fd1[_0x37c764(0x11c)],'geoHashList':[],'locationList':[]}));if(_0x432fd1['geohash']&&_0x432fd1['geohash']!='undefined'&&_0x432fd1[_0x37c764(0xa1)]['length']>0x4){let _0x503490=_0x25bc82[_0x3df79a[_0x37c764(0x17b)](_0x432fd1[_0x37c764(0x11c)])]['geoHashList'],_0x574a01=_0x432fd1[_0x37c764(0xa1)][_0x37c764(0x19d)](0x0,0x5);!_0x503490['includes'](_0x574a01)&&_0x503490[_0x37c764(0x190)]<0x5&&_0x503490[_0x37c764(0x17e)](_0x574a01);}}for(let _0x104360 of _0x25bc82){if(_0x104360[_0x37c764(0xd5)][_0x37c764(0x190)]<0x1)continue;for(let _0x4f547d in _0x104360[_0x37c764(0xd5)]){let _0x137739=_0x104360[_0x37c764(0xd5)][_0x4f547d][_0x37c764(0x19d)](0x0,0x5),_0x531460=null;if(geoDbCache[_0x137739])_0x531460=geoDbCache[_0x137739];else{let _0x511bd7='SELECT\x20name,cn_name,geohash\x20FROM\x20cities\x20WHERE\x20geohash=?';_0x531460=_0x48f3f4[_0x37c764(0x111)][_0x37c764(0x145)][_0x37c764(0x9e)](_0x511bd7)['get'](_0x137739),geoDbCache[_0x137739]=_0x531460;}_0x531460&&_0x104360['locationList']['push'](_0x531460);}delete _0x104360[_0x37c764(0xd5)];}for(let _0x585c1c=_0x25bc82['length']-0x1;_0x585c1c>=0x0;_0x585c1c--){_0x25bc82[_0x585c1c][_0x37c764(0xfc)]['length']<0x1&&_0x25bc82['splice'](_0x585c1c,0x1);}}}catch(_0x320a46){console[_0x37c764(0x171)](_0x320a46);}let _0x4eca3f={'code':0x0,'data':result,'originalDateItemList':_0x25bc82},_0x28e991=dbConfigTable['findByTitle'](_0x48f3f4[_0x37c764(0x111)]['dbOther'],_0x37c764(0x10d)),_0x28bdc5=dbConfigTable[_0x37c764(0x1b7)](_0x48f3f4['app'][_0x37c764(0x118)],_0x37c764(0x126));_0x4eca3f[_0x37c764(0xe3)]=_0x37c764(0x14a);if(_0x28e991&&_0x28e991[_0x37c764(0xb0)]==_0x37c764(0x189)&&_0x28bdc5&&_0x28bdc5[_0x37c764(0xb0)])try{let _0xfcbd44=parseInt(_0x28bdc5[_0x37c764(0xb0)]);_0x4eca3f['imagePreviewType']=_0x37c764(0x189),_0x4eca3f[_0x37c764(0xb5)]=_0xfcbd44;}catch(_0x368aa0){console[_0x37c764(0x171)](_0x368aa0);}_0x4422f7[_0x37c764(0x1a4)](_0x4eca3f);}}),router[_0x3e7c88(0x8d)]('/getAlbumPhotoForMap',(_0x1e84a4,_0x5d41c2,_0x293b10)=>{const _0x3796a3=_0x3e7c88;let _0x4fa2de='\x20in_trash=0\x20AND\x20latitude!=\x27undefined\x27\x20AND\x20longitude!=\x27undefined\x27\x20AND\x20latitude\x20is\x20not\x20null',_0x29bece=[],_0x46b13c=_0x1e84a4[_0x3796a3(0x1e2)][_0x3796a3(0x16e)];if(_0x1e84a4[_0x3796a3(0x1e2)][_0x3796a3(0x1ee)]){let _0x3e635c=dbAlbumTable[_0x3796a3(0x1a8)](_0x1e84a4[_0x3796a3(0x111)][_0x3796a3(0x118)],_0x1e84a4[_0x3796a3(0x1e2)]['albumId']);_0x3e635c&&(_0x4fa2de+=_0x3796a3(0xc2)+_0x3e635c);}if(_0x46b13c){let _0x1ec0a9=_0x1e84a4['app'][_0x3796a3(0xef)][_0x3796a3(0x9e)](_0x3796a3(0x1eb))[_0x3796a3(0xc7)](_0x46b13c);if(_0x1ec0a9)try{let _0x2f1472=JSON['parse'](_0x1ec0a9[_0x3796a3(0x1c9)]),_0xac7209=dbUserTable['getPathWhere'](!![],_0x2f1472);_0x4fa2de+=_0xac7209['whereStr'],_0x29bece[_0x3796a3(0x17e)](..._0xac7209[_0x3796a3(0x14d)]);}catch(_0x4598ad){console[_0x3796a3(0x171)](_0x4598ad);}}function _0x8f8c2a(_0x3aa1e7,_0x29183e,_0x593d17){const _0x588655=_0x3796a3;if(_0x593d17){let _0x5b2ce2=0x0;if(_0x1e84a4['body'][_0x588655(0x10c)]){let _0x10e666=dbFileIndexTable['getAllByWhereAndFieldFromOrdinaryAlbumCount'](_0x1e84a4[_0x588655(0x111)]['dbFileIndex'],_0x3aa1e7,[parseInt(_0x1e84a4[_0x588655(0x1e2)][_0x588655(0x10c)]),..._0x29bece]);_0x5b2ce2=_0x10e666['count'];}else{let _0x3d0a7a=dbFileIndexTable[_0x588655(0x180)](_0x1e84a4['app'][_0x588655(0xef)],_0x3aa1e7,dbFileIndexTable[_0x588655(0x196)],_0x29bece);_0x5b2ce2=_0x3d0a7a[_0x588655(0xce)];}return _0x5b2ce2;}else{let _0x668615=[];return _0x1e84a4[_0x588655(0x1e2)][_0x588655(0x10c)]?_0x668615=dbFileIndexTable[_0x588655(0x7e)](_0x1e84a4['app'][_0x588655(0xef)],_0x3aa1e7,_0x29183e,[parseInt(_0x1e84a4[_0x588655(0x1e2)][_0x588655(0x10c)]),..._0x29bece]):_0x668615=dbFileIndexTable[_0x588655(0x13d)](_0x1e84a4[_0x588655(0x111)][_0x588655(0xef)],_0x3aa1e7,_0x29183e,dbFileIndexTable[_0x588655(0x196)],_0x29bece),_0x668615;}}let _0x27014b=dbUserTable[_0x3796a3(0xc5)](_0x1e84a4,'photo',_0x3796a3(0xcc),!![]),_0x5184f8=_0x27014b[_0x3796a3(0xd0)];_0x4fa2de+=_0x5184f8,_0x29bece['push'](..._0x27014b[_0x3796a3(0x14d)]),_0x4fa2de+=_0x3796a3(0x100);let _0x544741=0xc8,_0x11f13c=[],_0x40e090=_0x8f8c2a(_0x4fa2de,null,!![]);if(_0x40e090<_0x544741)_0x11f13c=_0x8f8c2a(_0x4fa2de,'*');else{let _0x2042b1=_0x4fa2de+_0x3796a3(0x1ec),_0x1fd4ba=_0x8f8c2a(_0x2042b1,'*');if(_0x1fd4ba&&_0x1fd4ba[_0x3796a3(0x190)]<_0x544741)_0x11f13c=_0x1fd4ba;else{let _0x145828=_0x4fa2de+'\x20AND\x20geohash4!=\x27undefined\x27\x20GROUP\x20BY\x20geohash4',_0x3ef17d=_0x8f8c2a(_0x145828,'*');if(_0x3ef17d&&_0x3ef17d[_0x3796a3(0x190)]<_0x544741)_0x11f13c=_0x3ef17d;else{let _0x219cf3=_0x4fa2de+_0x3796a3(0xa9),_0x3bdfa9=_0x8f8c2a(_0x219cf3,'*');if(_0x3bdfa9&&_0x3bdfa9[_0x3796a3(0x190)]<_0x544741)_0x11f13c=_0x3bdfa9;else{let _0x1653ef=_0x4fa2de+_0x3796a3(0x12b);_0x11f13c=_0x8f8c2a(_0x1653ef,'*');}}}}return _0x5d41c2[_0x3796a3(0x1a4)]({'code':0x0,'mapPhoto':_0x11f13c});}),router['post'](_0x3e7c88(0x117),(_0x6295c8,_0x4be9f7,_0x31d967)=>{const _0x449b8b=_0x3e7c88;if(dbUserTable['doUserCanGet'](_0x6295c8,_0x4be9f7,_0x449b8b(0x133),_0x449b8b(0xcc))==!![]){let _0x8119e1=_0x6295c8[_0x449b8b(0x1e2)]['minLat'],_0x11adb8=_0x6295c8[_0x449b8b(0x1e2)][_0x449b8b(0x13e)],_0x25565a=_0x6295c8[_0x449b8b(0x1e2)][_0x449b8b(0x121)],_0x2a2d96=_0x6295c8[_0x449b8b(0x1e2)][_0x449b8b(0x92)],_0x11e94f=_0x6295c8[_0x449b8b(0x1e2)][_0x449b8b(0xb8)],_0x167c13='',_0xd5fdb8=0x2;if(_0x11e94f<=0x4)_0xd5fdb8=0x2,_0x167c13=_0x449b8b(0x119);else{if(_0x11e94f<=0x6)_0xd5fdb8=0x3,_0x167c13=_0x449b8b(0xbb);else _0x11e94f<=0x8?(_0xd5fdb8=0x4,_0x167c13=_0x449b8b(0x152)):(_0xd5fdb8=0x5,_0x167c13=_0x449b8b(0xba));}let _0x1b9248=geohash[_0x449b8b(0x1bb)](_0x8119e1,_0x11adb8,_0x25565a,_0x2a2d96,_0xd5fdb8),_0x2026a9=_0x449b8b(0x1a9),_0x37ec5a=[],_0x237aab=dbUserTable[_0x449b8b(0xc5)](_0x6295c8,_0x449b8b(0x133),_0x449b8b(0xcc),!![]);for(let _0x379b86=0x0;_0x379b86<_0x1b9248[_0x449b8b(0x190)];_0x379b86++){let _0x3e0620=_0x1b9248[_0x379b86],_0xbbe816=[_0x3e0620,..._0x237aab[_0x449b8b(0x14d)]],_0x2cc959='\x20'+_0x167c13+'\x20'+_0x237aab[_0x449b8b(0xd0)]+'\x20AND\x20in_trash=0\x20\x20AND\x20is_file=1\x20\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20limit\x201',_0x367366=dbFileIndexTable[_0x449b8b(0x176)](_0x6295c8[_0x449b8b(0x111)][_0x449b8b(0xef)],_0x2cc959,_0x2026a9,dbFileIndexTable[_0x449b8b(0x196)],_0xbbe816);_0x367366&&_0x37ec5a[_0x449b8b(0x17e)](_0x367366);}_0x4be9f7['json']({'code':0x0,'mapPhoto':_0x37ec5a});}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x12c),(_0x385234,_0x2b86c2,_0x1bd813)=>{const _0x2b3ad6=_0x3e7c88;if(dbUserTable[_0x2b3ad6(0x134)](_0x385234,_0x2b86c2,'photo',_0x2b3ad6(0x161))==!![]){let _0xfcab16=_0x385234[_0x2b3ad6(0x1e2)][_0x2b3ad6(0xe4)],_0x127eac=_0x385234[_0x2b3ad6(0x1e2)]['data'],_0x5b3605=_0x385234[_0x2b3ad6(0x1e2)][_0x2b3ad6(0x1c2)],_0x41d277=_0x385234['body'][_0x2b3ad6(0x1d1)],_0x856c5d=_0x385234[_0x2b3ad6(0x1e2)][_0x2b3ad6(0x146)];if(!_0x127eac||!_0x127eac[_0x2b3ad6(0x1cf)]||sqliteUtil[_0x2b3ad6(0xee)](_0x127eac[_0x2b3ad6(0x1cf)])==!![])return _0x385234[_0x2b3ad6(0x111)][_0x2b3ad6(0x15a)](_0x2b86c2,_0x2b3ad6(0xd4));if(!_0x856c5d){let _0x56fa98=dbAlbumTable[_0x2b3ad6(0x13a)](_0x385234[_0x2b3ad6(0x111)][_0x2b3ad6(0x118)],_0x41d277);if(_0x56fa98)return _0x385234[_0x2b3ad6(0x111)][_0x2b3ad6(0x15a)](_0x2b86c2,_0x2b86c2['__'](_0x2b3ad6(0xd3)));}let _0x49829e=null;_0x856c5d?_0x49829e=dbAlbumTable[_0x2b3ad6(0x1d0)](_0x385234['app'][_0x2b3ad6(0x118)],{'type':_0xfcab16,'data':_0x127eac,'data_value':_0x5b3605,'name':_0x41d277},_0x856c5d):_0x49829e=dbAlbumTable[_0x2b3ad6(0xf5)](_0x385234['app'][_0x2b3ad6(0x118)],{'type':_0xfcab16,'data':_0x127eac,'data_value':_0x5b3605,'name':_0x41d277}),_0x2b86c2['json']({'code':0x0,'result':_0x49829e});}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x1b9),(_0x35f834,_0xfa3e12,_0x558a93)=>{const _0x50c66b=_0x3e7c88;if(dbUserTable[_0x50c66b(0x134)](_0x35f834,_0xfa3e12,_0x50c66b(0x133),'power_delete')==!![]){let _0x46b926=_0x35f834[_0x50c66b(0x1e2)]['id'],_0x35621a=dbAlbumTable[_0x50c66b(0x129)](_0x35f834[_0x50c66b(0x111)][_0x50c66b(0x118)],_0x46b926);_0x35621a[_0x50c66b(0x1bf)]>0x0?_0xfa3e12[_0x50c66b(0x1a4)]({'code':0x0,'result':_0x35621a}):_0xfa3e12['json']({'code':0x1,'message':_0x50c66b(0x184)});}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x1a6),(_0x3caf74,_0x3ac9a0,_0x4743c0)=>{const _0x47ffb1=_0x3e7c88;if(dbUserTable['doUserCanGet'](_0x3caf74,_0x3ac9a0,_0x47ffb1(0x133),_0x47ffb1(0x9f))==!![]){let _0xea656e=_0x3caf74['body']['id'],_0x4da5ba=_0x3caf74['body'][_0x47ffb1(0x1d1)],_0x1c761c=dbAlbumTable[_0x47ffb1(0x13a)](_0x3caf74[_0x47ffb1(0x111)][_0x47ffb1(0x118)],_0x4da5ba);if(_0x1c761c)return _0x3caf74['app'][_0x47ffb1(0x15a)](_0x3ac9a0,_0x3ac9a0['__'](_0x47ffb1(0xd3)));let _0x56e3b9=dbAlbumTable[_0x47ffb1(0x172)](_0x3caf74[_0x47ffb1(0x111)][_0x47ffb1(0x118)],_0xea656e,_0x4da5ba);_0x56e3b9[_0x47ffb1(0x1bf)]>0x0?_0x3ac9a0['json']({'code':0x0,'result':_0x56e3b9}):_0x3ac9a0['json']({'code':0x1,'message':_0x47ffb1(0x184)});}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x8a),(_0x47ce3f,_0x53f1c5,_0x30e39e)=>{const _0x155984=_0x3e7c88;if(dbUserTable['doUserCanGet'](_0x47ce3f,_0x53f1c5,_0x155984(0x133),'power_get')==!![]){let _0x59cc0e=_0x47ce3f['body'][_0x155984(0xce)]||0x32,_0x35ca64=_0x47ce3f[_0x155984(0x1e2)]['offset']||0x0,_0x590d0f=_0x47ce3f[_0x155984(0x1e2)][_0x155984(0x191)]||'id',_0x5c7a9f=_0x47ce3f[_0x155984(0x1e2)][_0x155984(0x1ae)]||_0x155984(0x104),_0x534f3a=_0x47ce3f[_0x155984(0x1e2)]['search'],_0x254874=dbAlbumTable[_0x155984(0xa8)](_0x47ce3f[_0x155984(0x111)][_0x155984(0x118)],_0x59cc0e,_0x35ca64,_0x590d0f,_0x5c7a9f,_0x534f3a),_0x47c720=dbUserTable[_0x155984(0xc5)](_0x47ce3f,_0x155984(0x133),_0x155984(0xcc),!![]);for(let _0x119a78=0x0;_0x119a78<_0x254874[_0x155984(0x190)];_0x119a78++){let _0x92cd20='\x20is_file=1\x20';_0x92cd20+=_0x47c720[_0x155984(0xd0)];let _0x199dd1=[..._0x47c720['paramsList']],_0x47e048=dbAlbumTable[_0x155984(0x1a8)](_0x47ce3f[_0x155984(0x111)]['dbOther'],_0x254874[_0x119a78]['id']);_0x47e048&&(_0x92cd20+=_0x155984(0xc2)+_0x47e048);_0x92cd20+=_0x155984(0xdd),_0x92cd20+='\x20ORDER\x20BY\x20original_time\x20DESC\x20LIMIT\x201';try{let _0x1ace8b=dbFileIndexTable['getAllByWhere'](_0x47ce3f[_0x155984(0x111)]['dbFileIndex'],_0x92cd20,'*',dbFileIndexTable[_0x155984(0x196)],_0x199dd1);_0x254874[_0x119a78][_0x155984(0x10f)]=_0x1ace8b;}catch(_0x214d0e){console[_0x155984(0x171)](_0x214d0e),_0x254874[_0x119a78][_0x155984(0x10f)]=[];}}_0x53f1c5[_0x155984(0x1a4)]({'code':0x0,'data':_0x254874});}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x131),(_0x47cddf,_0x5092d1,_0x43cd50)=>{const _0x3961fd=_0x3e7c88;let _0x317ad0=_0x47cddf[_0x3961fd(0x1e2)]['key'],_0x385552=dbFileIndexTable['searchMode'](_0x47cddf[_0x3961fd(0x111)][_0x3961fd(0xef)],_0x317ad0),_0x27b603=[];for(let _0x208c98=0x0;_0x208c98<_0x385552[_0x3961fd(0x190)];_0x208c98++){_0x27b603[_0x3961fd(0x17e)](_0x385552[_0x208c98]['mode']);}_0x5092d1[_0x3961fd(0x1a4)]({'code':0x0,'data':_0x27b603});}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x7c),(_0x1bac58,_0x1d30a8,_0x4cdeb1)=>{const _0x2e46e8=_0x3e7c88;let _0x329348=_0x1bac58[_0x2e46e8(0x1e2)][_0x2e46e8(0xdb)],_0x4c1ebf=_0x1bac58[_0x2e46e8(0x1e2)][_0x2e46e8(0x1e4)],_0x445547=_0x1bac58[_0x2e46e8(0x1e2)][_0x2e46e8(0xce)],_0x40ec8d=_0x1bac58[_0x2e46e8(0x1e2)][_0x2e46e8(0x1c3)]||0x0;_0x40ec8d=parseInt(_0x40ec8d);let _0x2e1a97=parseInt(_0x1bac58[_0x2e46e8(0x1e2)][_0x2e46e8(0xed)]),_0x501f62=_0x1bac58['body'][_0x2e46e8(0x18e)],_0x44e72f=[_0x2e46e8(0xda),_0x2e46e8(0x11b),_0x2e46e8(0x1d5),_0x2e46e8(0x162),'filename_number'],_0x3fbe58=[_0x2e46e8(0x154),_0x2e46e8(0x104)],_0x2c8149=_0x1bac58[_0x2e46e8(0x1e2)][_0x2e46e8(0x191)]||'id',_0x2b9ca7=_0x1bac58[_0x2e46e8(0x1e2)][_0x2e46e8(0x1ae)]||_0x2e46e8(0x104);!_0x44e72f[_0x2e46e8(0xd1)](_0x2c8149)&&(_0x2c8149='id');!_0x3fbe58[_0x2e46e8(0xd1)](_0x2b9ca7)&&(_0x2c8149=_0x2e46e8(0x104));if(dbUserTable['doUserCanGet'](_0x1bac58,_0x1d30a8,_0x4c1ebf,_0x2e46e8(0xcc))==!![]){let _0x511648=[];if(!_0x329348){let _0x253872=[];_0x1bac58[_0x2e46e8(0x95)][_0x2e46e8(0x195)]==0x1?_0x253872=dbSourceFolderTable['getPathByType'](_0x1bac58[_0x2e46e8(0x111)][_0x2e46e8(0x118)],_0x4c1ebf):_0x253872=dbUserTable[_0x2e46e8(0xc9)](_0x1bac58[_0x2e46e8(0x111)][_0x2e46e8(0x118)],_0x1bac58[_0x2e46e8(0x95)]['username'],_0x4c1ebf);if(_0x253872)for(let _0x4f900e=0x0;_0x4f900e<_0x253872['length'];_0x4f900e++){_0x511648[_0x2e46e8(0x17e)]({'path':_0x253872[_0x4f900e][_0x2e46e8(0x159)],'is_file':0x0,'filename':path[_0x2e46e8(0xcd)](_0x253872[_0x4f900e][_0x2e46e8(0x159)]),'root':!![]});}}else{if(_0x1bac58[_0x2e46e8(0x95)][_0x2e46e8(0x195)]!=0x1){if(dbUserTable[_0x2e46e8(0x134)](_0x1bac58,_0x1d30a8,_0x4c1ebf,'power_get',_0x329348)!==!![])return;}_0x329348=path[_0x2e46e8(0x1e9)](path['normalize'](_0x329348));let _0x933476=_0x2e46e8(0x1f3),_0x223622=[_0x329348];if(_0x2e1a97==0x0)_0x933476+=_0x2e46e8(0x1cc);else{if(_0x2e1a97==0x1)_0x933476+=_0x2e46e8(0xc4);else{if(_0x2e1a97==0x2)_0x933476+=_0x2e46e8(0x12a);else _0x2e1a97==0x3&&(_0x933476+=_0x2e46e8(0x1b8));}}if(_0x501f62){let _0x4cf172=_0x2e46e8(0x9b);_0x223622[_0x2e46e8(0x17e)]('%'+_0x501f62+'%','\x27%'+_0x501f62+'%\x27'),_0x4c1ebf==_0x2e46e8(0x1f1)&&(_0x4cf172=_0x2e46e8(0xe2),_0x223622[_0x2e46e8(0x17e)]('\x27%'+_0x501f62+'%\x27')),_0x933476+=_0x4cf172;}let _0x34339b=_0x2e46e8(0xb9),_0x21c0e2=dbFileIndexTable[_0x2e46e8(0x1df)](_0x4c1ebf);if(_0x4c1ebf=='movie')_0x34339b=_0x2e46e8(0xf9);else _0x4c1ebf=='music'&&(_0x34339b=_0x2e46e8(0x19e));_0x933476+='\x20ORDER\x20BY\x20is_file\x20asc,\x20'+_0x2c8149+'\x20'+_0x2b9ca7+'\x20LIMIT\x20'+_0x445547+_0x2e46e8(0x9c)+_0x40ec8d,_0x511648=dbFileIndexTable['getAllByWhere'](_0x1bac58[_0x2e46e8(0x111)]['dbFileIndex'],_0x933476,_0x34339b,_0x21c0e2,_0x223622);}let _0x30869f=path[_0x2e46e8(0x150)],_0x13ad05={'platform':platform,'code':0x0,'data':_0x511648,'sep':_0x30869f};return _0x1d30a8['json'](_0x13ad05);}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0xe6),(_0x2974df,_0x2a99b4,_0x4004bc)=>{const _0x382c0c=_0x3e7c88;let _0x40e87d=_0x2974df[_0x382c0c(0x1e2)]['id'],_0x3e50be=_0x2974df[_0x382c0c(0x1e2)][_0x382c0c(0x1e5)],_0x4e51c8=dbFileIndexTable['INDEX_TABLE_NAME_PHOTO'];if(_0x3e50be=='movie')_0x4e51c8=dbFileIndexTable[_0x382c0c(0x1a2)];else{if(_0x3e50be=='music')_0x4e51c8=dbFileIndexTable[_0x382c0c(0x112)];else _0x3e50be==_0x382c0c(0x188)&&(_0x4e51c8=dbFileIndexTable['INDEX_TABLE_NAME_BOOK']);}let _0x3cb9e7=dbFileIndexTable[_0x382c0c(0x17a)](_0x2974df[_0x382c0c(0x111)][_0x382c0c(0xef)],_0x40e87d,_0x4e51c8);if(!_0x3cb9e7)return _0x2a99b4[_0x382c0c(0x1cb)](0x194)['end']();if(dbUserTable[_0x382c0c(0x134)](_0x2974df,_0x2a99b4,'',_0x382c0c(0xcc),_0x3cb9e7[_0x382c0c(0x159)])==!![]){let _0x2a4a4a={'code':0x0,'data':_0x3cb9e7};if(_0x3e50be=='movie'){let _0x335373=dbConfigTable[_0x382c0c(0x1b7)](_0x2974df[_0x382c0c(0x111)][_0x382c0c(0x118)],_0x382c0c(0xa3));_0x2a4a4a[_0x382c0c(0xa3)]=_0x335373?_0x335373['value']:_0x382c0c(0xea),_0x2a4a4a[_0x382c0c(0x17d)][_0x382c0c(0xa3)]=_0x2a4a4a[_0x382c0c(0xa3)];let _0x5cf934=dbConfigTable[_0x382c0c(0x1b7)](_0x2974df[_0x382c0c(0x111)][_0x382c0c(0x118)],'moviePlaylongPressRate');_0x2a4a4a[_0x382c0c(0x89)]=_0x5cf934?_0x5cf934[_0x382c0c(0xb0)]:'2',_0x2a4a4a['data'][_0x382c0c(0x89)]=_0x2a4a4a[_0x382c0c(0x89)];let _0xc00451=dbConfigTable[_0x382c0c(0x1b7)](_0x2974df[_0x382c0c(0x111)][_0x382c0c(0x118)],_0x382c0c(0x86));_0x2a4a4a['defaultTranscodeResolution']=_0xc00451?_0xc00451['value']:'3';let _0x431851=dbConfigTable[_0x382c0c(0x1b7)](_0x2974df[_0x382c0c(0x111)][_0x382c0c(0x118)],'defaultMoviePlay');_0x2a4a4a['defaultMoviePlay']=_0x431851?_0x431851['value']:_0x382c0c(0x1d7);let _0x1e0064=path['join'](_0x3cb9e7[_0x382c0c(0x159)],_0x3cb9e7[_0x382c0c(0xda)]);fs[_0x382c0c(0x160)](_0x1e0064,(_0x47b8b1,_0xcbba25)=>{const _0x960e82=_0x382c0c;return _0x47b8b1?(_0x2a4a4a[_0x960e82(0x7d)]=0x0,_0x2a4a4a[_0x960e82(0x124)]=_0x1e0064):(_0x2a4a4a[_0x960e82(0x7d)]=0x1,_0x2a4a4a[_0x960e82(0x124)]=_0x1e0064),_0x2a99b4[_0x960e82(0x1a4)](_0x2a4a4a);});}else return _0x2a99b4[_0x382c0c(0x1a4)](_0x2a4a4a);}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x11d),(_0x35d10b,_0x6a5540,_0x585a99)=>{const _0x2648f4=_0x3e7c88;if(dbUserTable[_0x2648f4(0x134)](_0x35d10b,_0x6a5540,_0x2648f4(0x133),'power_change')==!![]){let _0x5342f3=_0x35d10b[_0x2648f4(0x1e2)]['id'],_0x33fce9=_0x35d10b[_0x2648f4(0x1e2)][_0x2648f4(0x1be)],_0x248eec=_0x35d10b['body'][_0x2648f4(0x128)],_0x505fa4=_0x35d10b[_0x2648f4(0x1e2)][_0x2648f4(0xe5)],_0x15562d=dbFileIndexTable[_0x2648f4(0x17a)](_0x35d10b['app'][_0x2648f4(0xef)],_0x5342f3);if(!_0x15562d)return _0x35d10b['app'][_0x2648f4(0x15a)](_0x6a5540,_0x6a5540['__'](_0x2648f4(0x125)));let _0x215089=path[_0x2648f4(0xf1)](_0x15562d['path'],path['sep'],_0x15562d[_0x2648f4(0xda)]),_0x4cc3be=path['extname'](_0x215089)?path[_0x2648f4(0x175)](_0x215089)[_0x2648f4(0x1c8)]():'';if(_0x4cc3be!='.jpg'&&_0x4cc3be!='.jpeg')return _0x35d10b[_0x2648f4(0x111)][_0x2648f4(0x15a)](_0x6a5540,_0x2648f4(0x97));fs['stat'](_0x215089,(_0x276e29,_0x24f290)=>{const _0x2bd607=_0x2648f4;if(_0x276e29||!_0x24f290[_0x2bd607(0xb3)]())return _0x35d10b[_0x2bd607(0x111)][_0x2bd607(0x15a)](_0x6a5540,_0x6a5540['__'](_0x2bd607(0x164)));if(_0x276e29||!_0x24f290[_0x2bd607(0xb3)]())return _0x35d10b[_0x2bd607(0x111)]['returnErrMsg'](_0x6a5540,_0x6a5540['__'](_0x2bd607(0x164)));fs[_0x2bd607(0x1ba)](_0x215089,(_0x4a26ac,_0x1cff56)=>{const _0x362dcd=_0x2bd607;if(_0x4a26ac)return _0x35d10b[_0x362dcd(0x111)]['returnErrMsg'](_0x6a5540,_0x6a5540['__'](_0x362dcd(0x16c)));var _0x185b04=piexif[_0x362dcd(0x170)](_0x1cff56[_0x362dcd(0x8f)](_0x362dcd(0x1ab)));if(_0x33fce9&&_0x248eec){function _0xe720ce(_0x280aa5){const _0x207c67=_0x362dcd;try{_0x280aa5=Number(_0x280aa5);let _0x2de708=Math['floor'](Math[_0x207c67(0x1a1)](_0x280aa5)),_0x20832b=(Math[_0x207c67(0x1a1)](_0x280aa5)-_0x2de708)*0x3c,_0x2562c7=Math[_0x207c67(0x192)](_0x20832b),_0x294d28=Math[_0x207c67(0x122)]((_0x20832b-_0x2562c7)*0x3c*0x64);return[[_0x2de708,0x1],[_0x2562c7,0x1],[_0x294d28,0x64]];}catch(_0x4863fa){return'';}}let _0x32e629=_0xe720ce(_0x33fce9),_0x1d892f=_0xe720ce(_0x248eec);if(!_0x1d892f||!_0x32e629)return _0x35d10b[_0x362dcd(0x111)][_0x362dcd(0x15a)](_0x6a5540,_0x362dcd(0xdf));_0x185b04['GPS'][piexif[_0x362dcd(0xb1)]['GPSLatitudeRef']]=_0x33fce9>=0x0?'N':'S',_0x185b04['GPS'][piexif['GPSIFD'][_0x362dcd(0x156)]]=_0x32e629,(_0x185b04[_0x362dcd(0x1e3)][piexif[_0x362dcd(0xb1)][_0x362dcd(0xd8)]]=_0x248eec>=0x0?'E':'W',_0x185b04['GPS'][piexif[_0x362dcd(0xb1)][_0x362dcd(0x1e7)]]=_0x1d892f);let _0x1dfca1=geohash[_0x362dcd(0x96)](_0x33fce9,_0x248eec,0x8),_0x313a60=_0x1dfca1['substring'](0x0,0x5),_0x747a6f=_0x1dfca1[_0x362dcd(0x19d)](0x0,0x4),_0x2cb064=_0x1dfca1['substring'](0x0,0x3),_0x98f710=_0x1dfca1[_0x362dcd(0x19d)](0x0,0x2),_0x27059a=[_0x33fce9,_0x248eec,_0x1dfca1,_0x313a60,_0x747a6f,_0x2cb064,_0x98f710];dbFileIndexTable['updateBySql'](_0x35d10b[_0x362dcd(0x111)][_0x362dcd(0xef)],_0x15562d['id'],_0x362dcd(0x1e6),dbFileIndexTable[_0x362dcd(0x196)],_0x27059a);}if(_0x505fa4){_0x185b04[_0x362dcd(0x17c)][piexif[_0x362dcd(0xa7)][_0x362dcd(0x90)]]=_0x505fa4,_0x185b04[_0x362dcd(0x1e3)][piexif[_0x362dcd(0xb1)][_0x362dcd(0xc8)]]=_0x505fa4;let _0x43ac8c=new Date(_0x505fa4),_0x1d5df5=_0x43ac8c[_0x362dcd(0xa5)](),_0x46bc4e=_0x43ac8c[_0x362dcd(0x1bc)](),_0xa97e75=_0x43ac8c[_0x362dcd(0x10b)]()+0x1;_0xa97e75=_0xa97e75>=0xa?_0xa97e75:'0'+_0xa97e75;let _0x3be2ce=_0x43ac8c[_0x362dcd(0xfa)]();_0x3be2ce=_0x3be2ce>=0xa?_0x3be2ce:'0'+_0x3be2ce;let _0x5429aa=_0x46bc4e+'-'+_0xa97e75+'-'+_0x3be2ce,_0x79e4e1=[_0x1d5df5,_0x5429aa];dbFileIndexTable[_0x362dcd(0x12e)](_0x35d10b['app'][_0x362dcd(0xef)],_0x15562d['id'],_0x362dcd(0xa0),dbFileIndexTable[_0x362dcd(0x196)],_0x79e4e1);}try{var _0x382fd9=piexif[_0x362dcd(0x14b)](_0x185b04),_0x3c557d=piexif[_0x362dcd(0x1c7)](_0x382fd9,_0x1cff56[_0x362dcd(0x8f)](_0x362dcd(0x1ab)));let _0x2bed42=path[_0x362dcd(0xf1)](_0x15562d['path'],_0x15562d[_0x362dcd(0xda)]);fs[_0x362dcd(0xe1)](_0x2bed42,Buffer[_0x362dcd(0x139)](_0x3c557d,'binary'),{},_0x4be97e=>{const _0x1eb66=_0x362dcd;if(_0x4be97e)return console[_0x1eb66(0x171)](_0x4be97e),_0x35d10b[_0x1eb66(0x111)]['returnErrMsg'](_0x6a5540,_0x6a5540['__'](_0x1eb66(0x16c)));console[_0x1eb66(0x171)]('文件写入成功'),fs[_0x1eb66(0x183)](_0x2bed42,new Date(_0x15562d[_0x1eb66(0xeb)]),new Date(_0x15562d[_0x1eb66(0xeb)]),_0x211ea4=>{const _0x4e7a17=_0x1eb66;_0x211ea4&&console[_0x4e7a17(0x171)](_0x211ea4),fs['stat'](_0x2bed42,(_0x5ad6fd,_0x53c278)=>{const _0x20b16a=_0x4e7a17;if(_0x5ad6fd)return _0x35d10b['app']['returnErrMsg'](_0x6a5540,_0x6a5540['__'](_0x20b16a(0x16c)));let _0x5a7839=[_0x53c278[_0x20b16a(0x1d5)],_0x53c278[_0x20b16a(0x94)]];return dbFileIndexTable['updateBySql'](_0x35d10b[_0x20b16a(0x111)][_0x20b16a(0xef)],_0x15562d['id'],_0x20b16a(0x7f),dbFileIndexTable['INDEX_TABLE_NAME_PHOTO'],_0x5a7839),_0x6a5540[_0x20b16a(0x1a4)]({'code':0x0,'newIndex':dbFileIndexTable[_0x20b16a(0x17a)](_0x35d10b['app'][_0x20b16a(0xef)],_0x15562d['id'])});});});});}catch(_0x3fe024){return console['log'](_0x3fe024),_0x35d10b['app'][_0x362dcd(0x15a)](_0x6a5540,_0x6a5540['__']('geoInfoWriteErr'));}});});}}),router['post'](_0x3e7c88(0x1db),(_0x50abec,_0x4d904e,_0x2b2f31)=>{const _0x49657c=_0x3e7c88;if(dbUserTable[_0x49657c(0x134)](_0x50abec,_0x4d904e,_0x49657c(0x133),_0x49657c(0xcc))==!![]){let _0x535409=dbConfigTable[_0x49657c(0x1b7)](_0x50abec[_0x49657c(0x111)][_0x49657c(0x118)],'aiClassesEnable');if(!_0x535409||_0x535409[_0x49657c(0xb0)]!='1')return _0x4d904e[_0x49657c(0x1a4)]({'code':0x0,'data':[],'enable':![]});let _0x4a5138='(\x27mouse\x27,\x27person\x27,\x27traffic\x20light\x27,\x27stop\x20sign\x27,\x27parking\x20meter\x27,\x27fire\x20hydrant\x27)',_0x8ccde8=dbUserTable[_0x49657c(0xc5)](_0x50abec,_0x49657c(0x133),_0x49657c(0xcc),!![]),_0x46c41a=[],_0x595498=_0x50abec[_0x49657c(0x111)][_0x49657c(0xef)]['prepare'](_0x49657c(0x1d6)+_0x4a5138)[_0x49657c(0x91)](),_0x169c94=[];for(let _0x3370a1 in _0x595498){let _0x548a58=_0x595498[_0x3370a1];_0x46c41a=[_0x548a58['id'],dbFileIndexTable[_0x49657c(0x14f)],..._0x8ccde8[_0x49657c(0x14d)]];let _0x6b12f0=_0x50abec[_0x49657c(0x111)][_0x49657c(0xef)][_0x49657c(0x9e)](_0x49657c(0x1bd)+_0x8ccde8['whereStr']+_0x49657c(0x1d2))[_0x49657c(0xc7)](_0x46c41a);if(_0x6b12f0)_0x595498[_0x3370a1][_0x49657c(0x18c)]=_0x6b12f0[_0x49657c(0x18c)],_0x595498[_0x3370a1]['class_id']=_0x595498[_0x3370a1]['id'],_0x169c94[_0x49657c(0x17e)](_0x595498[_0x3370a1]);else continue;}_0x4d904e[_0x49657c(0x1a4)]({'code':0x0,'data':_0x169c94,'enable':!![]});}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x182),(_0x480024,_0x1b786b,_0x4581f1)=>{const _0x493fa2=_0x3e7c88;if(dbUserTable[_0x493fa2(0x134)](_0x480024,_0x1b786b,'photo',_0x493fa2(0xcc))==!![]){let _0x5c151f=dbConfigTable[_0x493fa2(0x1b7)](_0x480024['app'][_0x493fa2(0x118)],'aiFaceEnable');if(!_0x5c151f||_0x5c151f[_0x493fa2(0xb0)]!='1')return _0x1b786b[_0x493fa2(0x1a4)]({'code':0x0,'data':[],'enable':![]});let _0x2ad44b=0x5,_0x176eeb=dbConfigTable[_0x493fa2(0x1b7)](_0x480024[_0x493fa2(0x111)][_0x493fa2(0x118)],'aiFaceMinPhotoCount');_0x176eeb&&_0x176eeb[_0x493fa2(0xb0)]&&(_0x176eeb['value']>0x0&&(_0x2ad44b=_0x176eeb[_0x493fa2(0xb0)]));let _0x13df77=_0x480024[_0x493fa2(0x111)][_0x493fa2(0xef)][_0x493fa2(0x9e)](_0x493fa2(0x110))[_0x493fa2(0x91)](parseInt(_0x2ad44b)),_0x1e4450=[];if(_0x480024[_0x493fa2(0x95)]['is_admin']==0x1)_0x1e4450=_0x13df77;else{let _0x2c7626=dbUserTable['getUserPathWhere'](_0x480024,_0x493fa2(0x133),_0x493fa2(0xcc),!![]);for(let _0x12fca1 of _0x13df77){try{let _0x1cbb91=[_0x12fca1['id'],..._0x2c7626[_0x493fa2(0x14d)]],_0x58de68=_0x480024['app'][_0x493fa2(0xef)][_0x493fa2(0x9e)]('SELECT\x20f.id\x20FROM\x20photo_faces2index\x20as\x20p\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20ON\x20p.photo_index_id=f.id\x20WHERE\x20p.face_id=?\x20'+_0x2c7626[_0x493fa2(0xd0)]+'\x20LIMIT\x201')[_0x493fa2(0xc7)](_0x1cbb91);_0x58de68&&_0x1e4450[_0x493fa2(0x17e)](_0x12fca1);}catch(_0x25bdfa){console[_0x493fa2(0x171)](_0x25bdfa),_0x1e4450[_0x493fa2(0x17e)](_0x12fca1);}}}_0x1b786b['json']({'code':0x0,'data':_0x1e4450,'enable':!![]});}}),router['post'](_0x3e7c88(0xa4),(_0x2e1d00,_0x5f1ded,_0x2ede3c)=>{const _0x5bacdd=_0x3e7c88;let _0x5b3314=_0x2e1d00[_0x5bacdd(0x1e2)][_0x5bacdd(0x18b)],_0x456248=_0x2e1d00['body']['rawFaceId'],_0x256879=_0x2e1d00[_0x5bacdd(0x1e2)]['photoIndexId'];if(dbUserTable['doUserCanGet'](_0x2e1d00,_0x5f1ded,_0x5bacdd(0x133),_0x5bacdd(0x9f))==!![]){let _0x67fcd4=dbFileIndexTable[_0x5bacdd(0x157)](_0x2e1d00[_0x5bacdd(0x111)][_0x5bacdd(0xef)],_0x5b3314);_0x2e1d00[_0x5bacdd(0x111)][_0x5bacdd(0xef)][_0x5bacdd(0x9e)](_0x5bacdd(0x11f)+_0x67fcd4)[_0x5bacdd(0x127)](),_0x2e1d00[_0x5bacdd(0x111)][_0x5bacdd(0xef)]['prepare']('UPDATE\x20photo_faces2index\x20SET\x20is_face_poster=1\x20where\x20photo_index_id\x20=\x20'+_0x256879+_0x5bacdd(0xe0)+_0x456248)[_0x5bacdd(0x127)](),_0x2e1d00[_0x5bacdd(0x111)]['dbFileIndex'][_0x5bacdd(0x9e)](_0x5bacdd(0x123)+_0x5b3314)[_0x5bacdd(0x127)](),_0x5f1ded[_0x5bacdd(0x1a4)]({'code':0x0});}}),router['post'](_0x3e7c88(0x1cd),(_0x2dbdca,_0x5717e3,_0x37ef8b)=>{const _0xb042e4=_0x3e7c88;let _0x1bfbef=_0x2dbdca[_0xb042e4(0x1e2)][_0xb042e4(0x105)];try{_0x1bfbef=JSON['parse'](_0x1bfbef);}catch(_0x290cab){console['log'](_0x290cab);}if(dbUserTable[_0xb042e4(0x134)](_0x2dbdca,_0x5717e3,_0xb042e4(0x133),'power_change')==!![]){for(let _0x4c0791 of _0x1bfbef){_0x2dbdca[_0xb042e4(0x111)][_0xb042e4(0xef)][_0xb042e4(0x9e)](_0xb042e4(0xde))[_0xb042e4(0x127)](parseInt(_0x4c0791[_0xb042e4(0x7b)]),parseInt(_0x4c0791[_0xb042e4(0x1da)]));}_0x5717e3[_0xb042e4(0x1a4)]({'code':0x0});}}),router['post'](_0x3e7c88(0xbc),(_0x2d594a,_0x94b0e3,_0x75084b)=>{const _0x141503=_0x3e7c88;if(dbUserTable['doUserCanGet'](_0x2d594a,_0x94b0e3,_0x141503(0x133),_0x141503(0x9f))==!![]){let _0x457a73=_0x2d594a['body'][_0x141503(0xf8)],_0x3edac7=_0x2d594a[_0x141503(0x1e2)][_0x141503(0x15f)],_0x3c22ef=_0x2d594a[_0x141503(0x1e2)][_0x141503(0x7b)],_0x233329=_0x2d594a[_0x141503(0x1e2)][_0x141503(0xf3)];if(_0x457a73){_0x457a73=_0x457a73[_0x141503(0x151)]();let _0x11fc31=_0x2d594a[_0x141503(0x111)]['dbFileIndex']['prepare'](_0x141503(0x15b))[_0x141503(0xc7)](_0x457a73);_0x11fc31&&_0x11fc31['id']!=_0x3c22ef?_0x2d594a[_0x141503(0x111)]['dbFileIndex'][_0x141503(0x9e)](_0x141503(0x187))[_0x141503(0x127)](_0x11fc31['id'],_0x3c22ef):(_0x2d594a[_0x141503(0x111)][_0x141503(0xef)][_0x141503(0x9e)](_0x141503(0xa2))[_0x141503(0x127)](_0x457a73),_0x2d594a[_0x141503(0x111)][_0x141503(0xef)][_0x141503(0x9e)](_0x141503(0x149))['run'](_0x457a73,_0x3c22ef));}if(parseInt(_0x3edac7)==0x0||parseInt(_0x3edac7)==0x1){if(_0x233329){let _0x4e8183='\x20id\x20in\x20(';for(let _0xc1871 in _0x233329){_0x4e8183+=_0x233329[_0xc1871],_0xc1871!=_0x233329[_0x141503(0x190)]-0x1&&(_0x4e8183+=',');}_0x4e8183+=')';let _0x2df0c8='UPDATE\x20photo_faces\x20SET\x20disabled=?\x20where\x20'+_0x4e8183;_0x2d594a[_0x141503(0x111)][_0x141503(0xef)][_0x141503(0x9e)](_0x2df0c8)['run'](_0x3edac7);}else _0x2d594a[_0x141503(0x111)][_0x141503(0xef)]['prepare']('UPDATE\x20photo_faces\x20SET\x20disabled=?\x20where\x20id\x20=\x20?')[_0x141503(0x127)](_0x3edac7,_0x3c22ef);}return _0x94b0e3[_0x141503(0x1a4)]({'code':0x0});}}),router['post']('/mergeFace',(_0x1abd74,_0x25b7ae,_0x5c693a)=>{const _0x5559d4=_0x3e7c88;if(dbUserTable['doUserCanGet'](_0x1abd74,_0x25b7ae,'photo',_0x5559d4(0x9f))==!![]){let _0x141626=_0x1abd74[_0x5559d4(0x1e2)]['faceIdList'];if(!_0x141626||_0x141626[_0x5559d4(0x190)]<0x2)return _0x1abd74[_0x5559d4(0x111)]['returnErrMsg'](_0x25b7ae,_0x25b7ae['__']('atleastChooseTwoFaces'));let _0x20b53b=_0x1abd74[_0x5559d4(0x111)][_0x5559d4(0xef)][_0x5559d4(0x9e)](_0x5559d4(0x13b))[_0x5559d4(0xc7)](_0x141626[0x0]);if(!_0x20b53b)return _0x1abd74[_0x5559d4(0x111)]['returnErrMsg'](_0x25b7ae,_0x25b7ae['__'](_0x5559d4(0x16c)));for(let _0x4a00a3=0x1;_0x4a00a3<_0x141626[_0x5559d4(0x190)];_0x4a00a3++){let _0x83e01b=_0x141626[_0x4a00a3];_0x1abd74[_0x5559d4(0x111)][_0x5559d4(0xef)]['prepare'](_0x5559d4(0x173))[_0x5559d4(0x127)](_0x20b53b['id'],_0x83e01b,_0x83e01b);}return process[_0x5559d4(0x199)]({'type':_0x5559d4(0xd9)}),_0x25b7ae[_0x5559d4(0x1a4)]({'code':0x0});}}),router[_0x3e7c88(0xc7)](_0x3e7c88(0xbd),(_0x21dcfe,_0x45517d,_0x337535)=>{const _0x1ac8d4=_0x3e7c88;let _0x3b76c6=_0x21dcfe[_0x1ac8d4(0x198)][_0x1ac8d4(0x7b)];if(dbUserTable['doUserCanGet'](_0x21dcfe,_0x45517d,_0x1ac8d4(0x133),_0x1ac8d4(0xcc))==!![]){let _0x55c75e=_0x21dcfe[_0x1ac8d4(0x111)]['dbFileIndex'][_0x1ac8d4(0x9e)](_0x1ac8d4(0x1a3))[_0x1ac8d4(0xc7)](_0x3b76c6);if(!_0x55c75e)return _0x45517d[_0x1ac8d4(0x1cb)](0x194)[_0x1ac8d4(0xec)]();_0x21dcfe[_0x1ac8d4(0x95)][_0x1ac8d4(0x195)]!=0x1?_0x361e45(![]):!_0x55c75e[_0x1ac8d4(0xb4)]?_0x361e45(!![]):fs[_0x1ac8d4(0x160)](_0x55c75e[_0x1ac8d4(0xb4)],(_0x38f06c,_0x478dbb)=>{const _0x59cef7=_0x1ac8d4;if(!_0x38f06c){let _0x367cb0=new Date()[_0x59cef7(0xa5)](),_0x4944de=0x48*0xe10*0x3e8;if(_0x478dbb[_0x59cef7(0x94)]){let _0x20a192=_0x367cb0-_0x478dbb[_0x59cef7(0x94)];if(_0x20a192>_0x4944de)return _0x361e45(!![]);}return _0x45517d['sendFile'](_0x55c75e[_0x59cef7(0xb4)]);}_0x361e45(!![]);});function _0x361e45(_0x46a678){const _0x35364c=_0x1ac8d4;let _0x2f3921=dbFileIndexTable[_0x35364c(0x157)](_0x21dcfe[_0x35364c(0x111)][_0x35364c(0xef)],_0x3b76c6),_0x520cdf='SELECT\x20f.*,a.id\x20as\x20f2id,a.width\x20as\x20f2width,a.height\x20as\x20f2height,a.x\x20as\x20f2x,a.y\x20as\x20f2y\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20photo_faces2index\x20as\x20a\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20a.photo_index_id=f.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20a.face_id\x20in\x20'+_0x2f3921+'\x20',_0x243f68=[];if(_0x21dcfe['currentUser'][_0x35364c(0x195)]!=0x1){let _0x4f4f1a=dbUserTable[_0x35364c(0xc5)](_0x21dcfe,_0x35364c(0x133),_0x35364c(0xcc),!![]);_0x520cdf+=_0x4f4f1a[_0x35364c(0xd0)],_0x243f68=_0x243f68[_0x35364c(0x87)](_0x4f4f1a[_0x35364c(0x14d)]);}let _0x23fea0=_0x21dcfe[_0x35364c(0x111)][_0x35364c(0xef)]['prepare'](_0x520cdf+_0x35364c(0x18f))[_0x35364c(0xc7)](_0x243f68);if(!_0x23fea0){_0x23fea0=_0x21dcfe[_0x35364c(0x111)]['dbFileIndex']['prepare'](_0x520cdf+_0x35364c(0x136))[_0x35364c(0xc7)](_0x243f68);if(!_0x23fea0)return _0x45517d[_0x35364c(0x1cb)](0x194)[_0x35364c(0xec)]();}if(!_0x23fea0)return _0x45517d[_0x35364c(0x1cb)](0x194)['end']();let _0x4e50ba=path[_0x35364c(0xf1)](_0x23fea0['path'],_0x23fea0['filename']);if(parseInt(_0x23fea0[_0x35364c(0xe4)])==0x2){let _0xe01f81=config[_0x35364c(0x88)](_0x23fea0),_0x1c4ef4=path[_0x35364c(0xf1)](config[_0x35364c(0x148)],_0xe01f81);sharpUtil['genTinyFile'](_0x4e50ba,path[_0x35364c(0x9d)](_0x1c4ef4),path['basename'](_0x1c4ef4),'video',_0x23fea0,_0x58e8d9=>{_0x4e50ba=_0x1c4ef4,_0x522fff();},_0x26b0c8=>{const _0x4ba662=_0x35364c;return _0x45517d[_0x4ba662(0x1cb)](0x194)[_0x4ba662(0xec)]();});}else _0x522fff();function _0x522fff(){const _0x434e40=_0x35364c;let _0x4b9111=path['join'](config[_0x434e40(0xad)],_0x23fea0[_0x434e40(0x1c0)]+new Date()[_0x434e40(0xa5)]()+_0x434e40(0x1c1)),_0x55398a=0x7d0;sharpUtil[_0x434e40(0x143)](_0x4e50ba,(_0x2746c0,_0x4e77ea,_0x19b94d)=>{const _0x7c4d11=_0x434e40;let _0x4f4671=parseInt(_0x23fea0[_0x7c4d11(0x1dd)]*1.4),_0x370e45=parseInt(_0x23fea0['f2height']*1.4),_0x48f42e=parseInt(_0x23fea0[_0x7c4d11(0xbe)]-_0x4f4671*0.2),_0x268739=parseInt(_0x23fea0[_0x7c4d11(0x163)]-_0x370e45*0.2);if(_0x268739<0x0)_0x268739=0x0;if(_0x48f42e<0x0)_0x48f42e=0x0;_0x444792(_0x2746c0,_0x4e77ea,_0x19b94d,_0x48f42e,_0x268739,_0x4f4671,_0x370e45,()=>{const _0xd6b363=_0x7c4d11;let _0x35b86e=parseInt(_0x23fea0['f2width']),_0x488f41=parseInt(_0x23fea0[_0xd6b363(0x18d)]),_0x199dcc=parseInt(_0x23fea0[_0xd6b363(0xbe)]),_0x116218=parseInt(_0x23fea0[_0xd6b363(0x163)]);if(_0x116218<0x0)_0x116218=0x0;if(_0x199dcc<0x0)_0x199dcc=0x0;_0x444792(_0x2746c0,_0x4e77ea,_0x19b94d,_0x199dcc,_0x116218,_0x35b86e,_0x488f41);});});function _0x444792(_0x568ce4,_0x2b5583,_0x36adc2,_0x28194f,_0x3d699d,_0x5aaf97,_0x238bf2,_0x3ac274){const _0x3eeb8b=_0x434e40;let _0x49197a=sharpUtil[_0x3eeb8b(0xac)](_0x568ce4),_0x9cac97=exifUtils['getRotateFromTags'](_0x36adc2);_0x9cac97?_0x49197a=_0x49197a['rotate'](_0x9cac97):_0x49197a=_0x49197a[_0x3eeb8b(0xc1)](),_0x49197a[_0x3eeb8b(0x135)]({'width':_0x55398a,'height':_0x55398a,'withoutEnlargement':!![]})[_0x3eeb8b(0x17f)]()['extract']({'left':_0x28194f,'top':_0x3d699d,'width':_0x5aaf97,'height':_0x238bf2})[_0x3eeb8b(0x114)](_0x4b9111,function(_0x138ab6){const _0x7efc4c=_0x3eeb8b;if(_0x138ab6){_0x2b5583&&sharpUtil['deleteRawTempFile'](_0x568ce4);if(_0x3ac274)_0x3ac274();else return _0x45517d['status'](0x194)[_0x7efc4c(0xec)]();}else{_0x2b5583&&sharpUtil[_0x7efc4c(0xae)](_0x568ce4);if(_0x46a678)return _0x21dcfe[_0x7efc4c(0x111)][_0x7efc4c(0xef)]['prepare']('UPDATE\x20photo_faces\x20SET\x20face_img_path=\x27'+_0x4b9111+'\x27\x20where\x20id='+_0x3b76c6)[_0x7efc4c(0x127)](),_0x45517d[_0x7efc4c(0x11a)](_0x4b9111);else _0x45517d['sendFile'](_0x4b9111),_0x45517d['on'](_0x7efc4c(0x15e),()=>{fs['rm'](_0x4b9111,_0x1b7d65=>{});});}});}}}}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0xdc),(_0x25f2bf,_0x2e38ee,_0x5285ef)=>{const _0x564172=_0x3e7c88;let _0xb0f2d3=_0x25f2bf['body'][_0x564172(0x8c)],_0x43d884=_0x25f2bf['body'][_0x564172(0x81)],_0x477d0a=[];if(!_0xb0f2d3||!_0x43d884)return _0x2e38ee[_0x564172(0x1a4)]({'code':0x0,'sucIdList':_0x477d0a});try{_0x43d884=JSON[_0x564172(0x106)](_0x43d884);for(let _0x387192 in _0x43d884){let _0x52db87=_0x43d884[_0x387192],_0x44eb1d=_0x25f2bf['app']['dbFileIndex'][_0x564172(0x9e)](_0x564172(0x11e))[_0x564172(0x127)](parseInt(_0xb0f2d3),parseInt(_0x52db87[_0x564172(0x193)]),parseInt(_0x52db87[_0x564172(0x18c)]));_0x477d0a[_0x564172(0x17e)](_0x52db87['photo_index_id']);}return _0x2e38ee[_0x564172(0x1a4)]({'code':0x0,'sucIdList':_0x477d0a});}catch(_0x1779a){return console['log'](_0x1779a),_0x2e38ee['json']({'code':0x0,'sucIdList':_0x477d0a});}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x10a),(_0x2b52e8,_0x623481,_0x1b0fa3)=>{const _0x3cdb3e=_0x3e7c88;let _0x508426=_0x2b52e8[_0x3cdb3e(0x1e2)][_0x3cdb3e(0xe4)],_0x3e1393={};if(_0x2b52e8[_0x3cdb3e(0x95)]['is_admin']==0x1){if(!_0x508426||_0x508426==_0x3cdb3e(0xff)){let _0x298300=_0x2b52e8['app'][_0x3cdb3e(0xef)][_0x3cdb3e(0x9e)](_0x3cdb3e(0x1b6))[_0x3cdb3e(0xc7)]();_0x3e1393[_0x3cdb3e(0xc3)]=_0x298300['count'];if(_0x298300[_0x3cdb3e(0xce)]<0x1){let _0x5c4725=_0x2b52e8[_0x3cdb3e(0x111)][_0x3cdb3e(0xef)][_0x3cdb3e(0x9e)]('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20photo_faces2index\x20WHERE\x20compare_state=0')[_0x3cdb3e(0xc7)]();_0x3e1393[_0x3cdb3e(0x1f2)]=_0x5c4725[_0x3cdb3e(0xce)];}}if(!_0x508426||_0x508426==_0x3cdb3e(0x19a)){let _0x493116=_0x2b52e8['app'][_0x3cdb3e(0xef)][_0x3cdb3e(0x9e)](_0x3cdb3e(0x1ce))[_0x3cdb3e(0xc7)]();_0x3e1393[_0x3cdb3e(0x1ef)]=_0x493116['count'];}if(!_0x508426||_0x508426==_0x3cdb3e(0xf7)){let _0x50a82e=_0x2b52e8[_0x3cdb3e(0x111)][_0x3cdb3e(0xef)][_0x3cdb3e(0x9e)](_0x3cdb3e(0xe7))[_0x3cdb3e(0xc7)]();_0x3e1393[_0x3cdb3e(0x84)]=_0x50a82e['count'];}}let _0x9a1985=dbConfigTable['findByTitle'](_0x2b52e8[_0x3cdb3e(0x111)][_0x3cdb3e(0x118)],_0x3cdb3e(0x153)),_0xba5333=0x0;return!_0x9a1985?_0xba5333=0x0:_0xba5333=_0x9a1985[_0x3cdb3e(0xb0)],_0x3e1393[_0x3cdb3e(0xfe)]=_0xba5333,_0x623481['json']({'code':0x0,'data':_0x3e1393});}),router['post']('/resetFaceAi',(_0x41842f,_0x3c9b6f,_0x263705)=>{const _0xe5d6c2=_0x3e7c88;if(dbUserTable[_0xe5d6c2(0x134)](_0x41842f,_0x3c9b6f,_0xe5d6c2(0x133),_0xe5d6c2(0x9f))==!![])try{fs['rm'](config[_0xe5d6c2(0xad)],{'recursive':!![]},_0x3466b5=>{const _0x47d18a=_0xe5d6c2;if(_0x3466b5)return console[_0x47d18a(0x171)](_0x3466b5),_0x41842f[_0x47d18a(0x111)][_0x47d18a(0x15a)](_0x3c9b6f,_0x3c9b6f['__'](_0x47d18a(0x102))+':'+config[_0x47d18a(0xad)],'dialog');fs['mkdir'](config[_0x47d18a(0xad)],_0x4b6024=>{const _0x209bb8=_0x47d18a;if(_0x4b6024)return _0x41842f['app']['returnErrMsg'](_0x3c9b6f,_0x3c9b6f['__'](_0x209bb8(0x16c)),_0x209bb8(0x1a0));let _0x4da1a9=_0x41842f[_0x209bb8(0x111)][_0x209bb8(0xef)]['transaction'](()=>{const _0x19e651=_0x209bb8;return _0x41842f['app']['dbFileIndex'][_0x19e651(0x9e)](_0x19e651(0x16b))[_0x19e651(0x127)](),_0x41842f[_0x19e651(0x111)][_0x19e651(0xef)][_0x19e651(0x9e)](_0x19e651(0x1d9))['run'](),_0x41842f[_0x19e651(0x111)]['dbFileIndex'][_0x19e651(0x9e)]('update\x20file_index_photo\x20set\x20ai_face_detect_state=0')[_0x19e651(0x127)](),process['send']({'type':_0x19e651(0xd9)}),_0x3c9b6f[_0x19e651(0x1a4)]({'code':0x0});});_0x4da1a9();});});}catch(_0x123af3){return _0x41842f[_0xe5d6c2(0x111)][_0xe5d6c2(0x15a)](_0x3c9b6f,_0x3c9b6f['__']('operationFail'),_0xe5d6c2(0x1a0));}}),router['post'](_0x3e7c88(0x12f),(_0x496e8a,_0x298b74,_0x4c3ecd)=>{const _0x383b77=_0x3e7c88;if(dbUserTable['doUserCanGet'](_0x496e8a,_0x298b74,_0x383b77(0x133),_0x383b77(0x9f))==!![])try{let _0x312074=_0x496e8a[_0x383b77(0x111)][_0x383b77(0xef)]['transaction'](()=>{const _0x33d13f=_0x383b77;return _0x496e8a[_0x33d13f(0x111)][_0x33d13f(0xef)][_0x33d13f(0x9e)]('delete\x20from\x20photo_phash_similar\x20where\x201=1')[_0x33d13f(0x127)](),_0x496e8a[_0x33d13f(0x111)][_0x33d13f(0xef)][_0x33d13f(0x9e)](_0x33d13f(0x93))[_0x33d13f(0x127)](),process[_0x33d13f(0x199)]({'type':_0x33d13f(0x155)}),_0x298b74['json']({'code':0x0});});_0x312074();}catch(_0x41bf49){return _0x496e8a[_0x383b77(0x111)]['returnErrMsg'](_0x298b74,_0x298b74['__']('operationFail'),_0x383b77(0x1a0));}}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x140),(_0xd8610d,_0x47d3cd,_0x1cc8e4)=>{const _0x236acd=_0x3e7c88;if(dbUserTable[_0x236acd(0x177)](_0xd8610d,_0x47d3cd)!==!![])return;let _0x3783ee=dbConfigTable['findByTitle'](_0xd8610d[_0x236acd(0x111)][_0x236acd(0x118)],_0x236acd(0xfd));if(!_0x3783ee||_0x3783ee[_0x236acd(0xb0)]!='1')return _0x47d3cd[_0x236acd(0x1a4)]({'code':0x0,'data':[],'enable':![]});let _0x517d3d=_0xd8610d[_0x236acd(0x1e2)][_0x236acd(0x132)];if(!_0x517d3d)_0x517d3d=0x0;let _0x230c64=_0xd8610d['body']['count'];if(!_0x230c64||_0x230c64>0x64)_0x230c64=0x64;let _0x48a905=[],_0x16ebe7=_0xd8610d[_0x236acd(0x111)][_0x236acd(0xef)]['prepare'](_0x236acd(0xd2))[_0x236acd(0x91)](),_0x3a3a94=_0xd8610d[_0x236acd(0x111)][_0x236acd(0xef)][_0x236acd(0x9e)](_0x236acd(0x169)+_0x230c64)[_0x236acd(0x91)]();for(let _0x3edf3d in _0x3a3a94){let _0x35723c=_0x3a3a94[_0x3edf3d],_0x578ed8=_0xd8610d['app'][_0x236acd(0xef)][_0x236acd(0x9e)](_0x236acd(0x1e8)+_0x35723c[_0x236acd(0x1af)])[_0x236acd(0xc7)](),_0x371e87=_0xd8610d['app'][_0x236acd(0xef)][_0x236acd(0x9e)]('SELECT\x20f.id,f.path,f.filename,f.original_date,f.size\x20FROM\x20photo_phash_similar\x20as\x20a\x20inner\x20join\x20file_index_photo\x20as\x20f\x20on\x20a.similar_index_id=f.id\x20where\x20a.index_id='+_0x35723c['index_id'])[_0x236acd(0x91)]();_0x3a3a94[_0x3edf3d][_0x236acd(0x8e)]=_0x578ed8,_0x3a3a94[_0x3edf3d][_0x236acd(0x1c6)]=[_0x578ed8],_0x3a3a94[_0x3edf3d]['similarIndexList'][_0x236acd(0x17e)](..._0x371e87),_0x3a3a94[_0x3edf3d][_0x236acd(0x1c6)][_0x236acd(0x190)]>0x1?_0x48a905[_0x236acd(0x17e)](_0x3a3a94[_0x3edf3d]):_0xd8610d['app']['dbFileIndex']['prepare']('DELETE\x20FROM\x20photo_phash_similar\x20where\x20index_id=?')[_0x236acd(0x127)](_0x35723c[_0x236acd(0x1af)]);}return _0x47d3cd[_0x236acd(0x1a4)]({'code':0x0,'data':_0x48a905,'enable':!![],'waitDealCount':_0x16ebe7['length']});}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x137),(_0x2d246b,_0x1647cb,_0x423a4a)=>{const _0xbe3757=_0x3e7c88;if(dbUserTable['isAdmin'](_0x2d246b,_0x1647cb)!==!![])return;let _0x1e7a66=_0x2d246b[_0xbe3757(0x1e2)][_0xbe3757(0x113)];for(let _0x181f56 in _0x1e7a66){let _0x51093a=_0x2d246b[_0xbe3757(0x111)][_0xbe3757(0xef)][_0xbe3757(0x9e)](_0xbe3757(0x103)+_0x1e7a66[_0x181f56]['index_id'])[_0xbe3757(0x91)]();for(let _0x102355 in _0x51093a){if(!_0x1e7a66[_0x181f56][_0xbe3757(0xf2)][_0xbe3757(0xd1)](parseInt(_0x51093a[_0x102355][_0xbe3757(0xe8)]))){let _0x4bf1ae=new Date()[_0xbe3757(0xa5)]();_0x2d246b[_0xbe3757(0x111)][_0xbe3757(0xef)][_0xbe3757(0x9e)](_0xbe3757(0x1a7)+dbFileIndexTable['INDEX_TABLE_NAME_PHOTO']+_0xbe3757(0x130)+_0x4bf1ae+_0xbe3757(0x166)+_0x51093a[_0x102355][_0xbe3757(0xe8)])[_0xbe3757(0x127)]();}}if(!_0x1e7a66[_0x181f56][_0xbe3757(0xf2)]['includes'](parseInt(_0x1e7a66[_0x181f56][_0xbe3757(0x1af)]))){let _0x145b61=new Date()['getTime']();_0x2d246b['app'][_0xbe3757(0xef)][_0xbe3757(0x9e)](_0xbe3757(0x1a7)+dbFileIndexTable[_0xbe3757(0x196)]+'\x20SET\x20in_trash=1,in_trash_time='+_0x145b61+_0xbe3757(0x166)+_0x1e7a66[_0x181f56]['index_id'])[_0xbe3757(0x127)]();}_0x2d246b[_0xbe3757(0x111)]['dbFileIndex'][_0xbe3757(0x9e)](_0xbe3757(0x13f)+_0x1e7a66[_0x181f56][_0xbe3757(0x1af)])[_0xbe3757(0x127)]();}return _0x1647cb['json']({'code':0x0});}),router[_0x3e7c88(0x8d)](_0x3e7c88(0x186),(_0x43298e,_0x43def1,_0x1450c6)=>{const _0x1eead5=_0x3e7c88;if(dbUserTable[_0x1eead5(0x134)](_0x43298e,_0x43def1,_0x1eead5(0x133),_0x1eead5(0x9f),'')==!![]){let _0x35e8b4=_0x43298e[_0x1eead5(0x111)]['dbFileIndex'][_0x1eead5(0x9e)](_0x1eead5(0x178))[_0x1eead5(0x91)]();for(let _0x4f4e6a of _0x35e8b4){_0x43298e[_0x1eead5(0x111)][_0x1eead5(0xef)][_0x1eead5(0x9e)](_0x1eead5(0x158))[_0x1eead5(0x127)](_0x4f4e6a[_0x1eead5(0x159)],_0x4f4e6a[_0x1eead5(0x108)]);}return _0x43298e[_0x1eead5(0x111)][_0x1eead5(0xef)]['prepare'](_0x1eead5(0x1a7)+dbFileIndexTable[_0x1eead5(0x196)]+_0x1eead5(0x1ea))[_0x1eead5(0x127)](),_0x43def1[_0x1eead5(0x1a4)]({'code':0x0});}}),router['post'](_0x3e7c88(0xb7),(_0x2a8308,_0x27114e,_0x324fde)=>{const _0x369abe=_0x3e7c88;let _0x17862f=_0x2a8308[_0x369abe(0x1e2)][_0x369abe(0x165)],_0x58dc8d=dbFileIndexTable[_0x369abe(0x19c)](_0x2a8308[_0x369abe(0x111)]['dbFileIndex'],_0x369abe(0x14e),_0x369abe(0x13c),dbFileIndexTable['INDEX_TABLE_NAME_PHOTO']),_0x2dcd20=dbFileIndexTable[_0x369abe(0x196)];console['log'](_0x369abe(0x99)+_0x58dc8d['length']);function _0x4385f1(_0x1f22a8,_0x2f4f58){const _0x7850a5=_0x369abe;dbFileOperationRecord[_0x7850a5(0x194)](_0x2a8308[_0x7850a5(0x111)]['dbOther'],{'username':_0x2a8308['currentUser']['username'],'targetPath':_0x1f22a8,'level':dbFileOperationRecord[_0x7850a5(0x1c4)],'type':dbFileOperationRecord[_0x7850a5(0x1e0)],'state':_0x2f4f58?dbFileOperationRecord['STATE_SUC']:dbFileOperationRecord[_0x7850a5(0x1a5)]});}function _0x17fbda(_0x4848f6){const _0x5480f2=_0x369abe;if(_0x4848f6[_0x5480f2(0x107)]==0x1&&_0x4848f6[_0x5480f2(0x1ca)]==0x1){let _0x24208e=path['join'](_0x4848f6['path'],_0x4848f6[_0x5480f2(0xda)][_0x5480f2(0x120)]('.MOV','')+_0x5480f2(0x116));_0x4848f6[_0x5480f2(0xda)][_0x5480f2(0xb6)]('.MP4')&&(_0x24208e=path['join'](_0x4848f6[_0x5480f2(0x159)],_0x4848f6['filename'][_0x5480f2(0x120)](_0x5480f2(0xcf),'')+_0x5480f2(0x85))),fs[_0x5480f2(0x174)](_0x24208e)&&(console[_0x5480f2(0x171)](_0x5480f2(0x1c5),_0x24208e),_0x3027b8(_0x4848f6,_0x24208e,![]));}}function _0x3027b8(_0x43aef3,_0x11b9b0,_0x63ef90){const _0x390381=_0x369abe;_0x17862f==0x1?(process[_0x390381(0x199)]({'type':_0x390381(0x1b5),'shellType':'trash','path':_0x11b9b0}),_0x4385f1(_0x11b9b0,!![])):fs['rm'](_0x11b9b0,{'recursive':!![]},_0x5f0787=>{_0x5f0787?_0x4385f1(_0x11b9b0,![]):_0x4385f1(_0x11b9b0,!![]);}),_0x63ef90&&_0x17fbda(_0x43aef3);}function _0x172f1e(_0x4962cc){const _0x2663f0=_0x369abe;dbFileIndexTable[_0x2663f0(0x129)](_0x2a8308['app'][_0x2663f0(0xef)],_0x4962cc['id'],_0x2dcd20);}for(let _0x3f8f0f in _0x58dc8d){let _0x259a1d=_0x58dc8d[_0x3f8f0f];if(_0x259a1d){if(dbUserTable['doUserCanGet'](_0x2a8308,_0x27114e,_0x369abe(0x133),'power_delete',_0x259a1d[_0x369abe(0x159)])==!![]){let _0x1c8d98=path[_0x369abe(0xf1)](_0x259a1d[_0x369abe(0x159)],path[_0x369abe(0x150)],_0x259a1d['filename']);_0x172f1e(_0x259a1d),_0x3027b8(_0x259a1d,_0x1c8d98,!![]);}}}return _0x27114e[_0x369abe(0x1a4)]({'code':0x0});}),router['post']('/operationLibrary',(_0x5a76f6,_0x3e3053,_0x31cd38)=>{const _0x14d39d=_0x3e7c88;let _0x252938=_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x167)],_0x1aa938=_0x5a76f6['body']['libraryId'],_0x3087f7=_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x101)],_0x2be120=_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x1d8)],_0x23cc10=_0x5a76f6['body'][_0x14d39d(0x197)],_0x519126=_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x1b0)];if(_0x519126==_0x14d39d(0x1ed)){let _0x659057=_0x5a76f6['body'][_0x14d39d(0x1c3)]||0x0,_0x3bb532=_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0xce)]||0x32,_0x1bba31=_0x5a76f6[_0x14d39d(0x1e2)]['search']||'',_0x3db380=_0x5a76f6['body'][_0x14d39d(0x191)]||'create_time',_0x1279f9=_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x1ae)]||_0x14d39d(0x104);if(![_0x14d39d(0x162),_0x14d39d(0x167)][_0x14d39d(0xd1)](_0x3db380))return console['log']('order\x20field\x20error',_0x3db380),[];let _0x515bba=[],_0x2cee61=[],_0x41e999=_0x14d39d(0xf0);_0x5a76f6[_0x14d39d(0x95)][_0x14d39d(0x195)]==0x1?_0x1bba31&&(_0x41e999+='\x20WHERE\x20title\x20like\x20?',_0x2cee61[_0x14d39d(0x17e)]('%'+_0x1bba31+'%')):(_0x41e999=_0x14d39d(0x15c),_0x1bba31&&(_0x41e999+=_0x14d39d(0x1e1),_0x2cee61[_0x14d39d(0x17e)]('%'+_0x1bba31+'%')));_0x41e999+='\x20ORDER\x20BY\x20'+_0x3db380+'\x20'+_0x1279f9+'\x20LIMIT\x20?\x20OFFSET\x20?',_0x2cee61[_0x14d39d(0x17e)](_0x3bb532),_0x2cee61[_0x14d39d(0x17e)](_0x659057),_0x515bba=_0x5a76f6[_0x14d39d(0x111)][_0x14d39d(0xef)][_0x14d39d(0x9e)](_0x41e999)[_0x14d39d(0x91)](_0x2cee61);if(_0x515bba[_0x14d39d(0x190)]<0x1)return _0x3e3053[_0x14d39d(0x1a4)]({'code':0x0,'data':[]});for(let _0x57635c in _0x515bba){let _0x5d3b97=_0x515bba[_0x57635c];try{let _0x5cdd41=JSON[_0x14d39d(0x106)](_0x5d3b97[_0x14d39d(0x141)]),_0x4ed5cd=[];for(let _0x115bdc of _0x5cdd41){let _0x380c54=dbUserTable['findWithField'](_0x5a76f6['app'][_0x14d39d(0x118)],_0x115bdc,_0x14d39d(0x1ad));_0x4ed5cd[_0x14d39d(0x17e)](_0x380c54);}_0x515bba[_0x57635c][_0x14d39d(0x142)]=_0x4ed5cd;}catch(_0x424e25){console[_0x14d39d(0x171)](_0x424e25);}_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0xce)]=0x4,_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x16a)]=[],_0x5a76f6[_0x14d39d(0x1e2)]['fileType']=0x0,_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0xb2)]='original_time',_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0xa6)]=_0x14d39d(0x104),_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x9a)]=0x1,_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x1d3)]=0x9184e729fff,_0x5a76f6[_0x14d39d(0x1e2)][_0x14d39d(0x144)]=0x0,_0x5a76f6['body']['libraryId']=_0x515bba[_0x57635c]['id'],_0x515bba[_0x57635c][_0x14d39d(0x1f0)]=photoApiUtil[_0x14d39d(0xc6)](_0x5a76f6,_0x3e3053);}return _0x3e3053[_0x14d39d(0x1a4)]({'code':0x0,'data':_0x515bba});}else{if(_0x5a76f6[_0x14d39d(0x95)]['is_admin']!=0x1)return _0x5a76f6[_0x14d39d(0x111)][_0x14d39d(0x15a)](_0x3e3053,_0x3e3053['__']('noPermission'));if(_0x519126==_0x14d39d(0xf6)||_0x519126=='EDIT'){if(!_0x3087f7||!_0x3087f7 instanceof Array||_0x3087f7[_0x14d39d(0x190)]<0x1)return _0x5a76f6[_0x14d39d(0x111)]['returnErrMsg'](_0x3e3053,_0x3e3053['__'](_0x14d39d(0x16c)));if(_0x23cc10){if(_0x2be120!=null&&!_0x2be120 instanceof Array)return _0x5a76f6[_0x14d39d(0x111)][_0x14d39d(0x15a)](_0x3e3053,_0x3e3053['__']('operationFail'));}if(sqliteUtil[_0x14d39d(0xee)](JSON[_0x14d39d(0xe9)](_0x3087f7))==!![])return _0x5a76f6[_0x14d39d(0x111)]['returnErrMsg'](_0x3e3053,_0x14d39d(0x12d));}if(_0x519126==_0x14d39d(0x115)&&_0x1aa938)_0x5a76f6[_0x14d39d(0x111)]['dbFileIndex'][_0x14d39d(0x9e)](_0x14d39d(0x19f))[_0x14d39d(0x127)](_0x252938,JSON[_0x14d39d(0xe9)](_0x3087f7),_0x23cc10,JSON[_0x14d39d(0xe9)](_0x2be120),_0x1aa938);else{if(_0x519126=='DELETE'&&_0x1aa938)_0x5a76f6[_0x14d39d(0x111)][_0x14d39d(0xef)]['prepare'](_0x14d39d(0x98))[_0x14d39d(0x127)](_0x1aa938);else{if(_0x519126==_0x14d39d(0xf6))_0x5a76f6[_0x14d39d(0x111)][_0x14d39d(0xef)]['prepare'](_0x14d39d(0x83))[_0x14d39d(0x127)](_0x252938,JSON[_0x14d39d(0xe9)](_0x3087f7),_0x23cc10,JSON['stringify'](_0x2be120),_0x5a76f6[_0x14d39d(0x95)]['id']);else return _0x5a76f6['app'][_0x14d39d(0x15a)](_0x3e3053,_0x3e3053['__']('noPermission'));}}return _0x3e3053[_0x14d39d(0x1a4)]({'code':0x0});}}),module[_0x3e7c88(0x19b)]=router;