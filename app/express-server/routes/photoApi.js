const _0x14f265=_0x31f9;(function(_0x56e7ce,_0x3d938c){const _0x5aaf25=_0x31f9,_0xce1b76=_0x56e7ce();while(!![]){try{const _0x1be0da=parseInt(_0x5aaf25(0x26d))/0x1*(parseInt(_0x5aaf25(0x239))/0x2)+-parseInt(_0x5aaf25(0x2be))/0x3*(parseInt(_0x5aaf25(0x22d))/0x4)+parseInt(_0x5aaf25(0x2a1))/0x5*(-parseInt(_0x5aaf25(0x258))/0x6)+parseInt(_0x5aaf25(0x24e))/0x7*(parseInt(_0x5aaf25(0x2c0))/0x8)+parseInt(_0x5aaf25(0x23a))/0x9*(parseInt(_0x5aaf25(0x318))/0xa)+parseInt(_0x5aaf25(0x2f8))/0xb+parseInt(_0x5aaf25(0x2d2))/0xc*(-parseInt(_0x5aaf25(0x1e6))/0xd);if(_0x1be0da===_0x3d938c)break;else _0xce1b76['push'](_0xce1b76['shift']());}catch(_0x3331f4){_0xce1b76['push'](_0xce1b76['shift']());}}}(_0x2c94,0x9cd3b));let express=require(_0x14f265(0x25a)),router=express[_0x14f265(0x255)](),path=require(_0x14f265(0x2e3));function _0x2c94(){const _0x336af7=['.jpeg','\x20is_file,id,path,filename,ext,duration,size\x20','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20ai_face_detect_state=0\x20and\x20(type=1\x20or\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20','faceIdList','push','\x20id,geohash,latitude,longitude,original_time\x20','timestamp','update\x20file_index_photo\x20set\x20phash=null,phash_compare=0','checkSqlInjection','75090LmSthR','.jpg','4916176XaeXjV','\x20OFFSET\x20','stringify','body','../../utils/exifUtils','getMonth','photo','keepIndexList','error\x20pathList','share_uid','power_delete','dirname','../../db/dbFileOperationRecord','utimes','path_list','data_value','getAllByWhereAndFieldFromOrdinaryAlbum','original_time','348foMzbs','timeOrder','\x20LIMIT\x20','data','now','INDEX_TABLE_NAME_PHOTO','\x20id\x20in\x20(','noPermission','length','UPDATE\x20photo_faces\x20SET\x20face_img_path=\x27\x27\x20where\x20id=','desc','SELECT\x20index_id\x20FROM\x20photo_phash_similar\x20group\x20by\x20index_id','SELECT\x20*\x20FROM\x20photo_faces\x20where\x20id\x20=?','similar_index_id','run','/resetSimilarPhotoAi','prepare','path','\x20is_file,id,path,filename,ext,type,width,height,duration,size,original_date,original_time,latitude,longitude\x20','f2x','dump','CUSTOM','/editExifByIndexId','log','concat','UPDATE\x20photo_faces\x20SET\x20face_name=?\x20where\x20id\x20=\x20?','end','getDate','\x20and\x20face_id=','\x20type=2\x20\x20','geohash4\x20=\x20?','from','face_img_path','paramsList','\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)','EDIT','rawFaceIndexIdList','\x20WHERE\x20id\x20=\x20','1459502pZzOvc','UPDATE\x20photo_faces\x20SET\x20face_img_path=\x27','ExifIFD','/mergeFace','app','faceId','\x20AND\x20','imagePreviewType','getList','endsWith','.MP4','\x20AND\x20filename\x20LIKE\x20?\x20','GPS','readFile','/getBoundsPhoto','dialog','replace','getByWhere','SELECT\x20index_id\x20FROM\x20photo_phash_similar\x20group\x20by\x20index_id\x20limit\x20','rotate','faceapi','SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20id=?','operation\x20fail','file_index_photo-indexing','ADD','libraryId','shareForSubUser','searchValue','UPDATE\x20photo_faces2index\x20SET\x20is_face_poster=0\x20where\x20is_face_poster=1\x20and\x20face_id\x20in\x20','../../db/dbFileIndexTable','parent','delete\x20from\x20photo_faces2index\x20where\x201=1','746530ptfRQn','doUserCanGet','count','ngeohash','orderType','putInSystemTrash','f2width','\x20in_trash=1\x20and\x20is_file=1\x20','\x20path=\x20?\x20AND\x20','/getFileTreePhoto','getAlbumWhereStr','findWithField','user_list','\x20and\x20title\x20like\x20?','DELETE','getFaceInSql','minLng','/getIndexDetail','update','aiClassId','toFile','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20ai_class_state=0\x20and\x20(type=1\x20or\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27','../../myConfig/config','/getPhotoClasses','\x20ORDER\x20BY\x20original_time\x20DESC\x20LIMIT\x201','excludeIds','facesPath','photoPreviewType','SELECT\x20f.*,a.id\x20as\x20f2id,a.width\x20as\x20f2width,a.height\x20as\x20f2height,a.x\x20as\x20f2x,a.y\x20as\x20f2y\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20photo_faces2index\x20as\x20a\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20a.photo_index_id=f.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20a.face_id\x20in\x20','\x20SET\x20in_trash=1,in_trash_time=','filename','GPSLatitude','name','returnErrMsg','sortType','GPSLongitudeRef','parse','SELECT\x20id,path,filename,original_date,size\x20FROM\x20file_index_photo\x20where\x20id=','存在livephoto','json','sep','operation','floor','query','zoom','.MOV','trash','excludeFilenamePhoto','getTime','aiFaceMinPhotoCount','sendFile','Exif','mode','SELECT\x20*\x20FROM\x20ai_classes\x20where\x20\x20class_name\x20not\x20in\x20','showFileType','get','DateTimeOriginal','locationList','/getFaceImg/*','getFileHashName','152555tMqOld','photo_index_id','fileType','power_add','../../db/dbConfigTable','original_date','stat','genTinyFile','cocossdWaitDealCount','power_get','create_time','id,username','UPDATE\x20photo_faces2index\x20SET\x20face_id=?\x20WHERE\x20face_id=?\x20and\x20photo_index_id=?','delete\x20from\x20photo_phash_similar\x20where\x201=1','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20photo_faces2index\x20WHERE\x20compare_state=0','getAllByWhereAndFieldFromOrdinaryAlbumCount','faceName','photoIndexId','/searchMode','raw_filename','\x20is_file,id,path,filename,ext,type,width,height,duration,size,original_date,original_time\x20','order\x20field\x20error','undefined','dbFileIndex','SELECT\x20f.id,f.path,f.filename,f.original_date,f.size\x20FROM\x20photo_phash_similar\x20as\x20a\x20inner\x20join\x20file_index_photo\x20as\x20f\x20on\x20a.similar_index_id=f.id\x20where\x20a.index_id=','is_admin','key','isFile','/resetFaceAi','orderField','photoPreviewSize','value','GPSIFD','RAW','changes','splice','/getPhotoByTime','/getPhotoFaces','./photoApiUtils','create','join','defaultMoviePlay','resolve','username','getTimeLineDateList','photoSavedAsNewFile','asc','dbOther','excludePathPhoto','currentUser','\x20AND\x20in_trash=0\x20\x20AND\x20is_file=1\x20\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20limit\x201','startFaceAiWork','getByName','DELETE\x20FROM\x20photo_library\x20\x20WHERE\x20id=?','Cleaning\x20out\x20the\x20recycle\x20bin\x20:\x20','transSpcielFormat','insert','movie','delete\x20from\x20photo_faces\x20where\x201=1','GPSLongitude','UPDATE\x20photo_faces\x20SET\x20belong_face_id=?\x20where\x20id\x20=\x20?\x20or\x20belong_face_id=?','geoHashList','id,is_file,is_livephoto,path,filename,raw_filename,is_raw','UPDATE\x20photo_faces\x20SET\x20face_name=null\x20where\x20face_name\x20=\x20?','/restoreTrashBinFiles','post','sourceFolderList','ordinaryAlbumId','\x20size=?,ctime=?\x20','status','../../db/dbSourceFolderTable','52ZiqsgJ','INDEX_TABLE_NAME_MUSIC','similarIndexList','\x20original_time=?,original_date=?\x20','extract','getPhotoByParams','fileExist','mkdir','SELECT\x20*\x20FROM\x20photo_library\x20','music','delete','/getAllAlbum','427906xJvNLY','117mmCels','timeType','maxLat','\x20in_trash=0\x20AND\x20latitude!=\x27undefined\x27\x20AND\x20longitude!=\x27undefined\x27\x20AND\x20latitude\x20is\x20not\x20null','video','SELECT\x20*\x20from\x20photo_phash_similar\x20where\x20index_id=','close','SELECT\x20f.id\x20FROM\x20photo_faces2index\x20as\x20p\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20ON\x20p.photo_index_id=f.id\x20WHERE\x20p.face_id=?\x20','all','f2y','/updatePhotoFace','getPathByType','/removeFromFace','binary','indexObj','sortField','deleteList','aiSimilarPhotoEnable','type','targetFaceId','7HSoNbW','findByTitle','\x20AND\x20(type=1\x20or\x20type=2)\x20AND\x20in_trash=0','/updateAlbum','isAdmin','faceApiWaitDealCount','power_change','Router','geohash','/clearTrashBin','1870734ckxbuE','title','express','setFaceId','minIndexId','maxLng','latitude','getUserPathWhere','/dealSimilarPhoto','f2height','includes','\x27\x20where\x20id=','SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20face_name=?\x20and\x20belong_face_id\x20is\x20null','\x20latitude=?,longitude=?,geohash=?,geohash5=?,geohash4=?,geohash3=?,geohash2=?\x20','UPDATE\x20','SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20id=?','\x20AND\x20geohash4!=\x27undefined\x27\x20GROUP\x20BY\x20geohash4','TYPE_DELETE','\x20order\x20by\x20score\x20desc','\x20\x20\x20AND\x20in_trash!=1\x20','substring','1OYSfkn','aiFaceEnable','getSharpInstanceFromInput','indexOf','\x20(((type=1\x20or\x20type=2)\x20\x20)\x20OR\x20is_file=0\x20)\x20','newDate','operationFail','folderNotExist','geohash3\x20=\x20?','album.sameNameExist','\x20AND\x20geohash2!=\x27undefined\x27\x20GROUP\x20BY\x20geohash2','addFileOperationRecord','is_file','INDEX_TABLE_NAME_MOVIE','round','bboxes','imgList','../utils/sqliteUtil','searchMode','getFullYear','\x20type=1\x20','encode','文件写入成功','toLowerCase','UPDATE\x20photo_faces2index\x20SET\x20is_face_poster=1\x20where\x20photo_index_id\x20=\x20','dbCity','dealList','DELETE\x20FROM\x20photo_faces2index\x20where\x20face_id=?\x20and\x20photo_index_id\x20=?','offset','/operationLibrary','whereStr','existsSync','/getSimilarPhoto','geoInfoWriteErr','transaction','ctimeMs','index_id','disabled','\x20is_file=0\x20','(\x27mouse\x27,\x27person\x27,\x27traffic\x20light\x27,\x27stop\x20sign\x27,\x27parking\x20meter\x27,\x27fire\x20hydrant\x27)','basename','getAllByWhereAndField','dataPreview','STATE_SUC','SELECT\x20f.id\x20as\x20photo_index_id\x20FROM\x20ai_classes2index\x20as\x20a\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20ON\x20a.photo_index_id=f.id\x20WHERE\x20a.class_id=?\x20and\x20score>?\x20and\x20\x20f.in_trash=0\x20\x20and\x20f.tiny_path\x20is\x20not\x20null\x20AND\x20f.tiny_path\x20!=\x20\x270\x27\x20\x20','startSimilarPhotoWork','send','../../db/dbAlbumTable','getExcludePathWhereStr','moviePlaylongPressRate','moviePreferLanguage','getAllByWhere','10kIvslI','\x20AND\x20\x20is_file=1\x20','\x20LIMIT\x20?\x20OFFSET\x20?','deleteRawTempFile','editId','trim','\x20WHERE\x20title\x20like\x20?','longitude','../../db/dbUserTable','getPathWhere','platform','is_livephoto','COCO_CLASS_MIN_SCORE','toString','LEVEL_MAIN_OPERATION','update\x20file_index_photo\x20set\x20ai_face_detect_state=0','/getAiDealState','extname','searchStr','abs'];_0x2c94=function(){return _0x336af7;};return _0x2c94();}const config=require(_0x14f265(0x32e)),dbFileIndexTable=require(_0x14f265(0x315)),dbSourceFolderTable=require(_0x14f265(0x22c)),dbFileOperationRecord=require(_0x14f265(0x2cc)),sqliteUtil=require(_0x14f265(0x27e)),exifUtils=require(_0x14f265(0x2c4)),dbUserTable=require(_0x14f265(0x2a9)),dbAlbumTable=require(_0x14f265(0x29c));let geohash=require(_0x14f265(0x31b)),fs=require('fs');const dbConfigTable=require(_0x14f265(0x1ea));let sharpUtil=require('../utils/sharpUtils');const photoApiUtil=require(_0x14f265(0x20c)),platform=require('os')[_0x14f265(0x2ab)]();function _0x31f9(_0x4f5f76,_0x4c3300){const _0x2c9435=_0x2c94();return _0x31f9=function(_0x31f916,_0x2be698){_0x31f916=_0x31f916-0x1c2;let _0x4ae7c7=_0x2c9435[_0x31f916];return _0x4ae7c7;},_0x31f9(_0x4f5f76,_0x4c3300);}let piexif=require('piexifjs');router[_0x14f265(0x227)]('/getTimeLineDateList',(_0xbb7e0f,_0x51a476,_0x59da66)=>{const _0x3b82ad=_0x14f265;if(dbUserTable['doUserCanGet'](_0xbb7e0f,_0x51a476,_0x3b82ad(0x2c6),_0x3b82ad(0x1ef))==!![]){let _0x24d6d4=_0xbb7e0f[_0x3b82ad(0x2c3)]['year'],_0x52b745=_0xbb7e0f['body'][_0x3b82ad(0x24c)],_0x321a0a=_0xbb7e0f[_0x3b82ad(0x2c3)]['geohash'],_0x4d68e0=_0xbb7e0f[_0x3b82ad(0x2c3)]['albumId'],_0x2ca83f=_0xbb7e0f[_0x3b82ad(0x2c3)]['searchStr'],_0x5f5704=_0xbb7e0f['body'][_0x3b82ad(0x229)],_0x24b007=_0xbb7e0f['body'][_0x3b82ad(0x32b)],_0x1ecace=_0xbb7e0f['body'][_0x3b82ad(0x311)],_0x1fa8a2=_0xbb7e0f[_0x3b82ad(0x2c3)][_0x3b82ad(0x2fd)],_0x4548a6=_0xbb7e0f[_0x3b82ad(0x2c3)][_0x3b82ad(0x2d3)],_0x3b0f55=_0xbb7e0f['body'][_0x3b82ad(0x228)],_0x1d926c=dbUserTable['getUserPathWhere'](_0xbb7e0f,_0x3b82ad(0x2c6),_0x3b82ad(0x1ef),!![],_0x3b0f55),_0x3a7c1f=_0x1d926c[_0x3b82ad(0x28b)],_0x619e67=[..._0x1d926c[_0x3b82ad(0x2f3)]];_0x321a0a&&(_0x3a7c1f+='\x20AND\x20geohash\x20LIKE\x20?\x20',_0x619e67[_0x3b82ad(0x2b9)](_0x321a0a+'%'));let _0x55894a=dbSourceFolderTable[_0x3b82ad(0x29d)](_0xbb7e0f[_0x3b82ad(0x2fc)][_0x3b82ad(0x215)],_0x3b82ad(0x2e3),_0x3b82ad(0x216));_0x55894a&&(_0x3a7c1f+=_0x3b82ad(0x2fe)+_0x55894a);let _0x1ee95a=dbSourceFolderTable[_0x3b82ad(0x29d)](_0xbb7e0f[_0x3b82ad(0x2fc)][_0x3b82ad(0x215)],'filename',_0x3b82ad(0x1d9));_0x1ee95a&&(_0x3a7c1f+='\x20AND\x20'+_0x1ee95a);if(_0x1ecace){let _0x4d9137=_0xbb7e0f[_0x3b82ad(0x2fc)][_0x3b82ad(0x1fd)][_0x3b82ad(0x2e2)](_0x3b82ad(0x30d))[_0x3b82ad(0x1e1)](_0x1ecace);if(_0x4d9137)try{let _0x160db5=JSON[_0x3b82ad(0x1ce)](_0x4d9137[_0x3b82ad(0x2ce)]),_0x4ff3a6=dbUserTable[_0x3b82ad(0x2aa)](!![],_0x160db5);_0x3a7c1f+=_0x4ff3a6[_0x3b82ad(0x28b)],_0x619e67=_0x619e67[_0x3b82ad(0x2ea)](_0x4ff3a6[_0x3b82ad(0x2f3)]);}catch(_0x3b53a7){console[_0x3b82ad(0x2e9)](_0x3b53a7);}}if(_0x4d68e0){let _0x4c59af=dbAlbumTable[_0x3b82ad(0x322)](_0xbb7e0f[_0x3b82ad(0x2fc)][_0x3b82ad(0x215)],_0x4d68e0);_0x4c59af&&(_0x3a7c1f+=_0x3b82ad(0x2fe)+_0x4c59af);}_0x2ca83f&&(_0x3a7c1f+=_0x3b82ad(0x2f4),_0x619e67['push']('%'+_0x2ca83f+'%'),_0x619e67[_0x3b82ad(0x2b9)]('%'+_0x2ca83f+'%'));_0x3a7c1f+=_0x3b82ad(0x26b);let _0x3e7694=dbFileIndexTable[_0x3b82ad(0x212)](_0xbb7e0f['app'][_0x3b82ad(0x1fd)],_0x24d6d4,_0x52b745,_0x3a7c1f,_0x5f5704,_0x24b007,_0x1fa8a2,_0x619e67,_0x4548a6);_0x51a476[_0x3b82ad(0x1d1)]({'code':0x0,'data':_0x3e7694});}});let geoDbCache={};router['post'](_0x14f265(0x20a),(_0x1a32cb,_0x199c33,_0x45dcfe)=>{const _0x6046c0=_0x14f265;if(dbUserTable[_0x6046c0(0x319)](_0x1a32cb,_0x199c33,_0x6046c0(0x2c6),_0x6046c0(0x1ef))==!![]){result=photoApiUtil[_0x6046c0(0x232)](_0x1a32cb,_0x199c33);let _0x459b09=[],_0x2f08d4=[];try{let _0x6d8cfc=Date[_0x6046c0(0x2d6)]();if(result&&result[_0x6046c0(0x2da)]>0x0){for(let _0xf34d6e of result){!_0x459b09[_0x6046c0(0x262)](_0xf34d6e['original_date'])&&(_0x459b09[_0x6046c0(0x2b9)](_0xf34d6e[_0x6046c0(0x1eb)]),_0x2f08d4[_0x6046c0(0x2b9)]({'date':_0xf34d6e['original_date'],'geoHashList':[],'locationList':[]}));if(_0xf34d6e[_0x6046c0(0x256)]&&_0xf34d6e['geohash']!=_0x6046c0(0x1fc)&&_0xf34d6e[_0x6046c0(0x256)][_0x6046c0(0x2da)]>0x4){let _0x23599b=_0x2f08d4[_0x459b09[_0x6046c0(0x270)](_0xf34d6e['original_date'])][_0x6046c0(0x223)],_0x50a817=_0xf34d6e[_0x6046c0(0x256)][_0x6046c0(0x26c)](0x0,0x5);!_0x23599b['includes'](_0x50a817)&&_0x23599b[_0x6046c0(0x2da)]<0x5&&_0x23599b['push'](_0x50a817);}}for(let _0x3cc20b of _0x2f08d4){if(_0x3cc20b[_0x6046c0(0x223)][_0x6046c0(0x2da)]<0x1)continue;for(let _0x54f80c in _0x3cc20b['geoHashList']){let _0x3ef9f6=_0x3cc20b['geoHashList'][_0x54f80c][_0x6046c0(0x26c)](0x0,0x5),_0x13a850=null;if(geoDbCache[_0x3ef9f6])_0x13a850=geoDbCache[_0x3ef9f6];else{let _0x1f68a0='SELECT\x20name,cn_name,geohash\x20FROM\x20cities\x20WHERE\x20geohash=?';_0x13a850=_0x1a32cb[_0x6046c0(0x2fc)][_0x6046c0(0x286)]['prepare'](_0x1f68a0)['get'](_0x3ef9f6),geoDbCache[_0x3ef9f6]=_0x13a850;}_0x13a850&&_0x3cc20b[_0x6046c0(0x1e3)][_0x6046c0(0x2b9)](_0x13a850);}delete _0x3cc20b[_0x6046c0(0x223)];}for(let _0x5649f9=_0x2f08d4[_0x6046c0(0x2da)]-0x1;_0x5649f9>=0x0;_0x5649f9--){_0x2f08d4[_0x5649f9][_0x6046c0(0x1e3)][_0x6046c0(0x2da)]<0x1&&_0x2f08d4[_0x6046c0(0x209)](_0x5649f9,0x1);}}}catch(_0x3c5662){console[_0x6046c0(0x2e9)](_0x3c5662);}let _0x5175cc={'code':0x0,'data':result,'originalDateItemList':_0x2f08d4},_0x46750a=dbConfigTable[_0x6046c0(0x24f)](_0x1a32cb[_0x6046c0(0x2fc)]['dbOther'],_0x6046c0(0x1c5)),_0x2e8795=dbConfigTable['findByTitle'](_0x1a32cb[_0x6046c0(0x2fc)][_0x6046c0(0x215)],_0x6046c0(0x204));_0x5175cc[_0x6046c0(0x2ff)]=_0x6046c0(0x207);if(_0x46750a&&_0x46750a['value']==_0x6046c0(0x2e7)&&_0x2e8795&&_0x2e8795[_0x6046c0(0x205)])try{let _0x5d30a4=parseInt(_0x2e8795[_0x6046c0(0x205)]);_0x5175cc[_0x6046c0(0x2ff)]='CUSTOM',_0x5175cc['imagePreviewSize']=_0x5d30a4;}catch(_0x181ea2){console[_0x6046c0(0x2e9)](_0x181ea2);}_0x199c33[_0x6046c0(0x1d1)](_0x5175cc);}}),router[_0x14f265(0x227)]('/getAlbumPhotoForMap',(_0x5c6287,_0x5d710d,_0x4036d6)=>{const _0xbc5463=_0x14f265;let _0x31216f=_0xbc5463(0x23d),_0x1f689d=[],_0x4bf86c=_0x5c6287[_0xbc5463(0x2c3)][_0xbc5463(0x311)];if(_0x5c6287[_0xbc5463(0x2c3)]['albumId']){let _0x50c004=dbAlbumTable[_0xbc5463(0x322)](_0x5c6287['app'][_0xbc5463(0x215)],_0x5c6287[_0xbc5463(0x2c3)]['albumId']);_0x50c004&&(_0x31216f+=_0xbc5463(0x2fe)+_0x50c004);}if(_0x4bf86c){let _0x4f85d3=_0x5c6287[_0xbc5463(0x2fc)]['dbFileIndex'][_0xbc5463(0x2e2)](_0xbc5463(0x30d))[_0xbc5463(0x1e1)](_0x4bf86c);if(_0x4f85d3)try{let _0x5aa7d4=JSON[_0xbc5463(0x1ce)](_0x4f85d3[_0xbc5463(0x2ce)]),_0x12de3a=dbUserTable['getPathWhere'](!![],_0x5aa7d4);_0x31216f+=_0x12de3a[_0xbc5463(0x28b)],_0x1f689d[_0xbc5463(0x2b9)](..._0x12de3a['paramsList']);}catch(_0xd02be4){console['log'](_0xd02be4);}}function _0x3754c9(_0x9795b,_0xe01ae5,_0x240ef0){const _0x4c23eb=_0xbc5463;if(_0x240ef0){let _0x19c123=0x0;if(_0x5c6287['body']['ordinaryAlbumId']){let _0x2fffe1=dbFileIndexTable[_0x4c23eb(0x1f5)](_0x5c6287[_0x4c23eb(0x2fc)][_0x4c23eb(0x1fd)],_0x9795b,[parseInt(_0x5c6287['body']['ordinaryAlbumId']),..._0x1f689d]);_0x19c123=_0x2fffe1['count'];}else{let _0x186c7d=dbFileIndexTable['getCountByWhere'](_0x5c6287[_0x4c23eb(0x2fc)][_0x4c23eb(0x1fd)],_0x9795b,dbFileIndexTable[_0x4c23eb(0x2d7)],_0x1f689d);_0x19c123=_0x186c7d[_0x4c23eb(0x31a)];}return _0x19c123;}else{let _0x4d8a5b=[];return _0x5c6287[_0x4c23eb(0x2c3)][_0x4c23eb(0x229)]?_0x4d8a5b=dbFileIndexTable[_0x4c23eb(0x2d0)](_0x5c6287['app']['dbFileIndex'],_0x9795b,_0xe01ae5,[parseInt(_0x5c6287[_0x4c23eb(0x2c3)][_0x4c23eb(0x229)]),..._0x1f689d]):_0x4d8a5b=dbFileIndexTable[_0x4c23eb(0x296)](_0x5c6287[_0x4c23eb(0x2fc)][_0x4c23eb(0x1fd)],_0x9795b,_0xe01ae5,dbFileIndexTable[_0x4c23eb(0x2d7)],_0x1f689d),_0x4d8a5b;}}let _0x70a620=dbUserTable[_0xbc5463(0x25f)](_0x5c6287,_0xbc5463(0x2c6),_0xbc5463(0x1ef),!![]),_0x2d0deb=_0x70a620[_0xbc5463(0x28b)];_0x31216f+=_0x2d0deb,_0x1f689d[_0xbc5463(0x2b9)](..._0x70a620[_0xbc5463(0x2f3)]),_0x31216f+=_0xbc5463(0x2a2);let _0x4e48a8=0xc8,_0x10b08f=[],_0x2e8cf6=_0x3754c9(_0x31216f,null,!![]);if(_0x2e8cf6<_0x4e48a8)_0x10b08f=_0x3754c9(_0x31216f,'*');else{let _0x135156=_0x31216f+'\x20AND\x20geohash5!=\x27undefined\x27\x20GROUP\x20BY\x20geohash5',_0x142c53=_0x3754c9(_0x135156,'*');if(_0x142c53&&_0x142c53['length']<_0x4e48a8)_0x10b08f=_0x142c53;else{let _0x35ca02=_0x31216f+_0xbc5463(0x268),_0x5d53e0=_0x3754c9(_0x35ca02,'*');if(_0x5d53e0&&_0x5d53e0[_0xbc5463(0x2da)]<_0x4e48a8)_0x10b08f=_0x5d53e0;else{let _0x5a5c0a=_0x31216f+'\x20AND\x20geohash3!=\x27undefined\x27\x20GROUP\x20BY\x20geohash3',_0x2aeffe=_0x3754c9(_0x5a5c0a,'*');if(_0x2aeffe&&_0x2aeffe[_0xbc5463(0x2da)]<_0x4e48a8)_0x10b08f=_0x2aeffe;else{let _0x45af9c=_0x31216f+_0xbc5463(0x277);_0x10b08f=_0x3754c9(_0x45af9c,'*');}}}}return _0x5d710d['json']({'code':0x0,'mapPhoto':_0x10b08f});}),router[_0x14f265(0x227)](_0x14f265(0x306),(_0x21ab42,_0x4e65ac,_0x5ab76a)=>{const _0x1b81b7=_0x14f265;if(dbUserTable[_0x1b81b7(0x319)](_0x21ab42,_0x4e65ac,'photo',_0x1b81b7(0x1ef))==!![]){let _0x749f4a=_0x21ab42[_0x1b81b7(0x2c3)]['minLat'],_0x4e5bd=_0x21ab42[_0x1b81b7(0x2c3)][_0x1b81b7(0x328)],_0x238c6d=_0x21ab42[_0x1b81b7(0x2c3)][_0x1b81b7(0x23c)],_0x3013ea=_0x21ab42['body'][_0x1b81b7(0x25d)],_0x412456=_0x21ab42[_0x1b81b7(0x2c3)][_0x1b81b7(0x1d6)],_0x3ae912='',_0x291aa3=0x2;if(_0x412456<=0x4)_0x291aa3=0x2,_0x3ae912='geohash2\x20=\x20?';else{if(_0x412456<=0x6)_0x291aa3=0x3,_0x3ae912=_0x1b81b7(0x275);else _0x412456<=0x8?(_0x291aa3=0x4,_0x3ae912=_0x1b81b7(0x2f0)):(_0x291aa3=0x5,_0x3ae912='geohash5\x20=\x20?');}let _0x445403=geohash[_0x1b81b7(0x27c)](_0x749f4a,_0x4e5bd,_0x238c6d,_0x3013ea,_0x291aa3),_0x19d2e6=_0x1b81b7(0x2ba),_0x6b44ad=[],_0x20b1d9=dbUserTable['getUserPathWhere'](_0x21ab42,_0x1b81b7(0x2c6),_0x1b81b7(0x1ef),!![]);for(let _0x3fe195=0x0;_0x3fe195<_0x445403[_0x1b81b7(0x2da)];_0x3fe195++){let _0x175333=_0x445403[_0x3fe195],_0x1cc80f=[_0x175333,..._0x20b1d9[_0x1b81b7(0x2f3)]],_0x33bc5d='\x20'+_0x3ae912+'\x20'+_0x20b1d9[_0x1b81b7(0x28b)]+_0x1b81b7(0x218),_0x3f2c90=dbFileIndexTable[_0x1b81b7(0x309)](_0x21ab42[_0x1b81b7(0x2fc)]['dbFileIndex'],_0x33bc5d,_0x19d2e6,dbFileIndexTable[_0x1b81b7(0x2d7)],_0x1cc80f);_0x3f2c90&&_0x6b44ad[_0x1b81b7(0x2b9)](_0x3f2c90);}_0x4e65ac['json']({'code':0x0,'mapPhoto':_0x6b44ad});}}),router[_0x14f265(0x227)]('/addAlbum',(_0x587f46,_0x1661af,_0x1a3e1e)=>{const _0x2ac742=_0x14f265;if(dbUserTable['doUserCanGet'](_0x587f46,_0x1661af,'photo',_0x2ac742(0x1e9))==!![]){let _0x4edff5=_0x587f46[_0x2ac742(0x2c3)][_0x2ac742(0x24c)],_0x57657d=_0x587f46['body'][_0x2ac742(0x2d5)],_0x4cd08e=_0x587f46['body'][_0x2ac742(0x2cf)],_0x400535=_0x587f46[_0x2ac742(0x2c3)][_0x2ac742(0x1ca)],_0x14f756=_0x587f46[_0x2ac742(0x2c3)][_0x2ac742(0x2a5)];if(!_0x57657d||!_0x57657d[_0x2ac742(0x313)]||sqliteUtil[_0x2ac742(0x2bd)](_0x57657d[_0x2ac742(0x313)])==!![])return _0x587f46[_0x2ac742(0x2fc)][_0x2ac742(0x1cb)](_0x1661af,'error\x20data');if(!_0x14f756){let _0x43ef7d=dbAlbumTable[_0x2ac742(0x21a)](_0x587f46[_0x2ac742(0x2fc)][_0x2ac742(0x215)],_0x400535);if(_0x43ef7d)return _0x587f46[_0x2ac742(0x2fc)][_0x2ac742(0x1cb)](_0x1661af,_0x1661af['__'](_0x2ac742(0x276)));}let _0x4168f8=null;_0x14f756?_0x4168f8=dbAlbumTable[_0x2ac742(0x32a)](_0x587f46[_0x2ac742(0x2fc)][_0x2ac742(0x215)],{'type':_0x4edff5,'data':_0x57657d,'data_value':_0x4cd08e,'name':_0x400535},_0x14f756):_0x4168f8=dbAlbumTable[_0x2ac742(0x20d)](_0x587f46['app'][_0x2ac742(0x215)],{'type':_0x4edff5,'data':_0x57657d,'data_value':_0x4cd08e,'name':_0x400535}),_0x1661af[_0x2ac742(0x1d1)]({'code':0x0,'result':_0x4168f8});}}),router[_0x14f265(0x227)]('/deleteAlbum',(_0x116d80,_0x4b5592,_0x402281)=>{const _0x14e534=_0x14f265;if(dbUserTable['doUserCanGet'](_0x116d80,_0x4b5592,_0x14e534(0x2c6),_0x14e534(0x2ca))==!![]){let _0xb4cd3b=_0x116d80[_0x14e534(0x2c3)]['id'],_0x33a4fd=dbAlbumTable[_0x14e534(0x237)](_0x116d80[_0x14e534(0x2fc)][_0x14e534(0x215)],_0xb4cd3b);_0x33a4fd[_0x14e534(0x208)]>0x0?_0x4b5592[_0x14e534(0x1d1)]({'code':0x0,'result':_0x33a4fd}):_0x4b5592['json']({'code':0x1,'message':_0x14e534(0x30e)});}}),router['post'](_0x14f265(0x251),(_0x59d394,_0x122181,_0x42a66f)=>{const _0x18ae54=_0x14f265;if(dbUserTable['doUserCanGet'](_0x59d394,_0x122181,_0x18ae54(0x2c6),_0x18ae54(0x254))==!![]){let _0x2ede39=_0x59d394[_0x18ae54(0x2c3)]['id'],_0x1ef586=_0x59d394['body'][_0x18ae54(0x1ca)],_0x5e2bf6=dbAlbumTable['getByName'](_0x59d394['app'][_0x18ae54(0x215)],_0x1ef586);if(_0x5e2bf6)return _0x59d394[_0x18ae54(0x2fc)][_0x18ae54(0x1cb)](_0x122181,_0x122181['__'](_0x18ae54(0x276)));let _0x37d584=dbAlbumTable['udpateName'](_0x59d394[_0x18ae54(0x2fc)][_0x18ae54(0x215)],_0x2ede39,_0x1ef586);_0x37d584[_0x18ae54(0x208)]>0x0?_0x122181[_0x18ae54(0x1d1)]({'code':0x0,'result':_0x37d584}):_0x122181['json']({'code':0x1,'message':_0x18ae54(0x30e)});}}),router['post'](_0x14f265(0x238),(_0x311318,_0x4c62a8,_0x4e9edd)=>{const _0x343b6a=_0x14f265;if(dbUserTable['doUserCanGet'](_0x311318,_0x4c62a8,_0x343b6a(0x2c6),_0x343b6a(0x1ef))==!![]){let _0x17ae6e=_0x311318[_0x343b6a(0x2c3)]['count']||0x32,_0x3ae3b0=_0x311318[_0x343b6a(0x2c3)][_0x343b6a(0x289)]||0x0,_0x215453=_0x311318['body'][_0x343b6a(0x203)]||'id',_0x46e95c=_0x311318[_0x343b6a(0x2c3)]['orderType']||'desc',_0x575595=_0x311318[_0x343b6a(0x2c3)]['search'],_0x46b8f4=dbAlbumTable[_0x343b6a(0x300)](_0x311318[_0x343b6a(0x2fc)][_0x343b6a(0x215)],_0x17ae6e,_0x3ae3b0,_0x215453,_0x46e95c,_0x575595),_0x55282c=dbUserTable[_0x343b6a(0x25f)](_0x311318,_0x343b6a(0x2c6),_0x343b6a(0x1ef),!![]);for(let _0x3cb9d9=0x0;_0x3cb9d9<_0x46b8f4['length'];_0x3cb9d9++){let _0x3542e6='\x20is_file=1\x20';_0x3542e6+=_0x55282c[_0x343b6a(0x28b)];let _0x48b047=[..._0x55282c[_0x343b6a(0x2f3)]],_0x358ece=dbAlbumTable[_0x343b6a(0x322)](_0x311318['app']['dbOther'],_0x46b8f4[_0x3cb9d9]['id']);_0x358ece&&(_0x3542e6+=_0x343b6a(0x2fe)+_0x358ece);_0x3542e6+=_0x343b6a(0x250),_0x3542e6+=_0x343b6a(0x1c2);try{let _0x590055=dbFileIndexTable[_0x343b6a(0x2a0)](_0x311318['app']['dbFileIndex'],_0x3542e6,'*',dbFileIndexTable[_0x343b6a(0x2d7)],_0x48b047);_0x46b8f4[_0x3cb9d9][_0x343b6a(0x27d)]=_0x590055;}catch(_0x2e38c7){console[_0x343b6a(0x2e9)](_0x2e38c7),_0x46b8f4[_0x3cb9d9][_0x343b6a(0x27d)]=[];}}_0x4c62a8[_0x343b6a(0x1d1)]({'code':0x0,'data':_0x46b8f4});}}),router[_0x14f265(0x227)](_0x14f265(0x1f8),(_0x13b7c1,_0x503a83,_0x42d376)=>{const _0x59fa00=_0x14f265;let _0xc6f0cc=_0x13b7c1[_0x59fa00(0x2c3)][_0x59fa00(0x200)],_0x55b63d=dbFileIndexTable[_0x59fa00(0x27f)](_0x13b7c1['app']['dbFileIndex'],_0xc6f0cc),_0x4c4d81=[];for(let _0x1d5d14=0x0;_0x1d5d14<_0x55b63d[_0x59fa00(0x2da)];_0x1d5d14++){_0x4c4d81[_0x59fa00(0x2b9)](_0x55b63d[_0x1d5d14][_0x59fa00(0x1de)]);}_0x503a83[_0x59fa00(0x1d1)]({'code':0x0,'data':_0x4c4d81});}),router['post'](_0x14f265(0x321),(_0xe05e90,_0x1a27c8,_0x27f503)=>{const _0x2b01d7=_0x14f265;let _0x481c1b=_0xe05e90['body'][_0x2b01d7(0x316)],_0x4532b9=_0xe05e90[_0x2b01d7(0x2c3)]['serveType'],_0xd33351=_0xe05e90[_0x2b01d7(0x2c3)]['count'],_0x5c670e=_0xe05e90['body'][_0x2b01d7(0x289)]||0x0;_0x5c670e=parseInt(_0x5c670e);let _0x5ada50=parseInt(_0xe05e90[_0x2b01d7(0x2c3)][_0x2b01d7(0x1e0)]),_0x148818=_0xe05e90[_0x2b01d7(0x2c3)][_0x2b01d7(0x2b3)],_0x32bebe=[_0x2b01d7(0x1c8),_0x2b01d7(0x2d1),'size','create_time','filename_number'],_0x2bdf14=[_0x2b01d7(0x214),_0x2b01d7(0x2dc)],_0xa196d9=_0xe05e90[_0x2b01d7(0x2c3)][_0x2b01d7(0x203)]||'id',_0x2054f0=_0xe05e90['body'][_0x2b01d7(0x31c)]||_0x2b01d7(0x2dc);!_0x32bebe[_0x2b01d7(0x262)](_0xa196d9)&&(_0xa196d9='id');!_0x2bdf14[_0x2b01d7(0x262)](_0x2054f0)&&(_0xa196d9='desc');if(dbUserTable[_0x2b01d7(0x319)](_0xe05e90,_0x1a27c8,_0x4532b9,_0x2b01d7(0x1ef))==!![]){let _0x3c84fb=[];if(!_0x481c1b){let _0x38bd86=[];_0xe05e90[_0x2b01d7(0x217)][_0x2b01d7(0x1ff)]==0x1?_0x38bd86=dbSourceFolderTable[_0x2b01d7(0x245)](_0xe05e90[_0x2b01d7(0x2fc)]['dbOther'],_0x4532b9):_0x38bd86=dbUserTable['getUserPower'](_0xe05e90[_0x2b01d7(0x2fc)][_0x2b01d7(0x215)],_0xe05e90['currentUser'][_0x2b01d7(0x211)],_0x4532b9);if(_0x38bd86)for(let _0x444e12=0x0;_0x444e12<_0x38bd86[_0x2b01d7(0x2da)];_0x444e12++){_0x3c84fb[_0x2b01d7(0x2b9)]({'path':_0x38bd86[_0x444e12][_0x2b01d7(0x2e3)],'is_file':0x0,'filename':path[_0x2b01d7(0x295)](_0x38bd86[_0x444e12][_0x2b01d7(0x2e3)]),'root':!![]});}}else{if(_0xe05e90[_0x2b01d7(0x217)][_0x2b01d7(0x1ff)]!=0x1){if(dbUserTable[_0x2b01d7(0x319)](_0xe05e90,_0x1a27c8,_0x4532b9,_0x2b01d7(0x1ef),_0x481c1b)!==!![])return;}_0x481c1b=path[_0x2b01d7(0x210)](path['normalize'](_0x481c1b));let _0xaa599c=_0x2b01d7(0x320),_0x257ae2=[_0x481c1b];if(_0x5ada50==0x0)_0xaa599c+=_0x2b01d7(0x271);else{if(_0x5ada50==0x1)_0xaa599c+=_0x2b01d7(0x281);else{if(_0x5ada50==0x2)_0xaa599c+=_0x2b01d7(0x2ef);else _0x5ada50==0x3&&(_0xaa599c+=_0x2b01d7(0x293));}}if(_0x148818){let _0x4485b1='\x20\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)\x20';_0x257ae2[_0x2b01d7(0x2b9)]('%'+_0x148818+'%','\x27%'+_0x148818+'%\x27'),_0x4532b9==_0x2b01d7(0x21f)&&(_0x4485b1=_0x2b01d7(0x303),_0x257ae2['push']('\x27%'+_0x148818+'%\x27')),_0xaa599c+=_0x4485b1;}let _0x4b8524=_0x2b01d7(0x2e4),_0x541778=dbFileIndexTable['getIndexTableNameByType'](_0x4532b9);if(_0x4532b9==_0x2b01d7(0x21f))_0x4b8524=_0x2b01d7(0x1fa);else _0x4532b9=='music'&&(_0x4b8524=_0x2b01d7(0x2b6));_0xaa599c+='\x20ORDER\x20BY\x20is_file\x20asc,\x20'+_0xa196d9+'\x20'+_0x2054f0+_0x2b01d7(0x2d4)+_0xd33351+_0x2b01d7(0x2c1)+_0x5c670e,_0x3c84fb=dbFileIndexTable[_0x2b01d7(0x2a0)](_0xe05e90[_0x2b01d7(0x2fc)]['dbFileIndex'],_0xaa599c,_0x4b8524,_0x541778,_0x257ae2);}let _0x2205b9=path[_0x2b01d7(0x1d2)],_0x475e7e={'platform':platform,'code':0x0,'data':_0x3c84fb,'sep':_0x2205b9};return _0x1a27c8[_0x2b01d7(0x1d1)](_0x475e7e);}}),router[_0x14f265(0x227)](_0x14f265(0x329),(_0x499a9f,_0x353965,_0x43732e)=>{const _0x40e375=_0x14f265;let _0xbfebad=_0x499a9f[_0x40e375(0x2c3)]['id'],_0x1f311b=_0x499a9f[_0x40e375(0x2c3)]['serverType'],_0x146572=dbFileIndexTable[_0x40e375(0x2d7)];if(_0x1f311b==_0x40e375(0x21f))_0x146572=dbFileIndexTable[_0x40e375(0x27a)];else{if(_0x1f311b==_0x40e375(0x236))_0x146572=dbFileIndexTable[_0x40e375(0x22e)];else _0x1f311b=='book'&&(_0x146572=dbFileIndexTable['INDEX_TABLE_NAME_BOOK']);}let _0x3292c5=dbFileIndexTable['getById'](_0x499a9f[_0x40e375(0x2fc)]['dbFileIndex'],_0xbfebad,_0x146572);if(!_0x3292c5)return _0x353965[_0x40e375(0x22b)](0x194)[_0x40e375(0x2ec)]();if(dbUserTable['doUserCanGet'](_0x499a9f,_0x353965,'','power_get',_0x3292c5['path'])==!![]){let _0x17d545={'code':0x0,'data':_0x3292c5};if(_0x1f311b==_0x40e375(0x21f)){let _0x356a87=dbConfigTable['findByTitle'](_0x499a9f[_0x40e375(0x2fc)]['dbOther'],_0x40e375(0x29f));_0x17d545[_0x40e375(0x29f)]=_0x356a87?_0x356a87[_0x40e375(0x205)]:'chi',_0x17d545['data'][_0x40e375(0x29f)]=_0x17d545[_0x40e375(0x29f)];let _0x1bc139=dbConfigTable[_0x40e375(0x24f)](_0x499a9f[_0x40e375(0x2fc)][_0x40e375(0x215)],_0x40e375(0x29e));_0x17d545[_0x40e375(0x29e)]=_0x1bc139?_0x1bc139[_0x40e375(0x205)]:'2',_0x17d545[_0x40e375(0x2d5)][_0x40e375(0x29e)]=_0x17d545[_0x40e375(0x29e)];let _0x3a9765=dbConfigTable[_0x40e375(0x24f)](_0x499a9f[_0x40e375(0x2fc)][_0x40e375(0x215)],'defaultTranscodeResolution');_0x17d545['defaultTranscodeResolution']=_0x3a9765?_0x3a9765[_0x40e375(0x205)]:'3';let _0x2e0cd8=dbConfigTable[_0x40e375(0x24f)](_0x499a9f['app']['dbOther'],_0x40e375(0x20f));_0x17d545[_0x40e375(0x20f)]=_0x2e0cd8?_0x2e0cd8['value']:'rawFile';let _0xcd74f3=path['join'](_0x3292c5[_0x40e375(0x2e3)],_0x3292c5['filename']);fs[_0x40e375(0x1ec)](_0xcd74f3,(_0x17e76e,_0x28ce9b)=>{const _0x40ff6c=_0x40e375;return _0x17e76e?(_0x17d545[_0x40ff6c(0x233)]=0x0,_0x17d545['indexFullPath']=_0xcd74f3):(_0x17d545['fileExist']=0x1,_0x17d545['indexFullPath']=_0xcd74f3),_0x353965[_0x40ff6c(0x1d1)](_0x17d545);});}else return _0x353965[_0x40e375(0x1d1)](_0x17d545);}}),router[_0x14f265(0x227)](_0x14f265(0x2e8),(_0x2c0855,_0x25ebe7,_0x36fb29)=>{const _0x52024c=_0x14f265;if(dbUserTable['doUserCanGet'](_0x2c0855,_0x25ebe7,_0x52024c(0x2c6),_0x52024c(0x254))==!![]){let _0x1d3613=_0x2c0855[_0x52024c(0x2c3)]['id'],_0x11fe8f=_0x2c0855[_0x52024c(0x2c3)][_0x52024c(0x25e)],_0x195de9=_0x2c0855[_0x52024c(0x2c3)][_0x52024c(0x2a8)],_0x4b1ecc=_0x2c0855['body'][_0x52024c(0x272)],_0x34d3fd=dbFileIndexTable['getById'](_0x2c0855[_0x52024c(0x2fc)][_0x52024c(0x1fd)],_0x1d3613);if(!_0x34d3fd)return _0x2c0855[_0x52024c(0x2fc)][_0x52024c(0x1cb)](_0x25ebe7,_0x25ebe7['__'](_0x52024c(0x213)));let _0x46976b=path[_0x52024c(0x20e)](_0x34d3fd['path'],path[_0x52024c(0x1d2)],_0x34d3fd[_0x52024c(0x1c8)]),_0x43c9c1=path['extname'](_0x46976b)?path[_0x52024c(0x2b2)](_0x46976b)[_0x52024c(0x284)]():'';if(_0x43c9c1!=_0x52024c(0x2bf)&&_0x43c9c1!=_0x52024c(0x2b5))return _0x2c0855['app'][_0x52024c(0x1cb)](_0x25ebe7,'Image\x20format\x20not\x20support');fs['stat'](_0x46976b,(_0x30343e,_0x292082)=>{const _0xa1bc8c=_0x52024c;if(_0x30343e||!_0x292082[_0xa1bc8c(0x201)]())return _0x2c0855['app'][_0xa1bc8c(0x1cb)](_0x25ebe7,_0x25ebe7['__'](_0xa1bc8c(0x274)));if(_0x30343e||!_0x292082[_0xa1bc8c(0x201)]())return _0x2c0855[_0xa1bc8c(0x2fc)][_0xa1bc8c(0x1cb)](_0x25ebe7,_0x25ebe7['__'](_0xa1bc8c(0x274)));fs[_0xa1bc8c(0x305)](_0x46976b,(_0x514903,_0xfe6f4c)=>{const _0x167d0e=_0xa1bc8c;if(_0x514903)return _0x2c0855[_0x167d0e(0x2fc)][_0x167d0e(0x1cb)](_0x25ebe7,_0x25ebe7['__'](_0x167d0e(0x273)));var _0x21ed2f=piexif['load'](_0xfe6f4c[_0x167d0e(0x2ae)](_0x167d0e(0x247)));if(_0x11fe8f&&_0x195de9){function _0x4b7d4f(_0x5a2631){const _0x4be3b9=_0x167d0e;try{_0x5a2631=Number(_0x5a2631);let _0x1944e5=Math[_0x4be3b9(0x1d4)](Math['abs'](_0x5a2631)),_0x257779=(Math[_0x4be3b9(0x2b4)](_0x5a2631)-_0x1944e5)*0x3c,_0x733f2f=Math['floor'](_0x257779),_0x4ed81b=Math[_0x4be3b9(0x27b)]((_0x257779-_0x733f2f)*0x3c*0x64);return[[_0x1944e5,0x1],[_0x733f2f,0x1],[_0x4ed81b,0x64]];}catch(_0x26aedd){return'';}}let _0x1e25ca=_0x4b7d4f(_0x11fe8f),_0x3c61d5=_0x4b7d4f(_0x195de9);if(!_0x3c61d5||!_0x1e25ca)return _0x2c0855['app'][_0x167d0e(0x1cb)](_0x25ebe7,'ERROR\x20GPS\x20LOCATION');_0x21ed2f[_0x167d0e(0x304)][piexif[_0x167d0e(0x206)]['GPSLatitudeRef']]=_0x11fe8f>=0x0?'N':'S',_0x21ed2f[_0x167d0e(0x304)][piexif[_0x167d0e(0x206)][_0x167d0e(0x1c9)]]=_0x1e25ca,(_0x21ed2f['GPS'][piexif['GPSIFD'][_0x167d0e(0x1cd)]]=_0x195de9>=0x0?'E':'W',_0x21ed2f['GPS'][piexif[_0x167d0e(0x206)][_0x167d0e(0x221)]]=_0x3c61d5);let _0x55268e=geohash[_0x167d0e(0x282)](_0x11fe8f,_0x195de9,0x8),_0x2603b5=_0x55268e[_0x167d0e(0x26c)](0x0,0x5),_0x9cc621=_0x55268e[_0x167d0e(0x26c)](0x0,0x4),_0x4d9794=_0x55268e[_0x167d0e(0x26c)](0x0,0x3),_0x123a88=_0x55268e[_0x167d0e(0x26c)](0x0,0x2),_0x48d0c2=[_0x11fe8f,_0x195de9,_0x55268e,_0x2603b5,_0x9cc621,_0x4d9794,_0x123a88];dbFileIndexTable['updateBySql'](_0x2c0855[_0x167d0e(0x2fc)][_0x167d0e(0x1fd)],_0x34d3fd['id'],_0x167d0e(0x265),dbFileIndexTable[_0x167d0e(0x2d7)],_0x48d0c2);}if(_0x4b1ecc){_0x21ed2f[_0x167d0e(0x1dd)][piexif[_0x167d0e(0x2fa)][_0x167d0e(0x1e2)]]=_0x4b1ecc,_0x21ed2f[_0x167d0e(0x304)][piexif['GPSIFD']['GPSDateStamp']]=_0x4b1ecc;let _0x595bbf=new Date(_0x4b1ecc),_0x43b40c=_0x595bbf['getTime'](),_0x5875ba=_0x595bbf[_0x167d0e(0x280)](),_0x16deab=_0x595bbf[_0x167d0e(0x2c5)]()+0x1;_0x16deab=_0x16deab>=0xa?_0x16deab:'0'+_0x16deab;let _0x344782=_0x595bbf[_0x167d0e(0x2ed)]();_0x344782=_0x344782>=0xa?_0x344782:'0'+_0x344782;let _0x2e098d=_0x5875ba+'-'+_0x16deab+'-'+_0x344782,_0x66712f=[_0x43b40c,_0x2e098d];dbFileIndexTable['updateBySql'](_0x2c0855['app'][_0x167d0e(0x1fd)],_0x34d3fd['id'],_0x167d0e(0x230),dbFileIndexTable[_0x167d0e(0x2d7)],_0x66712f);}try{var _0x5496bd=piexif[_0x167d0e(0x2e6)](_0x21ed2f),_0xfde440=piexif[_0x167d0e(0x21e)](_0x5496bd,_0xfe6f4c[_0x167d0e(0x2ae)](_0x167d0e(0x247)));let _0x33efb7=path['join'](_0x34d3fd[_0x167d0e(0x2e3)],_0x34d3fd[_0x167d0e(0x1c8)]);fs['writeFile'](_0x33efb7,Buffer[_0x167d0e(0x2f1)](_0xfde440,_0x167d0e(0x247)),{},_0x52a465=>{const _0x2ceb9d=_0x167d0e;if(_0x52a465)return console[_0x2ceb9d(0x2e9)](_0x52a465),_0x2c0855[_0x2ceb9d(0x2fc)][_0x2ceb9d(0x1cb)](_0x25ebe7,_0x25ebe7['__'](_0x2ceb9d(0x273)));console['log'](_0x2ceb9d(0x283)),fs[_0x2ceb9d(0x2cd)](_0x33efb7,new Date(_0x34d3fd['mtime']),new Date(_0x34d3fd['mtime']),_0x348b78=>{const _0x15ca57=_0x2ceb9d;_0x348b78&&console[_0x15ca57(0x2e9)](_0x348b78),fs[_0x15ca57(0x1ec)](_0x33efb7,(_0x599fd6,_0x1ec8d7)=>{const _0x1437cc=_0x15ca57;if(_0x599fd6)return _0x2c0855[_0x1437cc(0x2fc)][_0x1437cc(0x1cb)](_0x25ebe7,_0x25ebe7['__'](_0x1437cc(0x273)));let _0x38fef1=[_0x1ec8d7['size'],_0x1ec8d7[_0x1437cc(0x290)]];return dbFileIndexTable['updateBySql'](_0x2c0855[_0x1437cc(0x2fc)][_0x1437cc(0x1fd)],_0x34d3fd['id'],_0x1437cc(0x22a),dbFileIndexTable[_0x1437cc(0x2d7)],_0x38fef1),_0x25ebe7[_0x1437cc(0x1d1)]({'code':0x0,'newIndex':dbFileIndexTable['getById'](_0x2c0855[_0x1437cc(0x2fc)][_0x1437cc(0x1fd)],_0x34d3fd['id'])});});});});}catch(_0x543da7){return console[_0x167d0e(0x2e9)](_0x543da7),_0x2c0855[_0x167d0e(0x2fc)][_0x167d0e(0x1cb)](_0x25ebe7,_0x25ebe7['__'](_0x167d0e(0x28e)));}});});}}),router[_0x14f265(0x227)](_0x14f265(0x32f),(_0x367224,_0x479b0d,_0x26337a)=>{const _0x4f8341=_0x14f265;if(dbUserTable[_0x4f8341(0x319)](_0x367224,_0x479b0d,_0x4f8341(0x2c6),_0x4f8341(0x1ef))==!![]){let _0xc6316e=dbConfigTable[_0x4f8341(0x24f)](_0x367224[_0x4f8341(0x2fc)][_0x4f8341(0x215)],'aiClassesEnable');if(!_0xc6316e||_0xc6316e[_0x4f8341(0x205)]!='1')return _0x479b0d[_0x4f8341(0x1d1)]({'code':0x0,'data':[],'enable':![]});let _0x3c2ed7=_0x4f8341(0x294),_0x494bb2=dbUserTable[_0x4f8341(0x25f)](_0x367224,'photo',_0x4f8341(0x1ef),!![]),_0x1ad2b3=[],_0x252205=_0x367224[_0x4f8341(0x2fc)]['dbFileIndex'][_0x4f8341(0x2e2)](_0x4f8341(0x1df)+_0x3c2ed7)[_0x4f8341(0x242)](),_0x4b397d=[];for(let _0xbc6f9c in _0x252205){let _0x3337a2=_0x252205[_0xbc6f9c];_0x1ad2b3=[_0x3337a2['id'],dbFileIndexTable[_0x4f8341(0x2ad)],..._0x494bb2[_0x4f8341(0x2f3)]];let _0x3c1776=_0x367224[_0x4f8341(0x2fc)]['dbFileIndex']['prepare'](_0x4f8341(0x299)+_0x494bb2[_0x4f8341(0x28b)]+_0x4f8341(0x26a))[_0x4f8341(0x1e1)](_0x1ad2b3);if(_0x3c1776)_0x252205[_0xbc6f9c][_0x4f8341(0x1e7)]=_0x3c1776[_0x4f8341(0x1e7)],_0x252205[_0xbc6f9c]['class_id']=_0x252205[_0xbc6f9c]['id'],_0x4b397d[_0x4f8341(0x2b9)](_0x252205[_0xbc6f9c]);else continue;}_0x479b0d[_0x4f8341(0x1d1)]({'code':0x0,'data':_0x4b397d,'enable':!![]});}}),router['post'](_0x14f265(0x20b),(_0x5f4370,_0x130965,_0x163ef0)=>{const _0x2b68be=_0x14f265;if(dbUserTable[_0x2b68be(0x319)](_0x5f4370,_0x130965,'photo',_0x2b68be(0x1ef))==!![]){let _0x6d3482=dbConfigTable[_0x2b68be(0x24f)](_0x5f4370[_0x2b68be(0x2fc)][_0x2b68be(0x215)],_0x2b68be(0x26e));if(!_0x6d3482||_0x6d3482['value']!='1')return _0x130965[_0x2b68be(0x1d1)]({'code':0x0,'data':[],'enable':![]});let _0xcf2390=0x5,_0x5c4cf5=dbConfigTable[_0x2b68be(0x24f)](_0x5f4370['app'][_0x2b68be(0x215)],_0x2b68be(0x1db));_0x5c4cf5&&_0x5c4cf5[_0x2b68be(0x205)]&&(_0x5c4cf5['value']>0x0&&(_0xcf2390=_0x5c4cf5['value']));let _0x5bdd77=_0x5f4370[_0x2b68be(0x2fc)][_0x2b68be(0x1fd)]['prepare']('SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20disabled=0\x20and\x20belong_face_id\x20is\x20null\x20and\x20face_photo_count>=?\x20order\x20by\x20face_photo_count\x20desc\x20limit\x20500')[_0x2b68be(0x242)](parseInt(_0xcf2390)),_0x24bf26=[];if(_0x5f4370[_0x2b68be(0x217)][_0x2b68be(0x1ff)]==0x1)_0x24bf26=_0x5bdd77;else{let _0x4f64bc=dbUserTable['getUserPathWhere'](_0x5f4370,_0x2b68be(0x2c6),_0x2b68be(0x1ef),!![]);for(let _0x11ed09 of _0x5bdd77){try{let _0x44c949=[_0x11ed09['id'],..._0x4f64bc[_0x2b68be(0x2f3)]],_0x1e4569=_0x5f4370[_0x2b68be(0x2fc)][_0x2b68be(0x1fd)][_0x2b68be(0x2e2)](_0x2b68be(0x241)+_0x4f64bc[_0x2b68be(0x28b)]+'\x20LIMIT\x201')[_0x2b68be(0x1e1)](_0x44c949);_0x1e4569&&_0x24bf26[_0x2b68be(0x2b9)](_0x11ed09);}catch(_0x1fbf45){console[_0x2b68be(0x2e9)](_0x1fbf45),_0x24bf26[_0x2b68be(0x2b9)](_0x11ed09);}}}_0x130965[_0x2b68be(0x1d1)]({'code':0x0,'data':_0x24bf26,'enable':!![]});}}),router[_0x14f265(0x227)]('/setFacePoster',(_0x1942b1,_0x226590,_0x1af188)=>{const _0x3d9ce3=_0x14f265;let _0x110a34=_0x1942b1['body'][_0x3d9ce3(0x25b)],_0x56374a=_0x1942b1[_0x3d9ce3(0x2c3)]['rawFaceId'],_0x1e0ebb=_0x1942b1[_0x3d9ce3(0x2c3)][_0x3d9ce3(0x1f7)];if(dbUserTable[_0x3d9ce3(0x319)](_0x1942b1,_0x226590,_0x3d9ce3(0x2c6),_0x3d9ce3(0x254))==!![]){let _0x4165f2=dbFileIndexTable['getFaceInSql'](_0x1942b1[_0x3d9ce3(0x2fc)][_0x3d9ce3(0x1fd)],_0x110a34);_0x1942b1[_0x3d9ce3(0x2fc)][_0x3d9ce3(0x1fd)][_0x3d9ce3(0x2e2)](_0x3d9ce3(0x314)+_0x4165f2)[_0x3d9ce3(0x2e0)](),_0x1942b1[_0x3d9ce3(0x2fc)]['dbFileIndex'][_0x3d9ce3(0x2e2)](_0x3d9ce3(0x285)+_0x1e0ebb+_0x3d9ce3(0x2ee)+_0x56374a)[_0x3d9ce3(0x2e0)](),_0x1942b1[_0x3d9ce3(0x2fc)][_0x3d9ce3(0x1fd)][_0x3d9ce3(0x2e2)](_0x3d9ce3(0x2db)+_0x110a34)[_0x3d9ce3(0x2e0)](),_0x226590[_0x3d9ce3(0x1d1)]({'code':0x0});}}),router[_0x14f265(0x227)](_0x14f265(0x246),(_0x4df61a,_0x5af343,_0x8261bc)=>{const _0xc9c4db=_0x14f265;let _0x405017=_0x4df61a[_0xc9c4db(0x2c3)][_0xc9c4db(0x24a)];try{_0x405017=JSON[_0xc9c4db(0x1ce)](_0x405017);}catch(_0x2dea49){console['log'](_0x2dea49);}if(dbUserTable['doUserCanGet'](_0x4df61a,_0x5af343,'photo',_0xc9c4db(0x254))==!![]){for(let _0x42c9bc of _0x405017){_0x4df61a[_0xc9c4db(0x2fc)][_0xc9c4db(0x1fd)][_0xc9c4db(0x2e2)](_0xc9c4db(0x288))[_0xc9c4db(0x2e0)](parseInt(_0x42c9bc[_0xc9c4db(0x2fd)]),parseInt(_0x42c9bc['indexId']));}_0x5af343[_0xc9c4db(0x1d1)]({'code':0x0});}}),router['post'](_0x14f265(0x244),(_0x4875f4,_0x2d1829,_0x457ad0)=>{const _0x225c7f=_0x14f265;if(dbUserTable['doUserCanGet'](_0x4875f4,_0x2d1829,_0x225c7f(0x2c6),'power_change')==!![]){let _0x34d286=_0x4875f4[_0x225c7f(0x2c3)][_0x225c7f(0x1f6)],_0x379744=_0x4875f4['body'][_0x225c7f(0x292)],_0x1f3ebd=_0x4875f4[_0x225c7f(0x2c3)][_0x225c7f(0x2fd)],_0x2ac16e=_0x4875f4[_0x225c7f(0x2c3)]['faceIdList'];if(_0x34d286){_0x34d286=_0x34d286[_0x225c7f(0x2a6)]();let _0x1bbec4=_0x4875f4[_0x225c7f(0x2fc)]['dbFileIndex']['prepare'](_0x225c7f(0x264))[_0x225c7f(0x1e1)](_0x34d286);_0x1bbec4&&_0x1bbec4['id']!=_0x1f3ebd?_0x4875f4[_0x225c7f(0x2fc)][_0x225c7f(0x1fd)][_0x225c7f(0x2e2)]('UPDATE\x20photo_faces\x20SET\x20belong_face_id=?\x20where\x20id\x20=\x20?')['run'](_0x1bbec4['id'],_0x1f3ebd):(_0x4875f4[_0x225c7f(0x2fc)][_0x225c7f(0x1fd)]['prepare'](_0x225c7f(0x225))['run'](_0x34d286),_0x4875f4['app'][_0x225c7f(0x1fd)][_0x225c7f(0x2e2)](_0x225c7f(0x2eb))[_0x225c7f(0x2e0)](_0x34d286,_0x1f3ebd));}if(parseInt(_0x379744)==0x0||parseInt(_0x379744)==0x1){if(_0x2ac16e){let _0x47b870=_0x225c7f(0x2d8);for(let _0x33c51c in _0x2ac16e){_0x47b870+=_0x2ac16e[_0x33c51c],_0x33c51c!=_0x2ac16e['length']-0x1&&(_0x47b870+=',');}_0x47b870+=')';let _0xcc5632='UPDATE\x20photo_faces\x20SET\x20disabled=?\x20where\x20'+_0x47b870;_0x4875f4[_0x225c7f(0x2fc)][_0x225c7f(0x1fd)][_0x225c7f(0x2e2)](_0xcc5632)[_0x225c7f(0x2e0)](_0x379744);}else _0x4875f4[_0x225c7f(0x2fc)][_0x225c7f(0x1fd)][_0x225c7f(0x2e2)]('UPDATE\x20photo_faces\x20SET\x20disabled=?\x20where\x20id\x20=\x20?')[_0x225c7f(0x2e0)](_0x379744,_0x1f3ebd);}return _0x2d1829[_0x225c7f(0x1d1)]({'code':0x0});}}),router[_0x14f265(0x227)](_0x14f265(0x2fb),(_0x240af0,_0x58e335,_0x190886)=>{const _0x491c8=_0x14f265;if(dbUserTable['doUserCanGet'](_0x240af0,_0x58e335,_0x491c8(0x2c6),_0x491c8(0x254))==!![]){let _0x232816=_0x240af0['body'][_0x491c8(0x2b8)];if(!_0x232816||_0x232816[_0x491c8(0x2da)]<0x2)return _0x240af0[_0x491c8(0x2fc)][_0x491c8(0x1cb)](_0x58e335,_0x58e335['__']('atleastChooseTwoFaces'));let _0x5b45fb=_0x240af0[_0x491c8(0x2fc)][_0x491c8(0x1fd)][_0x491c8(0x2e2)](_0x491c8(0x267))['get'](_0x232816[0x0]);if(!_0x5b45fb)return _0x240af0[_0x491c8(0x2fc)][_0x491c8(0x1cb)](_0x58e335,_0x58e335['__'](_0x491c8(0x273)));for(let _0x3959fc=0x1;_0x3959fc<_0x232816[_0x491c8(0x2da)];_0x3959fc++){let _0x48c1b6=_0x232816[_0x3959fc];_0x240af0[_0x491c8(0x2fc)][_0x491c8(0x1fd)][_0x491c8(0x2e2)](_0x491c8(0x222))['run'](_0x5b45fb['id'],_0x48c1b6,_0x48c1b6);}return process[_0x491c8(0x29b)]({'type':_0x491c8(0x219)}),_0x58e335['json']({'code':0x0});}}),router[_0x14f265(0x1e1)](_0x14f265(0x1e4),(_0xf220e1,_0x2c2c6c,_0x455b5e)=>{const _0xfecd3a=_0x14f265;let _0x48dc39=_0xf220e1[_0xfecd3a(0x1d5)][_0xfecd3a(0x2fd)];if(dbUserTable[_0xfecd3a(0x319)](_0xf220e1,_0x2c2c6c,_0xfecd3a(0x2c6),_0xfecd3a(0x1ef))==!![]){let _0x539913=_0xf220e1['app']['dbFileIndex'][_0xfecd3a(0x2e2)](_0xfecd3a(0x2de))[_0xfecd3a(0x1e1)](_0x48dc39);if(!_0x539913)return _0x2c2c6c['status'](0x194)['end']();_0xf220e1[_0xfecd3a(0x217)]['is_admin']!=0x1?_0x34a3b9(![]):!_0x539913[_0xfecd3a(0x2f2)]?_0x34a3b9(!![]):fs[_0xfecd3a(0x1ec)](_0x539913[_0xfecd3a(0x2f2)],(_0x10c6f2,_0x48b5db)=>{const _0x1c9565=_0xfecd3a;if(!_0x10c6f2){let _0x56ca0b=new Date()[_0x1c9565(0x1da)](),_0x1ec4ce=0x48*0xe10*0x3e8;if(_0x48b5db['ctimeMs']){let _0x2a5b87=_0x56ca0b-_0x48b5db[_0x1c9565(0x290)];if(_0x2a5b87>_0x1ec4ce)return _0x34a3b9(!![]);}return _0x2c2c6c[_0x1c9565(0x1dc)](_0x539913[_0x1c9565(0x2f2)]);}_0x34a3b9(!![]);});function _0x34a3b9(_0x1ca09){const _0x2e2fe9=_0xfecd3a;let _0x575d0e=dbFileIndexTable[_0x2e2fe9(0x327)](_0xf220e1['app'][_0x2e2fe9(0x1fd)],_0x48dc39),_0xe3f595=_0x2e2fe9(0x1c6)+_0x575d0e+'\x20',_0x1f6529=[];if(_0xf220e1[_0x2e2fe9(0x217)][_0x2e2fe9(0x1ff)]!=0x1){let _0x5422f4=dbUserTable[_0x2e2fe9(0x25f)](_0xf220e1,'photo',_0x2e2fe9(0x1ef),!![]);_0xe3f595+=_0x5422f4[_0x2e2fe9(0x28b)],_0x1f6529=_0x1f6529[_0x2e2fe9(0x2ea)](_0x5422f4[_0x2e2fe9(0x2f3)]);}let _0x1513ce=_0xf220e1[_0x2e2fe9(0x2fc)][_0x2e2fe9(0x1fd)][_0x2e2fe9(0x2e2)](_0xe3f595+'\x20and\x20a.is_face_poster=1\x20limit\x201')[_0x2e2fe9(0x1e1)](_0x1f6529);if(!_0x1513ce){_0x1513ce=_0xf220e1[_0x2e2fe9(0x2fc)][_0x2e2fe9(0x1fd)][_0x2e2fe9(0x2e2)](_0xe3f595+'\x20order\x20by\x20f.original_time\x20desc\x20limit\x201')[_0x2e2fe9(0x1e1)](_0x1f6529);if(!_0x1513ce)return _0x2c2c6c[_0x2e2fe9(0x22b)](0x194)[_0x2e2fe9(0x2ec)]();}if(!_0x1513ce)return _0x2c2c6c[_0x2e2fe9(0x22b)](0x194)[_0x2e2fe9(0x2ec)]();let _0x391624=path['join'](_0x1513ce['path'],_0x1513ce[_0x2e2fe9(0x1c8)]);if(parseInt(_0x1513ce[_0x2e2fe9(0x24c)])==0x2){let _0x3e4081=config[_0x2e2fe9(0x1e5)](_0x1513ce),_0x2271a5=path[_0x2e2fe9(0x20e)](config['cachePath'],_0x3e4081);sharpUtil[_0x2e2fe9(0x1ed)](_0x391624,path[_0x2e2fe9(0x2cb)](_0x2271a5),path[_0x2e2fe9(0x295)](_0x2271a5),_0x2e2fe9(0x23e),_0x1513ce,_0x4ae996=>{_0x391624=_0x2271a5,_0x2a08a2();},_0x398c92=>{const _0x2d2059=_0x2e2fe9;return _0x2c2c6c[_0x2d2059(0x22b)](0x194)[_0x2d2059(0x2ec)]();});}else _0x2a08a2();function _0x2a08a2(){const _0x318aaa=_0x2e2fe9;let _0x7fe1a7=path[_0x318aaa(0x20e)](config[_0x318aaa(0x1c4)],_0x1513ce['f2id']+new Date()['getTime']()+_0x318aaa(0x2bf)),_0x4ebc65=0x7d0;sharpUtil[_0x318aaa(0x21d)](_0x391624,(_0x1ec46f,_0x169c39,_0x434e33)=>{const _0x5b5246=_0x318aaa;let _0x5a0b42=parseInt(_0x1513ce[_0x5b5246(0x31e)]*1.4),_0x273d2a=parseInt(_0x1513ce['f2height']*1.4),_0x2baa97=parseInt(_0x1513ce[_0x5b5246(0x2e5)]-_0x5a0b42*0.2),_0x3a5857=parseInt(_0x1513ce[_0x5b5246(0x243)]-_0x273d2a*0.2);if(_0x3a5857<0x0)_0x3a5857=0x0;if(_0x2baa97<0x0)_0x2baa97=0x0;_0x53a20c(_0x1ec46f,_0x169c39,_0x434e33,_0x2baa97,_0x3a5857,_0x5a0b42,_0x273d2a,()=>{const _0x47ee78=_0x5b5246;let _0x1dd84c=parseInt(_0x1513ce[_0x47ee78(0x31e)]),_0x4e59a9=parseInt(_0x1513ce[_0x47ee78(0x261)]),_0x392b66=parseInt(_0x1513ce[_0x47ee78(0x2e5)]),_0x1f44b7=parseInt(_0x1513ce[_0x47ee78(0x243)]);if(_0x1f44b7<0x0)_0x1f44b7=0x0;if(_0x392b66<0x0)_0x392b66=0x0;_0x53a20c(_0x1ec46f,_0x169c39,_0x434e33,_0x392b66,_0x1f44b7,_0x1dd84c,_0x4e59a9);});});function _0x53a20c(_0x19a41f,_0x389c18,_0x199350,_0x480821,_0x3ad8d9,_0x53c9c3,_0x29481e,_0x19acd1){const _0x4d4339=_0x318aaa;let _0x5adb6c=sharpUtil[_0x4d4339(0x26f)](_0x19a41f),_0x1f6a16=exifUtils['getRotateFromTags'](_0x199350);_0x1f6a16?_0x5adb6c=_0x5adb6c['rotate'](_0x1f6a16):_0x5adb6c=_0x5adb6c[_0x4d4339(0x30b)](),_0x5adb6c['resize']({'width':_0x4ebc65,'height':_0x4ebc65,'withoutEnlargement':!![]})['jpeg']()[_0x4d4339(0x231)]({'left':_0x480821,'top':_0x3ad8d9,'width':_0x53c9c3,'height':_0x29481e})[_0x4d4339(0x32c)](_0x7fe1a7,function(_0x4058b5){const _0x37d0bf=_0x4d4339;if(_0x4058b5){_0x389c18&&sharpUtil[_0x37d0bf(0x2a4)](_0x19a41f);if(_0x19acd1)_0x19acd1();else return _0x2c2c6c[_0x37d0bf(0x22b)](0x194)[_0x37d0bf(0x2ec)]();}else{_0x389c18&&sharpUtil[_0x37d0bf(0x2a4)](_0x19a41f);if(_0x1ca09)return _0xf220e1[_0x37d0bf(0x2fc)][_0x37d0bf(0x1fd)][_0x37d0bf(0x2e2)](_0x37d0bf(0x2f9)+_0x7fe1a7+_0x37d0bf(0x263)+_0x48dc39)['run'](),_0x2c2c6c['sendFile'](_0x7fe1a7);else _0x2c2c6c[_0x37d0bf(0x1dc)](_0x7fe1a7),_0x2c2c6c['on'](_0x37d0bf(0x240),()=>{fs['rm'](_0x7fe1a7,_0x2f41e6=>{});});}});}}}}}),router[_0x14f265(0x227)]('/switchFaceId',(_0x27938d,_0x5aed2f,_0x3ac97f)=>{const _0x138948=_0x14f265;let _0x5c12af=_0x27938d[_0x138948(0x2c3)][_0x138948(0x24d)],_0x409343=_0x27938d['body'][_0x138948(0x2f6)],_0x54e9b8=[];if(!_0x5c12af||!_0x409343)return _0x5aed2f[_0x138948(0x1d1)]({'code':0x0,'sucIdList':_0x54e9b8});try{_0x409343=JSON[_0x138948(0x1ce)](_0x409343);for(let _0x4a854a in _0x409343){let _0x23f524=_0x409343[_0x4a854a],_0x1feeea=_0x27938d[_0x138948(0x2fc)][_0x138948(0x1fd)][_0x138948(0x2e2)](_0x138948(0x1f2))[_0x138948(0x2e0)](parseInt(_0x5c12af),parseInt(_0x23f524['face_id']),parseInt(_0x23f524['photo_index_id']));_0x54e9b8[_0x138948(0x2b9)](_0x23f524[_0x138948(0x1e7)]);}return _0x5aed2f[_0x138948(0x1d1)]({'code':0x0,'sucIdList':_0x54e9b8});}catch(_0xaad5e6){return console[_0x138948(0x2e9)](_0xaad5e6),_0x5aed2f[_0x138948(0x1d1)]({'code':0x0,'sucIdList':_0x54e9b8});}}),router[_0x14f265(0x227)](_0x14f265(0x2b1),(_0x40525f,_0x2dc85d,_0x57e820)=>{const _0x10bcbe=_0x14f265;let _0x32ec42=_0x40525f[_0x10bcbe(0x2c3)]['type'],_0x151565={};if(_0x40525f[_0x10bcbe(0x217)][_0x10bcbe(0x1ff)]==0x1){if(!_0x32ec42||_0x32ec42==_0x10bcbe(0x30c)){let _0x422cf4=_0x40525f[_0x10bcbe(0x2fc)][_0x10bcbe(0x1fd)][_0x10bcbe(0x2e2)](_0x10bcbe(0x2b7))[_0x10bcbe(0x1e1)]();_0x151565[_0x10bcbe(0x253)]=_0x422cf4[_0x10bcbe(0x31a)];if(_0x422cf4[_0x10bcbe(0x31a)]<0x1){let _0x54424a=_0x40525f[_0x10bcbe(0x2fc)][_0x10bcbe(0x1fd)][_0x10bcbe(0x2e2)](_0x10bcbe(0x1f4))['get']();_0x151565['faceApiWaitCompareCount']=_0x54424a[_0x10bcbe(0x31a)];}}if(!_0x32ec42||_0x32ec42=='cocossd'){let _0xb9b625=_0x40525f[_0x10bcbe(0x2fc)][_0x10bcbe(0x1fd)][_0x10bcbe(0x2e2)](_0x10bcbe(0x32d))['get']();_0x151565[_0x10bcbe(0x1ee)]=_0xb9b625[_0x10bcbe(0x31a)];}if(!_0x32ec42||_0x32ec42=='similar'){let _0x105b1e=_0x40525f[_0x10bcbe(0x2fc)][_0x10bcbe(0x1fd)][_0x10bcbe(0x2e2)]('SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20phash\x20is\x20null\x20and\x20type=1')[_0x10bcbe(0x1e1)]();_0x151565['similarWaitDealCount']=_0x105b1e[_0x10bcbe(0x31a)];}}let _0x322555=dbConfigTable[_0x10bcbe(0x24f)](_0x40525f[_0x10bcbe(0x2fc)][_0x10bcbe(0x215)],_0x10bcbe(0x30f)),_0x56e021=0x0;return!_0x322555?_0x56e021=0x0:_0x56e021=_0x322555[_0x10bcbe(0x205)],_0x151565['isIndexing']=_0x56e021,_0x2dc85d[_0x10bcbe(0x1d1)]({'code':0x0,'data':_0x151565});}),router[_0x14f265(0x227)](_0x14f265(0x202),(_0x514cc1,_0x51b72c,_0x4babe1)=>{const _0x29d7fc=_0x14f265;if(dbUserTable[_0x29d7fc(0x319)](_0x514cc1,_0x51b72c,_0x29d7fc(0x2c6),'power_change')==!![])try{fs['rm'](config['facesPath'],{'recursive':!![]},_0x53316d=>{const _0x22871e=_0x29d7fc;if(_0x53316d)return console[_0x22871e(0x2e9)](_0x53316d),_0x514cc1[_0x22871e(0x2fc)][_0x22871e(0x1cb)](_0x51b72c,_0x51b72c['__']('cacheDeleteFail')+':'+config[_0x22871e(0x1c4)],_0x22871e(0x307));fs[_0x22871e(0x234)](config[_0x22871e(0x1c4)],_0x278c58=>{const _0x619b04=_0x22871e;if(_0x278c58)return _0x514cc1[_0x619b04(0x2fc)][_0x619b04(0x1cb)](_0x51b72c,_0x51b72c['__'](_0x619b04(0x273)),_0x619b04(0x307));let _0x3f5eaf=_0x514cc1['app'][_0x619b04(0x1fd)]['transaction'](()=>{const _0x12dd91=_0x619b04;return _0x514cc1[_0x12dd91(0x2fc)][_0x12dd91(0x1fd)][_0x12dd91(0x2e2)](_0x12dd91(0x220))[_0x12dd91(0x2e0)](),_0x514cc1[_0x12dd91(0x2fc)][_0x12dd91(0x1fd)][_0x12dd91(0x2e2)](_0x12dd91(0x317))[_0x12dd91(0x2e0)](),_0x514cc1['app']['dbFileIndex'][_0x12dd91(0x2e2)](_0x12dd91(0x2b0))[_0x12dd91(0x2e0)](),process['send']({'type':_0x12dd91(0x219)}),_0x51b72c[_0x12dd91(0x1d1)]({'code':0x0});});_0x3f5eaf();});});}catch(_0x548e11){return _0x514cc1[_0x29d7fc(0x2fc)][_0x29d7fc(0x1cb)](_0x51b72c,_0x51b72c['__'](_0x29d7fc(0x273)),'dialog');}}),router[_0x14f265(0x227)](_0x14f265(0x2e1),(_0x41837a,_0x1f6c9b,_0x17ecd0)=>{const _0x5cfe37=_0x14f265;if(dbUserTable[_0x5cfe37(0x319)](_0x41837a,_0x1f6c9b,_0x5cfe37(0x2c6),_0x5cfe37(0x254))==!![])try{let _0x59da00=_0x41837a['app'][_0x5cfe37(0x1fd)][_0x5cfe37(0x28f)](()=>{const _0x970e71=_0x5cfe37;return _0x41837a['app'][_0x970e71(0x1fd)]['prepare'](_0x970e71(0x1f3))['run'](),_0x41837a[_0x970e71(0x2fc)][_0x970e71(0x1fd)]['prepare'](_0x970e71(0x2bc))[_0x970e71(0x2e0)](),process[_0x970e71(0x29b)]({'type':_0x970e71(0x29a)}),_0x1f6c9b[_0x970e71(0x1d1)]({'code':0x0});});_0x59da00();}catch(_0x2c46db){return _0x41837a[_0x5cfe37(0x2fc)][_0x5cfe37(0x1cb)](_0x1f6c9b,_0x1f6c9b['__'](_0x5cfe37(0x273)),_0x5cfe37(0x307));}}),router[_0x14f265(0x227)](_0x14f265(0x28d),(_0x5a5330,_0xd1fb8,_0x5ad941)=>{const _0x3b7d14=_0x14f265;if(dbUserTable[_0x3b7d14(0x252)](_0x5a5330,_0xd1fb8)!==!![])return;let _0x2710f8=dbConfigTable['findByTitle'](_0x5a5330['app'][_0x3b7d14(0x215)],_0x3b7d14(0x24b));if(!_0x2710f8||_0x2710f8[_0x3b7d14(0x205)]!='1')return _0xd1fb8[_0x3b7d14(0x1d1)]({'code':0x0,'data':[],'enable':![]});let _0xace37e=_0x5a5330[_0x3b7d14(0x2c3)][_0x3b7d14(0x25c)];if(!_0xace37e)_0xace37e=0x0;let _0x352c64=_0x5a5330[_0x3b7d14(0x2c3)][_0x3b7d14(0x31a)];if(!_0x352c64||_0x352c64>0x64)_0x352c64=0x64;let _0x10f91b=[],_0x81f5a7=_0x5a5330[_0x3b7d14(0x2fc)][_0x3b7d14(0x1fd)][_0x3b7d14(0x2e2)](_0x3b7d14(0x2dd))[_0x3b7d14(0x242)](),_0x5a6f3e=_0x5a5330[_0x3b7d14(0x2fc)]['dbFileIndex'][_0x3b7d14(0x2e2)](_0x3b7d14(0x30a)+_0x352c64)[_0x3b7d14(0x242)]();for(let _0xb42cf2 in _0x5a6f3e){let _0x610357=_0x5a6f3e[_0xb42cf2],_0x17f95a=_0x5a5330[_0x3b7d14(0x2fc)][_0x3b7d14(0x1fd)][_0x3b7d14(0x2e2)](_0x3b7d14(0x1cf)+_0x610357[_0x3b7d14(0x291)])[_0x3b7d14(0x1e1)](),_0x3691e2=_0x5a5330[_0x3b7d14(0x2fc)][_0x3b7d14(0x1fd)][_0x3b7d14(0x2e2)](_0x3b7d14(0x1fe)+_0x610357['index_id'])[_0x3b7d14(0x242)]();_0x5a6f3e[_0xb42cf2][_0x3b7d14(0x248)]=_0x17f95a,_0x5a6f3e[_0xb42cf2][_0x3b7d14(0x22f)]=[_0x17f95a],_0x5a6f3e[_0xb42cf2][_0x3b7d14(0x22f)]['push'](..._0x3691e2),_0x5a6f3e[_0xb42cf2][_0x3b7d14(0x22f)][_0x3b7d14(0x2da)]>0x1?_0x10f91b[_0x3b7d14(0x2b9)](_0x5a6f3e[_0xb42cf2]):_0x5a5330[_0x3b7d14(0x2fc)][_0x3b7d14(0x1fd)][_0x3b7d14(0x2e2)]('DELETE\x20FROM\x20photo_phash_similar\x20where\x20index_id=?')[_0x3b7d14(0x2e0)](_0x610357[_0x3b7d14(0x291)]);}return _0xd1fb8[_0x3b7d14(0x1d1)]({'code':0x0,'data':_0x10f91b,'enable':!![],'waitDealCount':_0x81f5a7[_0x3b7d14(0x2da)]});}),router[_0x14f265(0x227)](_0x14f265(0x260),(_0x9d4322,_0x50e758,_0x1450e7)=>{const _0x4b6179=_0x14f265;if(dbUserTable['isAdmin'](_0x9d4322,_0x50e758)!==!![])return;let _0x1452b3=_0x9d4322[_0x4b6179(0x2c3)][_0x4b6179(0x287)];for(let _0x2d91d9 in _0x1452b3){let _0x58a73e=_0x9d4322[_0x4b6179(0x2fc)][_0x4b6179(0x1fd)][_0x4b6179(0x2e2)](_0x4b6179(0x23f)+_0x1452b3[_0x2d91d9]['index_id'])[_0x4b6179(0x242)]();for(let _0x4f282c in _0x58a73e){if(!_0x1452b3[_0x2d91d9][_0x4b6179(0x2c7)]['includes'](parseInt(_0x58a73e[_0x4f282c][_0x4b6179(0x2df)]))){let _0x382b18=new Date()[_0x4b6179(0x1da)]();_0x9d4322[_0x4b6179(0x2fc)][_0x4b6179(0x1fd)][_0x4b6179(0x2e2)](_0x4b6179(0x266)+dbFileIndexTable[_0x4b6179(0x2d7)]+_0x4b6179(0x1c7)+_0x382b18+_0x4b6179(0x2f7)+_0x58a73e[_0x4f282c][_0x4b6179(0x2df)])[_0x4b6179(0x2e0)]();}}if(!_0x1452b3[_0x2d91d9][_0x4b6179(0x2c7)]['includes'](parseInt(_0x1452b3[_0x2d91d9][_0x4b6179(0x291)]))){let _0x404a49=new Date()[_0x4b6179(0x1da)]();_0x9d4322['app'][_0x4b6179(0x1fd)][_0x4b6179(0x2e2)]('UPDATE\x20'+dbFileIndexTable['INDEX_TABLE_NAME_PHOTO']+'\x20SET\x20in_trash=1,in_trash_time='+_0x404a49+_0x4b6179(0x2f7)+_0x1452b3[_0x2d91d9][_0x4b6179(0x291)])['run']();}_0x9d4322[_0x4b6179(0x2fc)][_0x4b6179(0x1fd)][_0x4b6179(0x2e2)]('delete\x20from\x20photo_phash_similar\x20where\x20index_id='+_0x1452b3[_0x2d91d9][_0x4b6179(0x291)])[_0x4b6179(0x2e0)]();}return _0x50e758['json']({'code':0x0});}),router['post'](_0x14f265(0x226),(_0x2ec718,_0x43669f,_0xe039e3)=>{const _0x335423=_0x14f265;if(dbUserTable[_0x335423(0x319)](_0x2ec718,_0x43669f,_0x335423(0x2c6),_0x335423(0x254),'')==!![]){let _0x314cf2=_0x2ec718['app'][_0x335423(0x1fd)][_0x335423(0x2e2)]('SELECT\x20*\x20FROM\x20file_index_photo\x20WHERE\x20in_trash=1\x20AND\x20is_file=1\x20AND\x20raw_filename\x20is\x20not\x20null\x20AND\x20raw_filename!=\x27\x27\x20AND\x20type=1')[_0x335423(0x242)]();for(let _0x3a54ad of _0x314cf2){_0x2ec718[_0x335423(0x2fc)][_0x335423(0x1fd)]['prepare']('UPDATE\x20file_index_photo\x20SET\x20is_show=0\x20WHERE\x20path=?\x20AND\x20filename\x20=?')['run'](_0x3a54ad[_0x335423(0x2e3)],_0x3a54ad[_0x335423(0x1f9)]);}return _0x2ec718[_0x335423(0x2fc)]['dbFileIndex']['prepare']('UPDATE\x20'+dbFileIndexTable[_0x335423(0x2d7)]+'\x20SET\x20in_trash=0\x20WHERE\x20in_trash=1')[_0x335423(0x2e0)](),_0x43669f[_0x335423(0x1d1)]({'code':0x0});}}),router[_0x14f265(0x227)](_0x14f265(0x257),(_0x41e092,_0x32389c,_0x3aef97)=>{const _0x1c304a=_0x14f265;let _0x4e6ad4=_0x41e092[_0x1c304a(0x2c3)][_0x1c304a(0x31d)],_0x57099a=dbFileIndexTable['getAllByWhere'](_0x41e092[_0x1c304a(0x2fc)]['dbFileIndex'],_0x1c304a(0x31f),_0x1c304a(0x224),dbFileIndexTable[_0x1c304a(0x2d7)]),_0x1ece97=dbFileIndexTable[_0x1c304a(0x2d7)];console[_0x1c304a(0x2e9)](_0x1c304a(0x21c)+_0x57099a[_0x1c304a(0x2da)]);function _0x4fc30f(_0x59daad,_0x545c7e){const _0x2aaf6b=_0x1c304a;dbFileOperationRecord[_0x2aaf6b(0x278)](_0x41e092['app']['dbOther'],{'username':_0x41e092['currentUser']['username'],'targetPath':_0x59daad,'level':dbFileOperationRecord[_0x2aaf6b(0x2af)],'type':dbFileOperationRecord[_0x2aaf6b(0x269)],'state':_0x545c7e?dbFileOperationRecord[_0x2aaf6b(0x298)]:dbFileOperationRecord['STATE_FAIL']});}function _0x534af2(_0x11d059){const _0x3205e6=_0x1c304a;if(_0x11d059[_0x3205e6(0x279)]==0x1&&_0x11d059[_0x3205e6(0x2ac)]==0x1){let _0xc1911c=path[_0x3205e6(0x20e)](_0x11d059['path'],_0x11d059[_0x3205e6(0x1c8)][_0x3205e6(0x308)](_0x3205e6(0x1d7),'')+'.HEIC');_0x11d059[_0x3205e6(0x1c8)][_0x3205e6(0x301)](_0x3205e6(0x302))&&(_0xc1911c=path['join'](_0x11d059['path'],_0x11d059['filename'][_0x3205e6(0x308)](_0x3205e6(0x302),'')+'.JPG')),fs[_0x3205e6(0x28c)](_0xc1911c)&&(console[_0x3205e6(0x2e9)](_0x3205e6(0x1d0),_0xc1911c),_0x2ed026(_0x11d059,_0xc1911c,![]));}}function _0x2ed026(_0x349a98,_0x5eaa85,_0x1649de){const _0xef306c=_0x1c304a;_0x4e6ad4==0x1?(process[_0xef306c(0x29b)]({'type':'shell','shellType':_0xef306c(0x1d8),'path':_0x5eaa85}),_0x4fc30f(_0x5eaa85,!![])):fs['rm'](_0x5eaa85,{'recursive':!![]},_0x5a61ed=>{_0x5a61ed?_0x4fc30f(_0x5eaa85,![]):_0x4fc30f(_0x5eaa85,!![]);}),_0x1649de&&_0x534af2(_0x349a98);}function _0xdb3e08(_0x2359bb){const _0x2605d7=_0x1c304a;dbFileIndexTable[_0x2605d7(0x237)](_0x41e092[_0x2605d7(0x2fc)]['dbFileIndex'],_0x2359bb['id'],_0x1ece97);}for(let _0x2695b6 in _0x57099a){let _0x40132d=_0x57099a[_0x2695b6];if(_0x40132d){if(dbUserTable[_0x1c304a(0x319)](_0x41e092,_0x32389c,'photo','power_delete',_0x40132d[_0x1c304a(0x2e3)])==!![]){let _0x120059=path['join'](_0x40132d['path'],path[_0x1c304a(0x1d2)],_0x40132d[_0x1c304a(0x1c8)]);_0xdb3e08(_0x40132d),_0x2ed026(_0x40132d,_0x120059,!![]);}}}return _0x32389c['json']({'code':0x0});}),router[_0x14f265(0x227)](_0x14f265(0x28a),(_0x565b50,_0x5197ce,_0xbe497b)=>{const _0x5a4686=_0x14f265;let _0x387d8c=_0x565b50['body'][_0x5a4686(0x259)],_0x506229=_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x311)],_0x6181cd=_0x565b50['body']['pathList'],_0x3e59bf=_0x565b50[_0x5a4686(0x2c3)]['shareUidList'],_0x5b0adb=_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x312)],_0x2e3fda=_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x1d3)];if(_0x2e3fda=='GET'){let _0x5a8ffe=_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x289)]||0x0,_0x526424=_0x565b50[_0x5a4686(0x2c3)]['count']||0x32,_0x3d0d63=_0x565b50[_0x5a4686(0x2c3)]['search']||'',_0x3a3ed1=_0x565b50['body']['orderField']||_0x5a4686(0x1f0),_0x45edd3=_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x31c)]||_0x5a4686(0x2dc);if(![_0x5a4686(0x1f0),_0x5a4686(0x259)][_0x5a4686(0x262)](_0x3a3ed1))return console[_0x5a4686(0x2e9)](_0x5a4686(0x1fb),_0x3a3ed1),[];let _0x2a4ce8=[],_0x142501=[],_0x3ffbad=_0x5a4686(0x235);_0x565b50[_0x5a4686(0x217)]['is_admin']==0x1?_0x3d0d63&&(_0x3ffbad+=_0x5a4686(0x2a7),_0x142501[_0x5a4686(0x2b9)]('%'+_0x3d0d63+'%')):(_0x3ffbad='SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20share_for_subuser=1',_0x3d0d63&&(_0x3ffbad+=_0x5a4686(0x325),_0x142501['push']('%'+_0x3d0d63+'%')));_0x3ffbad+='\x20ORDER\x20BY\x20'+_0x3a3ed1+'\x20'+_0x45edd3+_0x5a4686(0x2a3),_0x142501['push'](_0x526424),_0x142501[_0x5a4686(0x2b9)](_0x5a8ffe),_0x2a4ce8=_0x565b50[_0x5a4686(0x2fc)]['dbFileIndex'][_0x5a4686(0x2e2)](_0x3ffbad)[_0x5a4686(0x242)](_0x142501);if(_0x2a4ce8[_0x5a4686(0x2da)]<0x1)return _0x5197ce[_0x5a4686(0x1d1)]({'code':0x0,'data':[]});for(let _0x188cb0 in _0x2a4ce8){let _0x5e208f=_0x2a4ce8[_0x188cb0];try{let _0x17cd12=JSON['parse'](_0x5e208f[_0x5a4686(0x2c9)]),_0x1fd65f=[];for(let _0x2a8368 of _0x17cd12){let _0x5bdfd1=dbUserTable[_0x5a4686(0x323)](_0x565b50[_0x5a4686(0x2fc)]['dbOther'],_0x2a8368,_0x5a4686(0x1f1));_0x1fd65f[_0x5a4686(0x2b9)](_0x5bdfd1);}_0x2a4ce8[_0x188cb0][_0x5a4686(0x324)]=_0x1fd65f;}catch(_0x479a2f){console[_0x5a4686(0x2e9)](_0x479a2f);}_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x31a)]=0x4,_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x1c3)]=[],_0x565b50['body'][_0x5a4686(0x1e8)]=0x0,_0x565b50['body'][_0x5a4686(0x249)]=_0x5a4686(0x2d1),_0x565b50['body'][_0x5a4686(0x1cc)]=_0x5a4686(0x2dc),_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x23b)]=0x1,_0x565b50[_0x5a4686(0x2c3)][_0x5a4686(0x2bb)]=0x9184e729fff,_0x565b50['body'][_0x5a4686(0x1d8)]=0x0,_0x565b50['body'][_0x5a4686(0x311)]=_0x2a4ce8[_0x188cb0]['id'],_0x2a4ce8[_0x188cb0][_0x5a4686(0x297)]=photoApiUtil[_0x5a4686(0x232)](_0x565b50,_0x5197ce);}return _0x5197ce[_0x5a4686(0x1d1)]({'code':0x0,'data':_0x2a4ce8});}else{if(_0x565b50[_0x5a4686(0x217)][_0x5a4686(0x1ff)]!=0x1)return _0x565b50[_0x5a4686(0x2fc)][_0x5a4686(0x1cb)](_0x5197ce,_0x5197ce['__'](_0x5a4686(0x2d9)));if(_0x2e3fda==_0x5a4686(0x310)||_0x2e3fda==_0x5a4686(0x2f5)){if(!_0x6181cd||!_0x6181cd instanceof Array||_0x6181cd[_0x5a4686(0x2da)]<0x1)return _0x565b50['app'][_0x5a4686(0x1cb)](_0x5197ce,_0x5197ce['__']('operationFail'));if(_0x5b0adb){if(_0x3e59bf!=null&&!_0x3e59bf instanceof Array)return _0x565b50['app'][_0x5a4686(0x1cb)](_0x5197ce,_0x5197ce['__'](_0x5a4686(0x273)));}if(sqliteUtil[_0x5a4686(0x2bd)](JSON[_0x5a4686(0x2c2)](_0x6181cd))==!![])return _0x565b50[_0x5a4686(0x2fc)][_0x5a4686(0x1cb)](_0x5197ce,_0x5a4686(0x2c8));}if(_0x2e3fda==_0x5a4686(0x2f5)&&_0x506229)_0x565b50[_0x5a4686(0x2fc)][_0x5a4686(0x1fd)]['prepare']('UPDATE\x20photo_library\x20SET\x20title=?,path_list=?,share_for_subuser=?,share_uid=?\x20WHERE\x20id=?')[_0x5a4686(0x2e0)](_0x387d8c,JSON['stringify'](_0x6181cd),_0x5b0adb,JSON[_0x5a4686(0x2c2)](_0x3e59bf),_0x506229);else{if(_0x2e3fda==_0x5a4686(0x326)&&_0x506229)_0x565b50[_0x5a4686(0x2fc)][_0x5a4686(0x1fd)][_0x5a4686(0x2e2)](_0x5a4686(0x21b))[_0x5a4686(0x2e0)](_0x506229);else{if(_0x2e3fda==_0x5a4686(0x310))_0x565b50[_0x5a4686(0x2fc)][_0x5a4686(0x1fd)][_0x5a4686(0x2e2)]('REPLACE\x20INTO\x20photo_library(title,path_list,share_for_subuser,share_uid,user_id)\x20VALUES(\x20?,?,?,?,?)')['run'](_0x387d8c,JSON[_0x5a4686(0x2c2)](_0x6181cd),_0x5b0adb,JSON[_0x5a4686(0x2c2)](_0x3e59bf),_0x565b50[_0x5a4686(0x217)]['id']);else return _0x565b50[_0x5a4686(0x2fc)][_0x5a4686(0x1cb)](_0x5197ce,_0x5197ce['__'](_0x5a4686(0x2d9)));}}return _0x5197ce[_0x5a4686(0x1d1)]({'code':0x0});}}),module['exports']=router;