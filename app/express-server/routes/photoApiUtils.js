const _0x1e76d9=_0x1c17;(function(_0x564c9d,_0xc614ea){const _0x482d8b=_0x1c17,_0x2c00ea=_0x564c9d();while(!![]){try{const _0x27abb3=-parseInt(_0x482d8b(0x9f))/0x1*(-parseInt(_0x482d8b(0xa4))/0x2)+parseInt(_0x482d8b(0x80))/0x3+parseInt(_0x482d8b(0x9a))/0x4+parseInt(_0x482d8b(0x9b))/0x5+-parseInt(_0x482d8b(0x83))/0x6*(parseInt(_0x482d8b(0x79))/0x7)+parseInt(_0x482d8b(0xb6))/0x8+-parseInt(_0x482d8b(0x9d))/0x9;if(_0x27abb3===_0xc614ea)break;else _0x2c00ea['push'](_0x2c00ea['shift']());}catch(_0x1ffd1e){_0x2c00ea['push'](_0x2c00ea['shift']());}}}(_0x336a,0x465b0));let photoApiUtil={};const dbFileIndexTable=require(_0x1e76d9(0x94)),dbSourceFolderTable=require('../../db/dbSourceFolderTable');function _0x336a(){const _0xe459ad=['geohash','\x20AND\x20is_show=1','aiClassId','\x20AND\x20is_livephoto=1','../../db/dbFileIndexTable','checkOrderParams','photo','\x20AND\x20geohash\x20LIKE\x20?\x20','\x20LIMIT\x20?','faceId','1907156iLXMLM','2012565OPDYOt','parse','14864067tdeilp','dbOther','1cjCvZj','../../db/dbAlbumTable','\x20GROUP\x20BY\x20f.id','path_list','asc','886434LoWjrE','rawImageIndex','getAlbumWhereStr','searchStr','log','excludeIds','app','INDEX_TABLE_NAME_PHOTO','excludePathPhoto','\x20AND\x20','../../db/dbUserTable','isNumber','\x20AND\x20in_trash=1','length','push','excludeIdsJson','albumId','livephotoIndex','4430992JGQsmC','power_get','getAllByWhereAndField','fileType','Params\x20error\x20:\x20sortType','\x20f.id,path,is_livephoto,is_raw,raw_filename,check_time,original_time,in_trash_time,original_date,filename,ext,type,f.width,f.height,duration,size,latitude,longitude,geohash,mode,tiny_path','whereStr','\x20>\x200','getRawImageIndex','dbFileIndex','<=?\x20AND\x20','\x20ORDER\x20BY\x20','Params\x20error\x20:\x20albumId','\x20AND\x20(type=?\x20\x20and\x20is_livephoto!=1)','getLivePhotoIndex','getAllByWhereAndFieldFromFaceIndex','timestamp','paramsList','ordinaryAlbumId','getUserPathWhere','35TGmYlk','Params\x20error\x20:\x20timestamp\x20/\x20timeType','sourceFolderList','Params\x20error\x20:\x20count','arrayInCheck','get','prepare','1705353UqyQvO','trash','getExcludePathWhereStr','606126XWMeQJ','sortType','\x20AND\x20in_trash=0','desc','\x20AND\x20f.id\x20NOT\x20IN\x20(','SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20id=?','raw_filename','timeType','getAllByWhereAndFieldFromAiClassesToIndex','doUserCanGet','sortField','filename','body'];_0x336a=function(){return _0xe459ad;};return _0x336a();}let checkUtil=require('../utils/checkUtil');const dbUserTable=require(_0x1e76d9(0xae)),dbAlbumTable=require(_0x1e76d9(0xa0));function _0x1c17(_0x19648d,_0x2e2413){const _0x336a9d=_0x336a();return _0x1c17=function(_0x1c176f,_0x418675){_0x1c176f=_0x1c176f-0x69;let _0x46bc0a=_0x336a9d[_0x1c176f];return _0x46bc0a;},_0x1c17(_0x19648d,_0x2e2413);}photoApiUtil['getPhotoByParams']=function(_0x49e2f4,_0x2ac982){const _0xd8579a=_0x1e76d9;if(dbUserTable[_0xd8579a(0x8c)](_0x49e2f4,_0x2ac982,_0xd8579a(0x96),_0xd8579a(0xb7),'',!![])!=!![])return[];let _0x143575=_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x7b)],_0x2e4cf5=dbUserTable[_0xd8579a(0x78)](_0x49e2f4,'photo','power_get',!![],_0x143575),_0x10f186=_0xd8579a(0x6a),_0x85f19f=_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x75)],_0x3f2b9c=_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x8a)],_0x11ad1a=_0x49e2f4[_0xd8579a(0x8f)]['count'],_0x1a440e=_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0xb9)],_0x2e5802=_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x81)],_0xda07c9=_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x8d)],_0x46effd=_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x84)],_0x2de479=_0x49e2f4['body'][_0xd8579a(0x90)],_0x2678af=_0x49e2f4['body'][_0xd8579a(0xa7)],_0x57fdbc=_0x49e2f4[_0xd8579a(0x8f)]['libraryId'];if(dbFileIndexTable[_0xd8579a(0x95)](_0x49e2f4,_0x2ac982,_0xda07c9,_0x46effd)!==!![])return[];if(!checkUtil[_0xd8579a(0x7d)]([_0xd8579a(0xa3),_0xd8579a(0x86)],_0x46effd))return console['log'](_0xd8579a(0x69)),[];if(!checkUtil[_0xd8579a(0xaf)](_0x85f19f)||!checkUtil[_0xd8579a(0xaf)](_0x3f2b9c))return console[_0xd8579a(0xa8)](_0xd8579a(0x7a)),[];let _0x2b5f8d=_0x49e2f4['body'][_0xd8579a(0xa9)];if(!_0x3f2b9c||!_0x85f19f)return[];let _0x384eb1='',_0x14caf1=[];_0x3f2b9c==0x1?(_0x384eb1+='\x20'+_0xda07c9+_0xd8579a(0x6f)+_0xda07c9+_0xd8579a(0x6c),_0x14caf1['push'](_0x85f19f)):(_0x384eb1+='\x20'+_0xda07c9+'>=?',_0x14caf1[_0xd8579a(0xb2)](_0x85f19f));let _0x46af7a=_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0xb3)];if(_0x46af7a)try{_0x2b5f8d=JSON['parse'](_0x46af7a);}catch(_0x57a3d2){console[_0xd8579a(0xa8)](_0x57a3d2);}if(_0x2b5f8d&&_0x2b5f8d['length']>0x0){_0x384eb1+=_0xd8579a(0x87);for(let _0x535942=0x0;_0x535942<_0x2b5f8d[_0xd8579a(0xb1)];_0x535942++){_0x384eb1+=_0x2b5f8d[_0x535942],_0x535942!=_0x2b5f8d[_0xd8579a(0xb1)]-0x1&&(_0x384eb1+=',');}_0x384eb1+=')';}_0x2de479&&(_0x384eb1+=_0xd8579a(0x97),_0x14caf1[_0xd8579a(0xb2)](_0x2de479+'%'));let _0xe06c4b=dbSourceFolderTable['getExcludePathWhereStr'](_0x49e2f4[_0xd8579a(0xaa)]['dbOther'],'path',_0xd8579a(0xac));_0xe06c4b&&(_0x384eb1+=_0xd8579a(0xad)+_0xe06c4b);let _0x55c44e=dbSourceFolderTable[_0xd8579a(0x82)](_0x49e2f4[_0xd8579a(0xaa)][_0xd8579a(0x9e)],_0xd8579a(0x8e),'excludeFilenamePhoto');_0x55c44e&&(_0x384eb1+=_0xd8579a(0xad)+_0x55c44e);if(_0x1a440e==0x0||!_0x1a440e)_0x384eb1+='\x20AND\x20(type=1\x20or\x20type=2)';else{if(_0x1a440e==0x1||_0x1a440e==0x2){if(!checkUtil[_0xd8579a(0xaf)](_0x1a440e))return console[_0xd8579a(0xa8)]('Params\x20error\x20:\x20fileType'),[];_0x384eb1+=_0xd8579a(0x72),_0x14caf1[_0xd8579a(0xb2)](_0x1a440e);}else _0x1a440e==0x3&&(_0x384eb1+=_0xd8579a(0x93));}_0x2678af&&(_0x384eb1+='\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)',_0x14caf1[_0xd8579a(0xb2)]('%'+_0x2678af+'%'),_0x14caf1[_0xd8579a(0xb2)]('%'+_0x2678af+'%'));!_0x2e5802||_0x2e5802==0x0?(_0x384eb1+=_0xd8579a(0x85),_0x384eb1+=_0xd8579a(0x91)):_0x384eb1+=_0xd8579a(0xb0);if(_0x57fdbc){let _0x4bc7e1=_0x49e2f4[_0xd8579a(0xaa)][_0xd8579a(0x6e)][_0xd8579a(0x7f)](_0xd8579a(0x88))[_0xd8579a(0x7e)](_0x57fdbc);if(_0x4bc7e1)try{let _0x607d32=JSON[_0xd8579a(0x9c)](_0x4bc7e1[_0xd8579a(0xa2)]),_0x21df84=dbUserTable['getPathWhere'](!![],_0x607d32);_0x384eb1+=_0x21df84['whereStr'],_0x14caf1[_0xd8579a(0xb2)](..._0x21df84['paramsList']);}catch(_0x188f43){console[_0xd8579a(0xa8)](_0x188f43);}}if(_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0xb4)]){if(!checkUtil['isNumber'](_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0xb4)]))return console[_0xd8579a(0xa8)](_0xd8579a(0x71)),[];let _0x444534=dbAlbumTable[_0xd8579a(0xa6)](_0x49e2f4[_0xd8579a(0xaa)][_0xd8579a(0x9e)],_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0xb4)]);_0x444534&&(_0x384eb1+=_0xd8579a(0xad)+_0x444534);}_0x384eb1+=_0x2e4cf5[_0xd8579a(0x6b)],_0x14caf1[_0xd8579a(0xb2)](..._0x2e4cf5[_0xd8579a(0x76)]),_0x384eb1+='\x20\x20AND\x20is_file=1\x20\x20';(_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x92)]||_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x99)])&&(_0x384eb1+=_0xd8579a(0xa1));_0x384eb1+=_0xd8579a(0x70)+_0xda07c9+'\x20'+_0x46effd;!_0x11ad1a&&(_0x11ad1a=0x32);if(!checkUtil[_0xd8579a(0xaf)](_0x11ad1a))return console['log'](_0xd8579a(0x7c)),[];_0x384eb1+=_0xd8579a(0x98),_0x14caf1['push'](_0x11ad1a);let _0x5356f6=[];if(_0x49e2f4[_0xd8579a(0x8f)]['ordinaryAlbumId'])_0x5356f6=dbFileIndexTable['getAllByWhereAndFieldFromOrdinaryAlbum'](_0x49e2f4[_0xd8579a(0xaa)][_0xd8579a(0x6e)],_0x384eb1,_0x10f186,[parseInt(_0x49e2f4['body'][_0xd8579a(0x77)]),..._0x14caf1]);else{if(_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x92)])_0x5356f6=dbFileIndexTable[_0xd8579a(0x8b)](_0x49e2f4[_0xd8579a(0xaa)]['dbFileIndex'],_0x49e2f4['body'][_0xd8579a(0x92)],_0x384eb1,_0x10f186,_0x14caf1);else _0x49e2f4['body'][_0xd8579a(0x99)]?_0x5356f6=dbFileIndexTable[_0xd8579a(0x74)](_0x49e2f4[_0xd8579a(0xaa)][_0xd8579a(0x6e)],_0x49e2f4[_0xd8579a(0x8f)][_0xd8579a(0x99)],_0x384eb1,_0x10f186,_0x14caf1):_0x5356f6=dbFileIndexTable[_0xd8579a(0xb8)](_0x49e2f4[_0xd8579a(0xaa)][_0xd8579a(0x6e)],_0x384eb1,_0x10f186,dbFileIndexTable[_0xd8579a(0xab)],_0x14caf1);}if(_0x5356f6&&_0x5356f6['length']>0x0)for(let _0x5de188 in _0x5356f6){_0x5356f6[_0x5de188]['is_livephoto']==0x1&&(_0x5356f6[_0x5de188][_0xd8579a(0xb5)]=dbFileIndexTable[_0xd8579a(0x73)](_0x49e2f4[_0xd8579a(0xaa)]['dbFileIndex'],_0x5356f6[_0x5de188],_0x10f186));if(_0x5356f6[_0x5de188]['is_raw']==0x0&&_0x5356f6[_0x5de188][_0xd8579a(0x89)]!=null&&_0x5356f6[_0x5de188]['raw_filename']!=''){let _0x2f3579=dbFileIndexTable[_0xd8579a(0x6d)](_0x49e2f4['app'][_0xd8579a(0x6e)],_0x5356f6[_0x5de188],_0x10f186);_0x2f3579&&(_0x5356f6[_0x5de188][_0xd8579a(0xa5)]=_0x2f3579);}}return _0x5356f6;},module['exports']=photoApiUtil;