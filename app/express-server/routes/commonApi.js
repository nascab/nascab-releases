const _0x1378a8=_0x9a2c;(function(_0x4e303e,_0xba014e){const _0x3d4c6c=_0x9a2c,_0x569349=_0x4e303e();while(!![]){try{const _0x590122=parseInt(_0x3d4c6c(0x1f7))/0x1*(-parseInt(_0x3d4c6c(0x1e4))/0x2)+parseInt(_0x3d4c6c(0x212))/0x3+parseInt(_0x3d4c6c(0x1dc))/0x4*(parseInt(_0x3d4c6c(0x238))/0x5)+parseInt(_0x3d4c6c(0x24c))/0x6+parseInt(_0x3d4c6c(0x16f))/0x7*(parseInt(_0x3d4c6c(0x171))/0x8)+parseInt(_0x3d4c6c(0x224))/0x9*(-parseInt(_0x3d4c6c(0x1df))/0xa)+-parseInt(_0x3d4c6c(0x1d6))/0xb*(parseInt(_0x3d4c6c(0x23c))/0xc);if(_0x590122===_0xba014e)break;else _0x569349['push'](_0x569349['shift']());}catch(_0x11333e){_0x569349['push'](_0x569349['shift']());}}}(_0x4dfd,0x27f66));var express=require('express'),router=express[_0x1378a8(0x162)]();let config=require(_0x1378a8(0x153)),dbFileIndexTable=require(_0x1378a8(0x1a3)),dbConfigTable=require('../../db/dbConfigTable'),dbSourceTable=require(_0x1378a8(0x180)),dbNoticeCenterTable=require(_0x1378a8(0x252)),netUtils=require('../utils/netUtils');const dbUserTable=require('../../db/dbUserTable'),dbBackupTask=require(_0x1378a8(0x199)),OS=require('os');let path=require(_0x1378a8(0x1ee)),fs=require('fs'),fileUtil=require('../utils/fileUtils');var package=require(_0x1378a8(0x1a2));const sqliteUtil=require(_0x1378a8(0x206)),sharp=require(_0x1378a8(0x15b)),si=require(_0x1378a8(0x18d));let tls=require(_0x1378a8(0x188));function testCertAndKeyMatch(_0xc41dc8,_0x3342cc){const _0x2c092d=_0x1378a8;try{return tls[_0x2c092d(0x1f5)]({'cert':_0xc41dc8,'key':_0x3342cc}),!![];}catch(_0x53f182){return![];}}function _0x4dfd(){const _0x4bf73c=['excludeFilenameMovie','defaultWebDavPortHttps','mkdir','language','isAdmin','Relaunch','path','notSupport','tmdbProxyUrl','region','webDavPortHttps','BACKUP','stat','createSecureContext','run','258238azeyki','movieHomeShowMyMedia','findByTitle','fast','/getLanguage','webDavUseApiCert','INDEX_TABLE_NAME_MOVIE','getGlobalInfo','folderNotExist','clearTable','err','FTPPort','ip\x20not\x20allow','returnFileError','/saveConfigMusic','../utils/sqliteUtil','api','value','/updateNewVersion','toLowerCase','cachePath','\x20title\x20in\x20(\x27apiServer\x27,\x27apiServerHttps\x27,\x27webDavServer\x27,\x27FTPServer\x27,\x27globalIpList\x27)','database','app','globalIndexInfo','subtitle','aiClassesEnable','438720wXKcvG','customLoginImage','httpsCertCannotSet','httpsCert','startSimilarPhotoWork','setting.portInvalid','join','constants','movie','/clearCache','W_OK','getUnReadCount','imgFolder','DELETE\x20FROM\x20bg_task\x20WHERE\x20id=?','/vaccumDb','serverRootPath','webDavPort','transCodeCoderNameH264','9rWPMBi','startClassesAiWork','send','access','ipDetection','/getServerState','notSupportForAutoUpdate','/saveConfig','deleteByTitle','aiFaceEnable','isWinDisk','error\x20keys','is_admin','photoPreviewType','/setLanguage','tmdbProxyEnable','currentUser','networkInterfaces','subtitleSize','json','5oUAOVw','/saveServerRootPath','task_id','autoHardAccDecode','96mBtPyI','medium','music-TitleType','moviePreferLanguage','startUpdate','platform','type\x20is\x20invalid','upload','toFile','parse','test','defaultApiPort','maxThreadCountIs','power_get','ipBan','shell','1811928iLmOkE','\x27,\x27globalDiskInfo\x27)','music','transcodeSpeed','getAllByWhere','defaultWebDavPort','../../db/dbNoticeCenterTable','serverType','versionInfo','audio','INDEX_TABLE_NAME_MUSIC','../../myConfig/config','/relaunch','/openInSystem','movieHomeShowLibrary','cacheParentPath','photoPreviewSize','version','/changeCachePath','sharp','excludeFilenamePhoto','existsSync','INDEX_TABLE_NAME_PHOTO','crf','INDEX_TABLE_NAME_BOOK','push','Router','serverRootError','openType','excludePathMovie','localhost','customShareUrl','/getSystemInfomation','copy_size','movieTmdbApiKey','mem','startsWith','getUpdateInfo','apiPortHttps','755377eAGptC','showMenuArr','16vWVMmQ','/getSystemInfo','ipMode','webDavHttpsKey','excludePathFolderBrowser','includes','/saveConfigMovie','customLoginTitle','moviePlaylongPressRate','darwin','httpsCertError','totalmem','exports','apiPort','stringify','../../db/dbSourceFolderTable','file','webDavHttpsCert','dbFileIndex','threadCount','cachePathInvalid','transCodeReadRate','START_PRE_GEN_SUBTITLE','tls','all','filename','custom','length','systeminformation','musicTitleType','dialog','/saveConfigPhoto','customLogoImage','aiSimilarPhotoEnable','cache','post',':http','CRF:\x201-51','-----',':https','../../db/dbBackupTask','subtitlePreGen','exec','refreshHomePage','getClientIp','hostname','transCodeParams-CoderNameHevc','bios','autoLaunch','../../../package.json','../../db/dbFileIndexTable','twoStepLogin','dbOther','httpsKey','task_name','id3tag','autoScanSource','tokenKeepHour','imgFolderUsable','userDataFolder','trim','refreshIpList','getDiskInfo','ddnsIpv6Address','create','operationFail','body','photo','prepare','unreadMsgCount','returnErrMsg','appRootPath','setting','/getBgTask','movieTmdbApiUrl','reloadHomePage','movieDatabaseType','customHomeBgImage','graphics','defaultThreadCount','log','download','wifiNetworks','win32','cpus','getById','autoShowWindow','SELECT\x20*\x20FROM\x20bg_task\x20WHERE\x20task_state=?\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?','\x20status=\x27running\x27\x20or\x20status=\x27waiting\x27','transCodeParams-readrate','count','/deleteBgTask','system','vacuum','wal_checkpoint(RESTART)','pragma','getAllIndexInfo','movieShowMatchName','getAllRecordByWhere','toUpperCase','usb','339922FZcNYN','port:\x20256-65500','transCodeCoderNameHevc','databaseFolder','\x27,\x27','movieHomeShowHistory','223324dkaAat','aiFaceMinPhotoCount','getIpList','507410vxeBYB','autoLoginClient','doUserCanGet','cacheImageInfo','book','2neQdsJ','battery','diskLayout','catch'];_0x4dfd=function(){return _0x4bf73c;};return _0x4dfd();}router[_0x1378a8(0x194)]('/refreshHomePage',(_0x4ebb56,_0x4c1687,_0x5d91d3)=>{const _0x15ca7b=_0x1378a8;let _0x2c0ee3=netUtils['getClientIpWithOutXforwarded'](_0x4ebb56);console[_0x15ca7b(0x1c1)](_0x15ca7b(0x19c),_0x2c0ee3);if(_0x2c0ee3!=_0x15ca7b(0x166))return'ip\x20not\x20allow';return process[_0x15ca7b(0x226)]({'type':_0x15ca7b(0x1bc)}),_0x4c1687[_0x15ca7b(0x237)]({'code':0x0});}),router[_0x1378a8(0x194)]('/getVersionInfo',(_0x1c344e,_0x4aeca5,_0x6e93f6)=>{const _0x447392=_0x1378a8;let _0x4a7be7=package[_0x447392(0x159)],_0x2ccc60=dbConfigTable[_0x447392(0x1f9)](_0x1c344e[_0x447392(0x20e)][_0x447392(0x1a5)],_0x447392(0x254)),_0x5cd812=dbConfigTable[_0x447392(0x1f9)](_0x1c344e['app'][_0x447392(0x1a5)],_0x447392(0x170));process[_0x447392(0x226)]({'type':_0x447392(0x1fe),'func':_0x447392(0x16d)}),_0x4aeca5['json']({'code':0x0,'showMenuArr':_0x5cd812?JSON[_0x447392(0x245)](_0x5cd812['value']):'','versionInfo':_0x2ccc60?JSON[_0x447392(0x245)](_0x2ccc60['value']):'','currentVersion':_0x4a7be7});}),router[_0x1378a8(0x194)](_0x1378a8(0x209),(_0x7c1fe8,_0x2e8851,_0x569e67)=>{const _0x54db0e=_0x1378a8;if(OS['platform']()!=_0x54db0e(0x1c4)&&OS[_0x54db0e(0x241)]()!='darwin')return _0x7c1fe8['app'][_0x54db0e(0x1b7)](_0x2e8851,_0x2e8851['__'](_0x54db0e(0x22a)));if(_0x7c1fe8[_0x54db0e(0x234)][_0x54db0e(0x230)]!=0x1)return _0x2e8851[_0x54db0e(0x237)]({'code':0x66});return process[_0x54db0e(0x226)]({'type':_0x54db0e(0x240)}),_0x2e8851['json']({'code':0x0});}),router[_0x1378a8(0x194)](_0x1378a8(0x1ba),(_0x47dcc2,_0x1f70d9,_0x5da659)=>{const _0x1e7d4f=_0x1378a8;let _0x5e5471=netUtils[_0x1e7d4f(0x19d)](_0x47dcc2),_0x191cc2=_0x47dcc2[_0x1e7d4f(0x1b3)]['taskState'],_0x1e8066=_0x47dcc2[_0x1e7d4f(0x1b3)]['count'],_0x152ab=_0x47dcc2['body']['offset'],_0x149c2a=[];if(_0x47dcc2[_0x1e7d4f(0x234)]['is_admin']==0x1){_0x149c2a=_0x47dcc2[_0x1e7d4f(0x20e)][_0x1e7d4f(0x1a5)][_0x1e7d4f(0x1b5)](_0x1e7d4f(0x1c8))['all'](_0x191cc2,_0x1e8066,_0x152ab);let _0x21d229=dbBackupTask[_0x1e7d4f(0x1d3)](_0x47dcc2[_0x1e7d4f(0x20e)][_0x1e7d4f(0x1a5)],_0x1e7d4f(0x1c9),[]);for(let _0x179f41 in _0x21d229){let _0x24edb1=_0x21d229[_0x179f41],_0x55f845=dbBackupTask[_0x1e7d4f(0x1c6)](_0x47dcc2['app'][_0x1e7d4f(0x1a5)],_0x24edb1[_0x1e7d4f(0x23a)]);_0x149c2a[_0x1e7d4f(0x161)]({'task_type':_0x1e7d4f(0x1f3),'task_name':_0x55f845?_0x55f845[_0x1e7d4f(0x1a7)]:'','size_current':_0x24edb1[_0x1e7d4f(0x169)],'size_all':_0x24edb1['total_size']});}}let _0x45bdf2={'code':0x0,'data':_0x149c2a,'reqIp':_0x5e5471};return _0x1f70d9['json'](_0x45bdf2);}),router[_0x1378a8(0x194)](_0x1378a8(0x1cc),(_0xebe132,_0x2cddd0,_0xb6c51d)=>{const _0x1b20ab=_0x1378a8;let _0x58606a=_0xebe132[_0x1b20ab(0x1b3)]['taskId'];dbUserTable[_0x1b20ab(0x1ec)](_0xebe132,_0x2cddd0)===!![]&&_0xebe132[_0x1b20ab(0x20e)][_0x1b20ab(0x1a5)][_0x1b20ab(0x1b5)](_0x1b20ab(0x21f))[_0x1b20ab(0x1f6)](_0x58606a);let _0x468821={'code':0x0};return _0x2cddd0[_0x1b20ab(0x237)](_0x468821);}),router['post'](_0x1378a8(0x220),(_0x307f93,_0x2d9220,_0x1a8b37)=>{const _0x21fa31=_0x1378a8;if(_0x307f93[_0x21fa31(0x234)][_0x21fa31(0x230)]!=0x1)return _0x2d9220[_0x21fa31(0x237)]({'code':0x66});try{return _0x307f93[_0x21fa31(0x20e)][_0x21fa31(0x1a5)][_0x21fa31(0x19b)](_0x21fa31(0x1ce)),_0x307f93[_0x21fa31(0x20e)][_0x21fa31(0x183)][_0x21fa31(0x19b)]('vacuum'),_0x307f93[_0x21fa31(0x20e)][_0x21fa31(0x1a5)][_0x21fa31(0x1d0)](_0x21fa31(0x1cf)),_0x307f93['app']['dbFileIndex'][_0x21fa31(0x1d0)](_0x21fa31(0x1cf)),_0x2d9220[_0x21fa31(0x237)]({'code':0x0});}catch(_0x2df579){return _0x307f93['app']['returnErrMsg'](_0x2d9220,_0x2d9220['__'](_0x21fa31(0x1b2)));}}),router[_0x1378a8(0x194)]('/resetIndex',(_0x128836,_0x56c27a,_0x105767)=>{const _0x2f8a01=_0x1378a8;if(_0x128836[_0x2f8a01(0x234)][_0x2f8a01(0x230)]!=0x1)return _0x56c27a[_0x2f8a01(0x237)]({'code':0x66});let _0x31c46e=_0x128836[_0x2f8a01(0x1b3)][_0x2f8a01(0x253)];dbSourceTable[_0x2f8a01(0x200)](_0x128836[_0x2f8a01(0x20e)][_0x2f8a01(0x1a5)],_0x31c46e);if(_0x31c46e==_0x2f8a01(0x21a))dbFileIndexTable[_0x2f8a01(0x200)](_0x128836[_0x2f8a01(0x20e)][_0x2f8a01(0x183)],dbFileIndexTable[_0x2f8a01(0x1fd)]);else{if(_0x31c46e==_0x2f8a01(0x1b4))dbFileIndexTable[_0x2f8a01(0x200)](_0x128836[_0x2f8a01(0x20e)][_0x2f8a01(0x183)],dbFileIndexTable['INDEX_TABLE_NAME_PHOTO']);else{if(_0x31c46e=='music')dbFileIndexTable[_0x2f8a01(0x200)](_0x128836[_0x2f8a01(0x20e)][_0x2f8a01(0x183)],dbFileIndexTable[_0x2f8a01(0x152)]);else _0x31c46e==_0x2f8a01(0x1e3)&&dbFileIndexTable[_0x2f8a01(0x200)](_0x128836[_0x2f8a01(0x20e)]['dbFileIndex'],dbFileIndexTable[_0x2f8a01(0x160)]);}}_0x56c27a[_0x2f8a01(0x237)]({'code':0x0});}),router[_0x1378a8(0x194)](_0x1378a8(0x229),(_0x2fa5db,_0x27d48e,_0x83e57c)=>{const _0x4beb33=_0x1378a8;let _0x410d1c=netUtils[_0x4beb33(0x19d)](_0x2fa5db),_0x7fea64=_0x2fa5db[_0x4beb33(0x1b3)]['serverName'],_0x5126c8;_0x7fea64==_0x4beb33(0x189)?(process[_0x4beb33(0x226)]({'type':_0x4beb33(0x1fe),'func':_0x4beb33(0x1de)}),_0x5126c8=dbConfigTable[_0x4beb33(0x250)](_0x2fa5db[_0x4beb33(0x20e)][_0x4beb33(0x1a5)],_0x4beb33(0x20c))):_0x5126c8=dbConfigTable[_0x4beb33(0x1f9)](_0x2fa5db[_0x4beb33(0x20e)][_0x4beb33(0x1a5)],_0x7fea64);let _0x358af3=dbConfigTable[_0x4beb33(0x1f9)](_0x2fa5db[_0x4beb33(0x20e)][_0x4beb33(0x1a5)],'ddnsIpv6Address'),_0x589f19=dbConfigTable[_0x4beb33(0x1f9)](_0x2fa5db[_0x4beb33(0x20e)]['dbOther'],_0x4beb33(0x221)),_0x5d5d29={'code':0x0,'data':_0x5126c8,'serverRootPath':_0x589f19&&_0x589f19['value']?_0x589f19[_0x4beb33(0x208)]:'','hostName':OS[_0x4beb33(0x19e)](),'reqIp':_0x410d1c};_0x358af3&&_0x358af3[_0x4beb33(0x208)]&&(_0x5d5d29[_0x4beb33(0x1b0)]=_0x358af3[_0x4beb33(0x208)]);let _0x20de8a=dbNoticeCenterTable[_0x4beb33(0x21d)](_0x2fa5db[_0x4beb33(0x20e)]['dbOther']);return _0x5d5d29[_0x4beb33(0x1b6)]=_0x20de8a[_0x4beb33(0x1cb)],_0x27d48e[_0x4beb33(0x237)](_0x5d5d29);}),router['post']('/getSystemState',(_0x1b5253,_0x450d31,_0x526077)=>{const _0x4fbf36=_0x1378a8;let _0x17a7aa=netUtils[_0x4fbf36(0x19d)](_0x1b5253),_0x27a999=_0x1b5253[_0x4fbf36(0x1b3)]['force'],_0x4bb8f6='globalIndexInfo'+dbFileIndexTable[_0x4fbf36(0x1fd)],_0x205a26=_0x4fbf36(0x20f)+dbFileIndexTable[_0x4fbf36(0x15e)];process[_0x4fbf36(0x226)]({'type':_0x4fbf36(0x1fe),'func':_0x4fbf36(0x1d1)}),process['send']({'type':_0x4fbf36(0x1fe),'func':_0x4fbf36(0x1af),'force':_0x27a999}),fs[_0x4fbf36(0x1f4)](config['cacheParentPath'],_0x792a7d=>{const _0x4c3a14=_0x4fbf36;if(_0x792a7d)return _0x1b5253[_0x4c3a14(0x20e)][_0x4c3a14(0x1b7)](_0x450d31,_0x450d31['__'](_0x4c3a14(0x185)));else{let _0x32f742=dbConfigTable[_0x4c3a14(0x250)](_0x1b5253[_0x4c3a14(0x20e)][_0x4c3a14(0x1a5)],'\x20title\x20in\x20(\x27globalCpuInfo\x27,\x27globalMemInfo\x27,\x27'+_0x4bb8f6+_0x4c3a14(0x1da)+_0x205a26+_0x4c3a14(0x24d));return _0x450d31[_0x4c3a14(0x237)]({'code':0x0,'data':_0x32f742,'version':package[_0x4c3a14(0x159)],'reqIp':_0x17a7aa,'platform':OS[_0x4c3a14(0x241)]()});}});}),router[_0x1378a8(0x194)]('/getAllConfig',(_0x29dcc2,_0x223d43,_0x372e22)=>{const _0x11119d=_0x1378a8;let _0x55ff6e=_0x29dcc2[_0x11119d(0x1b3)]['keys'];if(!_0x55ff6e||!_0x55ff6e instanceof Array||_0x55ff6e[_0x11119d(0x18c)]<0x1)return _0x29dcc2[_0x11119d(0x20e)][_0x11119d(0x1b7)](_0x223d43,_0x11119d(0x22f));let _0x646863;_0x646863=dbConfigTable['findByTitleParamsList'](_0x29dcc2[_0x11119d(0x20e)][_0x11119d(0x1a5)],_0x55ff6e);for(let _0x5031e5 in _0x646863){let _0x240c14=_0x646863[_0x5031e5];if(_0x240c14['title']==_0x11119d(0x215)||_0x240c14['title']=='httpsKey'){let _0x15b812=_0x29dcc2['currentUser']['is_admin']==0x1;(!_0x15b812||!_0x240c14[_0x11119d(0x208)][_0x11119d(0x16c)](_0x11119d(0x197)))&&(_0x240c14[_0x11119d(0x208)]='');}}let _0x384c97={};_0x384c97[_0x11119d(0x247)]=config[_0x11119d(0x17e)],_0x384c97['defaultApiPortHttps']=config['apiPortHttps'],_0x384c97[_0x11119d(0x251)]=config['webDavPort'],_0x384c97[_0x11119d(0x1e9)]=config[_0x11119d(0x1f2)],_0x384c97['defaultFTPPort']=config[_0x11119d(0x202)],_0x384c97[_0x11119d(0x1c0)]=0x2,_0x384c97['allConfig']=_0x646863,_0x223d43[_0x11119d(0x237)]({'code':0x0,'data':_0x384c97});}),router[_0x1378a8(0x194)](_0x1378a8(0x1fb),(_0x401b4e,_0x1c77b3,_0x3c0f4c)=>{const _0xfb9e04=_0x1378a8;let _0x3c1a0b=dbConfigTable['findByTitle'](_0x401b4e['app'][_0xfb9e04(0x1a5)],_0xfb9e04(0x1eb)),_0x484f5f='';_0x3c1a0b&&(_0x484f5f=_0x3c1a0b[_0xfb9e04(0x208)]),_0x1c77b3[_0xfb9e04(0x237)]({'code':0x0,'data':_0x484f5f});}),router['post'](_0x1378a8(0x232),(_0x327d6f,_0x4cfbb9,_0x50a642)=>{const _0x126bca=_0x1378a8;let _0x2b73b9=netUtils[_0x126bca(0x19d)](_0x327d6f);if(_0x2b73b9!=_0x126bca(0x166))return _0x126bca(0x203);if(_0x327d6f['currentUser'][_0x126bca(0x230)]!=0x1)return _0x4cfbb9[_0x126bca(0x237)]({'code':0x66});let _0x123a76=_0x327d6f['body'][_0x126bca(0x1eb)],_0x54ca13=_0x327d6f[_0x126bca(0x1b3)][_0x126bca(0x1f1)];return _0x123a76&&dbConfigTable[_0x126bca(0x1b1)](_0x327d6f['app'][_0x126bca(0x1a5)],{'title':_0x126bca(0x1eb),'value':_0x123a76}),_0x54ca13&&dbConfigTable[_0x126bca(0x1b1)](_0x327d6f[_0x126bca(0x20e)]['dbOther'],{'title':_0x126bca(0x1f1),'value':_0x54ca13}),_0x4cfbb9[_0x126bca(0x237)]({'code':0x0});});function saveConfig(_0x1aa69e,_0x25f662,_0x2de4a6){dbConfigTable['create'](_0x1aa69e,{'title':_0x25f662,'value':_0x2de4a6+''});}router[_0x1378a8(0x194)](_0x1378a8(0x15a),(_0x1aa0d5,_0x1ffb49,_0x2e3e98)=>{const _0x44f1cd=_0x1378a8;let _0x7cc414=_0x1aa0d5['body'][_0x44f1cd(0x20b)];if(_0x1aa0d5[_0x44f1cd(0x234)][_0x44f1cd(0x230)]!=0x1)return _0x1ffb49[_0x44f1cd(0x237)]({'code':0x66});if(_0x7cc414)fs[_0x44f1cd(0x227)](_0x7cc414,fs[_0x44f1cd(0x219)]['W_OK']|fs['constants']['R_OK'],_0x495719=>{const _0x3f981d=_0x44f1cd;return!_0x495719?(saveConfig(_0x1aa0d5[_0x3f981d(0x20e)]['dbOther'],'cacheParentPath',_0x7cc414),_0x1ffb49[_0x3f981d(0x237)]({'code':0x0})):fileUtil[_0x3f981d(0x204)](_0x1ffb49,_0x495719);});else return dbConfigTable['deleteByTitle'](_0x1aa0d5[_0x44f1cd(0x20e)]['dbOther'],_0x44f1cd(0x157)),_0x1ffb49[_0x44f1cd(0x237)]({'code':0x0});}),router[_0x1378a8(0x194)](_0x1378a8(0x239),(_0x3ac3a3,_0x5bef48,_0x12654e)=>{const _0x1ac013=_0x1378a8;if(_0x3ac3a3[_0x1ac013(0x234)][_0x1ac013(0x230)]!=0x1)return _0x5bef48[_0x1ac013(0x237)]({'code':0x66});let _0x504068=_0x3ac3a3['body'][_0x1ac013(0x221)];return _0x504068?saveConfig(_0x3ac3a3[_0x1ac013(0x20e)][_0x1ac013(0x1a5)],_0x1ac013(0x221),_0x504068):dbConfigTable[_0x1ac013(0x22c)](_0x3ac3a3[_0x1ac013(0x20e)][_0x1ac013(0x1a5)],'serverRootPath'),_0x5bef48['json']({'code':0x0});}),router[_0x1378a8(0x194)]('/saveShareUrl',(_0x334fb8,_0x2ca5f7,_0x3f9107)=>{const _0x562d66=_0x1378a8;if(_0x334fb8[_0x562d66(0x234)]['is_admin']!=0x1)return _0x2ca5f7[_0x562d66(0x237)]({'code':0x66});let _0x904261=_0x334fb8['body'][_0x562d66(0x167)];return _0x904261?saveConfig(_0x334fb8[_0x562d66(0x20e)][_0x562d66(0x1a5)],_0x562d66(0x167),_0x904261):dbConfigTable[_0x562d66(0x22c)](_0x334fb8['app'][_0x562d66(0x1a5)],_0x562d66(0x167)),_0x2ca5f7[_0x562d66(0x237)]({'code':0x0});});function _0x9a2c(_0x56b4ef,_0x10e6ff){const _0x4dfd2b=_0x4dfd();return _0x9a2c=function(_0x9a2c74,_0x5785ba){_0x9a2c74=_0x9a2c74-0x151;let _0x38443c=_0x4dfd2b[_0x9a2c74];return _0x38443c;},_0x9a2c(_0x56b4ef,_0x10e6ff);}let forbiddenPorts=[0x1,0x7,0x9,0xb,0xd,0xf,0x11,0x13,0x14,0x15,0x16,0x17,0x19,0x25,0x2a,0x2b,0x35,0x4d,0x4f,0x57,0x5f,0x65,0x66,0x67,0x68,0x6d,0x6e,0x6f,0x71,0x73,0x75,0x77,0x7b,0x87,0x8b,0x8f,0xb3,0x185,0x1d1,0x200,0x201,0x202,0x203,0x20e,0x212,0x213,0x214,0x21c,0x22c,0x233,0x24b,0x259,0x27c,0x3e1,0x3e3,0x801,0xe4b,0xfcd,0x1770,0x1a09,0x1a0a,0x1a0b,0x1a0c,0x1a0d,0xd3d];router['post'](_0x1378a8(0x22b),(_0x1159c4,_0x599f96,_0x48da0b)=>{const _0x11f493=_0x1378a8;let _0x3cd549=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x17e)],_0x2acd28=_0x1159c4[_0x11f493(0x1b3)]['apiPortHttps'],_0x498da1=_0x1159c4['body'][_0x11f493(0x222)],_0x2b7f66=_0x1159c4['body'][_0x11f493(0x1f2)],_0x53e037=_0x1159c4['body'][_0x11f493(0x202)],_0x3af855=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x1a1)],_0x4a75f5=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x1e0)],_0x44a4bc=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x1c7)],_0x298b45=_0x1159c4['body'][_0x11f493(0x1a9)],_0x54f71b=_0x1159c4[_0x11f493(0x1b3)]['httpsKey'],_0x3b9723=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x215)],_0x53a6af=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x174)],_0x54f44b=_0x1159c4['body'][_0x11f493(0x182)],_0x448f94=_0x1159c4[_0x11f493(0x1b3)]['language'],_0x40c3f7=_0x1159c4[_0x11f493(0x1b3)]['region'],_0x26e2fd=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x184)],_0x560407=_0x1159c4['body'][_0x11f493(0x165)],_0x28daa5=_0x1159c4[_0x11f493(0x1b3)]['excludePathPhoto'],_0x26c99e=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x175)],_0x360cfc=_0x1159c4[_0x11f493(0x1b3)]['excludeFilenameMovie'],_0x439753=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x15c)],_0x24fb1b=_0x1159c4[_0x11f493(0x1b3)]['showMenuArr'],_0x3acc12=_0x1159c4['body'][_0x11f493(0x1aa)],_0x43dc60=_0x1159c4['body'][_0x11f493(0x167)],_0x3968a5=_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x1fc)],_0x29c009=_0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1a5)];if(_0x1159c4['currentUser'][_0x11f493(0x230)]!=0x1)return _0x599f96['json']({'code':0x66});let _0x485759=_0x1159c4[_0x11f493(0x1b3)]['serverRootPath'];if(_0x485759&&_0x485759[_0x11f493(0x1ad)]()){_0x485759=_0x485759[_0x11f493(0x20a)]()[_0x11f493(0x1ad)]();if(_0x485759['length']>0x20||!/^[a-zA-Z0-9]+$/[_0x11f493(0x246)](_0x485759))return _0x1159c4[_0x11f493(0x20e)]['returnErrMsg'](_0x599f96,'Root\x20path\x20must\x20be\x2032\x20characters\x20or\x20less\x20and\x20contain\x20only\x20letters\x20and\x20numbers');if([_0x11f493(0x24e),_0x11f493(0x1e3),_0x11f493(0x1c2),_0x11f493(0x181),_0x11f493(0x1b9),'note',_0x11f493(0x207)][_0x11f493(0x176)](_0x485759))return _0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__'](_0x11f493(0x163))+(':'+_0x485759),_0x11f493(0x18f));saveConfig(_0x29c009,_0x11f493(0x221),_0x485759);}let _0x4671b7=0xffdc;if(_0x3cd549>_0x4671b7||_0x498da1>_0x4671b7||_0x53e037>_0x4671b7||_0x2b7f66>_0x4671b7)return _0x599f96['json']({'code':0x1,'message':_0x11f493(0x1d7)});_0x24fb1b&&saveConfig(_0x29c009,'showMenuArr',JSON[_0x11f493(0x17f)](_0x24fb1b));_0x43dc60&&saveConfig(_0x29c009,_0x11f493(0x167),_0x43dc60);_0x560407&&saveConfig(_0x29c009,_0x11f493(0x165),JSON[_0x11f493(0x17f)](_0x560407));_0x3acc12&&parseInt(_0x3acc12)!=NaN&&_0x3acc12>0x0&&_0x3acc12<0x5f5e0ff&&saveConfig(_0x29c009,_0x11f493(0x1aa),_0x3acc12);_0x28daa5&&saveConfig(_0x29c009,'excludePathPhoto',JSON[_0x11f493(0x17f)](_0x28daa5));_0x40c3f7&&saveConfig(_0x29c009,_0x11f493(0x1f1),_0x40c3f7);if(_0x26c99e){let _0x3f3220=netUtils[_0x11f493(0x19d)](_0x1159c4);if(_0x3f3220==_0x11f493(0x166)){for(let _0x56e3a8 in _0x26c99e){let _0x3494d1=_0x26c99e[_0x56e3a8],_0x34e2f2=fs[_0x11f493(0x15d)](_0x3494d1);if(!_0x34e2f2)return _0x1159c4['app'][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__']('folderNotExist')+':'+_0x3494d1);fileUtil[_0x11f493(0x22e)](_0x3494d1)&&(_0x26c99e[_0x56e3a8]=_0x3494d1[_0x11f493(0x1d4)]());}saveConfig(_0x29c009,_0x11f493(0x175),JSON[_0x11f493(0x17f)](_0x26c99e));}else return _0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__']('onlySupportOnServerApp'));}_0x360cfc&&saveConfig(_0x29c009,_0x11f493(0x1e8),JSON['stringify'](_0x360cfc));_0x439753&&saveConfig(_0x29c009,'excludeFilenamePhoto',JSON['stringify'](_0x439753));if(_0x3cd549){if(forbiddenPorts[_0x11f493(0x176)](parseInt(_0x3cd549)))return _0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__']('setting.portInvalid')+_0x11f493(0x195));saveConfig(_0x29c009,_0x11f493(0x17e),parseInt(_0x3cd549));}if(_0x2acd28){if(forbiddenPorts['includes'](parseInt(_0x2acd28))||_0x2acd28==_0x3cd549)return _0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__'](_0x11f493(0x217))+_0x11f493(0x198));saveConfig(_0x29c009,_0x11f493(0x16e),parseInt(_0x2acd28));}_0x1159c4[_0x11f493(0x1b3)]['ipBan']&&saveConfig(_0x29c009,'ipBan',_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x24a)]);_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x173)]&&(saveConfig(_0x29c009,_0x11f493(0x173),_0x1159c4[_0x11f493(0x1b3)]['ipMode']),_0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1ae)]());_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x228)]&&saveConfig(_0x29c009,_0x11f493(0x228),_0x1159c4[_0x11f493(0x1b3)][_0x11f493(0x228)]);_0x1159c4['body'][_0x11f493(0x1a4)]&&saveConfig(_0x29c009,_0x11f493(0x1a4),_0x1159c4['body'][_0x11f493(0x1a4)]);_0x498da1&&saveConfig(_0x29c009,_0x11f493(0x222),parseInt(_0x498da1));_0x2b7f66&&saveConfig(_0x29c009,_0x11f493(0x1f2),parseInt(_0x2b7f66));_0x53e037&&saveConfig(_0x29c009,_0x11f493(0x202),parseInt(_0x53e037));_0x3af855&&saveConfig(_0x29c009,_0x11f493(0x1a1),_0x3af855);_0x4a75f5&&saveConfig(_0x29c009,_0x11f493(0x1e0),_0x4a75f5);_0x44a4bc&&saveConfig(_0x29c009,_0x11f493(0x1c7),_0x44a4bc);_0x298b45&&saveConfig(_0x29c009,'autoScanSource',_0x298b45);let _0x2c7e73=dbConfigTable[_0x11f493(0x1f9)](_0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1a5)],'useNasCabCerts');if(!_0x2c7e73||_0x2c7e73[_0x11f493(0x208)]==0x0){if(_0x54f71b!='*'&&_0x3b9723!='*'){if(_0x54f71b&&_0x3b9723){if(!_0x54f71b[_0x11f493(0x16c)](_0x11f493(0x197))||!_0x3b9723[_0x11f493(0x16c)](_0x11f493(0x197)))return _0x1159c4['app'][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__'](_0x11f493(0x17b)));const _0x110fc4=testCertAndKeyMatch(_0x3b9723,_0x54f71b);if(!_0x110fc4)return _0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__'](_0x11f493(0x17b)));saveConfig(_0x29c009,_0x11f493(0x1a6),_0x54f71b),saveConfig(_0x29c009,_0x11f493(0x215),_0x3b9723);}else saveConfig(_0x29c009,_0x11f493(0x1a6),''),saveConfig(_0x29c009,_0x11f493(0x215),'');}}if(_0x2c7e73&&_0x2c7e73[_0x11f493(0x208)]==0x1){if(_0x54f71b&&_0x3b9723)return _0x1159c4[_0x11f493(0x20e)]['returnErrMsg'](_0x599f96,_0x599f96['__'](_0x11f493(0x214)),_0x11f493(0x18f));}_0x3968a5&&saveConfig(_0x29c009,_0x11f493(0x1fc),_0x3968a5);_0x3968a5=dbConfigTable[_0x11f493(0x1f9)](_0x1159c4['app'][_0x11f493(0x1a5)],_0x11f493(0x1fc));if(!_0x3968a5||_0x3968a5['value']==0x0){if(_0x53a6af!='*'&&_0x54f44b!='*'){if(_0x53a6af&&_0x54f44b){if(!_0x53a6af[_0x11f493(0x16c)](_0x11f493(0x197))||!_0x54f44b[_0x11f493(0x16c)](_0x11f493(0x197)))return _0x1159c4['app'][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__'](_0x11f493(0x17b)));const _0x2b7685=testCertAndKeyMatch(_0x53a6af,_0x54f44b);if(!_0x2b7685)return _0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__'](_0x11f493(0x17b)));saveConfig(_0x29c009,_0x11f493(0x174),_0x53a6af),saveConfig(_0x29c009,_0x11f493(0x182),_0x54f44b);}else saveConfig(_0x29c009,_0x11f493(0x174),''),saveConfig(_0x29c009,_0x11f493(0x182),'');}}_0x448f94&&saveConfig(_0x29c009,_0x11f493(0x1eb),_0x448f94);if(_0x26e2fd){if(_0x26e2fd>OS['cpus']()[_0x11f493(0x18c)])return _0x1159c4[_0x11f493(0x20e)][_0x11f493(0x1b7)](_0x599f96,_0x599f96['__'](_0x11f493(0x248))+OS[_0x11f493(0x1c5)]()[_0x11f493(0x18c)]);saveConfig(_0x29c009,'threadCount',_0x26e2fd);}return _0x599f96[_0x11f493(0x237)]({'code':0x0});}),router[_0x1378a8(0x194)](_0x1378a8(0x190),(_0x360dcc,_0x2e32d7,_0x2b8bfb)=>{const _0x206ab5=_0x1378a8;if(_0x360dcc['currentUser'][_0x206ab5(0x230)]!=0x1)return _0x2e32d7[_0x206ab5(0x237)]({'code':0x66});let _0x1aeb6a=_0x360dcc[_0x206ab5(0x20e)][_0x206ab5(0x1a5)],_0x215a39=_0x360dcc[_0x206ab5(0x1b3)][_0x206ab5(0x211)],_0x510cc9=_0x360dcc[_0x206ab5(0x1b3)]['aiFaceEnable'],_0x5990d1=_0x360dcc['body'][_0x206ab5(0x192)],_0x3e8600=_0x360dcc[_0x206ab5(0x1b3)][_0x206ab5(0x1dd)],_0x42912b=_0x360dcc[_0x206ab5(0x1b3)][_0x206ab5(0x231)],_0x5f585f=_0x360dcc['body'][_0x206ab5(0x158)];_0x42912b&&saveConfig(_0x1aeb6a,_0x206ab5(0x231),_0x42912b);_0x5f585f&&saveConfig(_0x1aeb6a,_0x206ab5(0x158),_0x5f585f);if(_0x215a39){if(_0x215a39==0x1){if(OS[_0x206ab5(0x17c)]()/0x400/0x400/0x400<0x3)return _0x360dcc['app']['returnErrMsg'](_0x2e32d7,_0x2e32d7['__']('memTooLess'));}saveConfig(_0x1aeb6a,'aiClassesEnable',_0x215a39);if(_0x215a39==0x1)process[_0x206ab5(0x226)]({'type':_0x206ab5(0x225)});}_0x3e8600&&saveConfig(_0x1aeb6a,_0x206ab5(0x1dd),_0x3e8600);if(_0x510cc9){if(_0x510cc9==0x1){if(OS['totalmem']()/0x400/0x400/0x400<0x3)return _0x360dcc[_0x206ab5(0x20e)][_0x206ab5(0x1b7)](_0x2e32d7,_0x2e32d7['__']('memTooLess'));}saveConfig(_0x1aeb6a,_0x206ab5(0x22d),_0x510cc9);if(_0x510cc9==0x1)process[_0x206ab5(0x226)]({'type':'startFaceAiWork'});}if(_0x5990d1){saveConfig(_0x1aeb6a,_0x206ab5(0x192),_0x5990d1);if(_0x5990d1==0x1)process[_0x206ab5(0x226)]({'type':_0x206ab5(0x216)});}return _0x2e32d7['json']({'code':0x0});}),router[_0x1378a8(0x194)]('/saveConfigCustom',(_0x2f510e,_0x2e423e,_0x3ea675)=>{const _0x4a2f26=_0x1378a8;if(_0x2f510e[_0x4a2f26(0x234)][_0x4a2f26(0x230)]!=0x1)return _0x2e423e[_0x4a2f26(0x237)]({'code':0x66});let _0x48dd4=_0x2f510e['app'][_0x4a2f26(0x1a5)],_0x338e7f=_0x2f510e['body'][_0x4a2f26(0x178)],_0x233b43=_0x2f510e[_0x4a2f26(0x1b3)][_0x4a2f26(0x191)],_0x3806f3=_0x2f510e[_0x4a2f26(0x1b3)][_0x4a2f26(0x213)],_0x40ec05=_0x2f510e[_0x4a2f26(0x1b3)]['customHomeBgImage'];function _0x2e44c1(_0x3f3bea,_0x14726d,_0x4852a8){const _0x555743=_0x4a2f26;if(_0x14726d=='-')return saveConfig(_0x48dd4,_0x3f3bea,'-'),_0x2e423e[_0x555743(0x237)]({'code':0x0});if(fs[_0x555743(0x15d)](_0x14726d)){let _0x23585d=path['join'](config[_0x555743(0x1ac)],_0x555743(0x18b));function _0x4864fb(){const _0x4a4d7d=_0x555743;let _0x5d5ab6=path[_0x4a4d7d(0x218)](_0x23585d,_0x3f3bea+'.webp');sharp(path[_0x4a4d7d(0x218)](_0x14726d))['resize']({'width':_0x4852a8,'withoutEnlargement':!![]})['rotate']()['webp']()[_0x4a4d7d(0x244)](_0x5d5ab6)['then'](()=>{const _0x3685fc=_0x4a4d7d;return saveConfig(_0x48dd4,_0x3f3bea,_0x5d5ab6),_0x2e423e[_0x3685fc(0x237)]({'code':0x0});})[_0x4a4d7d(0x1e7)](()=>{const _0x18d1f3=_0x4a4d7d;return _0x2f510e[_0x18d1f3(0x20e)][_0x18d1f3(0x1b7)](_0x2e423e,_0x2e423e['__'](_0x18d1f3(0x1b2)));});}!fs['existsSync'](_0x23585d)?fs['mkdir'](_0x23585d,{'recursive':!![]},_0x3885c9=>{const _0x37fa53=_0x555743;if(_0x3885c9)return _0x2f510e[_0x37fa53(0x20e)]['returnErrMsg'](_0x2e423e,_0x2e423e['__'](_0x37fa53(0x1b2)));_0x4864fb();}):_0x4864fb();}else return _0x2f510e['app'][_0x555743(0x1b7)](_0x2e423e,_0x2e423e['__'](_0x555743(0x1ff))+_0x14726d);}if(_0x338e7f)return saveConfig(_0x48dd4,_0x4a2f26(0x178),_0x338e7f),_0x2e423e[_0x4a2f26(0x237)]({'code':0x0});_0x233b43&&_0x2e44c1(_0x4a2f26(0x191),_0x233b43,0xc8),_0x3806f3&&_0x2e44c1('customLoginImage',_0x3806f3,0x3e8),_0x40ec05&&_0x2e44c1(_0x4a2f26(0x1be),_0x40ec05,0xf14);}),router[_0x1378a8(0x194)](_0x1378a8(0x177),(_0x58bb41,_0x451519,_0x5a290c)=>{const _0x29d6db=_0x1378a8;let _0x408431=_0x58bb41[_0x29d6db(0x20e)][_0x29d6db(0x1a5)],_0x3fa811=_0x58bb41['body'][_0x29d6db(0x236)],_0x15aad5=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x23b)],_0x3e1aef=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x1d8)],_0x4e9079=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x223)],_0xa14ec9=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x186)],_0x243816=_0x58bb41[_0x29d6db(0x1b3)]['transcodePath'],_0x2bf23e=_0x58bb41['body'][_0x29d6db(0x1d2)],_0x3f7d9d=_0x58bb41[_0x29d6db(0x1b3)]['useFolderPictureAsPoster'],_0x10c105=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x19a)],_0x445c5d=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x24f)],_0x2296d2=_0x58bb41['body'][_0x29d6db(0x23f)],_0x5ae713=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x179)],_0x2a6d4e=_0x58bb41[_0x29d6db(0x1b3)]['movieTmdbLanguage'],_0x7ef76e=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x1bb)],_0x49acdc=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x16a)],_0x33a9c8=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x1bd)],_0x54d78d=_0x58bb41[_0x29d6db(0x1b3)]['defaultTranscodeResolution'],_0x24a35a=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x233)],_0x4dff24=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x1f0)],_0x2715a5=_0x58bb41[_0x29d6db(0x1b3)]['defaultMoviePlay'];if(_0x58bb41[_0x29d6db(0x234)][_0x29d6db(0x230)]!=0x1)return _0x451519['json']({'code':0x66});_0x2a6d4e&&saveConfig(_0x408431,'movieTmdbLanguage',_0x2a6d4e);(_0x24a35a==0x1||_0x24a35a==0x0)&&saveConfig(_0x408431,_0x29d6db(0x233),_0x24a35a);_0x4dff24&&saveConfig(_0x408431,_0x29d6db(0x1f0),_0x4dff24?_0x4dff24:'');_0x7ef76e!=null&&saveConfig(_0x408431,_0x29d6db(0x1bb),_0x7ef76e?_0x7ef76e:'');_0x49acdc!=null&&saveConfig(_0x408431,_0x29d6db(0x16a),_0x49acdc?_0x49acdc:'');_0x33a9c8&&saveConfig(_0x408431,_0x29d6db(0x1bd),_0x33a9c8);_0x5ae713&&saveConfig(_0x408431,_0x29d6db(0x179),_0x5ae713);_0x54d78d&&saveConfig(_0x408431,'defaultTranscodeResolution',_0x54d78d);_0x2715a5&&saveConfig(_0x408431,'defaultMoviePlay',_0x2715a5);let _0x350037=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x1f8)],_0x31f9e1=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x1db)],_0x3cb4f1=_0x58bb41[_0x29d6db(0x1b3)][_0x29d6db(0x156)];(_0x350037==0x1||_0x350037==0x0)&&saveConfig(_0x408431,_0x29d6db(0x1f8),_0x350037);(_0x31f9e1==0x1||_0x31f9e1==0x0)&&saveConfig(_0x408431,_0x29d6db(0x1db),_0x31f9e1);(_0x3cb4f1==0x1||_0x3cb4f1==0x0)&&saveConfig(_0x408431,_0x29d6db(0x156),_0x3cb4f1);let _0x49b49b=_0x58bb41[_0x29d6db(0x1b3)]['crf'];if(_0x49b49b&&(_0x49b49b<0x1||_0x49b49b>0x33))return _0x451519['json']({'code':0x1,'message':_0x29d6db(0x196)});let _0x21baab=['ultrafast',_0x29d6db(0x1fa),_0x29d6db(0x23d),'slow'];_0x445c5d&&_0x21baab[_0x29d6db(0x176)](_0x445c5d)&&saveConfig(_0x408431,_0x29d6db(0x24f),_0x445c5d);_0x2bf23e&&saveConfig(_0x408431,_0x29d6db(0x1d2),_0x2bf23e);_0x3f7d9d&&saveConfig(_0x408431,'useFolderPictureAsPoster',_0x3f7d9d);_0x49b49b&&saveConfig(_0x408431,_0x29d6db(0x15f),parseInt(_0x49b49b));_0x3fa811&&saveConfig(_0x408431,_0x29d6db(0x236),_0x3fa811);_0x2296d2&&saveConfig(_0x408431,_0x29d6db(0x23f),_0x2296d2);_0x15aad5&&saveConfig(_0x408431,_0x29d6db(0x23b),_0x15aad5);_0x3e1aef&&saveConfig(_0x408431,_0x29d6db(0x19f),_0x3e1aef);_0x4e9079&&saveConfig(_0x408431,'transCodeParams-CoderNameH264',_0x4e9079);if(_0xa14ec9){try{_0xa14ec9=parseInt(_0xa14ec9);if(_0xa14ec9>0x1e)_0xa14ec9=0x1e;if(_0xa14ec9<0x2)_0xa14ec9=0x2;}catch(_0x2d7f0f){_0xa14ec9=0x5;}saveConfig(_0x408431,_0x29d6db(0x1ca),_0xa14ec9);}return _0x10c105&&(saveConfig(_0x408431,_0x29d6db(0x19a),_0x10c105),_0x10c105=='1'&&process[_0x29d6db(0x226)]({'type':_0x29d6db(0x187)})),_0x243816?saveConfig(_0x408431,'transcodePath',_0x243816):dbConfigTable['deleteByTitle'](_0x408431,'transcodePath'),_0x451519['json']({'code':0x0});}),router[_0x1378a8(0x194)](_0x1378a8(0x205),(_0x3b1988,_0x2f144e,_0x257b71)=>{const _0x4426ee=_0x1378a8;let _0x2c6f9a=_0x3b1988[_0x4426ee(0x20e)]['dbOther'];if(_0x3b1988[_0x4426ee(0x234)][_0x4426ee(0x230)]!=0x1)return _0x2f144e['json']({'code':0x66});function _0x28ec7e(){const _0xaa2fb1=_0x4426ee;let _0x9a57e4=_0x3b1988['body'][_0xaa2fb1(0x18e)]||'filename',_0x2f5f27=['filename',_0xaa2fb1(0x1a8)];return _0x2f5f27[_0xaa2fb1(0x176)](_0x9a57e4)&&saveConfig(_0x2c6f9a,_0xaa2fb1(0x23e),_0x9a57e4),_0x2f144e['json']({'code':0x0});}_0x28ec7e();}),router[_0x1378a8(0x194)](_0x1378a8(0x172),(_0x22cbbe,_0x2f6a03,_0x4ce1ee)=>{const _0x353d00=_0x1378a8;if(_0x22cbbe[_0x353d00(0x234)]['is_admin']!=0x1)return _0x2f6a03['json']({'code':0x66});let _0x4e8e1d={};_0x4e8e1d[_0x353d00(0x1d9)]=path[_0x353d00(0x218)](config['userDataFolder'],_0x353d00(0x20d)),_0x4e8e1d[_0x353d00(0x21e)]=config[_0x353d00(0x157)],fs[_0x353d00(0x227)](_0x4e8e1d[_0x353d00(0x21e)],fs[_0x353d00(0x219)]['R_OK']|fs[_0x353d00(0x219)][_0x353d00(0x21c)],_0x42e724=>{const _0x2dc901=_0x353d00;_0x4e8e1d['imgFolderUsable']=0x1;_0x42e724&&(_0x4e8e1d[_0x2dc901(0x1ab)]=0x0);let _0xdd87c5=dbConfigTable['findByTitle'](_0x22cbbe[_0x2dc901(0x20e)]['dbOther'],_0x2dc901(0x1e2));return _0xdd87c5?_0x4e8e1d[_0x2dc901(0x1e2)]=JSON[_0x2dc901(0x245)](_0xdd87c5[_0x2dc901(0x208)]):_0x4e8e1d['cacheImageInfo']=![],_0x4e8e1d[_0x2dc901(0x1b8)]=config['appRootPath'],_0x2f6a03[_0x2dc901(0x237)]({'code':0x0,'data':_0x4e8e1d});});}),router[_0x1378a8(0x194)](_0x1378a8(0x154),(_0x2cc12a,_0x28a21c,_0x4e082c)=>{const _0x484489=_0x1378a8;if(dbUserTable['isAdmin'](_0x2cc12a,_0x28a21c)!==!![])return;if(OS['platform']()!=_0x484489(0x1c4)&&OS['platform']()!=_0x484489(0x17a))return _0x2cc12a[_0x484489(0x20e)][_0x484489(0x1b7)](_0x28a21c,_0x28a21c['__'](_0x484489(0x1ef)));return process[_0x484489(0x226)]({'type':_0x484489(0x1ed)}),_0x28a21c[_0x484489(0x237)]({'code':0x0});}),router['post'](_0x1378a8(0x21b),(_0x2842ba,_0x1c9c88,_0x1ff646)=>{const _0x46a7c5=_0x1378a8;if(_0x2842ba[_0x46a7c5(0x234)][_0x46a7c5(0x230)]!=0x1)return _0x1c9c88['json']({'code':0x66});let _0x341936=path[_0x46a7c5(0x218)](config[_0x46a7c5(0x157)],_0x46a7c5(0x193));fs[_0x46a7c5(0x1f4)](_0x341936,(_0x15d056,_0x1e868f)=>{if(_0x15d056)return;fs['rm'](_0x341936,{'recursive':!![]},_0x504b67=>{const _0x2e23bd=_0x9a2c;fs[_0x2e23bd(0x1ea)](_0x341936,{'recursive':!![]},_0x3fea2e=>{console['log'](_0x3fea2e);});if(_0x504b67)return fileUtil[_0x2e23bd(0x204)](_0x1c9c88,_0x504b67);return dbConfigTable[_0x2e23bd(0x22c)](_0x2842ba[_0x2e23bd(0x20e)][_0x2e23bd(0x1a5)],_0x2e23bd(0x1e2)),_0x1c9c88[_0x2e23bd(0x237)]({'code':0x0});});});let _0x478a07=path[_0x46a7c5(0x218)](config[_0x46a7c5(0x157)],_0x46a7c5(0x210)),_0x5a8117=path[_0x46a7c5(0x218)](config[_0x46a7c5(0x157)],_0x46a7c5(0x210),_0x46a7c5(0x243));fs[_0x46a7c5(0x1f4)](_0x478a07,(_0x263fed,_0x47d9d9)=>{if(_0x263fed)return;fs['rm'](_0x478a07,{'recursive':!![]},_0x2c450c=>{fs['mkdir'](_0x5a8117,{'recursive':!![]},_0x60e313=>{const _0x12860a=_0x9a2c;console[_0x12860a(0x1c1)](_0x60e313);});if(_0x2c450c)return fileUtil['returnFileError'](_0x1c9c88,_0x2c450c);});});}),router['post'](_0x1378a8(0x168),(_0x8ce534,_0x445d87,_0x4c12ce)=>{const _0x1352b7=_0x1378a8;if(dbUserTable['isAdmin'](_0x8ce534,_0x445d87)!==!![])return;let _0x523717=_0x8ce534[_0x1352b7(0x1b3)]['type'],_0x5461f8=[_0x1352b7(0x1cd),_0x1352b7(0x1a0),'baseboard','chassis','cpu','cpuTemperature',_0x1352b7(0x16b),'memLayout',_0x1352b7(0x1e5),_0x1352b7(0x1bf),'osInfo',_0x1352b7(0x1e6),_0x1352b7(0x1d5),_0x1352b7(0x151),_0x1352b7(0x235),_0x1352b7(0x1c3),'bluetoothDevices'];if(!_0x5461f8[_0x1352b7(0x176)](_0x523717))return _0x8ce534[_0x1352b7(0x20e)][_0x1352b7(0x1b7)](_0x445d87,_0x1352b7(0x242));si[_0x523717](_0x3e47f5=>{const _0x2e4be0=_0x1352b7;try{return _0x445d87[_0x2e4be0(0x237)]({'code':0x0,'data':_0x3e47f5});}catch(_0x3a0f5a){console[_0x2e4be0(0x1c1)](_0x2e4be0(0x201),_0x3a0f5a);}});}),router[_0x1378a8(0x194)](_0x1378a8(0x155),(_0x49d8ae,_0x427408,_0x4fee79)=>{const _0x29514b=_0x1378a8;let _0x5e5aa4=netUtils[_0x29514b(0x19d)](_0x49d8ae);if(_0x5e5aa4!=_0x29514b(0x166))return _0x49d8ae[_0x29514b(0x20e)][_0x29514b(0x1b7)](_0x427408,_0x427408['__'](_0x29514b(0x1b2)));let _0x24fa83=_0x49d8ae['body']['folder'],_0x2defbe=_0x49d8ae['body'][_0x29514b(0x18a)],_0x1ad8d3=_0x49d8ae['body']['fullPath'];if(!_0x1ad8d3)try{_0x1ad8d3=path[_0x29514b(0x218)](_0x24fa83,_0x2defbe);}catch(_0x81f4c5){console[_0x29514b(0x1c1)](_0x81f4c5);}if(!_0x1ad8d3)return _0x49d8ae[_0x29514b(0x20e)][_0x29514b(0x1b7)](_0x427408,'need\x20path');if(dbUserTable[_0x29514b(0x1e1)](_0x49d8ae,_0x427408,'folder',_0x29514b(0x249),'')==!![]){let _0x5a4d18=_0x49d8ae[_0x29514b(0x1b3)][_0x29514b(0x164)]||'openPath';process[_0x29514b(0x226)]({'type':_0x29514b(0x24b),'shellType':_0x5a4d18,'path':_0x1ad8d3});let _0x45bf31={'code':0x0};return _0x427408['json'](_0x45bf31);}}),module[_0x1378a8(0x17d)]=router;