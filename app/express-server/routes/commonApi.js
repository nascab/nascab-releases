const _0x44b2cd=_0x5d9a;(function(_0x418206,_0x43636f){const _0x111047=_0x5d9a,_0x56bfb3=_0x418206();while(!![]){try{const _0x24a635=parseInt(_0x111047(0x156))/0x1*(parseInt(_0x111047(0x106))/0x2)+parseInt(_0x111047(0x157))/0x3*(parseInt(_0x111047(0x159))/0x4)+parseInt(_0x111047(0x114))/0x5+parseInt(_0x111047(0x17f))/0x6+-parseInt(_0x111047(0xa4))/0x7+parseInt(_0x111047(0x119))/0x8*(-parseInt(_0x111047(0xf8))/0x9)+-parseInt(_0x111047(0xcd))/0xa*(parseInt(_0x111047(0x13c))/0xb);if(_0x24a635===_0x43636f)break;else _0x56bfb3['push'](_0x56bfb3['shift']());}catch(_0x5e0aee){_0x56bfb3['push'](_0x56bfb3['shift']());}}}(_0x5a7c,0xbf28c));var express=require('express'),router=express[_0x44b2cd(0x196)]();let config=require(_0x44b2cd(0x16b)),dbFileIndexTable=require(_0x44b2cd(0xac)),dbConfigTable=require('../../db/dbConfigTable'),dbSourceTable=require(_0x44b2cd(0xe7)),dbNoticeCenterTable=require(_0x44b2cd(0x15c)),netUtils=require('../utils/netUtils');const dbUserTable=require(_0x44b2cd(0x188)),dbBackupTask=require(_0x44b2cd(0x13a)),OS=require('os');let path=require('path'),fs=require('fs'),fileUtil=require('../utils/fileUtils');var package=require(_0x44b2cd(0x129));const sqliteUtil=require(_0x44b2cd(0x10b)),sharp=require('sharp'),si=require('systeminformation');function _0x5a7c(){const _0x2496d1=['defaultThreadCount','tmdbProxyUrl','START_PRE_GEN_SUBTITLE','-----','returnFileError','aiSimilarPhotoEnable','currentUser','crf','value','movieHomeShowHistory','webDavHttpsCert','startUpdate','globalIndexInfo','10MCiwBF','wal_checkpoint(RESTART)','all','graphics','/resetIndex','cacheImageInfo','cpus','keys','musicTitleType','autoShowWindow','task_id','mkdir','movieTmdbApiKey','toFile','trim','json','then','platform','returnErrMsg','moviePlaylongPressRate','movieTmdbLanguage','moviePreferLanguage','app','force','/getBgTask','startFaceAiWork','../../db/dbSourceFolderTable','customLogoImage','appRootPath','ultrafast','httpsCert','ipMode','startClassesAiWork','openType','autoLaunch','threadCount','serverType','download','movieHomeShowLibrary','medium','toUpperCase','power_get','aiFaceMinPhotoCount','7929EASIzz','log','error\x20keys','excludePathFolderBrowser','transCodeParams-CoderNameHevc','customLoginTitle','webDavUseApiCert','webDavPort','transCodeCoderNameH264','localhost','webDavHttpsKey','book','customLoginImage','serverName','446MYdmBX','autoHardAccDecode','taskId','getGlobalInfo','/deleteBgTask','../utils/sqliteUtil','INDEX_TABLE_NAME_PHOTO','defaultApiPort','FTPPort','findByTitle','includes','autoLoginClient','cache','title','1075850RJjldv','/setLanguage','tmdbProxyEnable','type\x20is\x20invalid','chassis','3728UTGgtG','/openInSystem','openPath','folder','copy_size','DELETE\x20FROM\x20bg_task\x20WHERE\x20id=?','fast','ddnsIpv6Address','taskState','catch','total_size','findByTitleParamsList','W_OK','getAllByWhere','subtitle','defaultTranscodeResolution','../../../package.json','cachePath','INDEX_TABLE_NAME_MOVIE',':http','subtitleSize','filename','task_name','onlySupportOnServerApp','subtitlePreGen','memLayout','resize','excludeFilenamePhoto','ipDetection','INDEX_TABLE_NAME_BOOK','parse','excludePathMovie','darwin','../../db/dbBackupTask','customShareUrl','24848450QNdhST','getClientIpWithOutXforwarded','movie','database','SELECT\x20*\x20FROM\x20bg_task\x20WHERE\x20task_state=?\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?','R_OK','/getSystemInfomation','/vaccumDb','/saveConfigMusic','operationFail','region','\x20title\x20in\x20(\x27globalCpuInfo\x27,\x27globalMemInfo\x27,\x27','fullPath','is_admin','CRF:\x201-51','reloadHomePage','imgFolder','/getAllConfig','rotate','deleteByTitle','transCodeParams-CoderNameH264','getDiskInfo','customHomeBgImage','post','versionInfo','existsSync','6470LjwSiY','651459uhZwhL','diskLayout','28BqhLVQ','excludePathPhoto','stat','../../db/dbNoticeCenterTable','totalmem','excludeFilenameMovie','serverRootPath','create','tls','test','twoStepLogin','memTooLess','slow','mem','/getLanguage','transcodePath','shell','httpsKey','../../myConfig/config','allConfig','getAllRecordByWhere','photoPreviewSize','defaultWebDavPort','autoScanSource','audio','body','defaultMoviePlay','cpu','cacheParentPath','transCodeParams-readrate','file','id3tag','isAdmin','webp','clearTable','note','/clearCache','custom','2550390wphycf','getIpList','aiClassesEnable','apiPort','tokenKeepHour','hostname','INDEX_TABLE_NAME_MUSIC','/getSystemState','notSupportForAutoUpdate','../../db/dbUserTable','push','wifiNetworks','.webp','\x20status=\x27running\x27\x20or\x20status=\x27waiting\x27','stringify','movieTmdbApiUrl','startsWith','isWinDisk','access','notSupport','defaultApiPortHttps','networkInterfaces','length','Router','movieHomeShowMyMedia','defaultFTPPort','join','doUserCanGet','win32','/refreshHomePage',':https','ip\x20not\x20allow','pragma','getClientIp','aiFaceEnable','transcodeSpeed','toLowerCase','send','dbFileIndex','httpsCertError','webDavPortHttps','transCodeReadRate','port:\x20256-65500','userDataFolder','showMenuArr','vacuum','movieShowMatchName','/saveConfigMovie','serverRootError','useFolderPictureAsPoster','cpuTemperature','constants','language','err','1054424ohHfdv','getAllIndexInfo','setting.portInvalid','/saveConfigPhoto','setting','createSecureContext','getUnReadCount','transCodeCoderNameHevc','../../db/dbFileIndexTable','apiPortHttps','/getServerState','exec','api','system','imgFolderUsable','ipBan','/changeCachePath','music','/relaunch','Relaunch','baseboard','folderNotExist','type','dbOther','getUpdateInfo','getById','prepare','/getVersionInfo'];_0x5a7c=function(){return _0x2496d1;};return _0x5a7c();}let tls=require(_0x44b2cd(0x161));function testCertAndKeyMatch(_0x22dd75,_0x2a88ba){const _0x240806=_0x44b2cd;try{return tls[_0x240806(0xa9)]({'cert':_0x22dd75,'key':_0x2a88ba}),!![];}catch(_0x4fd6c1){return![];}}router['post'](_0x44b2cd(0x19c),(_0x15ede9,_0x33f03a,_0xd5ab3f)=>{const _0x41dd14=_0x44b2cd;let _0xb29bb3=netUtils[_0x41dd14(0x13d)](_0x15ede9);console[_0x41dd14(0xf9)]('refreshHomePage',_0xb29bb3);if(_0xb29bb3!='localhost')return _0x41dd14(0x19e);return process[_0x41dd14(0x93)]({'type':_0x41dd14(0x14b)}),_0x33f03a[_0x41dd14(0xdc)]({'code':0x0});}),router['post'](_0x44b2cd(0xbf),(_0x707746,_0x6f61b,_0x4b8285)=>{const _0x319751=_0x44b2cd;let _0x5e1707=package['version'],_0x5072b=dbConfigTable[_0x319751(0x10f)](_0x707746[_0x319751(0xe3)][_0x319751(0xbb)],_0x319751(0x154)),_0x550fd7=dbConfigTable[_0x319751(0x10f)](_0x707746['app'][_0x319751(0xbb)],_0x319751(0x9a));process['send']({'type':_0x319751(0x109),'func':_0x319751(0xbc)}),_0x6f61b['json']({'code':0x0,'showMenuArr':_0x550fd7?JSON[_0x319751(0x137)](_0x550fd7[_0x319751(0xc8)]):'','versionInfo':_0x5072b?JSON[_0x319751(0x137)](_0x5072b[_0x319751(0xc8)]):'','currentVersion':_0x5e1707});}),router[_0x44b2cd(0x153)]('/updateNewVersion',(_0x5d413b,_0x29dba2,_0x1558ce)=>{const _0x5ae8e7=_0x44b2cd;if(OS[_0x5ae8e7(0xde)]()!='win32'&&OS[_0x5ae8e7(0xde)]()!='darwin')return _0x5d413b['app'][_0x5ae8e7(0xdf)](_0x29dba2,_0x29dba2['__'](_0x5ae8e7(0x187)));if(_0x5d413b[_0x5ae8e7(0xc6)][_0x5ae8e7(0x149)]!=0x1)return _0x29dba2[_0x5ae8e7(0xdc)]({'code':0x66});return process['send']({'type':_0x5ae8e7(0xcb)}),_0x29dba2['json']({'code':0x0});}),router[_0x44b2cd(0x153)](_0x44b2cd(0xe5),(_0x152337,_0x38c1ff,_0x5f20a6)=>{const _0x545efd=_0x44b2cd;let _0x1def66=netUtils[_0x545efd(0x1a0)](_0x152337),_0x4f73dd=_0x152337['body'][_0x545efd(0x121)],_0x3af77e=_0x152337['body']['count'],_0x21a81a=_0x152337[_0x545efd(0x172)]['offset'],_0x46403f=[];if(_0x152337[_0x545efd(0xc6)]['is_admin']==0x1){_0x46403f=_0x152337[_0x545efd(0xe3)][_0x545efd(0xbb)][_0x545efd(0xbe)](_0x545efd(0x140))[_0x545efd(0xcf)](_0x4f73dd,_0x3af77e,_0x21a81a);let _0x274f88=dbBackupTask[_0x545efd(0x16d)](_0x152337['app']['dbOther'],_0x545efd(0x18c),[]);for(let _0x37e5bb in _0x274f88){let _0x5da5bc=_0x274f88[_0x37e5bb],_0x142b1c=dbBackupTask[_0x545efd(0xbd)](_0x152337[_0x545efd(0xe3)][_0x545efd(0xbb)],_0x5da5bc[_0x545efd(0xd7)]);_0x46403f[_0x545efd(0x189)]({'task_type':'BACKUP','task_name':_0x142b1c?_0x142b1c[_0x545efd(0x12f)]:'','size_current':_0x5da5bc[_0x545efd(0x11d)],'size_all':_0x5da5bc[_0x545efd(0x123)]});}}let _0xc831a={'code':0x0,'data':_0x46403f,'reqIp':_0x1def66};return _0x38c1ff['json'](_0xc831a);}),router[_0x44b2cd(0x153)](_0x44b2cd(0x10a),(_0x4619a0,_0x19dab9,_0x4e23bb)=>{const _0x473cde=_0x44b2cd;let _0x6561a5=_0x4619a0['body'][_0x473cde(0x108)];dbUserTable[_0x473cde(0x179)](_0x4619a0,_0x19dab9)===!![]&&_0x4619a0['app'][_0x473cde(0xbb)][_0x473cde(0xbe)](_0x473cde(0x11e))['run'](_0x6561a5);let _0xc20aa0={'code':0x0};return _0x19dab9['json'](_0xc20aa0);}),router[_0x44b2cd(0x153)](_0x44b2cd(0x143),(_0x317ee4,_0x5beab4,_0x468046)=>{const _0x54007f=_0x44b2cd;if(_0x317ee4['currentUser'][_0x54007f(0x149)]!=0x1)return _0x5beab4[_0x54007f(0xdc)]({'code':0x66});try{return _0x317ee4[_0x54007f(0xe3)]['dbOther'][_0x54007f(0xaf)](_0x54007f(0x9b)),_0x317ee4[_0x54007f(0xe3)][_0x54007f(0x94)][_0x54007f(0xaf)](_0x54007f(0x9b)),_0x317ee4[_0x54007f(0xe3)][_0x54007f(0xbb)]['pragma'](_0x54007f(0xce)),_0x317ee4['app'][_0x54007f(0x94)][_0x54007f(0x19f)]('wal_checkpoint(RESTART)'),_0x5beab4['json']({'code':0x0});}catch(_0x2c4c72){return _0x317ee4['app']['returnErrMsg'](_0x5beab4,_0x5beab4['__'](_0x54007f(0x145)));}}),router[_0x44b2cd(0x153)](_0x44b2cd(0xd1),(_0x44df19,_0x1a4be9,_0x1fab3e)=>{const _0x32fe3f=_0x44b2cd;if(_0x44df19[_0x32fe3f(0xc6)][_0x32fe3f(0x149)]!=0x1)return _0x1a4be9[_0x32fe3f(0xdc)]({'code':0x66});let _0x584ce3=_0x44df19['body'][_0x32fe3f(0xf1)];dbSourceTable[_0x32fe3f(0x17b)](_0x44df19[_0x32fe3f(0xe3)][_0x32fe3f(0xbb)],_0x584ce3);if(_0x584ce3==_0x32fe3f(0x13e))dbFileIndexTable[_0x32fe3f(0x17b)](_0x44df19[_0x32fe3f(0xe3)]['dbFileIndex'],dbFileIndexTable[_0x32fe3f(0x12b)]);else{if(_0x584ce3=='photo')dbFileIndexTable[_0x32fe3f(0x17b)](_0x44df19[_0x32fe3f(0xe3)][_0x32fe3f(0x94)],dbFileIndexTable[_0x32fe3f(0x10c)]);else{if(_0x584ce3==_0x32fe3f(0xb5))dbFileIndexTable['clearTable'](_0x44df19[_0x32fe3f(0xe3)][_0x32fe3f(0x94)],dbFileIndexTable[_0x32fe3f(0x185)]);else _0x584ce3==_0x32fe3f(0x103)&&dbFileIndexTable[_0x32fe3f(0x17b)](_0x44df19[_0x32fe3f(0xe3)]['dbFileIndex'],dbFileIndexTable[_0x32fe3f(0x136)]);}}_0x1a4be9[_0x32fe3f(0xdc)]({'code':0x0});}),router[_0x44b2cd(0x153)](_0x44b2cd(0xae),(_0x3949df,_0x535d44,_0x39be8e)=>{const _0x138784=_0x44b2cd;let _0x45506b=netUtils['getClientIp'](_0x3949df),_0x2ea7ea=_0x3949df[_0x138784(0x172)][_0x138784(0x105)],_0x252fe3;_0x2ea7ea==_0x138784(0xcf)?(process[_0x138784(0x93)]({'type':_0x138784(0x109),'func':_0x138784(0x180)}),_0x252fe3=dbConfigTable[_0x138784(0x126)](_0x3949df[_0x138784(0xe3)]['dbOther'],'\x20title\x20in\x20(\x27apiServer\x27,\x27apiServerHttps\x27,\x27webDavServer\x27,\x27FTPServer\x27,\x27globalIpList\x27)')):_0x252fe3=dbConfigTable[_0x138784(0x10f)](_0x3949df['app'][_0x138784(0xbb)],_0x2ea7ea);let _0x4e51df=dbConfigTable[_0x138784(0x10f)](_0x3949df[_0x138784(0xe3)][_0x138784(0xbb)],'ddnsIpv6Address'),_0x2e0a59=dbConfigTable[_0x138784(0x10f)](_0x3949df[_0x138784(0xe3)]['dbOther'],_0x138784(0x15f)),_0x1903e1={'code':0x0,'data':_0x252fe3,'serverRootPath':_0x2e0a59&&_0x2e0a59[_0x138784(0xc8)]?_0x2e0a59['value']:'','hostName':OS[_0x138784(0x184)](),'reqIp':_0x45506b};_0x4e51df&&_0x4e51df[_0x138784(0xc8)]&&(_0x1903e1[_0x138784(0x120)]=_0x4e51df['value']);let _0x546168=dbNoticeCenterTable[_0x138784(0xaa)](_0x3949df[_0x138784(0xe3)][_0x138784(0xbb)]);return _0x1903e1['unreadMsgCount']=_0x546168['count'],_0x535d44[_0x138784(0xdc)](_0x1903e1);}),router[_0x44b2cd(0x153)](_0x44b2cd(0x186),(_0x3052b3,_0x1ff9c6,_0x4c69c4)=>{const _0x5a44c4=_0x44b2cd;let _0x4406c8=netUtils[_0x5a44c4(0x1a0)](_0x3052b3),_0x372731=_0x3052b3['body'][_0x5a44c4(0xe4)],_0xba0c12=_0x5a44c4(0xcc)+dbFileIndexTable[_0x5a44c4(0x12b)],_0x2aae13=_0x5a44c4(0xcc)+dbFileIndexTable[_0x5a44c4(0x10c)];process[_0x5a44c4(0x93)]({'type':_0x5a44c4(0x109),'func':_0x5a44c4(0xa5)}),process[_0x5a44c4(0x93)]({'type':_0x5a44c4(0x109),'func':_0x5a44c4(0x151),'force':_0x372731}),fs[_0x5a44c4(0x15b)](config[_0x5a44c4(0x175)],_0x5cc0e9=>{const _0x338394=_0x5a44c4;if(_0x5cc0e9)return _0x3052b3[_0x338394(0xe3)]['returnErrMsg'](_0x1ff9c6,_0x1ff9c6['__']('cachePathInvalid'));else{let _0x2ecd3a=dbConfigTable[_0x338394(0x126)](_0x3052b3[_0x338394(0xe3)][_0x338394(0xbb)],_0x338394(0x147)+_0xba0c12+'\x27,\x27'+_0x2aae13+'\x27,\x27globalDiskInfo\x27)');return _0x1ff9c6[_0x338394(0xdc)]({'code':0x0,'data':_0x2ecd3a,'version':package['version'],'reqIp':_0x4406c8,'platform':OS[_0x338394(0xde)]()});}});}),router['post'](_0x44b2cd(0x14d),(_0x18e456,_0x307fa5,_0x3655fc)=>{const _0xe23395=_0x44b2cd;let _0x4165e7=_0x18e456[_0xe23395(0x172)][_0xe23395(0xd4)];if(!_0x4165e7||!_0x4165e7 instanceof Array||_0x4165e7[_0xe23395(0x195)]<0x1)return _0x18e456[_0xe23395(0xe3)][_0xe23395(0xdf)](_0x307fa5,_0xe23395(0xfa));let _0x50b2f8;_0x50b2f8=dbConfigTable[_0xe23395(0x124)](_0x18e456[_0xe23395(0xe3)][_0xe23395(0xbb)],_0x4165e7);for(let _0xbce3d3 in _0x50b2f8){let _0x30e2b6=_0x50b2f8[_0xbce3d3];(_0x30e2b6['title']==_0xe23395(0xeb)||_0x30e2b6[_0xe23395(0x113)]==_0xe23395(0x16a))&&(!_0x30e2b6[_0xe23395(0xc8)][_0xe23395(0x18f)](_0xe23395(0xc3))&&(_0x30e2b6[_0xe23395(0xc8)]=''));}let _0x3ed415={};_0x3ed415[_0xe23395(0x10d)]=config[_0xe23395(0x182)],_0x3ed415[_0xe23395(0x193)]=config[_0xe23395(0xad)],_0x3ed415[_0xe23395(0x16f)]=config[_0xe23395(0xff)],_0x3ed415['defaultWebDavPortHttps']=config[_0xe23395(0x96)],_0x3ed415[_0xe23395(0x198)]=config[_0xe23395(0x10e)],_0x3ed415[_0xe23395(0xc0)]=0x2,_0x3ed415[_0xe23395(0x16c)]=_0x50b2f8,_0x307fa5['json']({'code':0x0,'data':_0x3ed415});}),router[_0x44b2cd(0x153)](_0x44b2cd(0x167),(_0x537c85,_0x4c419a,_0x353d28)=>{const _0x5cd4f0=_0x44b2cd;let _0x546f86=dbConfigTable[_0x5cd4f0(0x10f)](_0x537c85['app']['dbOther'],_0x5cd4f0(0xa2)),_0x32ce41='';_0x546f86&&(_0x32ce41=_0x546f86['value']),_0x4c419a[_0x5cd4f0(0xdc)]({'code':0x0,'data':_0x32ce41});}),router[_0x44b2cd(0x153)](_0x44b2cd(0x115),(_0x5e7730,_0x3c5c17,_0x1fdfdd)=>{const _0x42fcdf=_0x44b2cd;let _0x51fef9=netUtils['getClientIp'](_0x5e7730);if(_0x51fef9!='localhost')return'ip\x20not\x20allow';if(_0x5e7730[_0x42fcdf(0xc6)]['is_admin']!=0x1)return _0x3c5c17[_0x42fcdf(0xdc)]({'code':0x66});let _0x58ee77=_0x5e7730[_0x42fcdf(0x172)][_0x42fcdf(0xa2)],_0x4eee48=_0x5e7730['body'][_0x42fcdf(0x146)];return _0x58ee77&&dbConfigTable[_0x42fcdf(0x160)](_0x5e7730[_0x42fcdf(0xe3)][_0x42fcdf(0xbb)],{'title':_0x42fcdf(0xa2),'value':_0x58ee77}),_0x4eee48&&dbConfigTable[_0x42fcdf(0x160)](_0x5e7730[_0x42fcdf(0xe3)][_0x42fcdf(0xbb)],{'title':_0x42fcdf(0x146),'value':_0x4eee48}),_0x3c5c17[_0x42fcdf(0xdc)]({'code':0x0});});function saveConfig(_0x5e69fc,_0x1cc0b3,_0xb0b1a8){const _0x3893b5=_0x44b2cd;dbConfigTable[_0x3893b5(0x160)](_0x5e69fc,{'title':_0x1cc0b3,'value':_0xb0b1a8+''});}router[_0x44b2cd(0x153)](_0x44b2cd(0xb4),(_0x134297,_0x3a4f38,_0xdd4c28)=>{const _0x2edfbd=_0x44b2cd;let _0x5d300b=_0x134297[_0x2edfbd(0x172)][_0x2edfbd(0x12a)];if(_0x134297[_0x2edfbd(0xc6)]['is_admin']!=0x1)return _0x3a4f38['json']({'code':0x66});if(_0x5d300b)fs['access'](_0x5d300b,fs[_0x2edfbd(0xa1)]['W_OK']|fs[_0x2edfbd(0xa1)][_0x2edfbd(0x141)],_0x1f78d0=>{const _0x34241a=_0x2edfbd;return!_0x1f78d0?(saveConfig(_0x134297[_0x34241a(0xe3)]['dbOther'],_0x34241a(0x175),_0x5d300b),_0x3a4f38[_0x34241a(0xdc)]({'code':0x0})):fileUtil[_0x34241a(0xc4)](_0x3a4f38,_0x1f78d0);});else return dbConfigTable[_0x2edfbd(0x14f)](_0x134297[_0x2edfbd(0xe3)]['dbOther'],'cacheParentPath'),_0x3a4f38[_0x2edfbd(0xdc)]({'code':0x0});});function _0x5d9a(_0x6f3759,_0x18256f){const _0x5a7c47=_0x5a7c();return _0x5d9a=function(_0x5d9aef,_0x17a40d){_0x5d9aef=_0x5d9aef-0x90;let _0x26123e=_0x5a7c47[_0x5d9aef];return _0x26123e;},_0x5d9a(_0x6f3759,_0x18256f);}let forbiddenPorts=[0x1,0x7,0x9,0xb,0xd,0xf,0x11,0x13,0x14,0x15,0x16,0x17,0x19,0x25,0x2a,0x2b,0x35,0x4d,0x4f,0x57,0x5f,0x65,0x66,0x67,0x68,0x6d,0x6e,0x6f,0x71,0x73,0x75,0x77,0x7b,0x87,0x8b,0x8f,0xb3,0x185,0x1d1,0x200,0x201,0x202,0x203,0x20e,0x212,0x213,0x214,0x21c,0x22c,0x233,0x24b,0x259,0x27c,0x3e1,0x3e3,0x801,0xe4b,0xfcd,0x1770,0x1a09,0x1a0a,0x1a0b,0x1a0c,0x1a0d,0xd3d];router['post']('/saveConfig',(_0x26c824,_0x5ab269,_0x5a51fb)=>{const _0x40c7dd=_0x44b2cd;let _0x25f0ab=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x182)],_0x23c85e=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0xad)],_0x3a7dd2=_0x26c824['body'][_0x40c7dd(0xff)],_0x53197f=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x96)],_0x30f75b=_0x26c824[_0x40c7dd(0x172)]['FTPPort'],_0x2ac69f=_0x26c824['body'][_0x40c7dd(0xef)],_0x4379b3=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x111)],_0xc25847=_0x26c824['body'][_0x40c7dd(0xd6)],_0x5defc6=_0x26c824['body'][_0x40c7dd(0x170)],_0x3b6ee0=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x16a)],_0x33b35d=_0x26c824[_0x40c7dd(0x172)]['httpsCert'],_0x3ed1cc=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x102)],_0x1b0ddd=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0xca)],_0x3defdf=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0xa2)],_0x2723d7=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x146)],_0x5ae2fa=_0x26c824['body'][_0x40c7dd(0xf0)],_0x564789=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x138)],_0x1415f6=_0x26c824['body'][_0x40c7dd(0x15a)],_0x57e02f=_0x26c824['body'][_0x40c7dd(0xfb)],_0x12e44e=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x15e)],_0x22c72c=_0x26c824['body'][_0x40c7dd(0x134)],_0x91eb82=_0x26c824['body'][_0x40c7dd(0x9a)],_0x4fdb18=_0x26c824['body'][_0x40c7dd(0x183)],_0x43ec13=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x13b)],_0x53af2c=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0xfe)],_0x2f9ea6=_0x26c824['app']['dbOther'],_0x48f0d5=_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x15f)];if(_0x48f0d5&&_0x48f0d5[_0x40c7dd(0xdb)]()){_0x48f0d5=_0x48f0d5[_0x40c7dd(0x92)]()[_0x40c7dd(0xdb)]();if(_0x48f0d5['length']>0x20||!/^[a-zA-Z0-9]+$/[_0x40c7dd(0x162)](_0x48f0d5))return _0x26c824['app']['returnErrMsg'](_0x5ab269,'Root\x20path\x20must\x20be\x2032\x20characters\x20or\x20less\x20and\x20contain\x20only\x20letters\x20and\x20numbers');if(['music',_0x40c7dd(0x103),_0x40c7dd(0xf2),_0x40c7dd(0x177),_0x40c7dd(0xa8),_0x40c7dd(0x17c),_0x40c7dd(0xb0)]['includes'](_0x48f0d5))return _0x26c824[_0x40c7dd(0xe3)]['returnErrMsg'](_0x5ab269,_0x5ab269['__'](_0x40c7dd(0x9e))+(':'+_0x48f0d5),'dialog');saveConfig(_0x2f9ea6,'serverRootPath',_0x48f0d5);}if(_0x26c824[_0x40c7dd(0xc6)]['is_admin']!=0x1)return _0x5ab269[_0x40c7dd(0xdc)]({'code':0x66});let _0x39552f=0xffdc;if(_0x25f0ab>_0x39552f||_0x3a7dd2>_0x39552f||_0x30f75b>_0x39552f||_0x53197f>_0x39552f)return _0x5ab269[_0x40c7dd(0xdc)]({'code':0x1,'message':_0x40c7dd(0x98)});_0x91eb82&&saveConfig(_0x2f9ea6,_0x40c7dd(0x9a),JSON[_0x40c7dd(0x18d)](_0x91eb82));_0x43ec13&&saveConfig(_0x2f9ea6,_0x40c7dd(0x13b),_0x43ec13);_0x564789&&saveConfig(_0x2f9ea6,_0x40c7dd(0x138),JSON[_0x40c7dd(0x18d)](_0x564789));_0x4fdb18&&parseInt(_0x4fdb18)!=NaN&&_0x4fdb18>0x0&&_0x4fdb18<0x5f5e0ff&&saveConfig(_0x2f9ea6,_0x40c7dd(0x183),_0x4fdb18);_0x1415f6&&saveConfig(_0x2f9ea6,'excludePathPhoto',JSON[_0x40c7dd(0x18d)](_0x1415f6));_0x2723d7&&saveConfig(_0x2f9ea6,_0x40c7dd(0x146),_0x2723d7);if(_0x57e02f){let _0x148e45=netUtils[_0x40c7dd(0x1a0)](_0x26c824);if(_0x148e45==_0x40c7dd(0x101)){for(let _0x6e68f3 in _0x57e02f){let _0x59c486=_0x57e02f[_0x6e68f3],_0x18f264=fs[_0x40c7dd(0x155)](_0x59c486);if(!_0x18f264)return _0x26c824['app']['returnErrMsg'](_0x5ab269,_0x5ab269['__'](_0x40c7dd(0xb9))+':'+_0x59c486);fileUtil[_0x40c7dd(0x190)](_0x59c486)&&(_0x57e02f[_0x6e68f3]=_0x59c486[_0x40c7dd(0xf5)]());}saveConfig(_0x2f9ea6,'excludePathFolderBrowser',JSON[_0x40c7dd(0x18d)](_0x57e02f));}else return _0x26c824[_0x40c7dd(0xe3)][_0x40c7dd(0xdf)](_0x5ab269,_0x5ab269['__'](_0x40c7dd(0x130)));}_0x12e44e&&saveConfig(_0x2f9ea6,_0x40c7dd(0x15e),JSON[_0x40c7dd(0x18d)](_0x12e44e));_0x22c72c&&saveConfig(_0x2f9ea6,_0x40c7dd(0x134),JSON[_0x40c7dd(0x18d)](_0x22c72c));if(_0x25f0ab){if(forbiddenPorts[_0x40c7dd(0x110)](parseInt(_0x25f0ab)))return _0x26c824[_0x40c7dd(0xe3)][_0x40c7dd(0xdf)](_0x5ab269,_0x5ab269['__'](_0x40c7dd(0xa6))+_0x40c7dd(0x12c));saveConfig(_0x2f9ea6,_0x40c7dd(0x182),parseInt(_0x25f0ab));}if(_0x23c85e){if(forbiddenPorts['includes'](parseInt(_0x23c85e))||_0x23c85e==_0x25f0ab)return _0x26c824[_0x40c7dd(0xe3)]['returnErrMsg'](_0x5ab269,_0x5ab269['__']('setting.portInvalid')+_0x40c7dd(0x19d));saveConfig(_0x2f9ea6,_0x40c7dd(0xad),parseInt(_0x23c85e));}_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0xb3)]&&saveConfig(_0x2f9ea6,_0x40c7dd(0xb3),_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0xb3)]);_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0xec)]&&(saveConfig(_0x2f9ea6,_0x40c7dd(0xec),_0x26c824['body'][_0x40c7dd(0xec)]),_0x26c824['app']['refreshIpList']());_0x26c824[_0x40c7dd(0x172)]['ipDetection']&&saveConfig(_0x2f9ea6,_0x40c7dd(0x135),_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x135)]);_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x163)]&&saveConfig(_0x2f9ea6,_0x40c7dd(0x163),_0x26c824[_0x40c7dd(0x172)][_0x40c7dd(0x163)]);_0x3a7dd2&&saveConfig(_0x2f9ea6,_0x40c7dd(0xff),parseInt(_0x3a7dd2));_0x53197f&&saveConfig(_0x2f9ea6,'webDavPortHttps',parseInt(_0x53197f));_0x30f75b&&saveConfig(_0x2f9ea6,'FTPPort',parseInt(_0x30f75b));_0x2ac69f&&saveConfig(_0x2f9ea6,'autoLaunch',_0x2ac69f);_0x4379b3&&saveConfig(_0x2f9ea6,_0x40c7dd(0x111),_0x4379b3);_0xc25847&&saveConfig(_0x2f9ea6,'autoShowWindow',_0xc25847);_0x5defc6&&saveConfig(_0x2f9ea6,_0x40c7dd(0x170),_0x5defc6);let _0x5d57d2=dbConfigTable[_0x40c7dd(0x10f)](_0x26c824['app'][_0x40c7dd(0xbb)],'useNasCabCerts');if(!_0x5d57d2||_0x5d57d2[_0x40c7dd(0xc8)]==0x0){if(_0x3b6ee0!='*'&&_0x33b35d!='*'){if(_0x3b6ee0&&_0x33b35d){if(!_0x3b6ee0[_0x40c7dd(0x18f)]('-----')||!_0x33b35d[_0x40c7dd(0x18f)]('-----'))return _0x26c824[_0x40c7dd(0xe3)][_0x40c7dd(0xdf)](_0x5ab269,_0x5ab269['__'](_0x40c7dd(0x95)));const _0x358529=testCertAndKeyMatch(_0x33b35d,_0x3b6ee0);if(!_0x358529)return _0x26c824[_0x40c7dd(0xe3)]['returnErrMsg'](_0x5ab269,_0x5ab269['__'](_0x40c7dd(0x95)));saveConfig(_0x2f9ea6,_0x40c7dd(0x16a),_0x3b6ee0),saveConfig(_0x2f9ea6,_0x40c7dd(0xeb),_0x33b35d);}else saveConfig(_0x2f9ea6,_0x40c7dd(0x16a),''),saveConfig(_0x2f9ea6,'httpsCert','');}}_0x53af2c&&saveConfig(_0x2f9ea6,_0x40c7dd(0xfe),_0x53af2c);_0x53af2c=dbConfigTable[_0x40c7dd(0x10f)](_0x26c824[_0x40c7dd(0xe3)][_0x40c7dd(0xbb)],_0x40c7dd(0xfe));if(!_0x53af2c||_0x53af2c[_0x40c7dd(0xc8)]==0x0){if(_0x3ed1cc!='*'&&_0x1b0ddd!='*'){if(_0x3ed1cc&&_0x1b0ddd){if(!_0x3ed1cc[_0x40c7dd(0x18f)](_0x40c7dd(0xc3))||!_0x1b0ddd[_0x40c7dd(0x18f)](_0x40c7dd(0xc3)))return _0x26c824[_0x40c7dd(0xe3)][_0x40c7dd(0xdf)](_0x5ab269,_0x5ab269['__'](_0x40c7dd(0x95)));const _0x4af8ef=testCertAndKeyMatch(_0x3ed1cc,_0x1b0ddd);if(!_0x4af8ef)return _0x26c824[_0x40c7dd(0xe3)]['returnErrMsg'](_0x5ab269,_0x5ab269['__'](_0x40c7dd(0x95)));saveConfig(_0x2f9ea6,'webDavHttpsKey',_0x3ed1cc),saveConfig(_0x2f9ea6,_0x40c7dd(0xca),_0x1b0ddd);}else saveConfig(_0x2f9ea6,_0x40c7dd(0x102),''),saveConfig(_0x2f9ea6,_0x40c7dd(0xca),'');}}_0x3defdf&&saveConfig(_0x2f9ea6,'language',_0x3defdf);if(_0x5ae2fa){if(_0x5ae2fa>OS[_0x40c7dd(0xd3)]()[_0x40c7dd(0x195)])return _0x26c824[_0x40c7dd(0xe3)]['returnErrMsg'](_0x5ab269,_0x5ab269['__']('maxThreadCountIs')+OS['cpus']()[_0x40c7dd(0x195)]);saveConfig(_0x2f9ea6,_0x40c7dd(0xf0),_0x5ae2fa);}return _0x5ab269[_0x40c7dd(0xdc)]({'code':0x0});}),router['post'](_0x44b2cd(0xa7),(_0x29f989,_0x620f3a,_0x25d26d)=>{const _0x5340c0=_0x44b2cd;if(_0x29f989[_0x5340c0(0xc6)][_0x5340c0(0x149)]!=0x1)return _0x620f3a['json']({'code':0x66});let _0x33dced=_0x29f989[_0x5340c0(0xe3)]['dbOther'],_0x33a25a=_0x29f989['body'][_0x5340c0(0x181)],_0x465960=_0x29f989['body'][_0x5340c0(0x90)],_0x3357f1=_0x29f989[_0x5340c0(0x172)][_0x5340c0(0xc5)],_0x3f1508=_0x29f989['body'][_0x5340c0(0xf7)],_0x59e5f5=_0x29f989[_0x5340c0(0x172)]['photoPreviewType'],_0x78a4b6=_0x29f989[_0x5340c0(0x172)][_0x5340c0(0x16e)];_0x59e5f5&&saveConfig(_0x33dced,'photoPreviewType',_0x59e5f5);_0x78a4b6&&saveConfig(_0x33dced,_0x5340c0(0x16e),_0x78a4b6);if(_0x33a25a){if(_0x33a25a==0x1){if(OS[_0x5340c0(0x15d)]()/0x400/0x400/0x400<0x3)return _0x29f989['app']['returnErrMsg'](_0x620f3a,_0x620f3a['__'](_0x5340c0(0x164)));}saveConfig(_0x33dced,'aiClassesEnable',_0x33a25a);if(_0x33a25a==0x1)process[_0x5340c0(0x93)]({'type':_0x5340c0(0xed)});}_0x3f1508&&saveConfig(_0x33dced,_0x5340c0(0xf7),_0x3f1508);if(_0x465960){if(_0x465960==0x1){if(OS['totalmem']()/0x400/0x400/0x400<0x3)return _0x29f989[_0x5340c0(0xe3)][_0x5340c0(0xdf)](_0x620f3a,_0x620f3a['__']('memTooLess'));}saveConfig(_0x33dced,_0x5340c0(0x90),_0x465960);if(_0x465960==0x1)process[_0x5340c0(0x93)]({'type':_0x5340c0(0xe6)});}if(_0x3357f1){saveConfig(_0x33dced,'aiSimilarPhotoEnable',_0x3357f1);if(_0x3357f1==0x1)process['send']({'type':'startSimilarPhotoWork'});}return _0x620f3a[_0x5340c0(0xdc)]({'code':0x0});}),router[_0x44b2cd(0x153)]('/saveConfigCustom',(_0xc7518e,_0x4723be,_0x2fa3d9)=>{const _0x113345=_0x44b2cd;if(_0xc7518e[_0x113345(0xc6)][_0x113345(0x149)]!=0x1)return _0x4723be['json']({'code':0x66});let _0x51e41b=_0xc7518e[_0x113345(0xe3)][_0x113345(0xbb)],_0xbcf0b9=_0xc7518e['body'][_0x113345(0xfd)],_0xcbac72=_0xc7518e[_0x113345(0x172)]['customLogoImage'],_0x100e16=_0xc7518e['body'][_0x113345(0x104)],_0x2b0261=_0xc7518e[_0x113345(0x172)]['customHomeBgImage'];function _0x2206bf(_0xb45e53,_0x253ff9,_0x4b8df3){const _0x4375cb=_0x113345;if(_0x253ff9=='-')return saveConfig(_0x51e41b,_0xb45e53,'-'),_0x4723be[_0x4375cb(0xdc)]({'code':0x0});if(fs[_0x4375cb(0x155)](_0x253ff9)){let _0xcea70c=path[_0x4375cb(0x199)](config[_0x4375cb(0x99)],_0x4375cb(0x17e));function _0x2200dd(){const _0x40c462=_0x4375cb;let _0x14e68a=path['join'](_0xcea70c,_0xb45e53+_0x40c462(0x18b));sharp(path[_0x40c462(0x199)](_0x253ff9))[_0x40c462(0x133)]({'width':_0x4b8df3,'withoutEnlargement':!![]})[_0x40c462(0x14e)]()[_0x40c462(0x17a)]()[_0x40c462(0xda)](_0x14e68a)[_0x40c462(0xdd)](()=>{return saveConfig(_0x51e41b,_0xb45e53,_0x14e68a),_0x4723be['json']({'code':0x0});})[_0x40c462(0x122)](()=>{const _0x2a5bb9=_0x40c462;return _0xc7518e['app']['returnErrMsg'](_0x4723be,_0x4723be['__'](_0x2a5bb9(0x145)));});}!fs[_0x4375cb(0x155)](_0xcea70c)?fs[_0x4375cb(0xd8)](_0xcea70c,{'recursive':!![]},_0x14b1e7=>{const _0xd461a=_0x4375cb;if(_0x14b1e7)return _0xc7518e['app'][_0xd461a(0xdf)](_0x4723be,_0x4723be['__'](_0xd461a(0x145)));_0x2200dd();}):_0x2200dd();}else return _0xc7518e['app'][_0x4375cb(0xdf)](_0x4723be,_0x4723be['__'](_0x4375cb(0xb9))+_0x253ff9);}if(_0xbcf0b9)return saveConfig(_0x51e41b,_0x113345(0xfd),_0xbcf0b9),_0x4723be[_0x113345(0xdc)]({'code':0x0});_0xcbac72&&_0x2206bf(_0x113345(0xe8),_0xcbac72,0xc8),_0x100e16&&_0x2206bf(_0x113345(0x104),_0x100e16,0x3e8),_0x2b0261&&_0x2206bf(_0x113345(0x152),_0x2b0261,0xf14);}),router[_0x44b2cd(0x153)](_0x44b2cd(0x9d),(_0x23a0ff,_0x39058c,_0x566a0f)=>{const _0x3621b3=_0x44b2cd;let _0x335bb7=_0x23a0ff['app'][_0x3621b3(0xbb)],_0x233e59=_0x23a0ff[_0x3621b3(0x172)]['subtitleSize'],_0x2393cd=_0x23a0ff['body'][_0x3621b3(0x107)],_0xc37508=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0xab)],_0x2a4514=_0x23a0ff['body'][_0x3621b3(0x100)],_0x757921=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0x97)],_0x4d84b3=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0x168)],_0x2536f0=_0x23a0ff[_0x3621b3(0x172)]['movieShowMatchName'],_0x156edb=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0x9f)],_0x5db8bf=_0x23a0ff['body'][_0x3621b3(0x131)],_0x775ec1=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0x91)],_0x40125f=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0xe2)],_0x48b219=_0x23a0ff['body'][_0x3621b3(0xe0)],_0x5bb7f8=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0xe1)],_0x39001c=_0x23a0ff[_0x3621b3(0x172)]['movieTmdbApiUrl'],_0x41cd09=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0xd9)],_0x512a43=_0x23a0ff[_0x3621b3(0x172)]['movieDatabaseType'],_0x2841d8=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0x128)],_0x14eca0=_0x23a0ff[_0x3621b3(0x172)]['tmdbProxyEnable'],_0xa7394a=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0xc1)],_0x45d9ae=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0x173)];if(_0x23a0ff[_0x3621b3(0xc6)][_0x3621b3(0x149)]!=0x1)return _0x39058c[_0x3621b3(0xdc)]({'code':0x66});_0x5bb7f8&&saveConfig(_0x335bb7,_0x3621b3(0xe1),_0x5bb7f8);(_0x14eca0==0x1||_0x14eca0==0x0)&&saveConfig(_0x335bb7,_0x3621b3(0x116),_0x14eca0);_0xa7394a&&saveConfig(_0x335bb7,_0x3621b3(0xc1),_0xa7394a?_0xa7394a:'');_0x39001c!=null&&saveConfig(_0x335bb7,_0x3621b3(0x18e),_0x39001c?_0x39001c:'');_0x41cd09!=null&&saveConfig(_0x335bb7,_0x3621b3(0xd9),_0x41cd09?_0x41cd09:'');_0x512a43&&saveConfig(_0x335bb7,'movieDatabaseType',_0x512a43);_0x48b219&&saveConfig(_0x335bb7,'moviePlaylongPressRate',_0x48b219);_0x2841d8&&saveConfig(_0x335bb7,_0x3621b3(0x128),_0x2841d8);_0x45d9ae&&saveConfig(_0x335bb7,_0x3621b3(0x173),_0x45d9ae);let _0x112f17=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0x197)],_0x472ebc=_0x23a0ff[_0x3621b3(0x172)]['movieHomeShowHistory'],_0x25be70=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0xf3)];(_0x112f17==0x1||_0x112f17==0x0)&&saveConfig(_0x335bb7,_0x3621b3(0x197),_0x112f17);(_0x472ebc==0x1||_0x472ebc==0x0)&&saveConfig(_0x335bb7,_0x3621b3(0xc9),_0x472ebc);(_0x25be70==0x1||_0x25be70==0x0)&&saveConfig(_0x335bb7,_0x3621b3(0xf3),_0x25be70);let _0x3fd83c=_0x23a0ff[_0x3621b3(0x172)][_0x3621b3(0xc7)];if(_0x3fd83c&&(_0x3fd83c<0x1||_0x3fd83c>0x33))return _0x39058c[_0x3621b3(0xdc)]({'code':0x1,'message':_0x3621b3(0x14a)});let _0x3478ab=[_0x3621b3(0xea),_0x3621b3(0x11f),_0x3621b3(0xf4),_0x3621b3(0x165)];_0x775ec1&&_0x3478ab[_0x3621b3(0x110)](_0x775ec1)&&saveConfig(_0x335bb7,_0x3621b3(0x91),_0x775ec1);_0x2536f0&&saveConfig(_0x335bb7,_0x3621b3(0x9c),_0x2536f0);_0x156edb&&saveConfig(_0x335bb7,_0x3621b3(0x9f),_0x156edb);_0x3fd83c&&saveConfig(_0x335bb7,'crf',parseInt(_0x3fd83c));_0x233e59&&saveConfig(_0x335bb7,_0x3621b3(0x12d),_0x233e59);_0x40125f&&saveConfig(_0x335bb7,_0x3621b3(0xe2),_0x40125f);_0x2393cd&&saveConfig(_0x335bb7,_0x3621b3(0x107),_0x2393cd);_0xc37508&&saveConfig(_0x335bb7,_0x3621b3(0xfc),_0xc37508);_0x2a4514&&saveConfig(_0x335bb7,_0x3621b3(0x150),_0x2a4514);if(_0x757921){try{_0x757921=parseInt(_0x757921);if(_0x757921>0x1e)_0x757921=0x1e;if(_0x757921<0x2)_0x757921=0x2;}catch(_0x321507){_0x757921=0x5;}saveConfig(_0x335bb7,_0x3621b3(0x176),_0x757921);}return _0x5db8bf&&(saveConfig(_0x335bb7,_0x3621b3(0x131),_0x5db8bf),_0x5db8bf=='1'&&process[_0x3621b3(0x93)]({'type':_0x3621b3(0xc2)})),_0x4d84b3?saveConfig(_0x335bb7,_0x3621b3(0x168),_0x4d84b3):dbConfigTable[_0x3621b3(0x14f)](_0x335bb7,_0x3621b3(0x168)),_0x39058c[_0x3621b3(0xdc)]({'code':0x0});}),router['post'](_0x44b2cd(0x144),(_0x29cfca,_0x4b9aaa,_0x14cf67)=>{const _0x4e4118=_0x44b2cd;let _0x1813c5=_0x29cfca['app']['dbOther'];if(_0x29cfca[_0x4e4118(0xc6)][_0x4e4118(0x149)]!=0x1)return _0x4b9aaa[_0x4e4118(0xdc)]({'code':0x66});function _0x4168ad(){const _0x12d4e4=_0x4e4118;let _0x4d0dca=_0x29cfca['body'][_0x12d4e4(0xd5)]||_0x12d4e4(0x12e),_0x3b7782=[_0x12d4e4(0x12e),_0x12d4e4(0x178)];return _0x3b7782[_0x12d4e4(0x110)](_0x4d0dca)&&saveConfig(_0x1813c5,'music-TitleType',_0x4d0dca),_0x4b9aaa[_0x12d4e4(0xdc)]({'code':0x0});}_0x4168ad();}),router[_0x44b2cd(0x153)]('/getSystemInfo',(_0x485956,_0x4ce23f,_0x51e9bc)=>{const _0x363199=_0x44b2cd;if(_0x485956['currentUser'][_0x363199(0x149)]!=0x1)return _0x4ce23f[_0x363199(0xdc)]({'code':0x66});let _0xa85e7={};_0xa85e7['databaseFolder']=path[_0x363199(0x199)](config[_0x363199(0x99)],_0x363199(0x13f)),_0xa85e7[_0x363199(0x14c)]=config[_0x363199(0x175)],fs[_0x363199(0x191)](_0xa85e7['imgFolder'],fs[_0x363199(0xa1)]['R_OK']|fs[_0x363199(0xa1)][_0x363199(0x125)],_0x1b4f11=>{const _0x3c3437=_0x363199;_0xa85e7[_0x3c3437(0xb2)]=0x1;_0x1b4f11&&(_0xa85e7[_0x3c3437(0xb2)]=0x0);let _0x1ac083=dbConfigTable[_0x3c3437(0x10f)](_0x485956[_0x3c3437(0xe3)]['dbOther'],_0x3c3437(0xd2));return _0x1ac083?_0xa85e7[_0x3c3437(0xd2)]=JSON[_0x3c3437(0x137)](_0x1ac083['value']):_0xa85e7['cacheImageInfo']=![],_0xa85e7[_0x3c3437(0xe9)]=config[_0x3c3437(0xe9)],_0x4ce23f['json']({'code':0x0,'data':_0xa85e7});});}),router[_0x44b2cd(0x153)](_0x44b2cd(0xb6),(_0x3fb03a,_0x107d3e,_0x5c389f)=>{const _0x541def=_0x44b2cd;if(dbUserTable['isAdmin'](_0x3fb03a,_0x107d3e)!==!![])return;if(OS['platform']()!=_0x541def(0x19b)&&OS[_0x541def(0xde)]()!=_0x541def(0x139))return _0x3fb03a['app']['returnErrMsg'](_0x107d3e,_0x107d3e['__'](_0x541def(0x192)));return process['send']({'type':_0x541def(0xb7)}),_0x107d3e['json']({'code':0x0});}),router[_0x44b2cd(0x153)](_0x44b2cd(0x17d),(_0x2fad88,_0x144720,_0x397948)=>{const _0x1bd926=_0x44b2cd;if(_0x2fad88['currentUser']['is_admin']!=0x1)return _0x144720[_0x1bd926(0xdc)]({'code':0x66});let _0xbfc2c2=path['join'](config[_0x1bd926(0x175)],_0x1bd926(0x112));fs[_0x1bd926(0x15b)](_0xbfc2c2,(_0x4eac68,_0x55d38d)=>{if(_0x4eac68)return;fs['rm'](_0xbfc2c2,{'recursive':!![]},_0x31ed78=>{const _0x294ddc=_0x5d9a;fs[_0x294ddc(0xd8)](_0xbfc2c2,{'recursive':!![]},_0x1732dd=>{const _0x2b862c=_0x294ddc;console[_0x2b862c(0xf9)](_0x1732dd);});if(_0x31ed78)return fileUtil['returnFileError'](_0x144720,_0x31ed78);return dbConfigTable[_0x294ddc(0x14f)](_0x2fad88[_0x294ddc(0xe3)][_0x294ddc(0xbb)],_0x294ddc(0xd2)),_0x144720[_0x294ddc(0xdc)]({'code':0x0});});});let _0x1529bf=path[_0x1bd926(0x199)](config['cacheParentPath'],_0x1bd926(0x127)),_0x225766=path['join'](config['cacheParentPath'],'subtitle','upload');fs[_0x1bd926(0x15b)](_0x1529bf,(_0x533f1a,_0x5df9af)=>{if(_0x533f1a)return;fs['rm'](_0x1529bf,{'recursive':!![]},_0x340d92=>{const _0x4f1bf0=_0x5d9a;fs[_0x4f1bf0(0xd8)](_0x225766,{'recursive':!![]},_0x3a875c=>{const _0x1fa53b=_0x4f1bf0;console[_0x1fa53b(0xf9)](_0x3a875c);});if(_0x340d92)return fileUtil[_0x4f1bf0(0xc4)](_0x144720,_0x340d92);});});}),router[_0x44b2cd(0x153)](_0x44b2cd(0x142),(_0x59848c,_0x174724,_0x19f7f1)=>{const _0x391788=_0x44b2cd;if(dbUserTable[_0x391788(0x179)](_0x59848c,_0x174724)!==!![])return;let _0xe788a1=_0x59848c[_0x391788(0x172)][_0x391788(0xba)],_0x5e0824=[_0x391788(0xb1),'bios',_0x391788(0xb8),_0x391788(0x118),_0x391788(0x174),_0x391788(0xa0),_0x391788(0x166),_0x391788(0x132),'battery',_0x391788(0xd0),'osInfo',_0x391788(0x158),'usb',_0x391788(0x171),_0x391788(0x194),_0x391788(0x18a),'bluetoothDevices'];if(!_0x5e0824[_0x391788(0x110)](_0xe788a1))return _0x59848c['app'][_0x391788(0xdf)](_0x174724,_0x391788(0x117));si[_0xe788a1](_0x3f610c=>{const _0x4edebb=_0x391788;try{return _0x174724['json']({'code':0x0,'data':_0x3f610c});}catch(_0x3d2f6b){console[_0x4edebb(0xf9)](_0x4edebb(0xa3),_0x3d2f6b);}});}),router['post'](_0x44b2cd(0x11a),(_0x1d2b37,_0x2c8681,_0x1ba51d)=>{const _0x54f931=_0x44b2cd;let _0x3c1d25=netUtils[_0x54f931(0x1a0)](_0x1d2b37);if(_0x3c1d25!=_0x54f931(0x101))return _0x1d2b37[_0x54f931(0xe3)][_0x54f931(0xdf)](_0x2c8681,_0x2c8681['__'](_0x54f931(0x145)));let _0x43d686=_0x1d2b37[_0x54f931(0x172)][_0x54f931(0x11c)],_0x59834e=_0x1d2b37[_0x54f931(0x172)][_0x54f931(0x12e)],_0x4ca7a8=_0x1d2b37[_0x54f931(0x172)][_0x54f931(0x148)];if(!_0x4ca7a8)try{_0x4ca7a8=path[_0x54f931(0x199)](_0x43d686,_0x59834e);}catch(_0x53cf41){console[_0x54f931(0xf9)](_0x53cf41);}if(!_0x4ca7a8)return _0x1d2b37['app'][_0x54f931(0xdf)](_0x2c8681,'need\x20path');if(dbUserTable[_0x54f931(0x19a)](_0x1d2b37,_0x2c8681,'folder',_0x54f931(0xf6),'')==!![]){let _0x1c318c=_0x1d2b37['body'][_0x54f931(0xee)]||_0x54f931(0x11b);process[_0x54f931(0x93)]({'type':_0x54f931(0x169),'shellType':_0x1c318c,'path':_0x4ca7a8});let _0x379a08={'code':0x0};return _0x2c8681[_0x54f931(0xdc)](_0x379a08);}}),module['exports']=router;