const _0x792809=_0x248b;function _0x248b(_0xaa3249,_0x5ba486){const _0xe19d9e=_0xe19d();return _0x248b=function(_0x248bdb,_0x1101f9){_0x248bdb=_0x248bdb-0x68;let _0x334c8a=_0xe19d9e[_0x248bdb];return _0x334c8a;},_0x248b(_0xaa3249,_0x5ba486);}(function(_0xd57714,_0x15e4f6){const _0x5e3c7d=_0x248b,_0x4ddd32=_0xd57714();while(!![]){try{const _0xaf4c6=parseInt(_0x5e3c7d(0xed))/0x1+parseInt(_0x5e3c7d(0x7e))/0x2+parseInt(_0x5e3c7d(0x7f))/0x3+-parseInt(_0x5e3c7d(0xd8))/0x4*(-parseInt(_0x5e3c7d(0x162))/0x5)+parseInt(_0x5e3c7d(0x159))/0x6*(parseInt(_0x5e3c7d(0x73))/0x7)+parseInt(_0x5e3c7d(0x6b))/0x8+-parseInt(_0x5e3c7d(0x8e))/0x9;if(_0xaf4c6===_0x15e4f6)break;else _0x4ddd32['push'](_0x4ddd32['shift']());}catch(_0x2591b2){_0x4ddd32['push'](_0x4ddd32['shift']());}}}(_0xe19d,0x34489));var express=require('express'),router=express[_0x792809(0x106)]();let config=require(_0x792809(0xd3)),dbFileIndexTable=require(_0x792809(0x116)),dbConfigTable=require(_0x792809(0x89)),dbSourceTable=require('../../db/dbSourceFolderTable'),dbNoticeCenterTable=require('../../db/dbNoticeCenterTable'),netUtils=require(_0x792809(0x85));const dbUserTable=require(_0x792809(0x7b)),dbBackupTask=require(_0x792809(0x12f)),OS=require('os');let path=require('path'),fs=require('fs'),fileUtil=require(_0x792809(0x111));function _0xe19d(){const _0x4a36f9=['wifiNetworks','autoHardAccDecode','length','/getSystemInfo','taskState','webDavUseApiCert','INDEX_TABLE_NAME_MOVIE','getAllIndexInfo','audio','../../../package.json','/changeCachePath','tmdbProxyUrl','/getLanguage',':https','ip\x20not\x20allow','join','dialog','/getBgTask','findByTitle','post','Router','currentUser','webDavPort','rotate','resize','/vaccumDb','shell','graphics','movieHomeShowLibrary','region','returnErrMsg','../utils/fileUtils','run','INDEX_TABLE_NAME_PHOTO','platform','/getVersionInfo','../../db/dbFileIndexTable','body','photo','toUpperCase','slow','threadCount','useFolderPictureAsPoster','startUpdate','ddnsIpv6Address','getUpdateInfo','subtitle','diskLayout','showMenuArr','trim','deleteByTitle','folderNotExist','INDEX_TABLE_NAME_BOOK','aiFaceMinPhotoCount','defaultTranscodeResolution','offset','ultrafast','exports','movieHomeShowHistory','parse','transcodePath','../../db/dbBackupTask','test','\x27,\x27','totalmem','serverType','globalIndexInfo','cachePathInvalid','port:\x20256-65500','hostname','send','imgFolderUsable','all','httpsKey','notSupportForAutoUpdate','language','win32','constants','exec','movieTmdbApiKey','isWinDisk','networkInterfaces','userDataFolder','transCodeCoderNameHevc','.webp','taskId','task_id','vacuum','aiSimilarPhotoEnable','apiPort','err','defaultApiPort','defaultFTPPort','title',':http','subtitlePreGen','R_OK','getUnReadCount','crf','excludePathFolderBrowser','transCodeReadRate','ipDetection','BACKUP','2544558ztQlDv','twoStepLogin','apiPortHttps','existsSync','note','/relaunch','FTPPort','is_admin','aiClassesEnable','131545LqTDtM','autoLoginClient','task_name','access','excludeFilenameMovie','then','chassis','value','dbFileIndex','getIpList','transCodeCoderNameH264','\x20title\x20in\x20(\x27globalCpuInfo\x27,\x27globalMemInfo\x27,\x27','fast','total_size','unreadMsgCount','api','bluetoothDevices','cpus','version','maxThreadCountIs','getClientIpWithOutXforwarded','2703920MLPsxe','returnFileError','file','Relaunch','dbOther','cacheImageInfo','autoShowWindow','power_get','7kkeUiM','system','stringify','localhost','reloadHomePage','mem','id3tag','filename','../../db/dbUserTable','need\x20path','notSupport','664992QwFBdd','371823leFQSW','refreshIpList','defaultWebDavPortHttps','movieTmdbApiUrl','autoScanSource','excludePathMovie','../utils/netUtils','httpsCert','getAllRecordByWhere','stat','../../db/dbConfigTable','log','/updateNewVersion','customHomeBgImage','getGlobalInfo','15177816Ebwmmc','/refreshHomePage','serverRootError','startSimilarPhotoWork','ipBan','webDavHttpsKey','fullPath','movieTmdbLanguage','/clearCache','startsWith','onlySupportOnServerApp','openType','/setLanguage','copy_size','defaultApiPortHttps','cacheParentPath','getClientIp','movieDatabaseType','setting.portInvalid','aiFaceEnable','/deleteBgTask','subtitleSize','getDiskInfo','serverRootPath','webDavHttpsCert','medium','transCodeParams-CoderNameH264','force','tmdbProxyEnable','count','START_PRE_GEN_SUBTITLE','Root\x20path\x20must\x20be\x2032\x20characters\x20or\x20less\x20and\x20contain\x20only\x20letters\x20and\x20numbers','movieShowMatchName','toFile','baseboard','CRF:\x201-51','wal_checkpoint(RESTART)','clearTable','ipMode','findByTitleParamsList','systeminformation','transcodeSpeed','photoPreviewType','allConfig','includes','/saveConfigCustom','memLayout','darwin','startClassesAiWork','folder','/getServerState','customShareUrl','customLogoImage','transCodeParams-CoderNameHevc','memTooLess','autoLaunch','getAllByWhere','prepare','../utils/sqliteUtil','osInfo','music','tokenKeepHour','moviePreferLanguage','json','create','movieHomeShowMyMedia','cpuTemperature','\x20status=\x27running\x27\x20or\x20status=\x27waiting\x27','W_OK','../../myConfig/config','music-TitleType','tls','customLoginTitle','mkdir','52sLzhPx','app','useNasCabCerts','refreshHomePage','-----','isAdmin','/saveConfigMusic','doUserCanGet','httpsCertError','/getSystemState','customLoginImage','cachePath','excludePathPhoto','webDavPortHttps','pragma','upload','photoPreviewSize','/saveServerRootPath','excludeFilenamePhoto','defaultMoviePlay','sharp','340040lWfVpV','operationFail','/resetIndex','book','type'];_0xe19d=function(){return _0x4a36f9;};return _0xe19d();}var package=require(_0x792809(0xfb));const sqliteUtil=require(_0x792809(0xc8)),sharp=require(_0x792809(0xec)),si=require(_0x792809(0xb6));let tls=require(_0x792809(0xd5));function testCertAndKeyMatch(_0x427119,_0x4beab5){try{return tls['createSecureContext']({'cert':_0x427119,'key':_0x4beab5}),!![];}catch(_0x4e51f1){return![];}}router['post'](_0x792809(0x8f),(_0x507eb5,_0x33701e,_0x4e6fd0)=>{const _0x4608cd=_0x792809;let _0x316679=netUtils[_0x4608cd(0x6a)](_0x507eb5);console[_0x4608cd(0x8a)](_0x4608cd(0xdb),_0x316679);if(_0x316679!=_0x4608cd(0x76))return'ip\x20not\x20allow';return process[_0x4608cd(0x138)]({'type':_0x4608cd(0x77)}),_0x33701e[_0x4608cd(0xcd)]({'code':0x0});}),router[_0x792809(0x105)](_0x792809(0x115),(_0x2e1882,_0x1ac233,_0xb8bc91)=>{const _0x318a27=_0x792809;let _0x370b67=package[_0x318a27(0x68)],_0xf005aa=dbConfigTable['findByTitle'](_0x2e1882[_0x318a27(0xd9)][_0x318a27(0x6f)],'versionInfo'),_0x12f62b=dbConfigTable['findByTitle'](_0x2e1882[_0x318a27(0xd9)][_0x318a27(0x6f)],_0x318a27(0x122));process[_0x318a27(0x138)]({'type':_0x318a27(0x8d),'func':_0x318a27(0x11f)}),_0x1ac233[_0x318a27(0xcd)]({'code':0x0,'showMenuArr':_0x12f62b?JSON[_0x318a27(0x12d)](_0x12f62b[_0x318a27(0x169)]):'','versionInfo':_0xf005aa?JSON[_0x318a27(0x12d)](_0xf005aa[_0x318a27(0x169)]):'','currentVersion':_0x370b67});}),router[_0x792809(0x105)](_0x792809(0x8b),(_0x3e8442,_0x2d1d0c,_0x2523e6)=>{const _0x4544fc=_0x792809;if(OS[_0x4544fc(0x114)]()!='win32'&&OS[_0x4544fc(0x114)]()!=_0x4544fc(0xbd))return _0x3e8442['app'][_0x4544fc(0x110)](_0x2d1d0c,_0x2d1d0c['__'](_0x4544fc(0x13c)));if(_0x3e8442[_0x4544fc(0x107)][_0x4544fc(0x160)]!=0x1)return _0x2d1d0c['json']({'code':0x66});return process[_0x4544fc(0x138)]({'type':_0x4544fc(0x11d)}),_0x2d1d0c[_0x4544fc(0xcd)]({'code':0x0});}),router[_0x792809(0x105)](_0x792809(0x103),(_0x3e6a36,_0x302c82,_0x321353)=>{const _0x19fb15=_0x792809;let _0x5d999b=netUtils[_0x19fb15(0x9e)](_0x3e6a36),_0x334e84=_0x3e6a36['body'][_0x19fb15(0xf6)],_0x259ef2=_0x3e6a36[_0x19fb15(0x117)][_0x19fb15(0xab)],_0xdf4c7=_0x3e6a36['body'][_0x19fb15(0x129)],_0x38785d=[];if(_0x3e6a36['currentUser'][_0x19fb15(0x160)]==0x1){_0x38785d=_0x3e6a36['app'][_0x19fb15(0x6f)][_0x19fb15(0xc7)]('SELECT\x20*\x20FROM\x20bg_task\x20WHERE\x20task_state=?\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?')[_0x19fb15(0x13a)](_0x334e84,_0x259ef2,_0xdf4c7);let _0x738840=dbBackupTask[_0x19fb15(0x87)](_0x3e6a36[_0x19fb15(0xd9)][_0x19fb15(0x6f)],_0x19fb15(0xd1),[]);for(let _0x3657cc in _0x738840){let _0xdddf8d=_0x738840[_0x3657cc],_0x2488b8=dbBackupTask['getById'](_0x3e6a36['app'][_0x19fb15(0x6f)],_0xdddf8d[_0x19fb15(0x148)]);_0x38785d['push']({'task_type':_0x19fb15(0x158),'task_name':_0x2488b8?_0x2488b8[_0x19fb15(0x164)]:'','size_current':_0xdddf8d[_0x19fb15(0x9b)],'size_all':_0xdddf8d[_0x19fb15(0x16f)]});}}let _0x433d29={'code':0x0,'data':_0x38785d,'reqIp':_0x5d999b};return _0x302c82['json'](_0x433d29);}),router['post'](_0x792809(0xa2),(_0x27f9ea,_0x4a72ea,_0x312fb1)=>{const _0x160777=_0x792809;let _0x2de01b=_0x27f9ea[_0x160777(0x117)][_0x160777(0x147)];dbUserTable[_0x160777(0xdd)](_0x27f9ea,_0x4a72ea)===!![]&&_0x27f9ea[_0x160777(0xd9)][_0x160777(0x6f)][_0x160777(0xc7)]('DELETE\x20FROM\x20bg_task\x20WHERE\x20id=?')[_0x160777(0x112)](_0x2de01b);let _0x3a6fe5={'code':0x0};return _0x4a72ea[_0x160777(0xcd)](_0x3a6fe5);}),router[_0x792809(0x105)](_0x792809(0x10b),(_0x8b5fd5,_0x4db0f6,_0x27e516)=>{const _0x4f5797=_0x792809;if(_0x8b5fd5[_0x4f5797(0x107)]['is_admin']!=0x1)return _0x4db0f6[_0x4f5797(0xcd)]({'code':0x66});try{return _0x8b5fd5[_0x4f5797(0xd9)][_0x4f5797(0x6f)]['exec'](_0x4f5797(0x149)),_0x8b5fd5['app'][_0x4f5797(0x16a)][_0x4f5797(0x140)](_0x4f5797(0x149)),_0x8b5fd5[_0x4f5797(0xd9)][_0x4f5797(0x6f)][_0x4f5797(0xe6)]('wal_checkpoint(RESTART)'),_0x8b5fd5[_0x4f5797(0xd9)][_0x4f5797(0x16a)][_0x4f5797(0xe6)](_0x4f5797(0xb2)),_0x4db0f6[_0x4f5797(0xcd)]({'code':0x0});}catch(_0x1dea7a){return _0x8b5fd5[_0x4f5797(0xd9)]['returnErrMsg'](_0x4db0f6,_0x4db0f6['__'](_0x4f5797(0xee)));}}),router[_0x792809(0x105)](_0x792809(0xef),(_0x23e994,_0x1bc1d6,_0x38c10d)=>{const _0x9059ba=_0x792809;if(_0x23e994[_0x9059ba(0x107)]['is_admin']!=0x1)return _0x1bc1d6[_0x9059ba(0xcd)]({'code':0x66});let _0xf8fd90=_0x23e994['body'][_0x9059ba(0x133)];dbSourceTable[_0x9059ba(0xb3)](_0x23e994[_0x9059ba(0xd9)]['dbOther'],_0xf8fd90);if(_0xf8fd90=='movie')dbFileIndexTable[_0x9059ba(0xb3)](_0x23e994['app'][_0x9059ba(0x16a)],dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']);else{if(_0xf8fd90==_0x9059ba(0x118))dbFileIndexTable[_0x9059ba(0xb3)](_0x23e994[_0x9059ba(0xd9)][_0x9059ba(0x16a)],dbFileIndexTable[_0x9059ba(0x113)]);else{if(_0xf8fd90==_0x9059ba(0xca))dbFileIndexTable[_0x9059ba(0xb3)](_0x23e994[_0x9059ba(0xd9)][_0x9059ba(0x16a)],dbFileIndexTable['INDEX_TABLE_NAME_MUSIC']);else _0xf8fd90==_0x9059ba(0xf0)&&dbFileIndexTable[_0x9059ba(0xb3)](_0x23e994[_0x9059ba(0xd9)][_0x9059ba(0x16a)],dbFileIndexTable[_0x9059ba(0x126)]);}}_0x1bc1d6[_0x9059ba(0xcd)]({'code':0x0});}),router[_0x792809(0x105)](_0x792809(0xc0),(_0x283ad5,_0x358b79,_0x49921e)=>{const _0x4e7d78=_0x792809;let _0x23387d=netUtils['getClientIp'](_0x283ad5),_0x21e615=_0x283ad5['body']['serverName'],_0x1c6675;_0x21e615==_0x4e7d78(0x13a)?(process[_0x4e7d78(0x138)]({'type':_0x4e7d78(0x8d),'func':_0x4e7d78(0x16b)}),_0x1c6675=dbConfigTable[_0x4e7d78(0xc6)](_0x283ad5[_0x4e7d78(0xd9)][_0x4e7d78(0x6f)],'\x20title\x20in\x20(\x27apiServer\x27,\x27apiServerHttps\x27,\x27webDavServer\x27,\x27FTPServer\x27,\x27globalIpList\x27)')):_0x1c6675=dbConfigTable['findByTitle'](_0x283ad5['app'][_0x4e7d78(0x6f)],_0x21e615);let _0x4cc86d=dbConfigTable[_0x4e7d78(0x104)](_0x283ad5[_0x4e7d78(0xd9)][_0x4e7d78(0x6f)],_0x4e7d78(0x11e)),_0x1036a5=dbConfigTable[_0x4e7d78(0x104)](_0x283ad5['app']['dbOther'],'serverRootPath'),_0x30c10e={'code':0x0,'data':_0x1c6675,'serverRootPath':_0x1036a5&&_0x1036a5['value']?_0x1036a5[_0x4e7d78(0x169)]:'','hostName':OS[_0x4e7d78(0x137)](),'reqIp':_0x23387d};_0x4cc86d&&_0x4cc86d[_0x4e7d78(0x169)]&&(_0x30c10e[_0x4e7d78(0x11e)]=_0x4cc86d[_0x4e7d78(0x169)]);let _0x5d5138=dbNoticeCenterTable[_0x4e7d78(0x153)](_0x283ad5[_0x4e7d78(0xd9)][_0x4e7d78(0x6f)]);return _0x30c10e[_0x4e7d78(0x170)]=_0x5d5138[_0x4e7d78(0xab)],_0x358b79[_0x4e7d78(0xcd)](_0x30c10e);}),router[_0x792809(0x105)](_0x792809(0xe1),(_0x36db28,_0x241a9b,_0x26751d)=>{const _0x2c52e2=_0x792809;let _0x344050=netUtils[_0x2c52e2(0x9e)](_0x36db28),_0x306a56=_0x36db28[_0x2c52e2(0x117)][_0x2c52e2(0xa9)],_0x18bed7=_0x2c52e2(0x134)+dbFileIndexTable[_0x2c52e2(0xf8)],_0x1ebc8d=_0x2c52e2(0x134)+dbFileIndexTable[_0x2c52e2(0x113)];process['send']({'type':_0x2c52e2(0x8d),'func':_0x2c52e2(0xf9)}),process[_0x2c52e2(0x138)]({'type':_0x2c52e2(0x8d),'func':_0x2c52e2(0xa4),'force':_0x306a56}),fs[_0x2c52e2(0x88)](config[_0x2c52e2(0x9d)],_0x217a3e=>{const _0x44e8c5=_0x2c52e2;if(_0x217a3e)return _0x36db28[_0x44e8c5(0xd9)][_0x44e8c5(0x110)](_0x241a9b,_0x241a9b['__'](_0x44e8c5(0x135)));else{let _0xe804ed=dbConfigTable[_0x44e8c5(0xc6)](_0x36db28[_0x44e8c5(0xd9)]['dbOther'],_0x44e8c5(0x16d)+_0x18bed7+_0x44e8c5(0x131)+_0x1ebc8d+'\x27,\x27globalDiskInfo\x27)');return _0x241a9b[_0x44e8c5(0xcd)]({'code':0x0,'data':_0xe804ed,'version':package[_0x44e8c5(0x68)],'reqIp':_0x344050,'platform':OS[_0x44e8c5(0x114)]()});}});}),router[_0x792809(0x105)]('/getAllConfig',(_0x2f4f91,_0x5d5648,_0xf93e26)=>{const _0x37e9c0=_0x792809;let _0x3f383=_0x2f4f91[_0x37e9c0(0x117)]['keys'];if(!_0x3f383||!_0x3f383 instanceof Array||_0x3f383[_0x37e9c0(0xf4)]<0x1)return _0x2f4f91[_0x37e9c0(0xd9)][_0x37e9c0(0x110)](_0x5d5648,'error\x20keys');let _0x5d0d5b;_0x5d0d5b=dbConfigTable[_0x37e9c0(0xb5)](_0x2f4f91[_0x37e9c0(0xd9)][_0x37e9c0(0x6f)],_0x3f383);for(let _0x10d255 in _0x5d0d5b){let _0x1e1993=_0x5d0d5b[_0x10d255];(_0x1e1993[_0x37e9c0(0x14f)]=='httpsCert'||_0x1e1993[_0x37e9c0(0x14f)]==_0x37e9c0(0x13b))&&(!_0x1e1993[_0x37e9c0(0x169)][_0x37e9c0(0x97)](_0x37e9c0(0xdc))&&(_0x1e1993[_0x37e9c0(0x169)]=''));}let _0x139339={};_0x139339[_0x37e9c0(0x14d)]=config[_0x37e9c0(0x14b)],_0x139339[_0x37e9c0(0x9c)]=config['apiPortHttps'],_0x139339['defaultWebDavPort']=config[_0x37e9c0(0x108)],_0x139339[_0x37e9c0(0x81)]=config['webDavPortHttps'],_0x139339[_0x37e9c0(0x14e)]=config[_0x37e9c0(0x15f)],_0x139339['defaultThreadCount']=0x2,_0x139339[_0x37e9c0(0xb9)]=_0x5d0d5b,_0x5d5648[_0x37e9c0(0xcd)]({'code':0x0,'data':_0x139339});}),router['post'](_0x792809(0xfe),(_0x2125ea,_0x233235,_0x5ce97e)=>{const _0x391f=_0x792809;let _0x524f02=dbConfigTable[_0x391f(0x104)](_0x2125ea['app'][_0x391f(0x6f)],_0x391f(0x13d)),_0x202784='';_0x524f02&&(_0x202784=_0x524f02[_0x391f(0x169)]),_0x233235[_0x391f(0xcd)]({'code':0x0,'data':_0x202784});}),router[_0x792809(0x105)](_0x792809(0x9a),(_0x23c16c,_0x4484e6,_0x1033b0)=>{const _0x3377ad=_0x792809;let _0x40e34d=netUtils[_0x3377ad(0x9e)](_0x23c16c);if(_0x40e34d!=_0x3377ad(0x76))return _0x3377ad(0x100);if(_0x23c16c[_0x3377ad(0x107)][_0x3377ad(0x160)]!=0x1)return _0x4484e6[_0x3377ad(0xcd)]({'code':0x66});let _0x5a251e=_0x23c16c[_0x3377ad(0x117)][_0x3377ad(0x13d)],_0x5e04ce=_0x23c16c[_0x3377ad(0x117)][_0x3377ad(0x10f)];return _0x5a251e&&dbConfigTable['create'](_0x23c16c[_0x3377ad(0xd9)][_0x3377ad(0x6f)],{'title':_0x3377ad(0x13d),'value':_0x5a251e}),_0x5e04ce&&dbConfigTable[_0x3377ad(0xce)](_0x23c16c[_0x3377ad(0xd9)][_0x3377ad(0x6f)],{'title':_0x3377ad(0x10f),'value':_0x5e04ce}),_0x4484e6[_0x3377ad(0xcd)]({'code':0x0});});function saveConfig(_0x2f74c5,_0x34bb0e,_0x4e6abe){const _0x5a314a=_0x792809;dbConfigTable[_0x5a314a(0xce)](_0x2f74c5,{'title':_0x34bb0e,'value':_0x4e6abe+''});}router[_0x792809(0x105)](_0x792809(0xfc),(_0x3e0648,_0x11181e,_0x268982)=>{const _0x7cbdf8=_0x792809;let _0x1fc34b=_0x3e0648[_0x7cbdf8(0x117)][_0x7cbdf8(0xe3)];if(_0x3e0648[_0x7cbdf8(0x107)]['is_admin']!=0x1)return _0x11181e['json']({'code':0x66});if(_0x1fc34b)fs[_0x7cbdf8(0x165)](_0x1fc34b,fs[_0x7cbdf8(0x13f)][_0x7cbdf8(0xd2)]|fs['constants']['R_OK'],_0x3b6496=>{const _0x4f5b8f=_0x7cbdf8;return!_0x3b6496?(saveConfig(_0x3e0648[_0x4f5b8f(0xd9)][_0x4f5b8f(0x6f)],_0x4f5b8f(0x9d),_0x1fc34b),_0x11181e[_0x4f5b8f(0xcd)]({'code':0x0})):fileUtil['returnFileError'](_0x11181e,_0x3b6496);});else return dbConfigTable[_0x7cbdf8(0x124)](_0x3e0648[_0x7cbdf8(0xd9)][_0x7cbdf8(0x6f)],_0x7cbdf8(0x9d)),_0x11181e[_0x7cbdf8(0xcd)]({'code':0x0});}),router[_0x792809(0x105)](_0x792809(0xe9),(_0x2435bb,_0x36b766,_0xca202f)=>{const _0xa534cf=_0x792809;if(_0x2435bb[_0xa534cf(0x107)][_0xa534cf(0x160)]!=0x1)return _0x36b766['json']({'code':0x66});let _0x19dc1b=_0x2435bb[_0xa534cf(0x117)][_0xa534cf(0xa5)];return _0x19dc1b?saveConfig(_0x2435bb['app'][_0xa534cf(0x6f)],'serverRootPath',_0x19dc1b):dbConfigTable[_0xa534cf(0x124)](_0x2435bb['app'][_0xa534cf(0x6f)],_0xa534cf(0xa5)),_0x36b766[_0xa534cf(0xcd)]({'code':0x0});}),router['post']('/saveShareUrl',(_0x46cd24,_0x315740,_0x5ed7e0)=>{const _0x5c3214=_0x792809;if(_0x46cd24[_0x5c3214(0x107)]['is_admin']!=0x1)return _0x315740[_0x5c3214(0xcd)]({'code':0x66});let _0x43b1d6=_0x46cd24[_0x5c3214(0x117)]['customShareUrl'];return _0x43b1d6?saveConfig(_0x46cd24[_0x5c3214(0xd9)]['dbOther'],'customShareUrl',_0x43b1d6):dbConfigTable[_0x5c3214(0x124)](_0x46cd24[_0x5c3214(0xd9)][_0x5c3214(0x6f)],_0x5c3214(0xc1)),_0x315740['json']({'code':0x0});});let forbiddenPorts=[0x1,0x7,0x9,0xb,0xd,0xf,0x11,0x13,0x14,0x15,0x16,0x17,0x19,0x25,0x2a,0x2b,0x35,0x4d,0x4f,0x57,0x5f,0x65,0x66,0x67,0x68,0x6d,0x6e,0x6f,0x71,0x73,0x75,0x77,0x7b,0x87,0x8b,0x8f,0xb3,0x185,0x1d1,0x200,0x201,0x202,0x203,0x20e,0x212,0x213,0x214,0x21c,0x22c,0x233,0x24b,0x259,0x27c,0x3e1,0x3e3,0x801,0xe4b,0xfcd,0x1770,0x1a09,0x1a0a,0x1a0b,0x1a0c,0x1a0d,0xd3d];router[_0x792809(0x105)]('/saveConfig',(_0x68ead0,_0x57c662,_0x3fee3b)=>{const _0x39d0fd=_0x792809;let _0x43598e=_0x68ead0['body'][_0x39d0fd(0x14b)],_0x3dd372=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x15b)],_0x1e2c22=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x108)],_0x47563e=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0xe5)],_0x24afa7=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x15f)],_0x175588=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0xc5)],_0x2e2002=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x163)],_0x458443=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x71)],_0x15cebd=_0x68ead0['body'][_0x39d0fd(0x83)],_0x4f8c7c=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x13b)],_0x48eb94=_0x68ead0['body']['httpsCert'],_0x844619=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x93)],_0x26aeec=_0x68ead0['body'][_0x39d0fd(0xa6)],_0x5e2f08=_0x68ead0[_0x39d0fd(0x117)]['language'],_0x31cb4b=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x10f)],_0xca1524=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x11b)],_0x33fc43=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x84)],_0x3555b5=_0x68ead0[_0x39d0fd(0x117)]['excludePathPhoto'],_0x559abc=_0x68ead0['body'][_0x39d0fd(0x155)],_0x25c650=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x166)],_0x4a4a11=_0x68ead0['body'][_0x39d0fd(0xea)],_0x34c1fb=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x122)],_0x4a7179=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0xcb)],_0x1067bf=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0xc1)],_0x55ada0=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0xf7)],_0x17e565=_0x68ead0[_0x39d0fd(0xd9)][_0x39d0fd(0x6f)];if(_0x68ead0['currentUser'][_0x39d0fd(0x160)]!=0x1)return _0x57c662['json']({'code':0x66});let _0x5de866=_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0xa5)];if(_0x5de866&&_0x5de866[_0x39d0fd(0x123)]()){_0x5de866=_0x5de866['toLowerCase']()[_0x39d0fd(0x123)]();if(_0x5de866[_0x39d0fd(0xf4)]>0x20||!/^[a-zA-Z0-9]+$/[_0x39d0fd(0x130)](_0x5de866))return _0x68ead0[_0x39d0fd(0xd9)][_0x39d0fd(0x110)](_0x57c662,_0x39d0fd(0xad));if(['music','book','download',_0x39d0fd(0x6d),'setting',_0x39d0fd(0x15d),_0x39d0fd(0x171)][_0x39d0fd(0xba)](_0x5de866))return _0x68ead0[_0x39d0fd(0xd9)]['returnErrMsg'](_0x57c662,_0x57c662['__'](_0x39d0fd(0x90))+(':'+_0x5de866),_0x39d0fd(0x102));saveConfig(_0x17e565,'serverRootPath',_0x5de866);}let _0x551df5=0xffdc;if(_0x43598e>_0x551df5||_0x1e2c22>_0x551df5||_0x24afa7>_0x551df5||_0x47563e>_0x551df5)return _0x57c662['json']({'code':0x1,'message':_0x39d0fd(0x136)});_0x34c1fb&&saveConfig(_0x17e565,_0x39d0fd(0x122),JSON[_0x39d0fd(0x75)](_0x34c1fb));_0x1067bf&&saveConfig(_0x17e565,_0x39d0fd(0xc1),_0x1067bf);_0x33fc43&&saveConfig(_0x17e565,_0x39d0fd(0x84),JSON[_0x39d0fd(0x75)](_0x33fc43));_0x4a7179&&parseInt(_0x4a7179)!=NaN&&_0x4a7179>0x0&&_0x4a7179<0x5f5e0ff&&saveConfig(_0x17e565,'tokenKeepHour',_0x4a7179);_0x3555b5&&saveConfig(_0x17e565,_0x39d0fd(0xe4),JSON[_0x39d0fd(0x75)](_0x3555b5));_0x31cb4b&&saveConfig(_0x17e565,_0x39d0fd(0x10f),_0x31cb4b);if(_0x559abc){let _0x48c2e0=netUtils[_0x39d0fd(0x9e)](_0x68ead0);if(_0x48c2e0=='localhost'){for(let _0x252c12 in _0x559abc){let _0x2f83db=_0x559abc[_0x252c12],_0x18d8ba=fs[_0x39d0fd(0x15c)](_0x2f83db);if(!_0x18d8ba)return _0x68ead0['app'][_0x39d0fd(0x110)](_0x57c662,_0x57c662['__'](_0x39d0fd(0x125))+':'+_0x2f83db);fileUtil[_0x39d0fd(0x142)](_0x2f83db)&&(_0x559abc[_0x252c12]=_0x2f83db[_0x39d0fd(0x119)]());}saveConfig(_0x17e565,_0x39d0fd(0x155),JSON[_0x39d0fd(0x75)](_0x559abc));}else return _0x68ead0[_0x39d0fd(0xd9)]['returnErrMsg'](_0x57c662,_0x57c662['__'](_0x39d0fd(0x98)));}_0x25c650&&saveConfig(_0x17e565,'excludeFilenameMovie',JSON['stringify'](_0x25c650));_0x4a4a11&&saveConfig(_0x17e565,'excludeFilenamePhoto',JSON[_0x39d0fd(0x75)](_0x4a4a11));if(_0x43598e){if(forbiddenPorts[_0x39d0fd(0xba)](parseInt(_0x43598e)))return _0x68ead0[_0x39d0fd(0xd9)]['returnErrMsg'](_0x57c662,_0x57c662['__'](_0x39d0fd(0xa0))+_0x39d0fd(0x150));saveConfig(_0x17e565,'apiPort',parseInt(_0x43598e));}if(_0x3dd372){if(forbiddenPorts['includes'](parseInt(_0x3dd372))||_0x3dd372==_0x43598e)return _0x68ead0['app']['returnErrMsg'](_0x57c662,_0x57c662['__'](_0x39d0fd(0xa0))+_0x39d0fd(0xff));saveConfig(_0x17e565,_0x39d0fd(0x15b),parseInt(_0x3dd372));}_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x92)]&&saveConfig(_0x17e565,_0x39d0fd(0x92),_0x68ead0['body'][_0x39d0fd(0x92)]);_0x68ead0['body'][_0x39d0fd(0xb4)]&&(saveConfig(_0x17e565,_0x39d0fd(0xb4),_0x68ead0[_0x39d0fd(0x117)]['ipMode']),_0x68ead0['app'][_0x39d0fd(0x80)]());_0x68ead0['body']['ipDetection']&&saveConfig(_0x17e565,_0x39d0fd(0x157),_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x157)]);_0x68ead0[_0x39d0fd(0x117)][_0x39d0fd(0x15a)]&&saveConfig(_0x17e565,'twoStepLogin',_0x68ead0[_0x39d0fd(0x117)]['twoStepLogin']);_0x1e2c22&&saveConfig(_0x17e565,'webDavPort',parseInt(_0x1e2c22));_0x47563e&&saveConfig(_0x17e565,_0x39d0fd(0xe5),parseInt(_0x47563e));_0x24afa7&&saveConfig(_0x17e565,'FTPPort',parseInt(_0x24afa7));_0x175588&&saveConfig(_0x17e565,'autoLaunch',_0x175588);_0x2e2002&&saveConfig(_0x17e565,_0x39d0fd(0x163),_0x2e2002);_0x458443&&saveConfig(_0x17e565,'autoShowWindow',_0x458443);_0x15cebd&&saveConfig(_0x17e565,'autoScanSource',_0x15cebd);let _0x3f6efd=dbConfigTable[_0x39d0fd(0x104)](_0x68ead0[_0x39d0fd(0xd9)][_0x39d0fd(0x6f)],_0x39d0fd(0xda));if(!_0x3f6efd||_0x3f6efd[_0x39d0fd(0x169)]==0x0){if(_0x4f8c7c!='*'&&_0x48eb94!='*'){if(_0x4f8c7c&&_0x48eb94){if(!_0x4f8c7c[_0x39d0fd(0x97)]('-----')||!_0x48eb94[_0x39d0fd(0x97)](_0x39d0fd(0xdc)))return _0x68ead0['app'][_0x39d0fd(0x110)](_0x57c662,_0x57c662['__']('httpsCertError'));const _0x10eeec=testCertAndKeyMatch(_0x48eb94,_0x4f8c7c);if(!_0x10eeec)return _0x68ead0['app'][_0x39d0fd(0x110)](_0x57c662,_0x57c662['__'](_0x39d0fd(0xe0)));saveConfig(_0x17e565,_0x39d0fd(0x13b),_0x4f8c7c),saveConfig(_0x17e565,_0x39d0fd(0x86),_0x48eb94);}else saveConfig(_0x17e565,_0x39d0fd(0x13b),''),saveConfig(_0x17e565,_0x39d0fd(0x86),'');}}_0x55ada0&&saveConfig(_0x17e565,'webDavUseApiCert',_0x55ada0);_0x55ada0=dbConfigTable['findByTitle'](_0x68ead0[_0x39d0fd(0xd9)][_0x39d0fd(0x6f)],_0x39d0fd(0xf7));if(!_0x55ada0||_0x55ada0[_0x39d0fd(0x169)]==0x0){if(_0x844619!='*'&&_0x26aeec!='*'){if(_0x844619&&_0x26aeec){if(!_0x844619[_0x39d0fd(0x97)](_0x39d0fd(0xdc))||!_0x26aeec['startsWith'](_0x39d0fd(0xdc)))return _0x68ead0[_0x39d0fd(0xd9)]['returnErrMsg'](_0x57c662,_0x57c662['__']('httpsCertError'));const _0x404c65=testCertAndKeyMatch(_0x844619,_0x26aeec);if(!_0x404c65)return _0x68ead0[_0x39d0fd(0xd9)]['returnErrMsg'](_0x57c662,_0x57c662['__'](_0x39d0fd(0xe0)));saveConfig(_0x17e565,'webDavHttpsKey',_0x844619),saveConfig(_0x17e565,_0x39d0fd(0xa6),_0x26aeec);}else saveConfig(_0x17e565,'webDavHttpsKey',''),saveConfig(_0x17e565,_0x39d0fd(0xa6),'');}}_0x5e2f08&&saveConfig(_0x17e565,_0x39d0fd(0x13d),_0x5e2f08);if(_0xca1524){if(_0xca1524>OS[_0x39d0fd(0x173)]()[_0x39d0fd(0xf4)])return _0x68ead0[_0x39d0fd(0xd9)][_0x39d0fd(0x110)](_0x57c662,_0x57c662['__'](_0x39d0fd(0x69))+OS['cpus']()[_0x39d0fd(0xf4)]);saveConfig(_0x17e565,_0x39d0fd(0x11b),_0xca1524);}return _0x57c662[_0x39d0fd(0xcd)]({'code':0x0});}),router['post']('/saveConfigPhoto',(_0x2648de,_0x13d4b4,_0x2138be)=>{const _0x2ef729=_0x792809;if(_0x2648de[_0x2ef729(0x107)]['is_admin']!=0x1)return _0x13d4b4[_0x2ef729(0xcd)]({'code':0x66});let _0x25ca68=_0x2648de[_0x2ef729(0xd9)][_0x2ef729(0x6f)],_0x10214b=_0x2648de[_0x2ef729(0x117)]['aiClassesEnable'],_0x241808=_0x2648de[_0x2ef729(0x117)]['aiFaceEnable'],_0x4fd607=_0x2648de[_0x2ef729(0x117)][_0x2ef729(0x14a)],_0x13905f=_0x2648de[_0x2ef729(0x117)][_0x2ef729(0x127)],_0xe9505a=_0x2648de['body'][_0x2ef729(0xb8)],_0x151ca7=_0x2648de[_0x2ef729(0x117)]['photoPreviewSize'];_0xe9505a&&saveConfig(_0x25ca68,_0x2ef729(0xb8),_0xe9505a);_0x151ca7&&saveConfig(_0x25ca68,_0x2ef729(0xe8),_0x151ca7);if(_0x10214b){if(_0x10214b==0x1){if(OS[_0x2ef729(0x132)]()/0x400/0x400/0x400<0x3)return _0x2648de['app'][_0x2ef729(0x110)](_0x13d4b4,_0x13d4b4['__'](_0x2ef729(0xc4)));}saveConfig(_0x25ca68,_0x2ef729(0x161),_0x10214b);if(_0x10214b==0x1)process[_0x2ef729(0x138)]({'type':_0x2ef729(0xbe)});}_0x13905f&&saveConfig(_0x25ca68,'aiFaceMinPhotoCount',_0x13905f);if(_0x241808){if(_0x241808==0x1){if(OS[_0x2ef729(0x132)]()/0x400/0x400/0x400<0x3)return _0x2648de[_0x2ef729(0xd9)][_0x2ef729(0x110)](_0x13d4b4,_0x13d4b4['__'](_0x2ef729(0xc4)));}saveConfig(_0x25ca68,_0x2ef729(0xa1),_0x241808);if(_0x241808==0x1)process[_0x2ef729(0x138)]({'type':'startFaceAiWork'});}if(_0x4fd607){saveConfig(_0x25ca68,_0x2ef729(0x14a),_0x4fd607);if(_0x4fd607==0x1)process[_0x2ef729(0x138)]({'type':_0x2ef729(0x91)});}return _0x13d4b4[_0x2ef729(0xcd)]({'code':0x0});}),router['post'](_0x792809(0xbb),(_0x1a807f,_0x21d7b1,_0x18d3fe)=>{const _0x208b03=_0x792809;if(_0x1a807f['currentUser']['is_admin']!=0x1)return _0x21d7b1[_0x208b03(0xcd)]({'code':0x66});let _0xa9ad3a=_0x1a807f[_0x208b03(0xd9)]['dbOther'],_0xbda1d4=_0x1a807f[_0x208b03(0x117)][_0x208b03(0xd6)],_0x5f393e=_0x1a807f[_0x208b03(0x117)][_0x208b03(0xc2)],_0x4a7ba5=_0x1a807f[_0x208b03(0x117)]['customLoginImage'],_0x1d4251=_0x1a807f['body'][_0x208b03(0x8c)];function _0x5e8035(_0x3d534c,_0x4b6b3e,_0x93c194){const _0x208705=_0x208b03;if(_0x4b6b3e=='-')return saveConfig(_0xa9ad3a,_0x3d534c,'-'),_0x21d7b1[_0x208705(0xcd)]({'code':0x0});if(fs[_0x208705(0x15c)](_0x4b6b3e)){let _0x42a177=path[_0x208705(0x101)](config[_0x208705(0x144)],'custom');function _0x102bf9(){const _0x13610b=_0x208705;let _0x32fcc9=path[_0x13610b(0x101)](_0x42a177,_0x3d534c+_0x13610b(0x146));sharp(path[_0x13610b(0x101)](_0x4b6b3e))[_0x13610b(0x10a)]({'width':_0x93c194,'withoutEnlargement':!![]})[_0x13610b(0x109)]()['webp']()[_0x13610b(0xaf)](_0x32fcc9)[_0x13610b(0x167)](()=>{const _0x3564d0=_0x13610b;return saveConfig(_0xa9ad3a,_0x3d534c,_0x32fcc9),_0x21d7b1[_0x3564d0(0xcd)]({'code':0x0});})['catch'](()=>{const _0x102105=_0x13610b;return _0x1a807f['app']['returnErrMsg'](_0x21d7b1,_0x21d7b1['__'](_0x102105(0xee)));});}!fs[_0x208705(0x15c)](_0x42a177)?fs[_0x208705(0xd7)](_0x42a177,{'recursive':!![]},_0x5e8209=>{const _0x4e4d92=_0x208705;if(_0x5e8209)return _0x1a807f[_0x4e4d92(0xd9)][_0x4e4d92(0x110)](_0x21d7b1,_0x21d7b1['__'](_0x4e4d92(0xee)));_0x102bf9();}):_0x102bf9();}else return _0x1a807f[_0x208705(0xd9)][_0x208705(0x110)](_0x21d7b1,_0x21d7b1['__'](_0x208705(0x125))+_0x4b6b3e);}if(_0xbda1d4)return saveConfig(_0xa9ad3a,_0x208b03(0xd6),_0xbda1d4),_0x21d7b1['json']({'code':0x0});_0x5f393e&&_0x5e8035(_0x208b03(0xc2),_0x5f393e,0xc8),_0x4a7ba5&&_0x5e8035(_0x208b03(0xe2),_0x4a7ba5,0x3e8),_0x1d4251&&_0x5e8035(_0x208b03(0x8c),_0x1d4251,0xf14);}),router[_0x792809(0x105)]('/saveConfigMovie',(_0xd1e65e,_0x2939cb,_0x471855)=>{const _0x4b92c5=_0x792809;let _0x58e496=_0xd1e65e[_0x4b92c5(0xd9)]['dbOther'],_0x1827e8=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0xa3)],_0x59527d=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0xf3)],_0x55f08=_0xd1e65e['body'][_0x4b92c5(0x145)],_0x4d4cc1=_0xd1e65e['body'][_0x4b92c5(0x16c)],_0x21296d=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0x156)],_0x101c60=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0x12e)],_0x134cf7=_0xd1e65e['body'][_0x4b92c5(0xae)],_0x4821bc=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0x11c)],_0x4458df=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0x151)],_0x3bee23=_0xd1e65e[_0x4b92c5(0x117)]['transcodeSpeed'],_0x53e9d9=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0xcc)],_0x46a4b2=_0xd1e65e[_0x4b92c5(0x117)]['moviePlaylongPressRate'],_0x45f6aa=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0x95)],_0x35db66=_0xd1e65e[_0x4b92c5(0x117)]['movieTmdbApiUrl'],_0x5c4eb7=_0xd1e65e[_0x4b92c5(0x117)]['movieTmdbApiKey'],_0x48064e=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0x9f)],_0x1443e8=_0xd1e65e['body'][_0x4b92c5(0x128)],_0x1a10d5=_0xd1e65e['body'][_0x4b92c5(0xaa)],_0x42bbe8=_0xd1e65e[_0x4b92c5(0x117)]['tmdbProxyUrl'],_0xeb93c8=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0xeb)];if(_0xd1e65e[_0x4b92c5(0x107)][_0x4b92c5(0x160)]!=0x1)return _0x2939cb['json']({'code':0x66});_0x45f6aa&&saveConfig(_0x58e496,'movieTmdbLanguage',_0x45f6aa);(_0x1a10d5==0x1||_0x1a10d5==0x0)&&saveConfig(_0x58e496,'tmdbProxyEnable',_0x1a10d5);_0x42bbe8&&saveConfig(_0x58e496,_0x4b92c5(0xfd),_0x42bbe8?_0x42bbe8:'');_0x35db66!=null&&saveConfig(_0x58e496,_0x4b92c5(0x82),_0x35db66?_0x35db66:'');_0x5c4eb7!=null&&saveConfig(_0x58e496,_0x4b92c5(0x141),_0x5c4eb7?_0x5c4eb7:'');_0x48064e&&saveConfig(_0x58e496,_0x4b92c5(0x9f),_0x48064e);_0x46a4b2&&saveConfig(_0x58e496,'moviePlaylongPressRate',_0x46a4b2);_0x1443e8&&saveConfig(_0x58e496,_0x4b92c5(0x128),_0x1443e8);_0xeb93c8&&saveConfig(_0x58e496,_0x4b92c5(0xeb),_0xeb93c8);let _0x2bc986=_0xd1e65e[_0x4b92c5(0x117)][_0x4b92c5(0xcf)],_0x5b81bb=_0xd1e65e['body'][_0x4b92c5(0x12c)],_0x3d5b2b=_0xd1e65e['body']['movieHomeShowLibrary'];(_0x2bc986==0x1||_0x2bc986==0x0)&&saveConfig(_0x58e496,_0x4b92c5(0xcf),_0x2bc986);(_0x5b81bb==0x1||_0x5b81bb==0x0)&&saveConfig(_0x58e496,_0x4b92c5(0x12c),_0x5b81bb);(_0x3d5b2b==0x1||_0x3d5b2b==0x0)&&saveConfig(_0x58e496,_0x4b92c5(0x10e),_0x3d5b2b);let _0x36c839=_0xd1e65e['body']['crf'];if(_0x36c839&&(_0x36c839<0x1||_0x36c839>0x33))return _0x2939cb['json']({'code':0x1,'message':_0x4b92c5(0xb1)});let _0x776c46=[_0x4b92c5(0x12a),_0x4b92c5(0x16e),_0x4b92c5(0xa7),_0x4b92c5(0x11a)];_0x3bee23&&_0x776c46['includes'](_0x3bee23)&&saveConfig(_0x58e496,_0x4b92c5(0xb7),_0x3bee23);_0x134cf7&&saveConfig(_0x58e496,_0x4b92c5(0xae),_0x134cf7);_0x4821bc&&saveConfig(_0x58e496,_0x4b92c5(0x11c),_0x4821bc);_0x36c839&&saveConfig(_0x58e496,_0x4b92c5(0x154),parseInt(_0x36c839));_0x1827e8&&saveConfig(_0x58e496,_0x4b92c5(0xa3),_0x1827e8);_0x53e9d9&&saveConfig(_0x58e496,_0x4b92c5(0xcc),_0x53e9d9);_0x59527d&&saveConfig(_0x58e496,'autoHardAccDecode',_0x59527d);_0x55f08&&saveConfig(_0x58e496,_0x4b92c5(0xc3),_0x55f08);_0x4d4cc1&&saveConfig(_0x58e496,_0x4b92c5(0xa8),_0x4d4cc1);if(_0x21296d){try{_0x21296d=parseInt(_0x21296d);if(_0x21296d>0x1e)_0x21296d=0x1e;if(_0x21296d<0x2)_0x21296d=0x2;}catch(_0x15337a){_0x21296d=0x5;}saveConfig(_0x58e496,'transCodeParams-readrate',_0x21296d);}return _0x4458df&&(saveConfig(_0x58e496,_0x4b92c5(0x151),_0x4458df),_0x4458df=='1'&&process[_0x4b92c5(0x138)]({'type':_0x4b92c5(0xac)})),_0x101c60?saveConfig(_0x58e496,_0x4b92c5(0x12e),_0x101c60):dbConfigTable[_0x4b92c5(0x124)](_0x58e496,_0x4b92c5(0x12e)),_0x2939cb[_0x4b92c5(0xcd)]({'code':0x0});}),router['post'](_0x792809(0xde),(_0xa9ab6c,_0x39875c,_0x2f3c68)=>{const _0x314002=_0x792809;let _0x41829b=_0xa9ab6c['app'][_0x314002(0x6f)];if(_0xa9ab6c[_0x314002(0x107)][_0x314002(0x160)]!=0x1)return _0x39875c[_0x314002(0xcd)]({'code':0x66});function _0x3054ba(){const _0x461ec0=_0x314002;let _0x52c636=_0xa9ab6c['body']['musicTitleType']||_0x461ec0(0x7a),_0x5a1919=[_0x461ec0(0x7a),_0x461ec0(0x79)];return _0x5a1919[_0x461ec0(0xba)](_0x52c636)&&saveConfig(_0x41829b,_0x461ec0(0xd4),_0x52c636),_0x39875c['json']({'code':0x0});}_0x3054ba();}),router['post'](_0x792809(0xf5),(_0x260e9a,_0x2183a5,_0x362981)=>{const _0x329a4c=_0x792809;if(_0x260e9a[_0x329a4c(0x107)][_0x329a4c(0x160)]!=0x1)return _0x2183a5['json']({'code':0x66});let _0x278575={};_0x278575['databaseFolder']=path['join'](config[_0x329a4c(0x144)],'database'),_0x278575['imgFolder']=config['cacheParentPath'],fs[_0x329a4c(0x165)](_0x278575['imgFolder'],fs['constants'][_0x329a4c(0x152)]|fs['constants'][_0x329a4c(0xd2)],_0x19990c=>{const _0x8dcd2d=_0x329a4c;_0x278575['imgFolderUsable']=0x1;_0x19990c&&(_0x278575[_0x8dcd2d(0x139)]=0x0);let _0xbe55c5=dbConfigTable['findByTitle'](_0x260e9a['app'][_0x8dcd2d(0x6f)],_0x8dcd2d(0x70));return _0xbe55c5?_0x278575[_0x8dcd2d(0x70)]=JSON[_0x8dcd2d(0x12d)](_0xbe55c5['value']):_0x278575['cacheImageInfo']=![],_0x278575['appRootPath']=config['appRootPath'],_0x2183a5['json']({'code':0x0,'data':_0x278575});});}),router[_0x792809(0x105)](_0x792809(0x15e),(_0x10790d,_0x49b7dc,_0x5f1b99)=>{const _0x359b2d=_0x792809;if(dbUserTable['isAdmin'](_0x10790d,_0x49b7dc)!==!![])return;if(OS[_0x359b2d(0x114)]()!=_0x359b2d(0x13e)&&OS['platform']()!=_0x359b2d(0xbd))return _0x10790d[_0x359b2d(0xd9)][_0x359b2d(0x110)](_0x49b7dc,_0x49b7dc['__'](_0x359b2d(0x7d)));return process['send']({'type':_0x359b2d(0x6e)}),_0x49b7dc[_0x359b2d(0xcd)]({'code':0x0});}),router[_0x792809(0x105)](_0x792809(0x96),(_0x2ced52,_0x44af9e,_0x41e47a)=>{const _0x27695b=_0x792809;if(_0x2ced52['currentUser'][_0x27695b(0x160)]!=0x1)return _0x44af9e[_0x27695b(0xcd)]({'code':0x66});let _0x132b86=path[_0x27695b(0x101)](config[_0x27695b(0x9d)],'cache');fs[_0x27695b(0x88)](_0x132b86,(_0xbcabd2,_0x566e8e)=>{if(_0xbcabd2)return;fs['rm'](_0x132b86,{'recursive':!![]},_0x44384b=>{const _0x4f75ac=_0x248b;fs[_0x4f75ac(0xd7)](_0x132b86,{'recursive':!![]},_0x5c12cb=>{const _0x414aff=_0x4f75ac;console[_0x414aff(0x8a)](_0x5c12cb);});if(_0x44384b)return fileUtil[_0x4f75ac(0x6c)](_0x44af9e,_0x44384b);return dbConfigTable[_0x4f75ac(0x124)](_0x2ced52[_0x4f75ac(0xd9)][_0x4f75ac(0x6f)],'cacheImageInfo'),_0x44af9e[_0x4f75ac(0xcd)]({'code':0x0});});});let _0x46038e=path[_0x27695b(0x101)](config['cacheParentPath'],_0x27695b(0x120)),_0x4aa8fc=path[_0x27695b(0x101)](config[_0x27695b(0x9d)],_0x27695b(0x120),_0x27695b(0xe7));fs[_0x27695b(0x88)](_0x46038e,(_0x4e4b42,_0x433dce)=>{if(_0x4e4b42)return;fs['rm'](_0x46038e,{'recursive':!![]},_0xe67130=>{const _0x982a1d=_0x248b;fs[_0x982a1d(0xd7)](_0x4aa8fc,{'recursive':!![]},_0xde0dc3=>{const _0x5ee182=_0x982a1d;console[_0x5ee182(0x8a)](_0xde0dc3);});if(_0xe67130)return fileUtil['returnFileError'](_0x44af9e,_0xe67130);});});}),router['post']('/getSystemInfomation',(_0x3e55b2,_0x5cb7d4,_0x590691)=>{const _0x256947=_0x792809;if(dbUserTable[_0x256947(0xdd)](_0x3e55b2,_0x5cb7d4)!==!![])return;let _0x3e5836=_0x3e55b2['body'][_0x256947(0xf1)],_0x224498=[_0x256947(0x74),'bios',_0x256947(0xb0),_0x256947(0x168),'cpu',_0x256947(0xd0),_0x256947(0x78),_0x256947(0xbc),'battery',_0x256947(0x10d),_0x256947(0xc9),_0x256947(0x121),'usb',_0x256947(0xfa),_0x256947(0x143),_0x256947(0xf2),_0x256947(0x172)];if(!_0x224498[_0x256947(0xba)](_0x3e5836))return _0x3e55b2[_0x256947(0xd9)][_0x256947(0x110)](_0x5cb7d4,'type\x20is\x20invalid');si[_0x3e5836](_0x8355c8=>{const _0x5bc604=_0x256947;try{return _0x5cb7d4['json']({'code':0x0,'data':_0x8355c8});}catch(_0x1f7ff1){console['log'](_0x5bc604(0x14c),_0x1f7ff1);}});}),router['post']('/openInSystem',(_0x2d3988,_0x28c808,_0xbc8092)=>{const _0x3edca1=_0x792809;let _0x522891=netUtils[_0x3edca1(0x9e)](_0x2d3988);if(_0x522891!=_0x3edca1(0x76))return _0x2d3988[_0x3edca1(0xd9)][_0x3edca1(0x110)](_0x28c808,_0x28c808['__'](_0x3edca1(0xee)));let _0x5c2417=_0x2d3988[_0x3edca1(0x117)][_0x3edca1(0xbf)],_0xb80ff7=_0x2d3988[_0x3edca1(0x117)][_0x3edca1(0x7a)],_0x264443=_0x2d3988['body'][_0x3edca1(0x94)];if(!_0x264443)try{_0x264443=path['join'](_0x5c2417,_0xb80ff7);}catch(_0x163271){console[_0x3edca1(0x8a)](_0x163271);}if(!_0x264443)return _0x2d3988[_0x3edca1(0xd9)]['returnErrMsg'](_0x28c808,_0x3edca1(0x7c));if(dbUserTable[_0x3edca1(0xdf)](_0x2d3988,_0x28c808,_0x3edca1(0xbf),_0x3edca1(0x72),'')==!![]){let _0x91e646=_0x2d3988[_0x3edca1(0x117)][_0x3edca1(0x99)]||'openPath';process['send']({'type':_0x3edca1(0x10c),'shellType':_0x91e646,'path':_0x264443});let _0x3a0c81={'code':0x0};return _0x28c808[_0x3edca1(0xcd)](_0x3a0c81);}}),module[_0x792809(0x12b)]=router;