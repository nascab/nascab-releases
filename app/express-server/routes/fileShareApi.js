function _0x2803(){const _0x14f055=['/delete','lastInsertRowid','ipv4','webdavHttp','12EuUsQR','pathSignNoNull','isDirectory','server_type=?\x20order\x20by\x20id\x20desc','\x20path_sign=?\x20and\x20server_type=\x27WebDav\x27','../../db/dbFileShare','../../db/dbUserTable','6036200NTZbGB','webdavHttps','getById','3468312LhIjok','is_admin','app','FTP','delete','json','constants','451895ojBbyB','log','FTPServer','express','share.alreadyHasOtherFtp','ftpHttp','user_id','body','update','currentUser','deleteShareUser','globalIpList','1772784BckRAF','type','createShareUser','ftp://','20460690LbJuIj','findByTitle','serverType','stat','dbOther','W_OK','post','getSharesUserByShareId','/getById','path','pathSign','userHasFtp','server_type','getByWhere','send','value','create','\x20username,id','5816573RNSzIg','length','../../db/dbConfigTable','\x20id\x20in\x20','/getAll','R_OK','returnErrMsg','share.samePathSign','access','users','https://','webDavHttpsServer','username','exports','1iHrutr','fileShareRestart','parse','http://','1208870KxmjVo','\x20path\x20is\x20not\x20directory','getAllByWhere'];_0x2803=function(){return _0x14f055;};return _0x2803();}const _0x26fda0=_0x156d;(function(_0x4acb5a,_0x4849a8){const _0x1431d9=_0x156d,_0x1eb5c5=_0x4acb5a();while(!![]){try{const _0x55676f=parseInt(_0x1431d9(0x17a))/0x1*(parseInt(_0x1431d9(0x17e))/0x2)+parseInt(_0x1431d9(0x18f))/0x3+-parseInt(_0x1431d9(0x18c))/0x4+-parseInt(_0x1431d9(0x196))/0x5+parseInt(_0x1431d9(0x185))/0x6*(-parseInt(_0x1431d9(0x1b8))/0x7)+parseInt(_0x1431d9(0x1a2))/0x8+parseInt(_0x1431d9(0x1a6))/0x9;if(_0x55676f===_0x4849a8)break;else _0x1eb5c5['push'](_0x1eb5c5['shift']());}catch(_0x31e5e9){_0x1eb5c5['push'](_0x1eb5c5['shift']());}}}(_0x2803,0xf2bc0));var express=require(_0x26fda0(0x199)),router=express['Router']();function _0x156d(_0x42369a,_0x55ef77){const _0x280373=_0x2803();return _0x156d=function(_0x156dee,_0x22141c){_0x156dee=_0x156dee-0x172;let _0x266123=_0x280373[_0x156dee];return _0x266123;},_0x156d(_0x42369a,_0x55ef77);}let path=require('path'),fs=require('fs');const dbFileShare=require(_0x26fda0(0x18a)),dbUserTable=require(_0x26fda0(0x18b));let dbConfigTable=require(_0x26fda0(0x1ba));router[_0x26fda0(0x1ac)]('/create',(_0x391240,_0x25c4d1,_0xb33388)=>{const _0x5b1ba7=_0x26fda0;if(_0x391240[_0x5b1ba7(0x19f)]['is_admin']!=0x1)return _0x25c4d1[_0x5b1ba7(0x194)]({'code':0x66});let _0x220110=_0x391240[_0x5b1ba7(0x19d)][_0x5b1ba7(0x1a3)],_0x20652d=_0x391240['body'][_0x5b1ba7(0x175)],_0x3e009e=_0x391240[_0x5b1ba7(0x19d)][_0x5b1ba7(0x1af)],_0x44d4d1=_0x391240[_0x5b1ba7(0x19d)][_0x5b1ba7(0x1a8)];fs[_0x5b1ba7(0x174)](_0x3e009e,fs[_0x5b1ba7(0x195)][_0x5b1ba7(0x1ab)]|fs['constants'][_0x5b1ba7(0x1bd)],_0x5bd919=>{const _0x877f3c=_0x5b1ba7;if(_0x5bd919)return _0x391240[_0x877f3c(0x191)][_0x877f3c(0x172)](_0x25c4d1,_0x25c4d1['__']('noWritePermission')+':'+_0x3e009e);let _0x33278a=_0x391240[_0x877f3c(0x19d)][_0x877f3c(0x1b0)];if(_0x44d4d1=='WebDav'){if(!_0x33278a)return _0x391240[_0x877f3c(0x191)][_0x877f3c(0x172)](_0x25c4d1,_0x25c4d1['__'](_0x877f3c(0x186)));else{let _0x27a1bf=[_0x33278a],_0x21cfda=_0x877f3c(0x189),_0x51244e=dbFileShare[_0x877f3c(0x1b3)](_0x391240['app'][_0x877f3c(0x1aa)],_0x21cfda,_0x27a1bf);if(_0x51244e){if(_0x220110=='create'||_0x220110==_0x877f3c(0x19e)&&_0x51244e['id']!=_0x391240[_0x877f3c(0x19d)]['id'])return _0x391240[_0x877f3c(0x191)][_0x877f3c(0x172)](_0x25c4d1,_0x25c4d1['__'](_0x877f3c(0x173))+':'+_0x33278a);}}}fs[_0x877f3c(0x1a9)](_0x3e009e,(_0x2dedbb,_0x38980c)=>{const _0x37b1d2=_0x877f3c;if(_0x2dedbb)return _0x391240[_0x37b1d2(0x191)][_0x37b1d2(0x172)](_0x25c4d1,'Invalid\x20path');if(_0x38980c[_0x37b1d2(0x187)]()){let _0x543c8b=_0x3e009e,_0x4688e6='\x20path=?\x20and\x20server_type=?',_0x1a8e48=[_0x543c8b,_0x44d4d1],_0x2acfe9=dbFileShare['getByWhere'](_0x391240[_0x37b1d2(0x191)][_0x37b1d2(0x1aa)],_0x4688e6,_0x1a8e48);if(_0x2acfe9){if(_0x220110==_0x37b1d2(0x1b6)||_0x220110=='update'&&_0x2acfe9['id']!=_0x391240[_0x37b1d2(0x19d)]['id'])return _0x391240[_0x37b1d2(0x191)][_0x37b1d2(0x172)](_0x25c4d1,_0x25c4d1['__']('share.samePathExist')+':'+_0x3e009e);}if(_0x44d4d1==_0x37b1d2(0x192)&&_0x220110==_0x37b1d2(0x1b6))for(let _0x51a2d7 in _0x20652d){let _0x110e3e=_0x20652d[_0x51a2d7]['id'],_0x57b932=dbUserTable['find'](_0x391240[_0x37b1d2(0x191)][_0x37b1d2(0x1aa)],_0x110e3e),_0x20947f=dbFileShare[_0x37b1d2(0x1b1)](_0x391240[_0x37b1d2(0x191)][_0x37b1d2(0x1aa)],_0x110e3e,_0x37b1d2(0x192));if(_0x20947f)return _0x391240[_0x37b1d2(0x191)][_0x37b1d2(0x172)](_0x25c4d1,_0x25c4d1['__'](_0x37b1d2(0x19a))+':'+_0x57b932[_0x37b1d2(0x178)]);}let _0x19d775={'path':_0x3e009e,'path_sign':_0x33278a,'server_type':_0x44d4d1};if(_0x220110=='create'){let _0x1eae1f=dbFileShare[_0x37b1d2(0x1b6)](_0x391240[_0x37b1d2(0x191)]['dbOther'],_0x19d775),_0x101e7a=_0x1eae1f[_0x37b1d2(0x182)];for(let _0x3cb7c9 in _0x20652d){dbFileShare['createShareUser'](_0x391240[_0x37b1d2(0x191)]['dbOther'],_0x101e7a,_0x20652d[_0x3cb7c9]['id']);}}else{if(_0x220110=='update'){let _0x5cdfb9=_0x391240[_0x37b1d2(0x19d)]['id'];dbFileShare[_0x37b1d2(0x19e)](_0x391240[_0x37b1d2(0x191)]['dbOther'],_0x19d775,_0x5cdfb9),dbFileShare[_0x37b1d2(0x1a0)](_0x391240[_0x37b1d2(0x191)][_0x37b1d2(0x1aa)],_0x5cdfb9);for(let _0x2c1366 in _0x20652d){dbFileShare[_0x37b1d2(0x1a4)](_0x391240[_0x37b1d2(0x191)][_0x37b1d2(0x1aa)],_0x5cdfb9,_0x20652d[_0x2c1366]['id']);}}}return process[_0x37b1d2(0x1b4)]({'type':_0x37b1d2(0x17b),'shareType':_0x44d4d1}),_0x25c4d1[_0x37b1d2(0x194)]({'code':0x0});}else return _0x391240['app'][_0x37b1d2(0x172)](_0x25c4d1,_0x37b1d2(0x17f));});});}),router[_0x26fda0(0x1ac)](_0x26fda0(0x181),(_0x2e0412,_0x5855f7,_0x1d9f5d)=>{const _0x347952=_0x26fda0;if(_0x2e0412[_0x347952(0x19f)][_0x347952(0x190)]!=0x1)return _0x5855f7[_0x347952(0x194)]({'code':0x66});let _0x5488ac=_0x2e0412[_0x347952(0x19d)]['id'],_0x133bbc=dbFileShare[_0x347952(0x18e)](_0x2e0412['app']['dbOther'],_0x5488ac);dbFileShare[_0x347952(0x193)](_0x2e0412['app'][_0x347952(0x1aa)],_0x5488ac),process[_0x347952(0x1b4)]({'type':_0x347952(0x17b),'shareType':_0x133bbc[_0x347952(0x1b2)]}),_0x5855f7[_0x347952(0x194)]({'code':0x0});}),router[_0x26fda0(0x1ac)](_0x26fda0(0x1bc),(_0x3493f9,_0x1cad69,_0x22c442)=>{const _0x4f98a9=_0x26fda0;if(_0x3493f9[_0x4f98a9(0x19f)][_0x4f98a9(0x190)]!=0x1)return _0x1cad69[_0x4f98a9(0x194)]({'code':0x66});let _0x27fff1=_0x3493f9[_0x4f98a9(0x19d)][_0x4f98a9(0x1a8)],_0x312edb=dbFileShare[_0x4f98a9(0x180)](_0x3493f9[_0x4f98a9(0x191)][_0x4f98a9(0x1aa)],_0x4f98a9(0x188),[_0x27fff1]);for(let _0x2c72d6 in _0x312edb){let _0x4bc11c=_0x312edb[_0x2c72d6],_0x9ee3ce=dbFileShare[_0x4f98a9(0x1ad)](_0x3493f9[_0x4f98a9(0x191)][_0x4f98a9(0x1aa)],_0x4bc11c['id']),_0x112d87='(';for(let _0x188378 in _0x9ee3ce){_0x112d87+=_0x9ee3ce[_0x188378][_0x4f98a9(0x19c)],_0x188378!=_0x9ee3ce[_0x4f98a9(0x1b9)]-0x1&&(_0x112d87+=',');}_0x112d87+=')';let _0xce610e=dbUserTable[_0x4f98a9(0x180)](_0x3493f9[_0x4f98a9(0x191)][_0x4f98a9(0x1aa)],_0x4f98a9(0x1bb)+_0x112d87+'\x20',_0x4f98a9(0x1b7));_0x312edb[_0x2c72d6]['users']=_0xce610e;}let _0x549587={'code':0x0,'data':_0x312edb},_0x4bd8d3='',_0x1bc03f='',_0x4eeaaf='';try{let _0x1898fe=dbConfigTable[_0x4f98a9(0x1a7)](_0x3493f9[_0x4f98a9(0x191)]['dbOther'],'webDavServer'),_0x4e773b=dbConfigTable[_0x4f98a9(0x1a7)](_0x3493f9[_0x4f98a9(0x191)]['dbOther'],_0x4f98a9(0x177)),_0x123a97=dbConfigTable[_0x4f98a9(0x1a7)](_0x3493f9[_0x4f98a9(0x191)][_0x4f98a9(0x1aa)],_0x4f98a9(0x198)),_0x11ed2a=dbConfigTable[_0x4f98a9(0x1a7)](_0x3493f9[_0x4f98a9(0x191)][_0x4f98a9(0x1aa)],_0x4f98a9(0x1a1));if(_0x11ed2a){_0x11ed2a=JSON['parse'](_0x11ed2a[_0x4f98a9(0x1b5)]);for(let _0x435978 of _0x11ed2a){if(_0x435978[_0x4f98a9(0x1a3)]==_0x4f98a9(0x183)){_0x4bd8d3=_0x4f98a9(0x17d)+_0x435978['ip'],_0x1bc03f=_0x4f98a9(0x176)+_0x435978['ip'],_0x4eeaaf=_0x4f98a9(0x1a5)+_0x435978['ip'];break;}}}_0x1898fe&&(_0x1898fe=JSON[_0x4f98a9(0x17c)](_0x1898fe[_0x4f98a9(0x1b5)]),_0x4bd8d3+=':'+_0x1898fe['port'],_0x549587[_0x4f98a9(0x184)]=_0x4bd8d3),_0x4e773b&&(_0x4e773b=JSON[_0x4f98a9(0x17c)](_0x4e773b[_0x4f98a9(0x1b5)]),_0x1bc03f+=':'+_0x4e773b['port'],_0x549587[_0x4f98a9(0x18d)]=_0x1bc03f),_0x123a97&&(_0x123a97=JSON['parse'](_0x123a97[_0x4f98a9(0x1b5)]),_0x4eeaaf+=':'+_0x123a97['port'],_0x549587[_0x4f98a9(0x19b)]=_0x4eeaaf);}catch(_0x432769){console[_0x4f98a9(0x197)](_0x432769);}_0x1cad69[_0x4f98a9(0x194)](_0x549587);}),router[_0x26fda0(0x1ac)](_0x26fda0(0x1ae),(_0x1d01d9,_0x22dadd,_0x156f0f)=>{const _0x25f70f=_0x26fda0;if(_0x1d01d9[_0x25f70f(0x19f)][_0x25f70f(0x190)]!=0x1)return _0x22dadd['json']({'code':0x66});let _0x227643=_0x1d01d9[_0x25f70f(0x19d)]['id'],_0x16e335=dbFileShare[_0x25f70f(0x18e)](_0x1d01d9[_0x25f70f(0x191)]['dbOther'],_0x227643),_0x3622ca=dbFileShare[_0x25f70f(0x1ad)](_0x1d01d9[_0x25f70f(0x191)][_0x25f70f(0x1aa)],_0x16e335['id']),_0x14bbf4='(';for(let _0x23afc0 in _0x3622ca){_0x14bbf4+=_0x3622ca[_0x23afc0][_0x25f70f(0x19c)],_0x23afc0!=_0x3622ca[_0x25f70f(0x1b9)]-0x1&&(_0x14bbf4+=',');}_0x14bbf4+=')';let _0x49fb93=dbUserTable['getAllByWhere'](_0x1d01d9[_0x25f70f(0x191)][_0x25f70f(0x1aa)],'\x20id\x20in\x20'+_0x14bbf4+'\x20','\x20username,id');_0x16e335['users']=_0x49fb93,_0x22dadd[_0x25f70f(0x194)]({'code':0x0,'data':_0x16e335});}),module[_0x26fda0(0x179)]=router;