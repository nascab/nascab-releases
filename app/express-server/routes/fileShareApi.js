function _0x49c2(_0x5abb42,_0x23242f){const _0x3c569e=_0x3c56();return _0x49c2=function(_0x49c2ae,_0x24fc77){_0x49c2ae=_0x49c2ae-0x16f;let _0x1a90e5=_0x3c569e[_0x49c2ae];return _0x1a90e5;},_0x49c2(_0x5abb42,_0x23242f);}const _0x15705f=_0x49c2;(function(_0x1fab9d,_0x55892b){const _0x410df4=_0x49c2,_0x351ba2=_0x1fab9d();while(!![]){try{const _0x3e3343=-parseInt(_0x410df4(0x182))/0x1*(parseInt(_0x410df4(0x17f))/0x2)+-parseInt(_0x410df4(0x1ad))/0x3+-parseInt(_0x410df4(0x17d))/0x4*(-parseInt(_0x410df4(0x19e))/0x5)+-parseInt(_0x410df4(0x183))/0x6+parseInt(_0x410df4(0x172))/0x7*(-parseInt(_0x410df4(0x184))/0x8)+parseInt(_0x410df4(0x1b1))/0x9*(parseInt(_0x410df4(0x1a1))/0xa)+-parseInt(_0x410df4(0x196))/0xb*(-parseInt(_0x410df4(0x1b9))/0xc);if(_0x3e3343===_0x55892b)break;else _0x351ba2['push'](_0x351ba2['shift']());}catch(_0x183dda){_0x351ba2['push'](_0x351ba2['shift']());}}}(_0x3c56,0x49b8d));var express=require(_0x15705f(0x1b4)),router=express[_0x15705f(0x188)]();let path=require('path'),fs=require('fs');function _0x3c56(){const _0x4e6da1=['/getAll','https://','currentUser','pathSign','create','Invalid\x20path','username','post','\x20username,id','app','2002FWKsCX','is_admin','../../db/dbUserTable','pathSignNoNull','webDavServer','serverType','FTPServer','lastInsertRowid','2237310abtlmi','update','returnErrMsg','430zcKoDX','FTP','share.samePathSign','\x20path=?\x20and\x20server_type=?','ipv4','delete','\x20path\x20is\x20not\x20directory','server_type=?\x20order\x20by\x20id\x20desc','share.alreadyHasOtherFtp','ftpHttp','port','globalIpList','1615149MarbJu','webdavHttp','dbOther','value','69354pIqlON','parse','exports','express','/delete','json','http://','getById','44364nbHYsV','createShareUser','webdavHttps','getSharesUserByShareId','find','252231LXEOaU','users','\x20id\x20in\x20','body','noWritePermission','W_OK','type','WebDav','fileShareRestart','getByWhere','findByTitle','4ZvjgeQ','access','2JWbgOB','webDavHttpsServer','/create','78567iZMTRW','602178xtyoqO','96diDpne','server_type','length','getAllByWhere','Router','../../db/dbConfigTable','deleteShareUser','R_OK'];_0x3c56=function(){return _0x4e6da1;};return _0x3c56();}const dbFileShare=require('../../db/dbFileShare'),dbUserTable=require(_0x15705f(0x198));let dbConfigTable=require(_0x15705f(0x189));router[_0x15705f(0x193)](_0x15705f(0x181),(_0x33e40f,_0xe758c4,_0x27d33c)=>{const _0x5f2f55=_0x15705f;if(_0x33e40f[_0x5f2f55(0x18e)][_0x5f2f55(0x197)]!=0x1)return _0xe758c4[_0x5f2f55(0x1b6)]({'code':0x66});let _0x5668bb=_0x33e40f[_0x5f2f55(0x175)]['type'],_0x1d1e59=_0x33e40f[_0x5f2f55(0x175)][_0x5f2f55(0x173)],_0x1effaf=_0x33e40f[_0x5f2f55(0x175)]['path'],_0x2a02a0=_0x33e40f[_0x5f2f55(0x175)]['serverType'];fs[_0x5f2f55(0x17e)](_0x1effaf,fs['constants'][_0x5f2f55(0x177)]|fs['constants'][_0x5f2f55(0x18b)],_0x187b7b=>{const _0x3ce6fe=_0x5f2f55;if(_0x187b7b)return _0x33e40f[_0x3ce6fe(0x195)]['returnErrMsg'](_0xe758c4,_0xe758c4['__'](_0x3ce6fe(0x176))+':'+_0x1effaf);let _0x236726=_0x33e40f['body'][_0x3ce6fe(0x18f)];if(_0x2a02a0==_0x3ce6fe(0x179)){if(!_0x236726)return _0x33e40f[_0x3ce6fe(0x195)][_0x3ce6fe(0x1a0)](_0xe758c4,_0xe758c4['__'](_0x3ce6fe(0x199)));else{let _0x2b6632=[_0x236726],_0x2c4125='\x20path_sign=?\x20and\x20server_type=\x27WebDav\x27',_0x10f3d7=dbFileShare[_0x3ce6fe(0x17b)](_0x33e40f[_0x3ce6fe(0x195)][_0x3ce6fe(0x1af)],_0x2c4125,_0x2b6632);if(_0x10f3d7){if(_0x5668bb=='create'||_0x5668bb=='update'&&_0x10f3d7['id']!=_0x33e40f[_0x3ce6fe(0x175)]['id'])return _0x33e40f[_0x3ce6fe(0x195)][_0x3ce6fe(0x1a0)](_0xe758c4,_0xe758c4['__'](_0x3ce6fe(0x1a3))+':'+_0x236726);}}}fs['stat'](_0x1effaf,(_0x420f7e,_0x38cb30)=>{const _0xfdce85=_0x3ce6fe;if(_0x420f7e)return _0x33e40f[_0xfdce85(0x195)]['returnErrMsg'](_0xe758c4,_0xfdce85(0x191));if(_0x38cb30['isDirectory']()){let _0x598f78=_0x1effaf,_0x70f4f=_0xfdce85(0x1a4),_0x4983bc=[_0x598f78,_0x2a02a0],_0x2fe45b=dbFileShare[_0xfdce85(0x17b)](_0x33e40f[_0xfdce85(0x195)][_0xfdce85(0x1af)],_0x70f4f,_0x4983bc);if(_0x2fe45b){if(_0x5668bb=='create'||_0x5668bb==_0xfdce85(0x19f)&&_0x2fe45b['id']!=_0x33e40f[_0xfdce85(0x175)]['id'])return _0x33e40f[_0xfdce85(0x195)][_0xfdce85(0x1a0)](_0xe758c4,_0xe758c4['__']('share.samePathExist')+':'+_0x1effaf);}if(_0x2a02a0==_0xfdce85(0x1a2)&&_0x5668bb==_0xfdce85(0x190))for(let _0x166ec8 in _0x1d1e59){let _0x212d4a=_0x1d1e59[_0x166ec8]['id'],_0x51023c=dbUserTable[_0xfdce85(0x171)](_0x33e40f[_0xfdce85(0x195)][_0xfdce85(0x1af)],_0x212d4a),_0x5bb917=dbFileShare['userHasFtp'](_0x33e40f[_0xfdce85(0x195)][_0xfdce85(0x1af)],_0x212d4a,_0xfdce85(0x1a2));if(_0x5bb917)return _0x33e40f['app'][_0xfdce85(0x1a0)](_0xe758c4,_0xe758c4['__'](_0xfdce85(0x1a9))+':'+_0x51023c[_0xfdce85(0x192)]);}let _0x46566a={'path':_0x1effaf,'path_sign':_0x236726,'server_type':_0x2a02a0};if(_0x5668bb==_0xfdce85(0x190)){let _0x4f390b=dbFileShare[_0xfdce85(0x190)](_0x33e40f[_0xfdce85(0x195)]['dbOther'],_0x46566a),_0x49b266=_0x4f390b[_0xfdce85(0x19d)];for(let _0x3642d9 in _0x1d1e59){dbFileShare[_0xfdce85(0x1ba)](_0x33e40f[_0xfdce85(0x195)][_0xfdce85(0x1af)],_0x49b266,_0x1d1e59[_0x3642d9]['id']);}}else{if(_0x5668bb==_0xfdce85(0x19f)){let _0x10b584=_0x33e40f[_0xfdce85(0x175)]['id'];dbFileShare[_0xfdce85(0x19f)](_0x33e40f['app'][_0xfdce85(0x1af)],_0x46566a,_0x10b584),dbFileShare[_0xfdce85(0x18a)](_0x33e40f[_0xfdce85(0x195)][_0xfdce85(0x1af)],_0x10b584);for(let _0x545c66 in _0x1d1e59){dbFileShare[_0xfdce85(0x1ba)](_0x33e40f[_0xfdce85(0x195)][_0xfdce85(0x1af)],_0x10b584,_0x1d1e59[_0x545c66]['id']);}}}return process['send']({'type':_0xfdce85(0x17a),'shareType':_0x2a02a0}),_0xe758c4[_0xfdce85(0x1b6)]({'code':0x0});}else return _0x33e40f[_0xfdce85(0x195)][_0xfdce85(0x1a0)](_0xe758c4,_0xfdce85(0x1a7));});});}),router['post'](_0x15705f(0x1b5),(_0x23d829,_0x119e74,_0x313446)=>{const _0xe21d0=_0x15705f;if(_0x23d829[_0xe21d0(0x18e)][_0xe21d0(0x197)]!=0x1)return _0x119e74[_0xe21d0(0x1b6)]({'code':0x66});let _0x431e56=_0x23d829['body']['id'],_0x5ee906=dbFileShare[_0xe21d0(0x1b8)](_0x23d829[_0xe21d0(0x195)]['dbOther'],_0x431e56);dbFileShare[_0xe21d0(0x1a6)](_0x23d829['app']['dbOther'],_0x431e56),process['send']({'type':_0xe21d0(0x17a),'shareType':_0x5ee906[_0xe21d0(0x185)]}),_0x119e74[_0xe21d0(0x1b6)]({'code':0x0});}),router[_0x15705f(0x193)](_0x15705f(0x18c),(_0x3520dd,_0x584a1b,_0xc49644)=>{const _0x1f98bf=_0x15705f;if(_0x3520dd[_0x1f98bf(0x18e)][_0x1f98bf(0x197)]!=0x1)return _0x584a1b[_0x1f98bf(0x1b6)]({'code':0x66});let _0x5f01f8=_0x3520dd[_0x1f98bf(0x175)][_0x1f98bf(0x19b)],_0x4bea02=dbFileShare[_0x1f98bf(0x187)](_0x3520dd[_0x1f98bf(0x195)][_0x1f98bf(0x1af)],_0x1f98bf(0x1a8),[_0x5f01f8]);for(let _0x171035 in _0x4bea02){let _0x38be08=_0x4bea02[_0x171035],_0x177dfd=dbFileShare[_0x1f98bf(0x170)](_0x3520dd[_0x1f98bf(0x195)][_0x1f98bf(0x1af)],_0x38be08['id']),_0x23d502='(';for(let _0x1cee3d in _0x177dfd){_0x23d502+=_0x177dfd[_0x1cee3d]['user_id'],_0x1cee3d!=_0x177dfd[_0x1f98bf(0x186)]-0x1&&(_0x23d502+=',');}_0x23d502+=')';let _0x4f0131=dbUserTable['getAllByWhere'](_0x3520dd[_0x1f98bf(0x195)][_0x1f98bf(0x1af)],_0x1f98bf(0x174)+_0x23d502+'\x20',_0x1f98bf(0x194));_0x4bea02[_0x171035][_0x1f98bf(0x173)]=_0x4f0131;}let _0x23e82b={'code':0x0,'data':_0x4bea02},_0x3ebda4='',_0x22d0ea='',_0x48e7c7='';try{let _0x97c761=dbConfigTable[_0x1f98bf(0x17c)](_0x3520dd['app'][_0x1f98bf(0x1af)],_0x1f98bf(0x19a)),_0x265fc5=dbConfigTable['findByTitle'](_0x3520dd[_0x1f98bf(0x195)][_0x1f98bf(0x1af)],_0x1f98bf(0x180)),_0x50373c=dbConfigTable[_0x1f98bf(0x17c)](_0x3520dd['app'][_0x1f98bf(0x1af)],_0x1f98bf(0x19c)),_0x46487e=dbConfigTable[_0x1f98bf(0x17c)](_0x3520dd[_0x1f98bf(0x195)][_0x1f98bf(0x1af)],_0x1f98bf(0x1ac));if(_0x46487e){_0x46487e=JSON[_0x1f98bf(0x1b2)](_0x46487e[_0x1f98bf(0x1b0)]);for(let _0x14d871 of _0x46487e){if(_0x14d871[_0x1f98bf(0x178)]==_0x1f98bf(0x1a5)){_0x3ebda4=_0x1f98bf(0x1b7)+_0x14d871['ip'],_0x22d0ea=_0x1f98bf(0x18d)+_0x14d871['ip'],_0x48e7c7='ftp://'+_0x14d871['ip'];break;}}}_0x97c761&&(_0x97c761=JSON[_0x1f98bf(0x1b2)](_0x97c761[_0x1f98bf(0x1b0)]),_0x3ebda4+=':'+_0x97c761[_0x1f98bf(0x1ab)],_0x23e82b[_0x1f98bf(0x1ae)]=_0x3ebda4),_0x265fc5&&(_0x265fc5=JSON[_0x1f98bf(0x1b2)](_0x265fc5[_0x1f98bf(0x1b0)]),_0x22d0ea+=':'+_0x265fc5[_0x1f98bf(0x1ab)],_0x23e82b[_0x1f98bf(0x16f)]=_0x22d0ea),_0x50373c&&(_0x50373c=JSON[_0x1f98bf(0x1b2)](_0x50373c[_0x1f98bf(0x1b0)]),_0x48e7c7+=':'+_0x50373c[_0x1f98bf(0x1ab)],_0x23e82b[_0x1f98bf(0x1aa)]=_0x48e7c7);}catch(_0x2b874e){console['log'](_0x2b874e);}_0x584a1b[_0x1f98bf(0x1b6)](_0x23e82b);}),router[_0x15705f(0x193)]('/getById',(_0xab4574,_0x908889,_0x1ea086)=>{const _0x37a0b9=_0x15705f;if(_0xab4574[_0x37a0b9(0x18e)][_0x37a0b9(0x197)]!=0x1)return _0x908889['json']({'code':0x66});let _0x343b7c=_0xab4574[_0x37a0b9(0x175)]['id'],_0x1c573d=dbFileShare[_0x37a0b9(0x1b8)](_0xab4574[_0x37a0b9(0x195)][_0x37a0b9(0x1af)],_0x343b7c),_0x88ab23=dbFileShare[_0x37a0b9(0x170)](_0xab4574[_0x37a0b9(0x195)][_0x37a0b9(0x1af)],_0x1c573d['id']),_0x3470a1='(';for(let _0x434e6a in _0x88ab23){_0x3470a1+=_0x88ab23[_0x434e6a]['user_id'],_0x434e6a!=_0x88ab23[_0x37a0b9(0x186)]-0x1&&(_0x3470a1+=',');}_0x3470a1+=')';let _0x1f2d95=dbUserTable[_0x37a0b9(0x187)](_0xab4574['app'][_0x37a0b9(0x1af)],_0x37a0b9(0x174)+_0x3470a1+'\x20',_0x37a0b9(0x194));_0x1c573d[_0x37a0b9(0x173)]=_0x1f2d95,_0x908889[_0x37a0b9(0x1b6)]({'code':0x0,'data':_0x1c573d});}),module[_0x15705f(0x1b3)]=router;