const _0xe3ce7b=_0x11c9;(function(_0xfc7719,_0x7d610a){const _0x237df2=_0x11c9,_0x8b4789=_0xfc7719();while(!![]){try{const _0x2deaa5=-parseInt(_0x237df2(0x1dc))/0x1+parseInt(_0x237df2(0x1db))/0x2*(parseInt(_0x237df2(0x1cf))/0x3)+parseInt(_0x237df2(0x191))/0x4*(parseInt(_0x237df2(0x17e))/0x5)+-parseInt(_0x237df2(0x1eb))/0x6*(-parseInt(_0x237df2(0x1e4))/0x7)+parseInt(_0x237df2(0x17c))/0x8+-parseInt(_0x237df2(0x213))/0x9*(-parseInt(_0x237df2(0x1f5))/0xa)+-parseInt(_0x237df2(0x1b0))/0xb*(parseInt(_0x237df2(0x22e))/0xc);if(_0x2deaa5===_0x7d610a)break;else _0x8b4789['push'](_0x8b4789['shift']());}catch(_0x4d9c97){_0x8b4789['push'](_0x8b4789['shift']());}}}(_0x5308,0xd59b2));function _0x11c9(_0x7b6fce,_0x13ae2f){const _0x5308b6=_0x5308();return _0x11c9=function(_0x11c99c,_0x5c5b79){_0x11c99c=_0x11c99c-0x16e;let _0x1be17b=_0x5308b6[_0x11c99c];return _0x1be17b;},_0x11c9(_0x7b6fce,_0x13ae2f);}let express=require(_0xe3ce7b(0x1a5)),router=express[_0xe3ce7b(0x1cb)](),path=require('path'),fs=require('fs'),dbBookIndexTable=require(_0xe3ce7b(0x1f7)),dbFileIndexTable=require(_0xe3ce7b(0x1f1)),dbBookListTable=require(_0xe3ce7b(0x21c)),dbBookFavorite=require(_0xe3ce7b(0x20a));function _0x5308(){const _0x40a28f=['search','INDEX_TABLE_NAME_BOOK','sendFile','catch','getBookListBookCount','introduction','/setReaderConfig','query','封面文件已不存在','filePath','\x20\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20title\x20\x20LIKE\x20?)\x20','replace','edit','existsSync','\x20LIMIT\x20?\x20OFFSET\x20?\x20','removeBookFromList','../../db/dbBookFavorite','bookList','language','now','fileName','fileCount','join','get','/addReadRecord','123516HYDJkM','parent','book_filename','substring','indexId','getFavoriteCount','removeBookList','basename','stat','../../db/dbBookListTable','log','\x20FROM\x20file_index_book\x20WHERE\x20','listType','/deleteSameNameCover','orderType','publisher','orderField','\x20id,is_file,id,path,filename,type,size,title,artist,ext,cover_path,language,publisher,total_page,type,check_time,create_time','power_change','UPDATE\x20book_read_record\x20SET\x20progress=?,read_time=?\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?','recentReadList','getTime','play_count','groupField','artist','title','sortFileNamesByNumber','949044KAYiDA','prepare','dbOther','uid','bookListId','favorite_time','run','path','searchStr','post','json','\x20order\x20by\x20f.','getGroupList','year','lastIndexOf','NO\x20book\x20INDEX','checkOrderParams','returnErrMsg','push','tag','cover\x20format\x20error','app','endsWith','getById','add','UPDATE\x20book_reader_config\x20SET\x20config_json=?\x20WHERE\x20uid=?','need\x20type/indexId','body','/getBookCover','getUserPathWhere','8309504pWMSAt','birthtime','55vNbAsN','remark','deleteFavorite','/getHomeData','getBookListByPath','runGetBookInfoWorker','parse','delete','../../db/dbUserTable','\x20order\x20by\x20f.artist_fl\x20','deleteFail','need\x20bookListId','length','need\x20index\x20id','book_path','/refreshCheckTime','filename','SELECT\x20*\x20FROM\x20book_reader_config\x20WHERE\x20uid\x20=\x20?','REPLACE\x20INTO\x20book_read_record\x20(uid,book_filename,book_path,progress,read_time)\x20VALUES(?,?,?,?,?)','560220DrcNDK','createBookList','progress','/getBookDetail','letterIndex','.nfo','configJson','SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?','\x20order\x20by\x20m.update_time\x20DESC\x20','UPDATE\x20book_reader_config\x20SET\x20remark=?\x20WHERE\x20uid=?','platform','offset','REPLACE\x20INTO\x20book_reader_config\x20(uid,config_json,remark)\x20VALUES(?,?,?)','updateBook','genre','publish_date','addFavorite','book_count','operation\x20error','getBookListById','express','/setBookType','cover_path','bookIsFavorite','name','is_file','封面文件已删除','status','sharpWriteCover','end','list','737sJHgGa','SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_size=?','封面写入成功','operation','doUserCanGet','currentUser','power_get','check_time','/operationBookListIndex','.jpg','exports','saveBookNfo','then','../../db/dbSourceFolderTable','isbn','need\x20type',',f.title\x20','\x20AND\x20(filename_fl\x20=?\x20or\x20title_fl=?\x20)','includes','SELECT\x20count(*)\x20as\x20count\x20FROM\x20file_index_book\x20WHERE\x20path=?\x20and\x20is_file=1','all','need\x20\x27name\x27','need\x20bookIndexId','\x20order\x20by\x20f.title_fl\x20','../../myConfig/config','need\x20bookIndexId/bookListId','getBookIndex','Router','desc','file_cover_path','folderNotExist','69846MNuchT','/updateBookNfo',',f.filename_fl\x20','updateByFiled','getMediaCoverCachePath','/getBookList','/getGroupList','is_admin','favorite',',f.artist\x20','getAllFavoriteByWhere','\x20AND\x20(filename\x20like\x20?\x20\x20OR\x20title\x20\x20like\x20?\x20OR\x20artist\x20like\x20?\x20OR\x20tag\x20like\x20?\x20OR\x20publisher\x20like\x20?\x20OR\x20isbn\x20like\x20?\x20OR\x20genre\x20like\x20?\x20OR\x20year\x20like\x20?)','112dhPisV','431149KSyHXm','book','UPDATE\x20file_index_book\x20set\x20check_time=?\x20WHERE\x20id=?','type','count','dbFileIndex','exist','whereStr','1658629gJBVVq','nfo写入失败','addBookToBookList','fileExist','username','bookIndexId','getBookListCount','30cjANbS','getFavorite','/getBookIndexFileTree','extname','coverData','updateBookList','../../db/dbFileIndexTable','index\x20id\x20error','update','SELECT\x20id\x20from\x20file_index_book\x20where\x20is_file=1\x20and\x20path\x20=?\x20or\x20path\x20like\x20?','1120zSPOBk','getBookList','../../db/dbBookIndexTable','getBookIndexByFileName','comicList'];_0x5308=function(){return _0x40a28f;};return _0x5308();}const dbUserTable=require(_0xe3ce7b(0x186)),dbSourceFolderTable=require(_0xe3ce7b(0x1bd));let os=require('os'),config=require(_0xe3ce7b(0x1c8));const bookIndexUtil=require('../../myWorkers/index/bookIndexUtil'),arrayUtil=require('../../utils/arrayUtil'),nfoUtil=require('../../utils/nfoUtil');function getBookSameNameCover(_0x1021fc){return new Promise((_0x813443,_0x3b3f2d)=>{const _0x1c784d=_0x11c9;try{let _0x417acd=_0x1021fc['filename'][_0x1c784d(0x205)](path[_0x1c784d(0x1ee)](_0x1021fc['filename']),''),_0x3b89e9=path['join'](_0x1021fc[_0x1c784d(0x235)],_0x417acd+_0x1c784d(0x1b9)),_0x33acf8='';fs[_0x1c784d(0x207)](_0x3b89e9)&&(_0x33acf8=_0x3b89e9),_0x813443(_0x33acf8);}catch(_0x566400){_0x813443('');}});}router['post'](_0xe3ce7b(0x200),(_0x5378a9,_0x1f6bb0,_0x165190)=>{const _0x30546e=_0xe3ce7b;let _0x52772d=_0x5378a9[_0x30546e(0x1b5)]['id'],_0x13d011=_0x5378a9['body'][_0x30546e(0x197)],_0x50f7e3=_0x5378a9[_0x30546e(0x179)][_0x30546e(0x17f)];if(!_0x13d011&&!_0x50f7e3)return _0x5378a9['app'][_0x30546e(0x16f)](_0x1f6bb0,'need\x20config\x20json');try{JSON[_0x30546e(0x184)](_0x13d011);}catch(_0x5286eb){return _0x5378a9[_0x30546e(0x173)][_0x30546e(0x16f)](_0x1f6bb0,'config\x20json\x20format\x20error');}let _0x16d61e=_0x5378a9[_0x30546e(0x173)][_0x30546e(0x230)]['prepare']('SELECT\x20*\x20FROM\x20book_reader_config\x20WHERE\x20uid=?')[_0x30546e(0x211)](_0x52772d);if(_0x16d61e){if(_0x13d011)_0x5378a9[_0x30546e(0x173)]['dbOther'][_0x30546e(0x22f)](_0x30546e(0x177))[_0x30546e(0x234)](_0x13d011,_0x52772d);else _0x50f7e3&&_0x5378a9[_0x30546e(0x173)][_0x30546e(0x230)][_0x30546e(0x22f)](_0x30546e(0x19a))[_0x30546e(0x234)](_0x50f7e3,_0x52772d);}else _0x5378a9[_0x30546e(0x173)][_0x30546e(0x230)]['prepare'](_0x30546e(0x19d))[_0x30546e(0x234)](_0x52772d,_0x13d011,_0x50f7e3);return _0x1f6bb0['json']({'code':0x0});}),router[_0xe3ce7b(0x237)](_0xe3ce7b(0x220),(_0x12200f,_0x37c2f3,_0xdf6342)=>{const _0x3cbd41=_0xe3ce7b;let _0x210c3d=_0x12200f[_0x3cbd41(0x1b5)]['id'],_0x405fe9=_0x12200f[_0x3cbd41(0x179)]['bookIndexId'];if(!_0x405fe9)return _0x12200f['app'][_0x3cbd41(0x16f)](_0x37c2f3,_0x3cbd41(0x1c6));let _0x2a104d=dbFileIndexTable[_0x3cbd41(0x175)](_0x12200f[_0x3cbd41(0x173)][_0x3cbd41(0x1e1)],_0x405fe9,dbFileIndexTable[_0x3cbd41(0x1fb)]);if(!_0x2a104d)return _0x12200f[_0x3cbd41(0x173)][_0x3cbd41(0x16f)](_0x37c2f3,_0x3cbd41(0x1c6));dbUserTable[_0x3cbd41(0x1b4)](_0x12200f,_0x37c2f3,'','power_delete',_0x2a104d['path'])==!![]&&getBookSameNameCover(_0x2a104d)[_0x3cbd41(0x1bc)](_0x2192ba=>{const _0x1d3910=_0x3cbd41;if(!_0x2192ba[_0x1d3910(0x174)](_0x1d3910(0x1b9)))return _0x12200f['app'][_0x1d3910(0x16f)](_0x37c2f3,_0x1d3910(0x172));fs['stat'](_0x2192ba,(_0x2e957e,_0x44b879)=>{const _0x1104f6=_0x1d3910;if(_0x2e957e)return console[_0x1104f6(0x21d)](_0x1104f6(0x202)),_0x37c2f3[_0x1104f6(0x238)]({'code':0x0});fs['rm'](_0x2192ba,_0x30ec2e=>{const _0x4faaeb=_0x1104f6;if(_0x30ec2e)return _0x12200f[_0x4faaeb(0x173)]['returnErrMsg'](_0x37c2f3,_0x37c2f3['__'](_0x4faaeb(0x188))+_0x2192ba);return console[_0x4faaeb(0x21d)](_0x4faaeb(0x1ab),_0x2192ba),_0x37c2f3[_0x4faaeb(0x238)]({'code':0x0});});});});}),router[_0xe3ce7b(0x237)](_0xe3ce7b(0x18d),(_0x2713a0,_0x4ea37c,_0x492725)=>{const _0x468a7c=_0xe3ce7b;let _0x49e8d2=_0x2713a0['currentUser']['id'],_0x5ec69a=_0x2713a0[_0x468a7c(0x179)][_0x468a7c(0x1e9)];if(!_0x5ec69a)return _0x4ea37c[_0x468a7c(0x1ac)](0x194)[_0x468a7c(0x1ae)]();return dbBookIndexTable[_0x468a7c(0x1d2)](_0x2713a0[_0x468a7c(0x173)][_0x468a7c(0x1e1)],_0x5ec69a,_0x468a7c(0x1b7),new Date()[_0x468a7c(0x228)]()),_0x4ea37c['json']({'code':0x0});}),router[_0xe3ce7b(0x237)](_0xe3ce7b(0x212),(_0x50e40f,_0x57f477,_0x3a71b3)=>{const _0x1400f3=_0xe3ce7b;let _0xf9c4ff=_0x50e40f[_0x1400f3(0x1b5)]['id'];if(!_0x50e40f[_0x1400f3(0x179)]['fileName']||!_0x50e40f['body'][_0x1400f3(0x203)]||!_0x50e40f[_0x1400f3(0x179)][_0x1400f3(0x193)])return _0x57f477['json']({'code':0x0});let _0x5449be=_0x50e40f[_0x1400f3(0x179)][_0x1400f3(0x20e)];_0x5449be=path[_0x1400f3(0x21a)](_0x50e40f['body'][_0x1400f3(0x20e)]);let _0x443c40=path[_0x1400f3(0x210)](_0x50e40f[_0x1400f3(0x179)][_0x1400f3(0x203)]),_0x419810=_0x50e40f['body']['progress'],_0x3c46a5=_0x50e40f[_0x1400f3(0x173)][_0x1400f3(0x1e1)][_0x1400f3(0x22f)](_0x1400f3(0x198))[_0x1400f3(0x211)](_0xf9c4ff,_0x5449be,_0x443c40);return _0x3c46a5?_0x50e40f[_0x1400f3(0x173)]['dbFileIndex']['prepare'](_0x1400f3(0x226))[_0x1400f3(0x234)](_0x419810,Date[_0x1400f3(0x20d)](),_0xf9c4ff,_0x5449be,_0x443c40):_0x50e40f[_0x1400f3(0x173)][_0x1400f3(0x1e1)][_0x1400f3(0x22f)](_0x1400f3(0x190))[_0x1400f3(0x234)](_0xf9c4ff,_0x5449be,_0x443c40,_0x419810,Date[_0x1400f3(0x20d)]()),_0x57f477['json']({'code':0x0});}),router[_0xe3ce7b(0x237)]('/getReadRecord',(_0x168ff0,_0x309486,_0x169bd0)=>{const _0x27ea65=_0xe3ce7b;let _0x21e093=_0x168ff0[_0x27ea65(0x1b5)]['id'],_0x20a7a8=_0x168ff0[_0x27ea65(0x173)][_0x27ea65(0x230)][_0x27ea65(0x22f)](_0x27ea65(0x18f))['get'](_0x21e093),_0x25db25=0x0,_0x4a7b8b=_0x168ff0[_0x27ea65(0x179)]['fileName'],_0x1be6e9=_0x168ff0[_0x27ea65(0x179)]['filePath'];if(_0x4a7b8b&&_0x1be6e9){_0x1be6e9=path[_0x27ea65(0x210)](_0x1be6e9+'');let _0x1fafe6=_0x168ff0[_0x27ea65(0x173)]['dbFileIndex'][_0x27ea65(0x22f)](_0x27ea65(0x198))[_0x27ea65(0x211)](_0x21e093,_0x4a7b8b,_0x1be6e9);_0x1fafe6&&(_0x25db25=_0x1fafe6[_0x27ea65(0x193)]);}return _0x309486[_0x27ea65(0x238)]({'code':0x0,'progress':_0x25db25,'readerConfig':_0x20a7a8});}),router['post'](_0xe3ce7b(0x1a6),(_0x2d9f01,_0x343102,_0x32418c)=>{const _0x453229=_0xe3ce7b;let _0x5749d3=_0x2d9f01[_0x453229(0x179)][_0x453229(0x217)],_0xea98cf=_0x2d9f01[_0x453229(0x179)][_0x453229(0x1df)];if(!_0xea98cf||!_0x5749d3)return _0x2d9f01[_0x453229(0x173)][_0x453229(0x16f)](_0x343102,_0x453229(0x178));if(_0xea98cf!=0x1&&_0xea98cf!=0x2)return _0x2d9f01[_0x453229(0x173)][_0x453229(0x16f)](_0x343102,_0x453229(0x1bf));let _0x525277=dbBookIndexTable[_0x453229(0x1ca)](_0x2d9f01[_0x453229(0x173)]['dbFileIndex'],_0x5749d3);if(!_0x525277)return _0x2d9f01['app'][_0x453229(0x16f)](_0x343102,'book\x20not\x20exist');if(dbUserTable['doUserCanGet'](_0x2d9f01,_0x343102,_0x453229(0x1dd),_0x453229(0x225),_0x525277['path'])==!![])return dbBookIndexTable['updateByFiled'](_0x2d9f01['app'][_0x453229(0x1e1)],_0x5749d3,_0x453229(0x1df),_0xea98cf),_0x343102[_0x453229(0x238)]({'code':0x0});});function getListByParams(_0x4def4a,_0x5ca643,_0x589fa1,_0x4a4fb6,_0x1b0a3f,_0x592586,_0xa6b13f,_0x2adb0d,_0x1ff983,_0x2a5d2d,_0x42b778,_0x14d824){return new Promise((_0x586590,_0x253f9b)=>{const _0x55e1df=_0x11c9;let _0x5c83ec=_0x4def4a[_0x55e1df(0x173)][_0x55e1df(0x1e1)],_0x70dfb2=[];if(_0x589fa1==_0x55e1df(0x1af)||_0x589fa1==_0x55e1df(0x20b))_0x70dfb2=dbBookIndexTable[_0x55e1df(0x1f6)](_0x5c83ec,_0x5ca643,_0x4a4fb6,_0x1b0a3f,_0x592586,_0xa6b13f,_0x2adb0d,_0x2a5d2d,_0x1ff983,_0x42b778,_0x14d824);else{if(_0x589fa1==_0x55e1df(0x1d7)){let _0x167bd0='',_0x5273b7=[];_0x167bd0+='\x20is_file=1';_0x1ff983&&(_0x1ff983=_0x1ff983[_0x55e1df(0x205)]('\x27','')[_0x55e1df(0x205)]('’',''),_0x167bd0+=_0x55e1df(0x1da),_0x5273b7[_0x55e1df(0x170)]('%'+_0x1ff983+'%','%'+_0x1ff983+'%','%'+_0x1ff983+'%','%'+_0x1ff983+'%','%'+_0x1ff983+'%','%'+_0x1ff983+'%','%'+_0x1ff983+'%','%'+_0x1ff983+'%'));_0x42b778&&(_0x167bd0+=_0x55e1df(0x1c1),_0x5273b7[_0x55e1df(0x170)](_0x42b778,_0x42b778));if(_0x592586&&_0xa6b13f){if(_0x592586==_0x55e1df(0x22b))_0x167bd0+=_0x55e1df(0x187)+_0xa6b13f+_0x55e1df(0x1d8)+_0xa6b13f+'\x20';else{if(_0x592586==_0x55e1df(0x22c))_0x167bd0+=_0x55e1df(0x1c7)+_0xa6b13f+_0x55e1df(0x1c0)+_0xa6b13f+_0x55e1df(0x1d1)+_0xa6b13f+'\x20';else _0x592586==_0x55e1df(0x233)?_0x167bd0+='\x20order\x20by\x20m.update_time\x20'+_0xa6b13f+'\x20':_0x167bd0+=_0x55e1df(0x239)+_0x592586+'\x20'+_0xa6b13f+'\x20';}}else _0x167bd0+=_0x55e1df(0x199);_0x167bd0+=_0x55e1df(0x208),_0x5273b7[_0x55e1df(0x170)](_0x4a4fb6),_0x5273b7[_0x55e1df(0x170)](_0x1b0a3f),_0x70dfb2=dbBookFavorite[_0x55e1df(0x1d9)](_0x4def4a[_0x55e1df(0x173)][_0x55e1df(0x1e1)],_0x4def4a['currentUser']['id'],_0x167bd0,_0x5273b7);}}setBookListProps(_0x4def4a,_0x70dfb2)[_0x55e1df(0x1bc)](_0x3347b9=>{_0x586590(_0x3347b9);});});}function setBookListProps(_0x55dc16,_0x3f3945){return new Promise(async(_0x408f29,_0x25c744)=>{const _0x28934e=_0x11c9;for(let _0x9659ce of _0x3f3945){_0x9659ce['favorite']=dbBookFavorite[_0x28934e(0x1a8)](_0x55dc16['app']['dbFileIndex'],_0x9659ce['id'],_0x55dc16['currentUser']['id'])?'1':'0',_0x9659ce[_0x28934e(0x203)]=path[_0x28934e(0x210)](_0x9659ce['path'],_0x9659ce[_0x28934e(0x18e)]),_0x9659ce['file_cover_path']=await getBookSameNameCover(_0x9659ce);}_0x408f29(_0x3f3945);});}router['post'](_0xe3ce7b(0x181),(_0x9dd1a3,_0x53ca1a,_0x1d064d)=>{const _0x1c766a=_0xe3ce7b;let _0x57add7=_0x9dd1a3[_0x1c766a(0x179)][_0x1c766a(0x1e0)]?_0x9dd1a3[_0x1c766a(0x179)][_0x1c766a(0x1e0)]:0xc,_0x2c88ab=_0x9dd1a3[_0x1c766a(0x1b5)]['id'],_0x385a33=dbUserTable[_0x1c766a(0x17b)](_0x9dd1a3,'book',_0x1c766a(0x1b6),!![]);if(_0x9dd1a3[_0x1c766a(0x1b5)][_0x1c766a(0x1d6)]!=0x1&&!_0x385a33[_0x1c766a(0x1e3)])return _0x53ca1a[_0x1c766a(0x238)]({'code':0x0,'data':null});let _0xa10050=[],_0x986720=_0x9dd1a3[_0x1c766a(0x173)]['dbFileIndex'][_0x1c766a(0x22f)]('SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20ORDER\x20BY\x20read_time\x20desc\x20LIMIT\x20?')['all'](_0x2c88ab,_0x57add7);for(let _0x423096 of _0x986720){let _0x4702cc=dbBookIndexTable[_0x1c766a(0x1f8)](_0x9dd1a3[_0x1c766a(0x173)][_0x1c766a(0x1e1)],_0x423096[_0x1c766a(0x18c)],_0x423096[_0x1c766a(0x215)]);_0x4702cc&&dbUserTable[_0x1c766a(0x1b4)](_0x9dd1a3,_0x53ca1a,'book',_0x1c766a(0x1b6),_0x4702cc[_0x1c766a(0x235)],!![])==!![]&&(_0x4702cc[_0x1c766a(0x193)]=_0x423096[_0x1c766a(0x193)],_0xa10050[_0x1c766a(0x170)](_0x4702cc));}setBookListProps(_0x9dd1a3,_0xa10050)[_0x1c766a(0x1bc)](_0x4d8ddb=>{const _0x99fbd5=_0x1c766a;_0xa10050=_0x4d8ddb,getListByParams(_0x9dd1a3,_0x385a33,'list',_0x57add7,0x0,_0x99fbd5(0x1b7),_0x99fbd5(0x1cc),null,null,null,null,0x1)[_0x99fbd5(0x1bc)](_0x1ed59a=>{const _0x401134=_0x99fbd5;getListByParams(_0x9dd1a3,_0x385a33,_0x401134(0x1af),_0x57add7,0x0,_0x401134(0x1b7),_0x401134(0x1cc),null,null,null,null,0x2)[_0x401134(0x1bc)](_0x127d31=>{const _0x284efa=_0x401134;getListByParams(_0x9dd1a3,_0x385a33,_0x284efa(0x1af),_0x57add7,0x0,'id',_0x284efa(0x1cc))['then'](_0x5a6b41=>{const _0x47f644=_0x284efa;let _0x5f0472={};return _0xa10050&&_0xa10050[_0x47f644(0x18a)]>0x0&&(_0x5f0472[_0x47f644(0x227)]=_0xa10050),_0x5a6b41&&_0x5a6b41['length']>0x0&&(_0x5f0472['recentAddList']=_0x5a6b41),_0x1ed59a&&_0x1ed59a['length']>0x0&&(_0x5f0472[_0x47f644(0x20b)]=_0x1ed59a),_0x127d31&&_0x127d31[_0x47f644(0x18a)]>0x0&&(_0x5f0472[_0x47f644(0x1f9)]=_0x127d31),_0x53ca1a['json']({'code':0x0,'data':_0x5f0472,'platform':os[_0x47f644(0x19b)]()});});});});});}),router[_0xe3ce7b(0x237)](_0xe3ce7b(0x1d4),(_0x58491b,_0x32fadb,_0x7f07cf)=>{const _0x1d46fe=_0xe3ce7b;let _0x3a7669=_0x58491b[_0x1d46fe(0x179)][_0x1d46fe(0x1e0)]||0x32,_0x99baa7=_0x58491b[_0x1d46fe(0x179)][_0x1d46fe(0x19c)]||0x0,_0xc1c80c=_0x58491b[_0x1d46fe(0x179)][_0x1d46fe(0x22b)],_0x301138=_0x58491b[_0x1d46fe(0x179)][_0x1d46fe(0x223)]||'check_time',_0x337626=_0x58491b[_0x1d46fe(0x179)][_0x1d46fe(0x221)]||_0x1d46fe(0x1cc),_0x257c31=[_0x1d46fe(0x1af),_0x1d46fe(0x1d7),_0x1d46fe(0x20b)],_0x48c5d4=_0x58491b[_0x1d46fe(0x179)][_0x1d46fe(0x21f)]||_0x1d46fe(0x1af),_0x401f1a=_0x58491b[_0x1d46fe(0x179)][_0x1d46fe(0x1fa)],_0x3bec7c=_0x58491b[_0x1d46fe(0x179)]['letterIndex'],_0x2a5e09=_0x58491b[_0x1d46fe(0x179)][_0x1d46fe(0x232)],_0x230725=_0x58491b['body']['type'];if(dbBookIndexTable[_0x1d46fe(0x16e)](_0x58491b,_0x32fadb,_0x301138,_0x337626)!==!![])return;if(_0x48c5d4==_0x1d46fe(0x20b)){if(!_0x2a5e09)return _0x58491b[_0x1d46fe(0x173)]['returnErrMsg'](_0x32fadb,_0x1d46fe(0x189));}!_0x257c31[_0x1d46fe(0x1c2)](_0x48c5d4)&&(_0x48c5d4=_0x1d46fe(0x1af));_0x3a7669>0x1f4&&(_0x3a7669=0x1f4);let _0x3d993c=dbUserTable[_0x1d46fe(0x17b)](_0x58491b,_0x1d46fe(0x1dd),_0x1d46fe(0x1b6),!![]);if(_0x58491b[_0x1d46fe(0x1b5)][_0x1d46fe(0x1d6)]!=0x1&&!_0x3d993c[_0x1d46fe(0x1e3)])return _0x32fadb[_0x1d46fe(0x238)]({'code':0x0,'data':null});getListByParams(_0x58491b,_0x3d993c,_0x48c5d4,_0x3a7669,_0x99baa7,_0x301138,_0x337626,_0xc1c80c,_0x401f1a,_0x2a5e09,_0x3bec7c,_0x230725)[_0x1d46fe(0x1bc)](_0x49f169=>{const _0x73ac63=_0x1d46fe;let _0x5577c9={'code':0x0,'data':_0x49f169};if(_0x48c5d4==_0x73ac63(0x1d7))_0x5577c9[_0x73ac63(0x1a2)]=dbBookFavorite[_0x73ac63(0x218)](_0x58491b['app'][_0x73ac63(0x1e1)],_0x58491b[_0x73ac63(0x1b5)]['id']);else{if(_0x48c5d4=='list')_0x5577c9[_0x73ac63(0x1a2)]=dbBookIndexTable[_0x73ac63(0x1ea)](_0x58491b[_0x73ac63(0x173)][_0x73ac63(0x1e1)],_0x3d993c,_0xc1c80c,_0x401f1a,_0x230725);else _0x48c5d4==_0x73ac63(0x20b)&&(_0x5577c9[_0x73ac63(0x1a2)]=dbBookListTable[_0x73ac63(0x1fe)](_0x58491b[_0x73ac63(0x173)][_0x73ac63(0x1e1)],_0x2a5e09));}return _0x32fadb[_0x73ac63(0x238)](_0x5577c9);});}),router[_0xe3ce7b(0x237)](_0xe3ce7b(0x194),(_0x44cff0,_0x430a20,_0x206774)=>{const _0x339a7a=_0xe3ce7b;let _0x6ae876=_0x44cff0[_0x339a7a(0x179)]['id'],_0x45cf55=dbFileIndexTable[_0x339a7a(0x175)](_0x44cff0[_0x339a7a(0x173)][_0x339a7a(0x1e1)],_0x6ae876,dbFileIndexTable[_0x339a7a(0x1fb)]);if(!_0x45cf55)return _0x44cff0['app'][_0x339a7a(0x16f)](_0x430a20,_0x339a7a(0x23d));if(dbUserTable['doUserCanGet'](_0x44cff0,_0x430a20,_0x339a7a(0x1dd),_0x339a7a(0x1b6),_0x45cf55[_0x339a7a(0x235)])==!![]){let _0x24b156=_0x44cff0[_0x339a7a(0x1b5)]['id'],_0x33e06d=dbBookFavorite[_0x339a7a(0x1ec)](_0x44cff0[_0x339a7a(0x173)][_0x339a7a(0x1e1)],_0x24b156,_0x6ae876);_0x45cf55[_0x339a7a(0x1d7)]=_0x33e06d?0x1:0x0,_0x45cf55[_0x339a7a(0x203)]=path[_0x339a7a(0x210)](_0x45cf55[_0x339a7a(0x235)],_0x45cf55['filename']);let _0x536362=dbBookIndexTable[_0x339a7a(0x182)](_0x44cff0[_0x339a7a(0x173)][_0x339a7a(0x1e1)],_0x45cf55['path']);_0x536362[_0x339a7a(0x18a)]>0x0?(_0x536362=arrayUtil[_0x339a7a(0x22d)](_0x536362,'filename'),setBookListProps(_0x44cff0,_0x536362)[_0x339a7a(0x1bc)](_0x39f004=>{_0x536362=_0x39f004,_0x37861c();})):_0x37861c;function _0x37861c(){const _0x56218e=_0x339a7a;let _0x1cb123={'code':0x0,'data':_0x45cf55,'sameFolderBookList':_0x536362};getBookSameNameCover(_0x45cf55)[_0x56218e(0x1bc)](_0x48bb53=>{const _0x447c11=_0x56218e;_0x45cf55[_0x447c11(0x1cd)]=_0x48bb53;let _0xc27c4c=_0x44cff0[_0x447c11(0x173)]['dbFileIndex'][_0x447c11(0x22f)](_0x447c11(0x1b1))[_0x447c11(0x211)](_0x24b156,path['join'](_0x45cf55[_0x447c11(0x235)],_0x45cf55['filename']),_0x45cf55['size']);_0xc27c4c&&(_0x1cb123[_0x447c11(0x193)]=_0xc27c4c['progress']),_0x1cb123[_0x447c11(0x1e7)]=fs[_0x447c11(0x21b)](_0x45cf55[_0x447c11(0x203)],(_0x2c0a76,_0xf3f0b)=>{const _0x3f4f88=_0x447c11;return _0x2c0a76?_0x1cb123[_0x3f4f88(0x1e2)]=0x0:_0x1cb123[_0x3f4f88(0x1e2)]=0x1,_0x430a20['json'](_0x1cb123);});});}}}),router[_0xe3ce7b(0x237)]('/bookFavorite',(_0x1c096a,_0x1149b0,_0x5dc897)=>{const _0x388423=_0xe3ce7b;let _0x563478=_0x1c096a[_0x388423(0x1b5)]['id'];function _0x35876f(_0x378f4d){const _0xb074c9=_0x388423;let _0x5d2856=dbFileIndexTable[_0xb074c9(0x175)](_0x1c096a['app'][_0xb074c9(0x1e1)],_0x378f4d,dbFileIndexTable['INDEX_TABLE_NAME_BOOK']);if(!_0x5d2856)return;let _0x2bb755=new Date()[_0xb074c9(0x228)]();_0x1c096a['app'][_0xb074c9(0x1e1)][_0xb074c9(0x22f)](_0xb074c9(0x1de))[_0xb074c9(0x234)](_0x2bb755,_0x378f4d),dbBookFavorite[_0xb074c9(0x1a1)](_0x1c096a['app']['dbFileIndex'],_0x563478,_0x378f4d);}if(_0x1c096a['body']['indexId']instanceof Array){let _0x2cd9d0=_0x1c096a[_0x388423(0x179)][_0x388423(0x1b3)];if(_0x2cd9d0==_0x388423(0x176))for(let _0x513dcc of _0x1c096a[_0x388423(0x179)][_0x388423(0x217)]){_0x35876f(_0x513dcc);}else{if(_0x2cd9d0==_0x388423(0x185))for(let _0x5f1220 of _0x1c096a[_0x388423(0x179)][_0x388423(0x217)]){dbBookFavorite[_0x388423(0x180)](_0x1c096a[_0x388423(0x173)]['dbFileIndex'],_0x563478,_0x5f1220);}}return _0x1149b0['json']({'code':0x0});}else{let _0x4d180c=parseInt(_0x1c096a['body'][_0x388423(0x217)]),_0x4d271b=dbBookFavorite['getFavorite'](_0x1c096a['app'][_0x388423(0x1e1)],_0x563478,_0x4d180c),_0x48c42a=0x0;return _0x4d271b?dbBookFavorite[_0x388423(0x180)](_0x1c096a[_0x388423(0x173)][_0x388423(0x1e1)],_0x563478,_0x4d180c):(_0x48c42a=0x1,_0x35876f(_0x4d180c)),_0x1149b0[_0x388423(0x238)]({'code':0x0,'favorite':_0x48c42a});}}),router[_0xe3ce7b(0x211)](_0xe3ce7b(0x17a),(_0x10373c,_0x35b903,_0x29a947)=>{const _0x470bba=_0xe3ce7b;let _0x380c25=_0x10373c[_0x470bba(0x201)]['indexId'],_0x604a15=dbBookIndexTable[_0x470bba(0x1ca)](_0x10373c['app'][_0x470bba(0x1e1)],_0x380c25),_0x2a93ee=_0x10373c[_0x470bba(0x201)]['size'];!_0x2a93ee&&(_0x2a93ee=0x200);if(!_0x604a15||_0x604a15&&!_0x604a15['cover_path'])return _0x35b903[_0x470bba(0x1ac)](0x194)[_0x470bba(0x1ae)]();dbUserTable[_0x470bba(0x1b4)](_0x10373c,_0x35b903,'book',_0x470bba(0x1b6),_0x604a15[_0x470bba(0x235)])==!![]&&fs[_0x470bba(0x21b)](_0x604a15[_0x470bba(0x1a7)],(_0x2038b7,_0x2b3592)=>{const _0x275957=_0x470bba;if(_0x2038b7){let _0x4b6fb5=config[_0x275957(0x1d3)](_0x604a15);bookIndexUtil[_0x275957(0x183)](_0x604a15,_0x4b6fb5)[_0x275957(0x1bc)](_0x53561e=>{const _0x53fb57=_0x275957;if(_0x53561e[_0x53fb57(0x1ef)])bookIndexUtil[_0x53fb57(0x1ad)](_0x53561e[_0x53fb57(0x1ef)],_0x4b6fb5)[_0x53fb57(0x1bc)](_0x59b3d1=>{const _0x1f0010=_0x53fb57;return console[_0x1f0010(0x21d)](_0x1f0010(0x1b2),_0x59b3d1),_0x35b903[_0x1f0010(0x1fc)](_0x59b3d1);})[_0x53fb57(0x1fd)](_0x4f7e29=>{const _0x12fef1=_0x53fb57;return _0x35b903[_0x12fef1(0x1ac)](0x194)['end']();});else return _0x35b903[_0x53fb57(0x1ac)](0x194)[_0x53fb57(0x1ae)]();})[_0x275957(0x1fd)](_0x4329cd=>{const _0x179f84=_0x275957;return _0x35b903[_0x179f84(0x1ac)](0x194)[_0x179f84(0x1ae)]();});}else return _0x35b903[_0x275957(0x1fc)](_0x604a15['cover_path']);});}),router[_0xe3ce7b(0x237)](_0xe3ce7b(0x1d5),(_0x4a4365,_0x574be2,_0x29c442)=>{const _0x2af3b3=_0xe3ce7b;let _0x4ff902=_0x4a4365['body'][_0x2af3b3(0x1e0)]||0x32,_0xc8068c=_0x4a4365['body'][_0x2af3b3(0x19c)]||0x0,_0x114436=_0x4a4365[_0x2af3b3(0x179)][_0x2af3b3(0x22a)]||_0x2af3b3(0x20b),_0x2ff88f=_0x4a4365[_0x2af3b3(0x179)][_0x2af3b3(0x223)]||_0x2af3b3(0x1b7),_0x39fe5f=_0x4a4365[_0x2af3b3(0x179)][_0x2af3b3(0x221)]||_0x2af3b3(0x1cc),_0x440c13=_0x4a4365[_0x2af3b3(0x179)][_0x2af3b3(0x1fa)],_0x16c1cd=_0x4a4365[_0x2af3b3(0x179)][_0x2af3b3(0x195)];if(dbBookIndexTable['checkOrderParams'](_0x4a4365,_0x574be2,_0x2ff88f,_0x39fe5f)!==!![])return;let _0x29900e=[_0x2af3b3(0x1b7),_0x2af3b3(0x229),_0x2af3b3(0x1b7),'filename',_0x2af3b3(0x22c),_0x2af3b3(0x22b),_0x2af3b3(0x17d),'id',_0x2af3b3(0x222)],_0x353feb=['asc','desc'];if(!_0x29900e['includes'](_0x2ff88f)||!_0x353feb[_0x2af3b3(0x1c2)](_0x39fe5f))return _0x4a4365['app'][_0x2af3b3(0x16f)](_0x574be2,'orderField/orderType\x20error',_0x2ff88f,_0x39fe5f);let _0x5de205=dbUserTable[_0x2af3b3(0x17b)](_0x4a4365,_0x2af3b3(0x1dd),'power_get',!![]);if(_0x4a4365[_0x2af3b3(0x1b5)][_0x2af3b3(0x1d6)]!=0x1&&!_0x5de205[_0x2af3b3(0x1e3)]&&_0x114436!=_0x2af3b3(0x20b))return _0x574be2[_0x2af3b3(0x238)]({'code':0x0,'data':null});let _0x4ebc9d=[];if(_0x114436==_0x2af3b3(0x22b))_0x4ebc9d=dbBookIndexTable[_0x2af3b3(0x23a)](_0x4a4365['app']['dbFileIndex'],_0x5de205,_0x114436,_0x4ff902,_0xc8068c,_0x2ff88f,_0x39fe5f,_0x440c13,_0x16c1cd);else{if(_0x114436==_0x2af3b3(0x20b)){_0x4ebc9d=dbBookListTable['getBookListList'](_0x4a4365[_0x2af3b3(0x173)]['dbFileIndex'],_0x4a4365[_0x2af3b3(0x1b5)]['id'],_0x4ff902,_0xc8068c,'id',_0x2af3b3(0x1cc),_0x440c13);for(let _0x35dc95 of _0x4ebc9d){_0x35dc95['cover']=dbBookIndexTable['getBooklistCover'](_0x4a4365[_0x2af3b3(0x173)][_0x2af3b3(0x1e1)],_0x35dc95['id']);}}}return _0x574be2[_0x2af3b3(0x238)]({'code':0x0,'data':_0x4ebc9d});}),router[_0xe3ce7b(0x237)]('/operationBookList',(_0x270ec0,_0x342a9b,_0x4e2738)=>{const _0x164cc3=_0xe3ce7b;let _0x3f49ac=_0x270ec0['body'][_0x164cc3(0x1a9)],_0x5e4c0b=_0x270ec0[_0x164cc3(0x179)][_0x164cc3(0x1b3)];if(_0x5e4c0b==_0x164cc3(0x176)){if(!_0x3f49ac)return _0x270ec0['app'][_0x164cc3(0x16f)](_0x342a9b,_0x164cc3(0x1c5));dbBookListTable[_0x164cc3(0x192)](_0x270ec0[_0x164cc3(0x173)][_0x164cc3(0x1e1)],_0x270ec0[_0x164cc3(0x1b5)]['id'],_0x3f49ac);}else{if(_0x5e4c0b=='edit'||_0x5e4c0b==_0x164cc3(0x185)){let _0x475458=_0x270ec0[_0x164cc3(0x179)][_0x164cc3(0x232)],_0x2bc02c=dbBookListTable[_0x164cc3(0x1a4)](_0x270ec0[_0x164cc3(0x173)]['dbFileIndex'],_0x475458),_0x3e9f7e=![];(_0x270ec0['currentUser'][_0x164cc3(0x1d6)]==0x1||_0x2bc02c[_0x164cc3(0x231)]==_0x270ec0['currentUser']['id'])&&(_0x3e9f7e=!![]);if(!_0x3e9f7e)return _0x342a9b[_0x164cc3(0x238)]({'code':0x66});if(_0x5e4c0b==_0x164cc3(0x185))dbBookListTable[_0x164cc3(0x219)](_0x270ec0[_0x164cc3(0x173)][_0x164cc3(0x1e1)],_0x475458);else{if(_0x5e4c0b==_0x164cc3(0x206)){if(!_0x3f49ac)return _0x270ec0[_0x164cc3(0x173)][_0x164cc3(0x16f)](_0x342a9b,'need\x20\x27name\x27');dbBookListTable[_0x164cc3(0x1f0)](_0x270ec0['app'][_0x164cc3(0x1e1)],_0x475458,_0x3f49ac);}}}else return _0x270ec0[_0x164cc3(0x173)][_0x164cc3(0x16f)](_0x342a9b,_0x164cc3(0x1a3));}return _0x342a9b[_0x164cc3(0x238)]({'code':0x0});}),router['post'](_0xe3ce7b(0x1b8),(_0x31885f,_0x26bad3,_0x2be859)=>{const _0x2eda0f=_0xe3ce7b;let _0xe0a866=_0x31885f[_0x2eda0f(0x179)][_0x2eda0f(0x1e9)],_0x443ef3=_0x31885f['body'][_0x2eda0f(0x232)];if(!_0xe0a866||!_0x443ef3)return _0x31885f[_0x2eda0f(0x173)][_0x2eda0f(0x16f)](_0x26bad3,_0x2eda0f(0x1c9));let _0x2631a5=dbBookListTable[_0x2eda0f(0x1a4)](_0x31885f[_0x2eda0f(0x173)]['dbFileIndex'],_0x443ef3);if(!_0x2631a5)return _0x31885f[_0x2eda0f(0x173)]['returnErrMsg'](_0x26bad3,'bookListId\x20no\x20exists');let _0x3ede40=_0x31885f[_0x2eda0f(0x179)][_0x2eda0f(0x1b3)];if(_0x3ede40==_0x2eda0f(0x176)){function _0x2df44f(_0x1f6b1c){const _0x4251a7=_0x2eda0f;let _0x31caf5=dbBookIndexTable[_0x4251a7(0x1ca)](_0x31885f[_0x4251a7(0x173)][_0x4251a7(0x1e1)],_0x1f6b1c);if(!_0x31caf5)return;if(_0x31caf5['is_file']==0x1){dbBookListTable[_0x4251a7(0x1e6)](_0x31885f['app']['dbFileIndex'],_0x1f6b1c,_0x443ef3);let _0x12bc0d=Date[_0x4251a7(0x20d)]();_0x31885f[_0x4251a7(0x173)][_0x4251a7(0x1e1)][_0x4251a7(0x22f)]('UPDATE\x20file_index_book\x20set\x20check_time=?\x20WHERE\x20id=?')[_0x4251a7(0x234)](_0x12bc0d,_0x31caf5['id']);}else{let _0x255c96=path[_0x4251a7(0x210)](_0x31caf5[_0x4251a7(0x235)],_0x31caf5['filename']),_0xefd670=_0x31885f[_0x4251a7(0x173)][_0x4251a7(0x1e1)][_0x4251a7(0x22f)](_0x4251a7(0x1f4))[_0x4251a7(0x1c4)](_0x255c96,_0x255c96+path['sep']+'%');for(let _0x3d8455 of _0xefd670){dbBookListTable[_0x4251a7(0x1e6)](_0x31885f[_0x4251a7(0x173)]['dbFileIndex'],_0x3d8455['id'],_0x443ef3);}}}if(_0xe0a866 instanceof Array)for(let _0x2a3917 of _0xe0a866){_0x2df44f(_0x2a3917);}else _0x2df44f(_0xe0a866);}else{if(_0x3ede40==_0x2eda0f(0x185)){if(_0xe0a866 instanceof Array)for(let _0x16315f of _0xe0a866){dbBookListTable[_0x2eda0f(0x209)](_0x31885f[_0x2eda0f(0x173)][_0x2eda0f(0x1e1)],_0x16315f,_0x443ef3);}else dbBookListTable[_0x2eda0f(0x209)](_0x31885f[_0x2eda0f(0x173)][_0x2eda0f(0x1e1)],_0xe0a866,_0x443ef3);}else return _0x31885f[_0x2eda0f(0x173)]['returnErrMsg'](_0x26bad3,_0x2eda0f(0x1a3));}return _0x26bad3['json']({'code':0x0,'data':{}});}),router[_0xe3ce7b(0x237)](_0xe3ce7b(0x1ed),(_0x423a57,_0x1804ef,_0x3ac6a0)=>{const _0x2d6389=_0xe3ce7b;let _0x413543=_0x423a57[_0x2d6389(0x179)][_0x2d6389(0x214)],_0x15f85e=_0x423a57[_0x2d6389(0x179)][_0x2d6389(0x236)],_0x269f68='book';if(dbUserTable[_0x2d6389(0x1b4)](_0x423a57,_0x1804ef,_0x269f68,_0x2d6389(0x1b6))==!![]){let _0x5f2cea=[];if(!_0x413543){let _0x24a7b2=[];_0x423a57[_0x2d6389(0x1b5)][_0x2d6389(0x1d6)]==0x1?_0x24a7b2=dbSourceFolderTable['getPathByType'](_0x423a57[_0x2d6389(0x173)][_0x2d6389(0x230)],_0x269f68):_0x24a7b2=dbUserTable['getUserPower'](_0x423a57[_0x2d6389(0x173)]['dbOther'],_0x423a57['currentUser'][_0x2d6389(0x1e8)],_0x269f68);if(_0x24a7b2)for(let _0xfe23cc=0x0;_0xfe23cc<_0x24a7b2[_0x2d6389(0x18a)];_0xfe23cc++){_0x5f2cea['push']({'path':_0x24a7b2[_0xfe23cc][_0x2d6389(0x235)],'is_file':0x0,'filename':path[_0x2d6389(0x21a)](_0x24a7b2[_0xfe23cc][_0x2d6389(0x235)]),'root':!![]});}}else{let _0x301d8a=[];if(_0x423a57[_0x2d6389(0x1b5)][_0x2d6389(0x1d6)]!=0x1){if(dbUserTable[_0x2d6389(0x1b4)](_0x423a57,_0x1804ef,_0x269f68,_0x2d6389(0x1b6),_0x413543)!==!![])return;}_0x413543=path[_0x2d6389(0x210)](_0x413543);let _0x179b1a='\x20path=?\x20\x20';_0x301d8a[_0x2d6389(0x170)](_0x413543);if(_0x15f85e){let _0x12a75b=_0x2d6389(0x204);_0x179b1a+=_0x12a75b,_0x301d8a[_0x2d6389(0x170)]('%'+_0x15f85e+'%'),_0x301d8a['push']('%'+_0x15f85e+'%');}let _0x31c67a=_0x2d6389(0x224);_0x5f2cea=_0x423a57[_0x2d6389(0x173)][_0x2d6389(0x1e1)][_0x2d6389(0x22f)]('SELECT\x20'+_0x31c67a+_0x2d6389(0x21e)+_0x179b1a)[_0x2d6389(0x1c4)](_0x301d8a);}for(let _0x57c999 of _0x5f2cea){if(_0x57c999[_0x2d6389(0x1aa)]==0x0){let _0x1ba17d=path['join'](_0x57c999[_0x2d6389(0x235)],_0x57c999['filename']),_0x5d340f=_0x423a57['app'][_0x2d6389(0x1e1)][_0x2d6389(0x22f)](_0x2d6389(0x1c3))[_0x2d6389(0x211)](_0x1ba17d);_0x57c999[_0x2d6389(0x20f)]=_0x5d340f[_0x2d6389(0x1e0)];}}let _0x3cfa0a=path['sep'],_0x4c97c0={'code':0x0,'data':_0x5f2cea,'sep':_0x3cfa0a};return _0x1804ef[_0x2d6389(0x238)](_0x4c97c0);}}),router[_0xe3ce7b(0x237)](_0xe3ce7b(0x1d0),(_0x2d8f80,_0x407e92,_0x5d49ab)=>{const _0x834c8a=_0xe3ce7b;let _0x1e6faa=_0x2d8f80['body'][_0x834c8a(0x1e9)],_0x7df060=_0x2d8f80[_0x834c8a(0x179)]['operation'];if(!_0x1e6faa)return _0x2d8f80['app'][_0x834c8a(0x16f)](_0x407e92,_0x834c8a(0x18b));let _0x2d3b79=dbBookIndexTable['getBookIndex'](_0x2d8f80[_0x834c8a(0x173)][_0x834c8a(0x1e1)],_0x1e6faa);if(!_0x2d3b79)return _0x2d8f80['app'][_0x834c8a(0x16f)](_0x407e92,_0x834c8a(0x1f2));if(_0x7df060==_0x834c8a(0x1f3)){let _0x5ccd91={'title':_0x2d8f80[_0x834c8a(0x179)][_0x834c8a(0x22c)],'publish_date':_0x2d8f80['body'][_0x834c8a(0x1a0)],'year':_0x2d8f80[_0x834c8a(0x179)][_0x834c8a(0x23b)],'isbn':_0x2d8f80[_0x834c8a(0x179)][_0x834c8a(0x1be)],'language':_0x2d8f80[_0x834c8a(0x179)][_0x834c8a(0x20c)],'genre':_0x2d8f80[_0x834c8a(0x179)][_0x834c8a(0x19f)],'tag':_0x2d8f80['body'][_0x834c8a(0x171)],'publisher':_0x2d8f80[_0x834c8a(0x179)][_0x834c8a(0x222)],'artist':_0x2d8f80[_0x834c8a(0x179)][_0x834c8a(0x22b)],'introduction':_0x2d8f80[_0x834c8a(0x179)][_0x834c8a(0x1ff)]},_0x4f5272=path[_0x834c8a(0x210)](_0x2d3b79[_0x834c8a(0x235)],_0x2d3b79[_0x834c8a(0x18e)]);fs[_0x834c8a(0x21b)](_0x4f5272,(_0x1daab2,_0x4adba2)=>{const _0x4cdaee=_0x834c8a;if(_0x1daab2)return _0x2d8f80[_0x4cdaee(0x173)][_0x4cdaee(0x16f)](_0x407e92,_0x407e92['__'](_0x4cdaee(0x1ce))+_0x4f5272);let _0x3072b1=_0x4f5272[_0x4cdaee(0x216)](0x0,_0x4f5272[_0x4cdaee(0x23c)]('.'))+_0x4cdaee(0x196);nfoUtil[_0x4cdaee(0x1bb)](_0x5ccd91,_0x3072b1)[_0x4cdaee(0x1bc)](()=>{const _0x533bc4=_0x4cdaee;console[_0x533bc4(0x21d)]('nfo写入成功'),dbBookIndexTable['updateBook'](_0x2d8f80[_0x533bc4(0x173)][_0x533bc4(0x1e1)],_0x1e6faa,_0x5ccd91),_0x2d3b79=dbBookIndexTable[_0x533bc4(0x1ca)](_0x2d8f80[_0x533bc4(0x173)][_0x533bc4(0x1e1)],_0x1e6faa),setBookListProps(_0x2d8f80,[_0x2d3b79])[_0x533bc4(0x1bc)](_0x4ab9ec=>{return _0x407e92['json']({'code':0x0,'data':_0x4ab9ec[0x0]});});})[_0x4cdaee(0x1fd)](_0x55936d=>{const _0x4e9f03=_0x4cdaee;return console[_0x4e9f03(0x21d)](_0x4e9f03(0x1e5),_0x55936d),_0x2d8f80['app'][_0x4e9f03(0x16f)](_0x407e92,'error');});});}else{if(_0x7df060=='delete'){let _0x54359a=path[_0x834c8a(0x210)](_0x2d3b79[_0x834c8a(0x235)],_0x2d3b79[_0x834c8a(0x18e)]),_0x144eb5=_0x54359a[_0x834c8a(0x216)](0x0,_0x54359a[_0x834c8a(0x23c)]('.'))+_0x834c8a(0x196);fs['stat'](_0x144eb5,(_0x4fc38e,_0x1e2aac)=>{const _0x15b2f2=_0x834c8a;if(_0x4fc38e)return _0x2d8f80[_0x15b2f2(0x173)][_0x15b2f2(0x16f)](_0x407e92,_0x407e92['__'](_0x15b2f2(0x1ce))+_0x144eb5);fs['rm'](_0x144eb5,_0x3dc940=>{const _0x232399=_0x15b2f2;if(_0x3dc940)return _0x2d8f80['app']['returnErrMsg'](_0x407e92,_0x407e92['__'](_0x232399(0x188))+_0x144eb5);return dbBookIndexTable[_0x232399(0x19e)](_0x2d8f80['app'][_0x232399(0x1e1)],indexId,{}),_0x407e92['json']({'code':0x0});});});}else return _0x2d8f80[_0x834c8a(0x173)][_0x834c8a(0x16f)](_0x407e92,_0x834c8a(0x1a3));}}),module[_0xe3ce7b(0x1ba)]=router;