const _0x1fd921=_0x44e7;(function(_0x510897,_0x45936d){const _0x44b6bb=_0x44e7,_0x5ef168=_0x510897();while(!![]){try{const _0x836758=parseInt(_0x44b6bb(0x21e))/0x1*(-parseInt(_0x44b6bb(0x227))/0x2)+parseInt(_0x44b6bb(0x24e))/0x3+-parseInt(_0x44b6bb(0x20f))/0x4*(parseInt(_0x44b6bb(0x288))/0x5)+parseInt(_0x44b6bb(0x214))/0x6+parseInt(_0x44b6bb(0x211))/0x7*(-parseInt(_0x44b6bb(0x219))/0x8)+parseInt(_0x44b6bb(0x264))/0x9*(-parseInt(_0x44b6bb(0x2a7))/0xa)+-parseInt(_0x44b6bb(0x21d))/0xb*(-parseInt(_0x44b6bb(0x246))/0xc);if(_0x836758===_0x45936d)break;else _0x5ef168['push'](_0x5ef168['shift']());}catch(_0x1e11d6){_0x5ef168['push'](_0x5ef168['shift']());}}}(_0x3a60,0x87f15));let express=require('express'),router=express['Router'](),path=require(_0x1fd921(0x230)),fs=require('fs'),dbBookIndexTable=require(_0x1fd921(0x282)),dbFileIndexTable=require('../../db/dbFileIndexTable'),dbBookListTable=require('../../db/dbBookListTable'),dbBookFavorite=require(_0x1fd921(0x26f));const dbUserTable=require(_0x1fd921(0x293)),dbSourceFolderTable=require(_0x1fd921(0x223));function _0x3a60(){const _0x2c5c0d=['bookListId\x20no\x20exists','lastIndexOf','checkOrderParams','endsWith','\x20id,is_file,id,path,filename,type,size,title,artist,ext,cover_path,language,publisher,total_page,type,check_time,create_time','getBooklistCover','updateBook','getBookIndexByFileName','indexId','existsSync','favorite_time','power_delete','year','get','doUserCanGet','username','bookList','/setReaderConfig','filename','operation','power_change','/refreshCheckTime','letterIndex','sendFile','filePath','prepare','isbn','count','catch',',f.title\x20','SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_size=?','../../myWorkers/index/bookIndexUtil','parse','fileCount','12VNuSpz','SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20ORDER\x20BY\x20read_time\x20desc\x20LIMIT\x20?','5607vxKquM','../../utils/nfoUtil','/getBookCover','1368726gdthnE','/getGroupList','groupField','getBookListCount','getById','424iyvGor','getBookIndex','fileName','add','7964NOhjbv','72521wWgKhr','favorite','search','.jpg','json','../../db/dbSourceFolderTable','check_time','power_get','post','26kYQFmv','progress','end','language','nfo写入失败','saveBookNfo','configJson','length','searchStr','path','publisher','coverData','book_path','birthtime','getBookListByPath','getBookListList','basename','log','edit','app','\x20AND\x20(filename\x20like\x20?\x20\x20OR\x20title\x20\x20like\x20?\x20OR\x20artist\x20like\x20?\x20OR\x20tag\x20like\x20?\x20OR\x20publisher\x20like\x20?\x20OR\x20isbn\x20like\x20?\x20OR\x20genre\x20like\x20?\x20OR\x20year\x20like\x20?)','\x20AND\x20(filename_fl\x20=?\x20or\x20title_fl=?\x20)','UPDATE\x20file_index_book\x20set\x20check_time=?\x20WHERE\x20id=?','then','title','封面文件已不存在','.nfo','INDEX_TABLE_NAME_BOOK','need\x20\x27name\x27','UPDATE\x20book_read_record\x20SET\x20progress=?,read_time=?\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?','getFavoriteCount','21864rFbFFm','now','name','updateByFiled','stat','getAllFavoriteByWhere','cover','config\x20json\x20format\x20error','2538249msPvPf','createBookList','dbOther','orderField','play_count','need\x20config\x20json','size','platform','封面写入成功','removeBookList','deleteFavorite','is_admin','/updateBookNfo','artist','dbFileIndex','\x20path=?\x20\x20','status','getBookListById','book\x20not\x20exist','book','replace','update','14517ivCGdC','NO\x20book\x20INDEX','REPLACE\x20INTO\x20book_read_record\x20(uid,book_filename,book_path,progress,read_time)\x20VALUES(?,?,?,?,?)','push','SELECT\x20*\x20FROM\x20book_reader_config\x20WHERE\x20uid=?','tag','comicList','need\x20type','body','/getBookDetail','SELECT\x20count(*)\x20as\x20count\x20FROM\x20file_index_book\x20WHERE\x20path=?\x20and\x20is_file=1','../../db/dbBookFavorite','UPDATE\x20book_reader_config\x20SET\x20remark=?\x20WHERE\x20uid=?','book_filename','substring','SELECT\x20id\x20from\x20file_index_book\x20where\x20is_file=1\x20and\x20path\x20=?\x20or\x20path\x20like\x20?','asc','bookIndexId','whereStr','addFavorite','delete','extname','orderField/orderType\x20error','folderNotExist','cover\x20format\x20error','is_file',',f.artist\x20','getBookList','need\x20index\x20id','getTime','../../db/dbBookIndexTable','../../myConfig/config','nfo写入成功','type','parent','\x20order\x20by\x20f.','1254820DfCvWY','genre','getBookListBookCount','index\x20id\x20error','need\x20type/indexId','exist','desc','../../utils/arrayUtil','/getReadRecord','all','need\x20bookListId','../../db/dbUserTable','\x20\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20title\x20\x20LIKE\x20?)\x20','/getBookIndexFileTree','\x20order\x20by\x20f.title_fl\x20','/deleteSameNameCover','book_count','publish_date','join','SELECT\x20','exports','bookListId','run','returnErrMsg','/operationBookListIndex','list','orderType','need\x20bookIndexId/bookListId','need\x20bookIndexId','error','deleteFail','610FIvvjZ','SELECT\x20*\x20FROM\x20book_reader_config\x20WHERE\x20uid\x20=\x20?','sep','remark','file_cover_path','addBookToBookList','includes','\x20order\x20by\x20f.artist_fl\x20','currentUser'];_0x3a60=function(){return _0x2c5c0d;};return _0x3a60();}let os=require('os'),config=require(_0x1fd921(0x283));const bookIndexUtil=require(_0x1fd921(0x20c)),arrayUtil=require(_0x1fd921(0x28f)),nfoUtil=require(_0x1fd921(0x212));function _0x44e7(_0x565933,_0x49d641){const _0x3a60d4=_0x3a60();return _0x44e7=function(_0x44e7fc,_0x4a653c){_0x44e7fc=_0x44e7fc-0x1f4;let _0x2eddc3=_0x3a60d4[_0x44e7fc];return _0x2eddc3;},_0x44e7(_0x565933,_0x49d641);}function getBookSameNameCover(_0xe8d1f0){return new Promise((_0x36298b,_0x3eb52e)=>{const _0x854098=_0x44e7;try{let _0x3a9b02=_0xe8d1f0[_0x854098(0x1ff)]['replace'](path[_0x854098(0x279)](_0xe8d1f0['filename']),''),_0x46a9d8=path[_0x854098(0x29a)](_0xe8d1f0['path'],_0x3a9b02+_0x854098(0x221)),_0x1ed10e='';fs[_0x854098(0x1f6)](_0x46a9d8)&&(_0x1ed10e=_0x46a9d8),_0x36298b(_0x1ed10e);}catch(_0x36cdcd){_0x36298b('');}});}router[_0x1fd921(0x226)](_0x1fd921(0x1fe),(_0x2757f7,_0x1f7066,_0x5a820a)=>{const _0x29541d=_0x1fd921;let _0x3a5fac=_0x2757f7[_0x29541d(0x2af)]['id'],_0x39871a=_0x2757f7[_0x29541d(0x26c)][_0x29541d(0x22d)],_0x438a14=_0x2757f7['body'][_0x29541d(0x2aa)];if(!_0x39871a&&!_0x438a14)return _0x2757f7[_0x29541d(0x23a)][_0x29541d(0x29f)](_0x1f7066,_0x29541d(0x253));try{JSON[_0x29541d(0x20d)](_0x39871a);}catch(_0x5b190c){return _0x2757f7['app']['returnErrMsg'](_0x1f7066,_0x29541d(0x24d));}let _0xb4120e=_0x2757f7[_0x29541d(0x23a)][_0x29541d(0x250)][_0x29541d(0x206)](_0x29541d(0x268))[_0x29541d(0x1fa)](_0x3a5fac);if(_0xb4120e){if(_0x39871a)_0x2757f7['app'][_0x29541d(0x250)][_0x29541d(0x206)]('UPDATE\x20book_reader_config\x20SET\x20config_json=?\x20WHERE\x20uid=?')['run'](_0x39871a,_0x3a5fac);else _0x438a14&&_0x2757f7['app'][_0x29541d(0x250)]['prepare'](_0x29541d(0x270))['run'](_0x438a14,_0x3a5fac);}else _0x2757f7['app'][_0x29541d(0x250)][_0x29541d(0x206)]('REPLACE\x20INTO\x20book_reader_config\x20(uid,config_json,remark)\x20VALUES(?,?,?)')['run'](_0x3a5fac,_0x39871a,_0x438a14);return _0x1f7066[_0x29541d(0x222)]({'code':0x0});}),router['post'](_0x1fd921(0x297),(_0x577377,_0xaae30c,_0x51d19c)=>{const _0x28773a=_0x1fd921;let _0xec777=_0x577377['currentUser']['id'],_0x3ef885=_0x577377[_0x28773a(0x26c)]['bookIndexId'];if(!_0x3ef885)return _0x577377['app'][_0x28773a(0x29f)](_0xaae30c,_0x28773a(0x2a4));let _0x4ea4cb=dbFileIndexTable[_0x28773a(0x218)](_0x577377['app'][_0x28773a(0x25c)],_0x3ef885,dbFileIndexTable[_0x28773a(0x242)]);if(!_0x4ea4cb)return _0x577377[_0x28773a(0x23a)][_0x28773a(0x29f)](_0xaae30c,_0x28773a(0x2a4));dbUserTable[_0x28773a(0x1fb)](_0x577377,_0xaae30c,'',_0x28773a(0x1f8),_0x4ea4cb['path'])==!![]&&getBookSameNameCover(_0x4ea4cb)[_0x28773a(0x23e)](_0x337d88=>{const _0x234d58=_0x28773a;if(!_0x337d88[_0x234d58(0x2b3)](_0x234d58(0x221)))return _0x577377[_0x234d58(0x23a)]['returnErrMsg'](_0xaae30c,_0x234d58(0x27c));fs[_0x234d58(0x24a)](_0x337d88,(_0x174e8f,_0x20d709)=>{const _0x4a5a75=_0x234d58;if(_0x174e8f)return console[_0x4a5a75(0x238)](_0x4a5a75(0x240)),_0xaae30c[_0x4a5a75(0x222)]({'code':0x0});fs['rm'](_0x337d88,_0xbfeab5=>{const _0x4f3b0a=_0x4a5a75;if(_0xbfeab5)return _0x577377[_0x4f3b0a(0x23a)][_0x4f3b0a(0x29f)](_0xaae30c,_0xaae30c['__']('deleteFail')+_0x337d88);return console[_0x4f3b0a(0x238)]('封面文件已删除',_0x337d88),_0xaae30c[_0x4f3b0a(0x222)]({'code':0x0});});});});}),router['post'](_0x1fd921(0x202),(_0x33b2bd,_0x232ab5,_0x4bc7ac)=>{const _0x545227=_0x1fd921;let _0x13fc70=_0x33b2bd[_0x545227(0x2af)]['id'],_0x288644=_0x33b2bd[_0x545227(0x26c)][_0x545227(0x275)];if(!_0x288644)return _0x232ab5[_0x545227(0x25e)](0x194)[_0x545227(0x229)]();return dbBookIndexTable[_0x545227(0x249)](_0x33b2bd['app'][_0x545227(0x25c)],_0x288644,_0x545227(0x224),new Date()['getTime']()),_0x232ab5['json']({'code':0x0});}),router[_0x1fd921(0x226)]('/addReadRecord',(_0x3d0bd8,_0x1df593,_0xb2abb2)=>{const _0x59acc8=_0x1fd921;let _0x15de2b=_0x3d0bd8[_0x59acc8(0x2af)]['id'];if(!_0x3d0bd8[_0x59acc8(0x26c)][_0x59acc8(0x21b)]||!_0x3d0bd8[_0x59acc8(0x26c)][_0x59acc8(0x205)]||!_0x3d0bd8[_0x59acc8(0x26c)][_0x59acc8(0x228)])return _0x1df593[_0x59acc8(0x222)]({'code':0x0});let _0xcd420c=_0x3d0bd8[_0x59acc8(0x26c)][_0x59acc8(0x21b)];_0xcd420c=path[_0x59acc8(0x237)](_0x3d0bd8[_0x59acc8(0x26c)][_0x59acc8(0x21b)]);let _0x47afda=path['join'](_0x3d0bd8[_0x59acc8(0x26c)][_0x59acc8(0x205)]),_0xed721d=_0x3d0bd8[_0x59acc8(0x26c)][_0x59acc8(0x228)],_0x19d940=_0x3d0bd8[_0x59acc8(0x23a)][_0x59acc8(0x25c)][_0x59acc8(0x206)]('SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?')['get'](_0x15de2b,_0xcd420c,_0x47afda);return _0x19d940?_0x3d0bd8[_0x59acc8(0x23a)][_0x59acc8(0x25c)]['prepare'](_0x59acc8(0x244))[_0x59acc8(0x29e)](_0xed721d,Date[_0x59acc8(0x247)](),_0x15de2b,_0xcd420c,_0x47afda):_0x3d0bd8[_0x59acc8(0x23a)][_0x59acc8(0x25c)][_0x59acc8(0x206)](_0x59acc8(0x266))[_0x59acc8(0x29e)](_0x15de2b,_0xcd420c,_0x47afda,_0xed721d,Date[_0x59acc8(0x247)]()),_0x1df593[_0x59acc8(0x222)]({'code':0x0});}),router['post'](_0x1fd921(0x290),(_0x2ee551,_0x1297d5,_0x43c558)=>{const _0x7a2a63=_0x1fd921;let _0x2e795c=_0x2ee551[_0x7a2a63(0x2af)]['id'],_0x1257d9=_0x2ee551['app'][_0x7a2a63(0x250)][_0x7a2a63(0x206)](_0x7a2a63(0x2a8))[_0x7a2a63(0x1fa)](_0x2e795c),_0x18f1b9=0x0,_0x1775bb=_0x2ee551[_0x7a2a63(0x26c)][_0x7a2a63(0x21b)],_0x4a44f4=_0x2ee551[_0x7a2a63(0x26c)][_0x7a2a63(0x205)];if(_0x1775bb&&_0x4a44f4){_0x4a44f4=path[_0x7a2a63(0x29a)](_0x4a44f4+'');let _0x727320=_0x2ee551[_0x7a2a63(0x23a)][_0x7a2a63(0x25c)][_0x7a2a63(0x206)]('SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?')[_0x7a2a63(0x1fa)](_0x2e795c,_0x1775bb,_0x4a44f4);_0x727320&&(_0x18f1b9=_0x727320[_0x7a2a63(0x228)]);}return _0x1297d5[_0x7a2a63(0x222)]({'code':0x0,'progress':_0x18f1b9,'readerConfig':_0x1257d9});}),router[_0x1fd921(0x226)]('/setBookType',(_0x189f5c,_0x17926b,_0x52daf6)=>{const _0xca6b6d=_0x1fd921;let _0x5bad70=_0x189f5c[_0xca6b6d(0x26c)]['indexId'],_0x57a6c9=_0x189f5c[_0xca6b6d(0x26c)][_0xca6b6d(0x285)];if(!_0x57a6c9||!_0x5bad70)return _0x189f5c[_0xca6b6d(0x23a)][_0xca6b6d(0x29f)](_0x17926b,_0xca6b6d(0x28c));if(_0x57a6c9!=0x1&&_0x57a6c9!=0x2)return _0x189f5c['app']['returnErrMsg'](_0x17926b,_0xca6b6d(0x26b));let _0x584c92=dbBookIndexTable[_0xca6b6d(0x21a)](_0x189f5c[_0xca6b6d(0x23a)][_0xca6b6d(0x25c)],_0x5bad70);if(!_0x584c92)return _0x189f5c[_0xca6b6d(0x23a)][_0xca6b6d(0x29f)](_0x17926b,_0xca6b6d(0x260));if(dbUserTable[_0xca6b6d(0x1fb)](_0x189f5c,_0x17926b,_0xca6b6d(0x261),_0xca6b6d(0x201),_0x584c92[_0xca6b6d(0x230)])==!![])return dbBookIndexTable[_0xca6b6d(0x249)](_0x189f5c[_0xca6b6d(0x23a)][_0xca6b6d(0x25c)],_0x5bad70,_0xca6b6d(0x285),_0x57a6c9),_0x17926b[_0xca6b6d(0x222)]({'code':0x0});});function getListByParams(_0x375b7d,_0x45f571,_0x207459,_0x5cced2,_0x254bd2,_0x39ab3c,_0x1ece89,_0x331a07,_0x226d91,_0x3a9ccd,_0x3d4fa4,_0x1a428e){return new Promise((_0x4f336a,_0x1d4812)=>{const _0xf080b5=_0x44e7;let _0x47ef2e=_0x375b7d[_0xf080b5(0x23a)]['dbFileIndex'],_0x5a8426=[];if(_0x207459==_0xf080b5(0x2a1)||_0x207459=='bookList')_0x5a8426=dbBookIndexTable[_0xf080b5(0x27f)](_0x47ef2e,_0x45f571,_0x5cced2,_0x254bd2,_0x39ab3c,_0x1ece89,_0x331a07,_0x3a9ccd,_0x226d91,_0x3d4fa4,_0x1a428e);else{if(_0x207459=='favorite'){let _0x435512='',_0xa0a01c=[];_0x435512+='\x20is_file=1';_0x226d91&&(_0x226d91=_0x226d91[_0xf080b5(0x262)]('\x27','')[_0xf080b5(0x262)]('’',''),_0x435512+=_0xf080b5(0x23b),_0xa0a01c[_0xf080b5(0x267)]('%'+_0x226d91+'%','%'+_0x226d91+'%','%'+_0x226d91+'%','%'+_0x226d91+'%','%'+_0x226d91+'%','%'+_0x226d91+'%','%'+_0x226d91+'%','%'+_0x226d91+'%'));_0x3d4fa4&&(_0x435512+=_0xf080b5(0x23c),_0xa0a01c[_0xf080b5(0x267)](_0x3d4fa4,_0x3d4fa4));if(_0x39ab3c&&_0x1ece89){if(_0x39ab3c==_0xf080b5(0x25b))_0x435512+=_0xf080b5(0x2ae)+_0x1ece89+_0xf080b5(0x27e)+_0x1ece89+'\x20';else{if(_0x39ab3c==_0xf080b5(0x23f))_0x435512+=_0xf080b5(0x296)+_0x1ece89+_0xf080b5(0x20a)+_0x1ece89+',f.filename_fl\x20'+_0x1ece89+'\x20';else _0x39ab3c==_0xf080b5(0x1f7)?_0x435512+='\x20order\x20by\x20m.update_time\x20'+_0x1ece89+'\x20':_0x435512+=_0xf080b5(0x287)+_0x39ab3c+'\x20'+_0x1ece89+'\x20';}}else _0x435512+='\x20order\x20by\x20m.update_time\x20DESC\x20';_0x435512+='\x20LIMIT\x20?\x20OFFSET\x20?\x20',_0xa0a01c['push'](_0x5cced2),_0xa0a01c[_0xf080b5(0x267)](_0x254bd2),_0x5a8426=dbBookFavorite[_0xf080b5(0x24b)](_0x375b7d[_0xf080b5(0x23a)][_0xf080b5(0x25c)],_0x375b7d[_0xf080b5(0x2af)]['id'],_0x435512,_0xa0a01c);}}setBookListProps(_0x375b7d,_0x5a8426)[_0xf080b5(0x23e)](_0x50f9fb=>{_0x4f336a(_0x50f9fb);});});}function setBookListProps(_0x2d74b1,_0x31c8f5){return new Promise(async(_0x5930e6,_0x41599e)=>{const _0x38be57=_0x44e7;for(let _0x2e5c14 of _0x31c8f5){_0x2e5c14[_0x38be57(0x21f)]=dbBookFavorite['bookIsFavorite'](_0x2d74b1[_0x38be57(0x23a)]['dbFileIndex'],_0x2e5c14['id'],_0x2d74b1[_0x38be57(0x2af)]['id'])?'1':'0',_0x2e5c14[_0x38be57(0x205)]=path[_0x38be57(0x29a)](_0x2e5c14[_0x38be57(0x230)],_0x2e5c14[_0x38be57(0x1ff)]),_0x2e5c14[_0x38be57(0x2ab)]=await getBookSameNameCover(_0x2e5c14);}_0x5930e6(_0x31c8f5);});}router[_0x1fd921(0x226)]('/getHomeData',(_0x554bd7,_0x586caf,_0x48a142)=>{const _0x1622e6=_0x1fd921;let _0x19cf3b=_0x554bd7[_0x1622e6(0x26c)][_0x1622e6(0x208)]?_0x554bd7[_0x1622e6(0x26c)][_0x1622e6(0x208)]:0xc,_0x56376e=_0x554bd7[_0x1622e6(0x2af)]['id'],_0x27bdd6=dbUserTable['getUserPathWhere'](_0x554bd7,_0x1622e6(0x261),_0x1622e6(0x225),!![]);if(_0x554bd7[_0x1622e6(0x2af)]['is_admin']!=0x1&&!_0x27bdd6[_0x1622e6(0x276)])return _0x586caf[_0x1622e6(0x222)]({'code':0x0,'data':null});let _0x53eaa1=[],_0x21135c=_0x554bd7['app'][_0x1622e6(0x25c)][_0x1622e6(0x206)](_0x1622e6(0x210))[_0x1622e6(0x291)](_0x56376e,_0x19cf3b);for(let _0x3504c0 of _0x21135c){let _0x25a588=dbBookIndexTable[_0x1622e6(0x1f4)](_0x554bd7[_0x1622e6(0x23a)]['dbFileIndex'],_0x3504c0[_0x1622e6(0x233)],_0x3504c0[_0x1622e6(0x271)]);_0x25a588&&dbUserTable['doUserCanGet'](_0x554bd7,_0x586caf,_0x1622e6(0x261),'power_get',_0x25a588[_0x1622e6(0x230)],!![])==!![]&&(_0x25a588[_0x1622e6(0x228)]=_0x3504c0[_0x1622e6(0x228)],_0x53eaa1[_0x1622e6(0x267)](_0x25a588));}setBookListProps(_0x554bd7,_0x53eaa1)[_0x1622e6(0x23e)](_0x28b0f6=>{const _0x1c711c=_0x1622e6;_0x53eaa1=_0x28b0f6,getListByParams(_0x554bd7,_0x27bdd6,'list',_0x19cf3b,0x0,'check_time',_0x1c711c(0x28e),null,null,null,null,0x1)[_0x1c711c(0x23e)](_0x236498=>{const _0x5b3792=_0x1c711c;getListByParams(_0x554bd7,_0x27bdd6,'list',_0x19cf3b,0x0,_0x5b3792(0x224),_0x5b3792(0x28e),null,null,null,null,0x2)[_0x5b3792(0x23e)](_0x39c64a=>{const _0x406ed7=_0x5b3792;getListByParams(_0x554bd7,_0x27bdd6,_0x406ed7(0x2a1),_0x19cf3b,0x0,'id',_0x406ed7(0x28e))[_0x406ed7(0x23e)](_0x966faa=>{const _0x428469=_0x406ed7;let _0x29e6ed={};return _0x53eaa1&&_0x53eaa1[_0x428469(0x22e)]>0x0&&(_0x29e6ed['recentReadList']=_0x53eaa1),_0x966faa&&_0x966faa['length']>0x0&&(_0x29e6ed['recentAddList']=_0x966faa),_0x236498&&_0x236498[_0x428469(0x22e)]>0x0&&(_0x29e6ed['bookList']=_0x236498),_0x39c64a&&_0x39c64a['length']>0x0&&(_0x29e6ed[_0x428469(0x26a)]=_0x39c64a),_0x586caf[_0x428469(0x222)]({'code':0x0,'data':_0x29e6ed,'platform':os[_0x428469(0x255)]()});});});});});}),router['post']('/getBookList',(_0xf13f50,_0x2ad9f2,_0x436888)=>{const _0x48f94a=_0x1fd921;let _0xdf5cc5=_0xf13f50[_0x48f94a(0x26c)][_0x48f94a(0x208)]||0x32,_0x1cfad1=_0xf13f50[_0x48f94a(0x26c)]['offset']||0x0,_0x5236e4=_0xf13f50['body'][_0x48f94a(0x25b)],_0x157b6c=_0xf13f50['body'][_0x48f94a(0x251)]||_0x48f94a(0x224),_0x22ea15=_0xf13f50[_0x48f94a(0x26c)][_0x48f94a(0x2a2)]||_0x48f94a(0x28e),_0x406fc9=[_0x48f94a(0x2a1),_0x48f94a(0x21f),_0x48f94a(0x1fd)],_0x4553c5=_0xf13f50[_0x48f94a(0x26c)]['listType']||_0x48f94a(0x2a1),_0x458111=_0xf13f50[_0x48f94a(0x26c)][_0x48f94a(0x220)],_0x5a4b51=_0xf13f50[_0x48f94a(0x26c)][_0x48f94a(0x203)],_0x250b94=_0xf13f50[_0x48f94a(0x26c)]['bookListId'],_0x1cb349=_0xf13f50[_0x48f94a(0x26c)][_0x48f94a(0x285)];if(dbBookIndexTable[_0x48f94a(0x2b2)](_0xf13f50,_0x2ad9f2,_0x157b6c,_0x22ea15)!==!![])return;if(_0x4553c5=='bookList'){if(!_0x250b94)return _0xf13f50['app'][_0x48f94a(0x29f)](_0x2ad9f2,_0x48f94a(0x292));}!_0x406fc9[_0x48f94a(0x2ad)](_0x4553c5)&&(_0x4553c5=_0x48f94a(0x2a1));_0xdf5cc5>0x1f4&&(_0xdf5cc5=0x1f4);let _0x417873=dbUserTable['getUserPathWhere'](_0xf13f50,'book',_0x48f94a(0x225),!![]);if(_0xf13f50['currentUser']['is_admin']!=0x1&&!_0x417873[_0x48f94a(0x276)])return _0x2ad9f2[_0x48f94a(0x222)]({'code':0x0,'data':null});getListByParams(_0xf13f50,_0x417873,_0x4553c5,_0xdf5cc5,_0x1cfad1,_0x157b6c,_0x22ea15,_0x5236e4,_0x458111,_0x250b94,_0x5a4b51,_0x1cb349)['then'](_0x33b215=>{const _0x1460db=_0x48f94a;let _0x3740fa={'code':0x0,'data':_0x33b215};if(_0x4553c5==_0x1460db(0x21f))_0x3740fa['book_count']=dbBookFavorite[_0x1460db(0x245)](_0xf13f50[_0x1460db(0x23a)][_0x1460db(0x25c)],_0xf13f50[_0x1460db(0x2af)]['id']);else{if(_0x4553c5==_0x1460db(0x2a1))_0x3740fa['book_count']=dbBookIndexTable[_0x1460db(0x217)](_0xf13f50[_0x1460db(0x23a)][_0x1460db(0x25c)],_0x417873,_0x5236e4,_0x458111,_0x1cb349);else _0x4553c5==_0x1460db(0x1fd)&&(_0x3740fa[_0x1460db(0x298)]=dbBookListTable[_0x1460db(0x28a)](_0xf13f50[_0x1460db(0x23a)][_0x1460db(0x25c)],_0x250b94));}return _0x2ad9f2[_0x1460db(0x222)](_0x3740fa);});}),router[_0x1fd921(0x226)](_0x1fd921(0x26d),(_0x3ca79a,_0x2f0335,_0x4d91e2)=>{const _0x482e43=_0x1fd921;let _0x1d9f70=_0x3ca79a[_0x482e43(0x26c)]['id'],_0x38b9ca=dbFileIndexTable[_0x482e43(0x218)](_0x3ca79a['app'][_0x482e43(0x25c)],_0x1d9f70,dbFileIndexTable[_0x482e43(0x242)]);if(!_0x38b9ca)return _0x3ca79a['app'][_0x482e43(0x29f)](_0x2f0335,_0x482e43(0x265));if(dbUserTable[_0x482e43(0x1fb)](_0x3ca79a,_0x2f0335,_0x482e43(0x261),_0x482e43(0x225),_0x38b9ca[_0x482e43(0x230)])==!![]){let _0x290398=_0x3ca79a[_0x482e43(0x2af)]['id'],_0x6edc4=dbBookFavorite['getFavorite'](_0x3ca79a[_0x482e43(0x23a)][_0x482e43(0x25c)],_0x290398,_0x1d9f70);_0x38b9ca[_0x482e43(0x21f)]=_0x6edc4?0x1:0x0,_0x38b9ca['filePath']=path[_0x482e43(0x29a)](_0x38b9ca['path'],_0x38b9ca[_0x482e43(0x1ff)]);let _0x55d443=dbBookIndexTable[_0x482e43(0x235)](_0x3ca79a[_0x482e43(0x23a)]['dbFileIndex'],_0x38b9ca[_0x482e43(0x230)]);_0x55d443[_0x482e43(0x22e)]>0x0?(_0x55d443=arrayUtil['sortFileNamesByNumber'](_0x55d443,_0x482e43(0x1ff)),setBookListProps(_0x3ca79a,_0x55d443)[_0x482e43(0x23e)](_0x2a8c7d=>{_0x55d443=_0x2a8c7d,_0x181c50();})):_0x181c50;function _0x181c50(){const _0x57eda0=_0x482e43;let _0x5d316d={'code':0x0,'data':_0x38b9ca,'sameFolderBookList':_0x55d443};getBookSameNameCover(_0x38b9ca)[_0x57eda0(0x23e)](_0x662f02=>{const _0x27329a=_0x57eda0;_0x38b9ca[_0x27329a(0x2ab)]=_0x662f02;let _0x2fb19e=_0x3ca79a['app'][_0x27329a(0x25c)][_0x27329a(0x206)](_0x27329a(0x20b))[_0x27329a(0x1fa)](_0x290398,path[_0x27329a(0x29a)](_0x38b9ca[_0x27329a(0x230)],_0x38b9ca[_0x27329a(0x1ff)]),_0x38b9ca['size']);_0x2fb19e&&(_0x5d316d[_0x27329a(0x228)]=_0x2fb19e['progress']),_0x5d316d['fileExist']=fs[_0x27329a(0x24a)](_0x38b9ca['filePath'],(_0x26e1b8,_0x296a36)=>{const _0x369904=_0x27329a;return _0x26e1b8?_0x5d316d[_0x369904(0x28d)]=0x0:_0x5d316d[_0x369904(0x28d)]=0x1,_0x2f0335[_0x369904(0x222)](_0x5d316d);});});}}}),router['post']('/bookFavorite',(_0x5ce043,_0x121b44,_0x22abeb)=>{const _0x3e5b99=_0x1fd921;let _0x6ecbc7=_0x5ce043[_0x3e5b99(0x2af)]['id'];function _0x40609e(_0x55ffd7){const _0x5453d1=_0x3e5b99;let _0x602ad5=dbFileIndexTable[_0x5453d1(0x218)](_0x5ce043[_0x5453d1(0x23a)]['dbFileIndex'],_0x55ffd7,dbFileIndexTable[_0x5453d1(0x242)]);if(!_0x602ad5)return;let _0x44af17=new Date()[_0x5453d1(0x281)]();_0x5ce043[_0x5453d1(0x23a)][_0x5453d1(0x25c)][_0x5453d1(0x206)](_0x5453d1(0x23d))['run'](_0x44af17,_0x55ffd7),dbBookFavorite[_0x5453d1(0x277)](_0x5ce043[_0x5453d1(0x23a)]['dbFileIndex'],_0x6ecbc7,_0x55ffd7);}if(_0x5ce043[_0x3e5b99(0x26c)]['indexId']instanceof Array){let _0x1e804d=_0x5ce043[_0x3e5b99(0x26c)][_0x3e5b99(0x200)];if(_0x1e804d==_0x3e5b99(0x21c))for(let _0x115d09 of _0x5ce043[_0x3e5b99(0x26c)][_0x3e5b99(0x1f5)]){_0x40609e(_0x115d09);}else{if(_0x1e804d==_0x3e5b99(0x278))for(let _0x5c3be1 of _0x5ce043[_0x3e5b99(0x26c)]['indexId']){dbBookFavorite[_0x3e5b99(0x258)](_0x5ce043[_0x3e5b99(0x23a)][_0x3e5b99(0x25c)],_0x6ecbc7,_0x5c3be1);}}return _0x121b44['json']({'code':0x0});}else{let _0x275708=parseInt(_0x5ce043[_0x3e5b99(0x26c)][_0x3e5b99(0x1f5)]),_0x4dbbae=dbBookFavorite['getFavorite'](_0x5ce043[_0x3e5b99(0x23a)][_0x3e5b99(0x25c)],_0x6ecbc7,_0x275708),_0x244e95=0x0;return _0x4dbbae?dbBookFavorite[_0x3e5b99(0x258)](_0x5ce043[_0x3e5b99(0x23a)][_0x3e5b99(0x25c)],_0x6ecbc7,_0x275708):(_0x244e95=0x1,_0x40609e(_0x275708)),_0x121b44[_0x3e5b99(0x222)]({'code':0x0,'favorite':_0x244e95});}}),router['get'](_0x1fd921(0x213),(_0x232c46,_0x1ff676,_0x357116)=>{const _0x13fd9a=_0x1fd921;let _0x13c900=_0x232c46['query'][_0x13fd9a(0x1f5)],_0x25a150=dbBookIndexTable['getBookIndex'](_0x232c46[_0x13fd9a(0x23a)][_0x13fd9a(0x25c)],_0x13c900),_0x9fedbb=_0x232c46['query'][_0x13fd9a(0x254)];!_0x9fedbb&&(_0x9fedbb=0x200);if(!_0x25a150||_0x25a150&&!_0x25a150['cover_path'])return _0x1ff676[_0x13fd9a(0x25e)](0x194)[_0x13fd9a(0x229)]();dbUserTable[_0x13fd9a(0x1fb)](_0x232c46,_0x1ff676,_0x13fd9a(0x261),_0x13fd9a(0x225),_0x25a150[_0x13fd9a(0x230)])==!![]&&fs[_0x13fd9a(0x24a)](_0x25a150['cover_path'],(_0x2762f8,_0x31b1f9)=>{const _0x45e285=_0x13fd9a;if(_0x2762f8){let _0x564f34=config['getMediaCoverCachePath'](_0x25a150);bookIndexUtil['runGetBookInfoWorker'](_0x25a150,_0x564f34)['then'](_0x4c1318=>{const _0x39166e=_0x44e7;if(_0x4c1318[_0x39166e(0x232)])bookIndexUtil['sharpWriteCover'](_0x4c1318[_0x39166e(0x232)],_0x564f34)[_0x39166e(0x23e)](_0x12043=>{const _0x3bc773=_0x39166e;return console[_0x3bc773(0x238)](_0x3bc773(0x256),_0x12043),_0x1ff676[_0x3bc773(0x204)](_0x12043);})['catch'](_0x2bece6=>{const _0x20cbfe=_0x39166e;return _0x1ff676[_0x20cbfe(0x25e)](0x194)[_0x20cbfe(0x229)]();});else return _0x1ff676[_0x39166e(0x25e)](0x194)[_0x39166e(0x229)]();})[_0x45e285(0x209)](_0x1ba02d=>{const _0x1b318a=_0x45e285;return _0x1ff676[_0x1b318a(0x25e)](0x194)[_0x1b318a(0x229)]();});}else return _0x1ff676[_0x45e285(0x204)](_0x25a150['cover_path']);});}),router[_0x1fd921(0x226)](_0x1fd921(0x215),(_0x3cdb21,_0x47d199,_0x5add2c)=>{const _0x27288e=_0x1fd921;let _0x52add4=_0x3cdb21[_0x27288e(0x26c)][_0x27288e(0x208)]||0x32,_0xaebc70=_0x3cdb21['body']['offset']||0x0,_0x248b9b=_0x3cdb21[_0x27288e(0x26c)][_0x27288e(0x216)]||_0x27288e(0x1fd),_0x8b89d7=_0x3cdb21[_0x27288e(0x26c)]['orderField']||_0x27288e(0x224),_0xaf9e6b=_0x3cdb21[_0x27288e(0x26c)][_0x27288e(0x2a2)]||'desc',_0x1723b5=_0x3cdb21['body'][_0x27288e(0x220)],_0x2c032d=_0x3cdb21[_0x27288e(0x26c)][_0x27288e(0x203)];if(dbBookIndexTable[_0x27288e(0x2b2)](_0x3cdb21,_0x47d199,_0x8b89d7,_0xaf9e6b)!==!![])return;let _0x1406c2=[_0x27288e(0x224),_0x27288e(0x252),_0x27288e(0x224),_0x27288e(0x1ff),'title','artist',_0x27288e(0x234),'id',_0x27288e(0x231)],_0x4da676=[_0x27288e(0x274),'desc'];if(!_0x1406c2['includes'](_0x8b89d7)||!_0x4da676[_0x27288e(0x2ad)](_0xaf9e6b))return _0x3cdb21['app'][_0x27288e(0x29f)](_0x47d199,_0x27288e(0x27a),_0x8b89d7,_0xaf9e6b);let _0x3b0f5e=dbUserTable['getUserPathWhere'](_0x3cdb21,_0x27288e(0x261),_0x27288e(0x225),!![]);if(_0x3cdb21['currentUser'][_0x27288e(0x259)]!=0x1&&!_0x3b0f5e[_0x27288e(0x276)]&&_0x248b9b!=_0x27288e(0x1fd))return _0x47d199[_0x27288e(0x222)]({'code':0x0,'data':null});let _0x478397=[];if(_0x248b9b=='artist')_0x478397=dbBookIndexTable['getGroupList'](_0x3cdb21[_0x27288e(0x23a)]['dbFileIndex'],_0x3b0f5e,_0x248b9b,_0x52add4,_0xaebc70,_0x8b89d7,_0xaf9e6b,_0x1723b5,_0x2c032d);else{if(_0x248b9b==_0x27288e(0x1fd)){_0x478397=dbBookListTable[_0x27288e(0x236)](_0x3cdb21[_0x27288e(0x23a)][_0x27288e(0x25c)],_0x3cdb21[_0x27288e(0x2af)]['id'],_0x52add4,_0xaebc70,'id',_0x27288e(0x28e),_0x1723b5);for(let _0x48543f of _0x478397){_0x48543f[_0x27288e(0x24c)]=dbBookIndexTable[_0x27288e(0x2b5)](_0x3cdb21[_0x27288e(0x23a)]['dbFileIndex'],_0x48543f['id']);}}}return _0x47d199[_0x27288e(0x222)]({'code':0x0,'data':_0x478397});}),router['post']('/operationBookList',(_0x2fc761,_0x326e09,_0x5460d4)=>{const _0x486d07=_0x1fd921;let _0x4e8891=_0x2fc761[_0x486d07(0x26c)][_0x486d07(0x248)],_0x4b5694=_0x2fc761[_0x486d07(0x26c)]['operation'];if(_0x4b5694==_0x486d07(0x21c)){if(!_0x4e8891)return _0x2fc761[_0x486d07(0x23a)][_0x486d07(0x29f)](_0x326e09,_0x486d07(0x243));dbBookListTable[_0x486d07(0x24f)](_0x2fc761[_0x486d07(0x23a)][_0x486d07(0x25c)],_0x2fc761[_0x486d07(0x2af)]['id'],_0x4e8891);}else{if(_0x4b5694=='edit'||_0x4b5694=='delete'){let _0x57e025=_0x2fc761[_0x486d07(0x26c)][_0x486d07(0x29d)],_0x21f2cd=dbBookListTable[_0x486d07(0x25f)](_0x2fc761[_0x486d07(0x23a)][_0x486d07(0x25c)],_0x57e025),_0x530e51=![];(_0x2fc761[_0x486d07(0x2af)][_0x486d07(0x259)]==0x1||_0x21f2cd['uid']==_0x2fc761[_0x486d07(0x2af)]['id'])&&(_0x530e51=!![]);if(!_0x530e51)return _0x326e09['json']({'code':0x66});if(_0x4b5694=='delete')dbBookListTable[_0x486d07(0x257)](_0x2fc761[_0x486d07(0x23a)][_0x486d07(0x25c)],_0x57e025);else{if(_0x4b5694==_0x486d07(0x239)){if(!_0x4e8891)return _0x2fc761[_0x486d07(0x23a)]['returnErrMsg'](_0x326e09,'need\x20\x27name\x27');dbBookListTable['updateBookList'](_0x2fc761['app']['dbFileIndex'],_0x57e025,_0x4e8891);}}}else return _0x2fc761[_0x486d07(0x23a)]['returnErrMsg'](_0x326e09,'operation\x20error');}return _0x326e09[_0x486d07(0x222)]({'code':0x0});}),router[_0x1fd921(0x226)](_0x1fd921(0x2a0),(_0x2614c9,_0x584515,_0x39db14)=>{const _0x13a7c3=_0x1fd921;let _0x2aab6e=_0x2614c9[_0x13a7c3(0x26c)][_0x13a7c3(0x275)],_0x4d54cd=_0x2614c9['body'][_0x13a7c3(0x29d)];if(!_0x2aab6e||!_0x4d54cd)return _0x2614c9[_0x13a7c3(0x23a)][_0x13a7c3(0x29f)](_0x584515,_0x13a7c3(0x2a3));let _0x5828c8=dbBookListTable[_0x13a7c3(0x25f)](_0x2614c9[_0x13a7c3(0x23a)]['dbFileIndex'],_0x4d54cd);if(!_0x5828c8)return _0x2614c9[_0x13a7c3(0x23a)]['returnErrMsg'](_0x584515,_0x13a7c3(0x2b0));let _0x2cc490=_0x2614c9[_0x13a7c3(0x26c)][_0x13a7c3(0x200)];if(_0x2cc490=='add'){function _0x1d3058(_0x58db0f){const _0xf1b78a=_0x13a7c3;let _0xed1faa=dbBookIndexTable['getBookIndex'](_0x2614c9[_0xf1b78a(0x23a)]['dbFileIndex'],_0x58db0f);if(!_0xed1faa)return;if(_0xed1faa[_0xf1b78a(0x27d)]==0x1){dbBookListTable['addBookToBookList'](_0x2614c9[_0xf1b78a(0x23a)][_0xf1b78a(0x25c)],_0x58db0f,_0x4d54cd);let _0x595ba8=Date[_0xf1b78a(0x247)]();_0x2614c9[_0xf1b78a(0x23a)]['dbFileIndex'][_0xf1b78a(0x206)]('UPDATE\x20file_index_book\x20set\x20check_time=?\x20WHERE\x20id=?')['run'](_0x595ba8,_0xed1faa['id']);}else{let _0x40dfc5=path[_0xf1b78a(0x29a)](_0xed1faa[_0xf1b78a(0x230)],_0xed1faa[_0xf1b78a(0x1ff)]),_0x4b73b3=_0x2614c9['app'][_0xf1b78a(0x25c)][_0xf1b78a(0x206)](_0xf1b78a(0x273))[_0xf1b78a(0x291)](_0x40dfc5,_0x40dfc5+path[_0xf1b78a(0x2a9)]+'%');for(let _0x2cb9bd of _0x4b73b3){dbBookListTable[_0xf1b78a(0x2ac)](_0x2614c9[_0xf1b78a(0x23a)][_0xf1b78a(0x25c)],_0x2cb9bd['id'],_0x4d54cd);}}}if(_0x2aab6e instanceof Array)for(let _0x405068 of _0x2aab6e){_0x1d3058(_0x405068);}else _0x1d3058(_0x2aab6e);}else{if(_0x2cc490==_0x13a7c3(0x278)){if(_0x2aab6e instanceof Array)for(let _0x5e2d16 of _0x2aab6e){dbBookListTable['removeBookFromList'](_0x2614c9[_0x13a7c3(0x23a)][_0x13a7c3(0x25c)],_0x5e2d16,_0x4d54cd);}else dbBookListTable['removeBookFromList'](_0x2614c9[_0x13a7c3(0x23a)][_0x13a7c3(0x25c)],_0x2aab6e,_0x4d54cd);}else return _0x2614c9[_0x13a7c3(0x23a)][_0x13a7c3(0x29f)](_0x584515,'operation\x20error');}return _0x584515['json']({'code':0x0,'data':{}});}),router[_0x1fd921(0x226)](_0x1fd921(0x295),(_0x3e2f39,_0x1df972,_0x8bef37)=>{const _0x239ffc=_0x1fd921;let _0x56df5e=_0x3e2f39[_0x239ffc(0x26c)][_0x239ffc(0x286)],_0x12b304=_0x3e2f39[_0x239ffc(0x26c)][_0x239ffc(0x22f)],_0x473d4f=_0x239ffc(0x261);if(dbUserTable['doUserCanGet'](_0x3e2f39,_0x1df972,_0x473d4f,_0x239ffc(0x225))==!![]){let _0x4cf457=[];if(!_0x56df5e){let _0x3da174=[];_0x3e2f39[_0x239ffc(0x2af)][_0x239ffc(0x259)]==0x1?_0x3da174=dbSourceFolderTable['getPathByType'](_0x3e2f39[_0x239ffc(0x23a)][_0x239ffc(0x250)],_0x473d4f):_0x3da174=dbUserTable['getUserPower'](_0x3e2f39['app'][_0x239ffc(0x250)],_0x3e2f39[_0x239ffc(0x2af)][_0x239ffc(0x1fc)],_0x473d4f);if(_0x3da174)for(let _0x1d8f4b=0x0;_0x1d8f4b<_0x3da174[_0x239ffc(0x22e)];_0x1d8f4b++){_0x4cf457[_0x239ffc(0x267)]({'path':_0x3da174[_0x1d8f4b][_0x239ffc(0x230)],'is_file':0x0,'filename':path[_0x239ffc(0x237)](_0x3da174[_0x1d8f4b][_0x239ffc(0x230)]),'root':!![]});}}else{let _0x12e8c0=[];if(_0x3e2f39[_0x239ffc(0x2af)][_0x239ffc(0x259)]!=0x1){if(dbUserTable[_0x239ffc(0x1fb)](_0x3e2f39,_0x1df972,_0x473d4f,_0x239ffc(0x225),_0x56df5e)!==!![])return;}_0x56df5e=path['join'](_0x56df5e);let _0x30c8ff=_0x239ffc(0x25d);_0x12e8c0[_0x239ffc(0x267)](_0x56df5e);if(_0x12b304){let _0x23fb89=_0x239ffc(0x294);_0x30c8ff+=_0x23fb89,_0x12e8c0['push']('%'+_0x12b304+'%'),_0x12e8c0[_0x239ffc(0x267)]('%'+_0x12b304+'%');}let _0x8b2ef0=_0x239ffc(0x2b4);_0x4cf457=_0x3e2f39['app']['dbFileIndex'][_0x239ffc(0x206)](_0x239ffc(0x29b)+_0x8b2ef0+'\x20FROM\x20file_index_book\x20WHERE\x20'+_0x30c8ff)[_0x239ffc(0x291)](_0x12e8c0);}for(let _0x1ed549 of _0x4cf457){if(_0x1ed549[_0x239ffc(0x27d)]==0x0){let _0x59c22a=path[_0x239ffc(0x29a)](_0x1ed549[_0x239ffc(0x230)],_0x1ed549[_0x239ffc(0x1ff)]),_0x54f3ac=_0x3e2f39[_0x239ffc(0x23a)][_0x239ffc(0x25c)]['prepare'](_0x239ffc(0x26e))['get'](_0x59c22a);_0x1ed549[_0x239ffc(0x20e)]=_0x54f3ac[_0x239ffc(0x208)];}}let _0x463ab2=path[_0x239ffc(0x2a9)],_0x1a4874={'code':0x0,'data':_0x4cf457,'sep':_0x463ab2};return _0x1df972[_0x239ffc(0x222)](_0x1a4874);}}),router[_0x1fd921(0x226)](_0x1fd921(0x25a),(_0x3d5909,_0x345781,_0x37c65c)=>{const _0x2e56c6=_0x1fd921;let _0x57f79d=_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x275)],_0x7ceae2=_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x200)];if(!_0x57f79d)return _0x3d5909[_0x2e56c6(0x23a)][_0x2e56c6(0x29f)](_0x345781,_0x2e56c6(0x280));let _0x2077f8=dbBookIndexTable[_0x2e56c6(0x21a)](_0x3d5909[_0x2e56c6(0x23a)][_0x2e56c6(0x25c)],_0x57f79d);if(!_0x2077f8)return _0x3d5909[_0x2e56c6(0x23a)][_0x2e56c6(0x29f)](_0x345781,_0x2e56c6(0x28b));if(_0x7ceae2==_0x2e56c6(0x263)){let _0x1cffa9={'title':_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x23f)],'publish_date':_0x3d5909['body'][_0x2e56c6(0x299)],'year':_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x1f9)],'isbn':_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x207)],'language':_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x22a)],'genre':_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x289)],'tag':_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x269)],'publisher':_0x3d5909[_0x2e56c6(0x26c)][_0x2e56c6(0x231)],'artist':_0x3d5909[_0x2e56c6(0x26c)]['artist'],'introduction':_0x3d5909[_0x2e56c6(0x26c)]['introduction']},_0x379f3e=path[_0x2e56c6(0x29a)](_0x2077f8[_0x2e56c6(0x230)],_0x2077f8[_0x2e56c6(0x1ff)]);fs['stat'](_0x379f3e,(_0xe870b,_0x116307)=>{const _0x2ea756=_0x2e56c6;if(_0xe870b)return _0x3d5909[_0x2ea756(0x23a)][_0x2ea756(0x29f)](_0x345781,_0x345781['__']('folderNotExist')+_0x379f3e);let _0x2e2cbe=_0x379f3e[_0x2ea756(0x272)](0x0,_0x379f3e[_0x2ea756(0x2b1)]('.'))+_0x2ea756(0x241);nfoUtil[_0x2ea756(0x22c)](_0x1cffa9,_0x2e2cbe)['then'](()=>{const _0x3d92e3=_0x2ea756;console[_0x3d92e3(0x238)](_0x3d92e3(0x284)),dbBookIndexTable[_0x3d92e3(0x2b6)](_0x3d5909[_0x3d92e3(0x23a)][_0x3d92e3(0x25c)],_0x57f79d,_0x1cffa9),_0x2077f8=dbBookIndexTable[_0x3d92e3(0x21a)](_0x3d5909['app'][_0x3d92e3(0x25c)],_0x57f79d),setBookListProps(_0x3d5909,[_0x2077f8])[_0x3d92e3(0x23e)](_0x2168bc=>{const _0x5f267e=_0x3d92e3;return _0x345781[_0x5f267e(0x222)]({'code':0x0,'data':_0x2168bc[0x0]});});})[_0x2ea756(0x209)](_0x10dc67=>{const _0x7c0dfc=_0x2ea756;return console[_0x7c0dfc(0x238)](_0x7c0dfc(0x22b),_0x10dc67),_0x3d5909[_0x7c0dfc(0x23a)][_0x7c0dfc(0x29f)](_0x345781,_0x7c0dfc(0x2a5));});});}else{if(_0x7ceae2=='delete'){let _0x3ecad8=path['join'](_0x2077f8[_0x2e56c6(0x230)],_0x2077f8[_0x2e56c6(0x1ff)]),_0xf385f0=_0x3ecad8[_0x2e56c6(0x272)](0x0,_0x3ecad8[_0x2e56c6(0x2b1)]('.'))+_0x2e56c6(0x241);fs['stat'](_0xf385f0,(_0x5ed0da,_0x38c7d2)=>{const _0x2f2c32=_0x2e56c6;if(_0x5ed0da)return _0x3d5909['app'][_0x2f2c32(0x29f)](_0x345781,_0x345781['__'](_0x2f2c32(0x27b))+_0xf385f0);fs['rm'](_0xf385f0,_0x1f3777=>{const _0x2f0e82=_0x2f2c32;if(_0x1f3777)return _0x3d5909[_0x2f0e82(0x23a)][_0x2f0e82(0x29f)](_0x345781,_0x345781['__'](_0x2f0e82(0x2a6))+_0xf385f0);return dbBookIndexTable[_0x2f0e82(0x2b6)](_0x3d5909['app'][_0x2f0e82(0x25c)],indexId,{}),_0x345781[_0x2f0e82(0x222)]({'code':0x0});});});}else return _0x3d5909[_0x2e56c6(0x23a)][_0x2e56c6(0x29f)](_0x345781,'operation\x20error');}}),module[_0x1fd921(0x29c)]=router;