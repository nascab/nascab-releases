const _0x5190e8=_0x1006;(function(_0x31594f,_0x478d10){const _0x2e4dfd=_0x1006,_0x3f3919=_0x31594f();while(!![]){try{const _0x1d8c41=-parseInt(_0x2e4dfd(0x25e))/0x1*(parseInt(_0x2e4dfd(0x267))/0x2)+-parseInt(_0x2e4dfd(0x287))/0x3+parseInt(_0x2e4dfd(0x16c))/0x4+parseInt(_0x2e4dfd(0x1a2))/0x5+parseInt(_0x2e4dfd(0x1a8))/0x6+parseInt(_0x2e4dfd(0x15c))/0x7*(parseInt(_0x2e4dfd(0x16f))/0x8)+-parseInt(_0x2e4dfd(0x22c))/0x9*(parseInt(_0x2e4dfd(0x179))/0xa);if(_0x1d8c41===_0x478d10)break;else _0x3f3919['push'](_0x3f3919['shift']());}catch(_0x4223d6){_0x3f3919['push'](_0x3f3919['shift']());}}}(_0x24bb,0xe291b));var express=require(_0x5190e8(0x211)),router=express[_0x5190e8(0x280)]();let path=require(_0x5190e8(0x1a4));const dbFileIndexTable=require(_0x5190e8(0x15f)),dbUserTable=require('../../db/dbUserTable');var fs=require('fs');let sha256=require(_0x5190e8(0x24c));function _0x1006(_0x4d8dd1,_0x4cc00d){const _0x24bb5e=_0x24bb();return _0x1006=function(_0x100683,_0x23bea2){_0x100683=_0x100683-0x12f;let _0x489c09=_0x24bb5e[_0x100683];return _0x489c09;},_0x1006(_0x4d8dd1,_0x4cc00d);}const dbConfigTable=require(_0x5190e8(0x1bf)),dbSourceFolderTable=require(_0x5190e8(0x278)),nfoUtil=require(_0x5190e8(0x215)),dbMovieFavorite=require('../../db/dbMovieFavorite'),movieUtil=require(_0x5190e8(0x27e));let fileUtil=require(_0x5190e8(0x1ab));function _0x24bb(){const _0x5a7b48=['shareUidList','\x20AND\x20is_tvplay==1','Extra\x27\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20\x27%','enablePwd','login.pwdErr','-UHD','SELECT\x20','HEIC','error\x20pathList','stringify','timeType','sortField','status','tvFolderName','REPLACE\x20INTO\x20movie_collection(title,enable_pwd,pwd,user_id,type,data,collection_cover_path,data_value,share_for_subuser)\x20VALUES(\x20?,?,?,?,?,?,?,?,?)','-FHD','dialog','searchStr','/getTvSeriesDetail','extra','ignoreTvList','.ass','findWithField','/checkCollectionPwd','libraryId','/movieFavorite','stat','Sample','SELECT\x20index_id\x20FROM\x20movie_history\x20where\x20index_id\x20in\x20','\x20id,movie_douban_score,movie_info_name,movie_year,movie_info_state,path,is_tvplay,filename,ext,type,width,height,duration,size,movie_douban_id,movie_imdb_id,show_name,show_in_list','prepare','pathList','SPECIALS','extra\x27\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20\x27%','%poster%','pageSize','readdir','path_list','create_time','name','\x20order\x20by\x20m.create_time\x20desc\x20limit\x2050','collectionPwd','movieShowMatchName','\x20SET\x20show_in_list=1\x20WHERE\x20id=?','getFavoriteList','../utils/sqliteUtil','clearlogo.%','toLowerCase','4676IHyDMM','EXTRA','getById','../../db/dbFileIndexTable','FAVORITE','\x20and\x20filename\x20>=\x20?\x20','SELECT\x20*\x20from\x20movie_history\x20WHERE\x20index_id=?\x20and\x20user_id=?','\x20and\x20path=?\x20and\x20is_tvplay=1\x20','firstLetter','send','specials\x27\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20\x27%','select\x20id\x20from\x20file_index_movie\x20where\x20(\x20path\x20like\x20?\x20OR\x20path=?)\x20and\x20is_file=1\x20and\x20type=2','catch','enable_pwd','getAllFavoriteByWhere','SELECT\x20*\x20FROM\x20movie_library\x20','2902392hpPSac','needLogoPathAndFanart','ignore_match_info','9352BQKuXK','getUserPathWhere','m.time,\x20f.id,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id,f.movie_douban_score,f.movie_info_name,f.show_name','concat','run','Extra','addScanTask','dirname','SAMPLE','startsWith','1006450opOITo','SELECT\x20*\x20from\x20movie_collection\x20where\x20id=?','\x20SELECT\x20','sourceFolderId','SELECT\x20*\x20FROM\x20movie_library\x20WHERE\x20id=?','\x20AND\x20is_file=1\x20AND\x20show_in_list=1\x20ORDER\x20BY\x20check_time\x20DESC\x20LIMIT\x20?','\x20and\x20filename_number\x20>=\x20?\x20','needSeasonCount','/getMovieHomeData','is_tvplay','whereStr','push','checkSqlInjection','show_name','thumb.jpg','.srt','power_change','movieDirectors','SELECT\x20count(*)\x20as\x20count\x20FROM\x20','-HD','\x20AND\x20','tvCount','REPLACE\x20INTO\x20movie_library(title,path_list,share_for_subuser,share_uid,user_id)\x20VALUES(\x20?,?,?,?,?)','ALL','UPDATE\x20movie_collection\x20SET\x20title=?,data=?,enable_pwd=?,pwd=?,collection_cover_path=?,data_value=?,share_for_subuser=?\x20WHERE\x20id=?','\x20LIMIT\x20?\x20OFFSET\x20?','(filename\x20like\x20?\x20or\x20filename\x20like\x20?\x20or\x20filename\x20like\x20?)','getCountByWhere','\x20as\x20f\x20WHERE\x20\x20is_file=1\x20and\x20type=2\x20and\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(\x20\x20\x20\x20\x20\x20path\x20like\x20?\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20?\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20?\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20?\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20?\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20?\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20?\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20?\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x20LIMIT\x20200','.clearlogo.%','SELECT\x20id,filename\x20FROM\x20','getSeasonNumber','UPDATE\x20file_index_movie\x20set\x20check_time=?\x20WHERE\x20id=?','\x20\x20WHERE\x20','get','ignoreSeasonList','getTvCount','sourceFolderList','basename','dealFirstLetterSingle','getFilenameNumber','9235410KANusP','user_list','path','/getTvHomeData','fileExist','fanart_path','676506zrXyHK','trash','log','../utils/fileUtils','\x20AND\x20path\x20not\x20like\x20?','logo_path','isTvPlay','returnErrMsg','.vtt','SELECT\x20id\x20FROM\x20','\x20\x20AND\x20is_file=1\x20AND\x20show_in_list=1\x20ORDER\x20BY\x20','movie_index_id','app','/getTvHomeData2','error\x20data','UPDATE\x20','\x20\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20and\x20filename_number\x20is\x20null','ordinary','\x20id,title,data,enable_pwd,collection_cover_path,data_value,create_time,share_for_subuser\x20','folderName','isTvSeries','duration','key_value','../../db/dbConfigTable','INDEX_TABLE_NAME_MOVIE','delete','movie_info_name','EDIT','/addCollection','\x20WHERE\x20title\x20like\x20?','\x20AND\x20(path\x20like\x20?\x20OR\x20filename\x20like\x20?\x20OR\x20movie_info_name\x20like\x20?\x20)','DELETE\x20FROM\x20movie_history\x20where\x20user_id=','movie_genres','(filename\x20like\x20?)','then','SWITCH_MOVIE_INFO','collectionId','pageCount','fromName','is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20is_tvplay!=1','paramsList','movieTvCache','sameFolderImgList','specials','/getMovieDetail','\x20\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20','data','genresType','ADD','desc','includes','\x20AND\x20share_for_subuser\x20=\x20?\x20','tvFolderPath','set','smart','autoSkip','power_get','/getTvList','/getHistory','excludeFilenameMovie','movie_actor','fanart.%','\x20AND\x20(filename_fl=?\x20AND\x20show_name_fl=?\x20AND\x20movie_info_name_fl=?)','\x20SET\x20show_in_list\x20=1,is_tvplay=0,show_name\x20=\x27\x27,show_name_fl=null\x20WHERE\x20path=\x27','DELETE\x20FROM\x20movie_collection\x20WHERE\x20id=?','is_file','\x20like\x20?\x20','filepath','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20\x27poster.%\x27\x20or\x20filename\x20like\x20\x27POSTER.%\x27\x20or\x20filename\x20like\x20\x27movie.%\x27\x20or\x20filename\x20like\x20\x27folder.%\x27\x20or\x20filename\x20like\x20\x27cover.%\x27\x20or\x20filename\x20like\x20\x27thumb.%\x27)','sourceType','pwd','SAMPLE\x27\x20\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20\x27%','\x20order\x20by\x20m.create_time\x20desc\x20limit\x201','%fanart%','videoPath','movie_regions','has','\x20OFFSET\x20','sortType','sort','length','order\x20field\x20error','value','\x27\x20and\x20type=1\x20and\x20is_file=1\x20limit\x2020','movieHomeShowLibrary','coverPath','/getMovieKeys','\x20SET\x20show_in_list=1,is_tvplay=0,show_name\x20=\x27\x27,show_name_fl=null\x20WHERE\x20path=?\x20or\x20path\x20like\x20?','dbOther','collection_id','json','favorite','subtitleSize','UPDATE\x20file_index_movie\x20SET\x20movie_info_state=0\x20WHERE\x20(path\x20like\x20?\x20OR\x20path=?)','findByTitle','SPECIALS\x27\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20\x27%','time','substr','startScanPath','endDuration','movieRegion','useTvSeriesInfo','DELETE\x20FROM\x20movie_library\x20\x20WHERE\x20id=?','indexId','movieHomeShowHistory','express','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20','existsSync','replaceAll','../../utils/nfoUtil','seasonList','\x20LIMIT\x20','orderField','\x20FROM\x20\x20movie_collection\x20WHERE\x20type=?','/removeIndexFromCollection','seasonNumber','\x20AND\x20(','folder_cover_path','UPDATE\x20file_index_movie\x20SET\x20movie_info_state=3\x20WHERE\x20path\x20like\x20?\x20OR\x20path=?','coverMovie','folder.jpg','\x20and\x20(filename\x20like\x20?\x20or\x20movie_info_name\x20like\x20?)\x20','seasonCount','checkPath','currentUser','/deleteCollection','getFavorite','/addIndexToCollection','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20filename\x20like\x20?','heic','/clearHistory','parseNfo','27shJIwG','trim','check_time','title','decodePath','search','sep','searchValue','getPhotoByParams','index_id','UPDATE\x20file_index_movie\x20SET\x20collection_id=0\x20where\x20collection_id=?','getTime','/addHistory','timestamp','SELECT\x20path,filename\x20from\x20','sourceList','\x20and\x20title\x20like\x20?','-clearlogo.%','shareForSubUser','../../utils/movieSeasonUtil','index.videoInfoReadFail','post','needTvCount','SELECT\x20*\x20FROM\x20movie_library\x20WHERE\x20share_for_subuser=1','offset','movie','sample\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x20LIMIT\x20200','/getMoviesByGenres','parse','SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_language\x27\x20and\x20\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100','movieGenres','noPermission','sha256','/getIndexDetail','count','deleteFavorite','movieActors','doUserCanGet','\x20AND\x20(filename_fl=?\x20OR\x20show_name_fl=?\x20OR\x20movie_info_name_fl=?)','UPDATE\x20file_index_movie\x20SET\x20collection_id=?\x20WHERE\x20id\x20in\x20','SELECT\x20*\x20FROM\x20movie_keys\x20WHERE\x20key_type=?\x20and\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20200','\x20AND\x20id\x20NOT\x20IN\x20(','replace','extname','indexIdList','movie_language','join','SELECT\x20*\x20FROM\x20source_folder\x20WHERE\x20type=?\x20LIMIT\x2010','\x20AND\x20is_tvplay==0','/getMovies','851OtXxcV','getExcludePathWhereStr','all','endsWith','SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_regions\x27\x20and\x20\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100','openDuration','type','/operationLibrary','SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_genres\x27\x20and\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100','2084LZnBJF','defaultTranscodeResolution','dbFileIndex','\x20AND\x20title\x20like\x20?\x20','../../db/dbScanTaskTable','\x20order\x20by\x20create_time\x20desc','now','filename','SELECT\x20*\x20from\x20movie_history\x20where\x20user_id=?\x20and\x20index_id=?','\x20type=2','power_delete','\x20as\x20f\x20WHERE\x20path\x20like\x20?\x20and\x20is_tvplay=1\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20limit\x20200','Sample\x27\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20\x27%','\x20from\x20movie_history\x20as\x20m\x20inner\x20join\x20file_index_movie\x20as\x20f\x20on\x20m.index_id=f.id\x20where\x20m.user_id=','m.time,\x20f.id,f.is_tvplay,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id,f.movie_douban_score,f.movie_info_name,f.show_name','Value\x20out\x20of\x20limit','\x27\x20or\x20filename\x20like\x20\x27','../../db/dbSourceFolderTable','EXTRA\x27\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20\x27%','%season','../../utils/movieInfoUtil','\x20WHERE\x20is_file=0\x20and\x20(path=?\x20or\x20path\x20like\x20?)\x20','-coverCache-','../utils/movieUtil','dataValue','Router','SELECT\x20*\x20from\x20','-fanart.%','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20?\x20or\x20filename\x20like\x20?)\x20and\x20filename\x20not\x20like\x20?','-seriesPoster','\x20AND\x20collection_id\x20=\x20','\x27\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20\x27','4048857BezFgT','m.time,\x20f.id,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id','sample','extraAndSpecialsList','SELECT\x20id,title,enable_pwd,create_time\x20FROM\x20movie_collection\x20where\x20id=?\x20and\x20pwd=?','updateByWhere','excludePathMovie','\x20FROM\x20','body','orderType','parseNfoTvSeries','pwdCanNotBeNull','-QHD','media_type','movieHomeShowMyMedia','operationFail','is_admin','\x20order\x20by\x20m.create_time\x20desc\x20limit\x2010','listType'];_0x24bb=function(){return _0x5a7b48;};return _0x24bb();}const sqliteUtil=require(_0x5190e8(0x159)),photoApiUtils=require('./photoApiUtils');let movieSeasonUtil=require(_0x5190e8(0x23f)),movieInfoUtil=require(_0x5190e8(0x27b));const dbScanTaskTable=require(_0x5190e8(0x26b));let movieFieldStr='\x20id,collection_id,movie_douban_score,movie_info_name,movie_year,movie_info_state,path,is_tvplay,filename,ext,type,width,height,duration,size,movie_douban_id,movie_imdb_id,show_name,show_in_list';function getTvSeriesPoster(_0x45b8a5){const _0x411a9e=_0x5190e8;let _0x501730='',_0x424073=path[_0x411a9e(0x25a)](path[_0x411a9e(0x176)](_0x45b8a5['path']),'poster.jpg');return fs[_0x411a9e(0x213)](_0x424073)&&(_0x501730=_0x424073),!_0x501730&&(_0x424073=path['join'](path[_0x411a9e(0x176)](_0x45b8a5[_0x411a9e(0x1a4)]),'poster.jpeg'),fs[_0x411a9e(0x213)](_0x424073)&&(_0x501730=_0x424073)),!_0x501730&&(_0x424073=path[_0x411a9e(0x25a)](path[_0x411a9e(0x176)](_0x45b8a5[_0x411a9e(0x1a4)]),_0x411a9e(0x220)),fs['existsSync'](_0x424073)&&(_0x501730=_0x424073)),!_0x501730&&(_0x424073=path['join'](path['dirname'](_0x45b8a5[_0x411a9e(0x1a4)]),_0x411a9e(0x187)),fs[_0x411a9e(0x213)](_0x424073)&&(_0x501730=_0x424073)),_0x501730;}router[_0x5190e8(0x241)](_0x5190e8(0x13e),(_0x444214,_0x56cc54,_0x529dba)=>{const _0x3279b9=_0x5190e8;let _0x371e21=_0x444214['body']['id'],_0x1a8aa7=dbFileIndexTable[_0x3279b9(0x15e)](_0x444214[_0x3279b9(0x1b4)][_0x3279b9(0x269)],_0x371e21,dbFileIndexTable[_0x3279b9(0x1c0)]);if(!_0x1a8aa7)return _0x444214[_0x3279b9(0x1b4)][_0x3279b9(0x1af)](_0x56cc54,_0x56cc54['__']('index.videoInfoReadFail'));if(dbUserTable[_0x3279b9(0x251)](_0x444214,_0x56cc54,_0x3279b9(0x245),_0x3279b9(0x1e0),_0x1a8aa7[_0x3279b9(0x1a4)])==!![]){nfoUtil[_0x3279b9(0x291)](_0x1a8aa7)[_0x3279b9(0x1ca)](_0x51562b=>{const _0x3fc8e1=_0x3279b9;_0x1a8aa7=_0x51562b,_0x444214[_0x3fc8e1(0x28f)][_0x3fc8e1(0x16d)]=!![],_0x444214[_0x3fc8e1(0x28f)][_0x3fc8e1(0x20d)]=0x1,_0x1a8aa7=addFolderCoverPath(_0x56cc54,_0x444214,_0x1a8aa7),_0x1887ed();})[_0x3279b9(0x168)](_0x561769=>{const _0x35fcc8=_0x3279b9;console[_0x35fcc8(0x1aa)]('未找到NFO信息',_0x561769),_0x1a8aa7=addFolderCoverPath(_0x56cc54,_0x444214,_0x1a8aa7),_0x1a8aa7[_0x35fcc8(0x1c2)]=_0x1a8aa7[_0x35fcc8(0x139)],_0x1887ed();});function _0x1887ed(){const _0x342d34=_0x3279b9;addTvFolderPathAndName(_0x1a8aa7),setLogoAndFanart(_0x444214,_0x1a8aa7,_0x1a8aa7[_0x342d34(0x1dc)]);let _0xe47fd5=dbMovieFavorite['getFavorite'](_0x444214['app']['dbFileIndex'],_0x444214['currentUser']['id'],_0x1a8aa7['id']);_0xe47fd5?_0x1a8aa7[_0x342d34(0x203)]=0x1:_0x1a8aa7['favorite']=0x0;let _0x469d53={'code':0x0,'movieIndex':_0x1a8aa7},_0x2004e1='SELECT\x20'+movieFieldStr+_0x342d34(0x28e)+dbFileIndexTable[_0x342d34(0x1c0)]+'\x20as\x20f\x20WHERE\x20path\x20like\x20?\x20and\x20is_tvplay=1\x20and\x20is_file=1\x20and\x20type=2\x20and\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(path\x20like\x20\x27%'+path[_0x342d34(0x232)]+_0x342d34(0x29c)+path[_0x342d34(0x232)]+_0x342d34(0x14d)+path[_0x342d34(0x232)]+_0x342d34(0x279)+path['sep']+'Specials\x27\x20or\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20like\x20\x27%'+path['sep']+_0x342d34(0x207)+path['sep']+_0x342d34(0x166)+path[_0x342d34(0x232)]+_0x342d34(0x273)+path[_0x342d34(0x232)]+_0x342d34(0x1ef)+path[_0x342d34(0x232)]+_0x342d34(0x246),_0x42024e=_0x444214['app'][_0x342d34(0x269)][_0x342d34(0x14a)](_0x2004e1)[_0x342d34(0x260)](path[_0x342d34(0x176)](_0x1a8aa7[_0x342d34(0x1a4)])+path['sep']+'%');for(let _0x1e3938 of _0x42024e){_0x1e3938[_0x342d34(0x1bb)]=path[_0x342d34(0x19f)](_0x1e3938[_0x342d34(0x1a4)]),_0x1e3938[_0x342d34(0x182)]=0x0;}_0x42024e[_0x342d34(0x1f8)]>0x0&&(_0x469d53[_0x342d34(0x28a)]=_0x42024e),fs[_0x342d34(0x146)](_0x1a8aa7[_0x342d34(0x1dc)],(_0x508b58,_0x4d5713)=>{const _0x5652d7=_0x342d34;_0x469d53['fileExist']=_0x508b58?0x0:0x1,_0x56cc54['json'](_0x469d53),_0x1a8aa7['is_tvplay']==0x1&&_0x1a8aa7[_0x5652d7(0x1dc)]&&(dbScanTaskTable[_0x5652d7(0x175)](_0x444214[_0x5652d7(0x1b4)][_0x5652d7(0x200)],_0x5652d7(0x245),_0x1a8aa7[_0x5652d7(0x1dc)]),process[_0x5652d7(0x165)]({'type':_0x5652d7(0x20a),'source_type':_0x5652d7(0x245),'restartWatcher':![]}));});}}}),router[_0x5190e8(0x241)](_0x5190e8(0x1d4),(_0x480e96,_0x3f9280,_0x404571)=>{const _0x3be029=_0x5190e8;let _0x5c6cbe=_0x480e96[_0x3be029(0x28f)]['id'],_0x3a674e=dbFileIndexTable[_0x3be029(0x15e)](_0x480e96[_0x3be029(0x1b4)][_0x3be029(0x269)],_0x5c6cbe,dbFileIndexTable[_0x3be029(0x1c0)]);if(!_0x3a674e)return _0x480e96[_0x3be029(0x1b4)][_0x3be029(0x1af)](_0x3f9280,_0x3f9280['__'](_0x3be029(0x240)));if(dbUserTable[_0x3be029(0x251)](_0x480e96,_0x3f9280,_0x3be029(0x245),_0x3be029(0x1e0),_0x3a674e[_0x3be029(0x1a4)])==!![]){nfoUtil['parseNfo'](_0x3a674e,!![],![])[_0x3be029(0x1ca)](_0x222587=>{const _0x2bf84e=_0x3be029;_0x3a674e=_0x222587,_0x480e96[_0x2bf84e(0x28f)][_0x2bf84e(0x16d)]=!![],_0x3a674e=addFolderCoverPath(_0x3f9280,_0x480e96,_0x3a674e),movieInfoUtil['saveMovieInfoToDb'](_0x480e96['app'][_0x2bf84e(0x269)],_0x3a674e['id'],_0x222587),_0x1bf748();})['catch'](()=>{_0x3a674e=addFolderCoverPath(_0x3f9280,_0x480e96,_0x3a674e),_0x1bf748();});function _0x1bf748(){const _0x474129=_0x3be029;let _0xff9e23=dbMovieFavorite[_0x474129(0x226)](_0x480e96[_0x474129(0x1b4)][_0x474129(0x269)],_0x480e96['currentUser']['id'],_0x3a674e['id']);_0xff9e23?_0x3a674e[_0x474129(0x203)]=0x1:_0x3a674e[_0x474129(0x203)]=0x0;let _0x550b45=null;if(_0x3a674e[_0x474129(0x182)]==0x1){let _0x448b73=_0x480e96[_0x474129(0x1b4)][_0x474129(0x269)][_0x474129(0x14a)](_0x474129(0x1b1)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+'\x20\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20')[_0x474129(0x260)](_0x3a674e['path']),_0x3f9e48='(';for(let _0x5317f8 in _0x448b73){_0x3f9e48+=_0x448b73[_0x5317f8]['id'],_0x5317f8!=_0x448b73[_0x474129(0x1f8)]-0x1&&(_0x3f9e48+=',');}_0x3f9e48+=')';let _0xe80d9c=_0x480e96[_0x474129(0x1b4)]['dbFileIndex'][_0x474129(0x14a)](_0x474129(0x148)+_0x3f9e48+_0x474129(0x26c))['get']();_0xe80d9c&&(_0x550b45=dbFileIndexTable['getById'](_0x480e96['app'][_0x474129(0x269)],_0xe80d9c[_0x474129(0x235)],dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']));}let _0x342983={'code':0x0,'movieIndex':_0x3a674e,'lastTvEpisodeIndex':_0x550b45},_0x4c0ccd='SELECT\x20'+movieFieldStr+'\x20FROM\x20'+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x474129(0x195),_0x3a1349=_0x480e96[_0x474129(0x1b4)][_0x474129(0x269)][_0x474129(0x14a)](_0x4c0ccd)[_0x474129(0x260)](_0x3a674e[_0x474129(0x1a4)]+(path[_0x474129(0x232)]+_0x474129(0x174)),_0x3a674e[_0x474129(0x1a4)]+(path[_0x474129(0x232)]+_0x474129(0x13f)),_0x3a674e[_0x474129(0x1a4)]+(path[_0x474129(0x232)]+_0x474129(0x15d)),_0x3a674e[_0x474129(0x1a4)]+(path[_0x474129(0x232)]+'Specials'),_0x3a674e['path']+(path[_0x474129(0x232)]+_0x474129(0x1d3)),_0x3a674e[_0x474129(0x1a4)]+(path[_0x474129(0x232)]+_0x474129(0x14c)),_0x3a674e[_0x474129(0x1a4)]+(path[_0x474129(0x232)]+_0x474129(0x147)),_0x3a674e[_0x474129(0x1a4)]+(path['sep']+_0x474129(0x177)),_0x3a674e[_0x474129(0x1a4)]+(path['sep']+_0x474129(0x289)));for(let _0x74bf97 of _0x3a1349){_0x74bf97[_0x474129(0x1bb)]=path[_0x474129(0x19f)](_0x74bf97[_0x474129(0x1a4)]);}_0x3a1349['length']>0x0&&(_0x342983[_0x474129(0x28a)]=_0x3a1349);let _0x330eea=path[_0x474129(0x19f)](_0x3a674e[_0x474129(0x1a4)])[_0x474129(0x15b)]();(_0x330eea=='extra'||_0x330eea=='specials'||_0x330eea==_0x474129(0x289))&&(_0x3a674e[_0x474129(0x182)]=0x0);let _0x2cfcee=[];try{let _0x2ec223=_0x480e96[_0x474129(0x1b4)]['dbFileIndex'][_0x474129(0x14a)]('SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=\x27'+_0x3a674e[_0x474129(0x1a4)]+_0x474129(0x1fb))[_0x474129(0x260)]();for(let _0x5a36b7 in _0x2ec223){let _0x8ba549=path[_0x474129(0x25a)](_0x2ec223[_0x5a36b7][_0x474129(0x1a4)],_0x2ec223[_0x5a36b7][_0x474129(0x26e)]);(_0x480e96[_0x474129(0x224)][_0x474129(0x297)]==0x1||dbUserTable[_0x474129(0x251)](_0x480e96,_0x3f9280,'folder',_0x474129(0x1e0),_0x8ba549,!![])==!![])&&_0x2cfcee[_0x474129(0x184)](_0x8ba549);}_0x342983[_0x474129(0x1d2)]=_0x2cfcee;}catch(_0x40bdd6){}let _0x25598b=path['join'](_0x3a674e['path'],_0x3a674e['filename']);fs[_0x474129(0x146)](_0x25598b,(_0x2559a9,_0x471abf)=>{const _0x26903a=_0x474129;_0x342983[_0x26903a(0x1a6)]=_0x2559a9?0x0:0x1,_0x342983['fileFullPath']=_0x25598b,_0x3f9280['json'](_0x342983),_0x3a674e[_0x26903a(0x182)]==0x1&&_0x3a674e[_0x26903a(0x1dc)]&&_0x3a674e[_0x26903a(0x1bc)]!=0x1&&(dbScanTaskTable[_0x26903a(0x175)](_0x480e96['app'][_0x26903a(0x200)],'movie',_0x3a674e[_0x26903a(0x1dc)]),process[_0x26903a(0x165)]({'type':_0x26903a(0x20a),'source_type':_0x26903a(0x245),'restartWatcher':![]}));});}}}),router['post'](_0x5190e8(0x1e1),(_0x40a969,_0x50813b,_0x55d319)=>{const _0x3fedb3=_0x5190e8;let _0x52de4b=_0x40a969[_0x3fedb3(0x28f)]['id'],_0x80760d=_0x40a969[_0x3fedb3(0x28f)]['page']||0x0,_0x5f90ab=_0x40a969[_0x3fedb3(0x28f)][_0x3fedb3(0x14f)]||0xa,_0x338ceb=_0x40a969['body'][_0x3fedb3(0x13d)],_0x21dbc0=_0x40a969[_0x3fedb3(0x28f)][_0x3fedb3(0x1ce)],_0x5e7cdf=_0x40a969['body'][_0x3fedb3(0x140)],_0x16e898=_0x40a969[_0x3fedb3(0x28f)][_0x3fedb3(0x19c)],_0xdbc6dc=dbFileIndexTable[_0x3fedb3(0x15e)](_0x40a969[_0x3fedb3(0x1b4)][_0x3fedb3(0x269)],_0x52de4b,dbFileIndexTable[_0x3fedb3(0x1c0)]);if(!_0xdbc6dc)return _0x40a969['app']['returnErrMsg'](_0x50813b,_0x50813b['__']('index.videoInfoReadFail'));let _0x1beb7e=movieFieldStr,_0x551260=[],_0x28bc3f=0x0;if(dbUserTable['doUserCanGet'](_0x40a969,_0x50813b,'movie',_0x3fedb3(0x1e0),_0xdbc6dc[_0x3fedb3(0x1a4)])==!![]){if(_0x5e7cdf==0x1)return _0x19d654();let _0x152c0c=_0x40a969[_0x3fedb3(0x1b4)][_0x3fedb3(0x269)][_0x3fedb3(0x14a)](_0x3fedb3(0x197)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x3fedb3(0x1b8))[_0x3fedb3(0x260)](_0xdbc6dc[_0x3fedb3(0x1a4)]);for(let _0x2e9b4d in _0x152c0c){let _0x47e08b=_0x152c0c[_0x2e9b4d];if(_0x47e08b[_0x3fedb3(0x26e)]){let _0x26dc35=movieUtil[_0x3fedb3(0x1a1)](_0x47e08b[_0x3fedb3(0x26e)]);_0x40a969[_0x3fedb3(0x1b4)][_0x3fedb3(0x269)][_0x3fedb3(0x14a)](_0x3fedb3(0x1b7)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+'\x20SET\x20filename_number=?\x20\x20WHERE\x20\x20id=?')[_0x3fedb3(0x173)](_0x26dc35,_0x47e08b['id']);}}let _0x385efa=dbUserTable['getUserPathWhere'](_0x40a969,_0x3fedb3(0x245),_0x3fedb3(0x1e0),!![]),_0x4a83ca=[..._0x385efa[_0x3fedb3(0x1d0)]],_0x135e34='\x20type=2\x20and\x20is_file=1';_0x135e34+=_0x385efa['whereStr'],_0x135e34+=_0x3fedb3(0x163),_0x4a83ca[_0x3fedb3(0x184)](_0xdbc6dc['path']);_0x338ceb&&(_0x135e34+=_0x3fedb3(0x221),_0x4a83ca[_0x3fedb3(0x184)]('%'+_0x338ceb+'%','%'+_0x338ceb+'%'));if(_0x21dbc0){let _0x25be43=movieUtil[_0x3fedb3(0x1a1)](_0x21dbc0);_0x25be43?(_0x135e34+=_0x3fedb3(0x17f),_0x4a83ca['push'](_0x25be43)):(_0x135e34+=_0x3fedb3(0x161),_0x4a83ca[_0x3fedb3(0x184)](_0x21dbc0));}let _0x2f9658=_0x135e34+'';_0x135e34+='\x20order\x20by\x20filename_number,filename';let _0x112d0f=_0x3fedb3(0x132)+_0x1beb7e+_0x3fedb3(0x28e)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+'\x20as\x20f\x20WHERE\x20'+_0x135e34+_0x3fedb3(0x217)+_0x5f90ab+_0x3fedb3(0x1f5)+_0x80760d*_0x5f90ab;_0x551260=_0x40a969[_0x3fedb3(0x1b4)][_0x3fedb3(0x269)]['prepare'](_0x112d0f)['all'](_0x4a83ca);let _0xdfbad=_0x3fedb3(0x18b)+dbFileIndexTable[_0x3fedb3(0x1c0)]+_0x3fedb3(0x19a)+_0x2f9658+'\x20',_0x1c1210=_0x40a969[_0x3fedb3(0x1b4)][_0x3fedb3(0x269)][_0x3fedb3(0x14a)](_0xdfbad)['get'](_0x4a83ca);_0x28bc3f=_0x1c1210[_0x3fedb3(0x24e)];if(_0x551260[_0x3fedb3(0x1f8)]>0x0){let _0x219af0=0x0;for(let _0x16fd27 in _0x551260){let _0x56dfc4=_0x551260[_0x16fd27];nfoUtil[_0x3fedb3(0x22b)](_0x56dfc4,!![],!![])[_0x3fedb3(0x1ca)](_0x84cd9c=>{const _0x1dfbf8=_0x3fedb3;_0x219af0+=0x1,_0x551260[_0x16fd27]=_0x84cd9c,_0x551260[_0x16fd27]=addFolderCoverPath(_0x50813b,_0x40a969,_0x551260[_0x16fd27],!![]),_0x219af0>=_0x551260[_0x1dfbf8(0x1f8)]&&_0x19d654();})[_0x3fedb3(0x168)](()=>{const _0x445ac9=_0x3fedb3;_0x219af0+=0x1,_0x551260[_0x16fd27]=addFolderCoverPath(_0x50813b,_0x40a969,_0x551260[_0x16fd27],!![]),_0x219af0>=_0x551260[_0x445ac9(0x1f8)]&&_0x19d654();});}}else _0x19d654();function _0x19d654(){const _0xd3eb36=_0x3fedb3;let _0x1a2ba7={'code':0x0,'tvplayList':_0x551260,'count':_0x28bc3f,'pageSize':_0x5f90ab};if(!_0x16e898){let _0x22dcb8=path[_0xd3eb36(0x19f)](_0xdbc6dc[_0xd3eb36(0x1a4)]),_0x2b8cc3=movieSeasonUtil[_0xd3eb36(0x198)](_0x22dcb8);if(_0x2b8cc3>-0x1){let _0xf6e086='SELECT\x20'+_0x1beb7e+_0xd3eb36(0x28e)+dbFileIndexTable[_0xd3eb36(0x1c0)]+_0xd3eb36(0x272),_0x1e2aa5=_0x40a969['app']['dbFileIndex'][_0xd3eb36(0x14a)](_0xf6e086)['all'](path['dirname'](_0xdbc6dc[_0xd3eb36(0x1a4)])+path[_0xd3eb36(0x232)]+'%'),_0x5c2f6a=[];for(let _0x1a8083 of _0x1e2aa5){let _0x311f2d=path[_0xd3eb36(0x19f)](_0x1a8083['path']),_0x42a2d3=movieSeasonUtil[_0xd3eb36(0x198)](_0x311f2d);_0x42a2d3>-0x1&&(_0x1a8083[_0xd3eb36(0x21b)]=_0x42a2d3,_0x5c2f6a[_0xd3eb36(0x184)](_0x1a8083));}for(let _0x7d07af of _0x5c2f6a){_0x7d07af=addFolderCoverPath(_0x50813b,_0x40a969,_0x7d07af);let _0xd7fd0e=dbFileIndexTable[_0xd3eb36(0x19d)](_0x40a969['app'][_0xd3eb36(0x269)],_0x7d07af);_0x7d07af[_0xd3eb36(0x18e)]=_0xd7fd0e[_0xd3eb36(0x24e)];}_0x5c2f6a[_0xd3eb36(0x1f8)]>0x0&&(_0x5c2f6a[_0xd3eb36(0x1f7)](function(_0x2d4806,_0x381c8f){const _0x483509=_0xd3eb36;return _0x2d4806[_0x483509(0x21b)]-_0x381c8f[_0x483509(0x21b)];}),_0x1a2ba7[_0xd3eb36(0x216)]=_0x5c2f6a);}}return _0x50813b['json'](_0x1a2ba7);}}}),router['post'](_0x5190e8(0x21a),(_0x2cf516,_0x1514b6,_0x48f25)=>{const _0x2262c9=_0x5190e8;let _0x17c95a=_0x2cf516[_0x2262c9(0x28f)][_0x2262c9(0x258)],_0x6cab2b=[];for(let _0x14f342 of _0x17c95a){let _0x1609b8=dbFileIndexTable['getById'](_0x2cf516[_0x2262c9(0x1b4)]['dbFileIndex'],_0x14f342,dbFileIndexTable[_0x2262c9(0x1c0)]);if(!_0x1609b8)continue;if(dbUserTable[_0x2262c9(0x251)](_0x2cf516,_0x1514b6,'','power_change',_0x1609b8[_0x2262c9(0x1a4)])!==!![])continue;let _0x222739=path[_0x2262c9(0x19f)](_0x1609b8[_0x2262c9(0x1a4)]),_0x9c2d2b=movieSeasonUtil['getSeasonNumber'](_0x222739);if(_0x9c2d2b>-0x1){let _0x49780f=path[_0x2262c9(0x25a)](path[_0x2262c9(0x176)](_0x1609b8[_0x2262c9(0x1a4)])),_0x5cdf12=_0x2cf516[_0x2262c9(0x1b4)][_0x2262c9(0x269)]['prepare'](_0x2262c9(0x167))[_0x2262c9(0x260)](_0x49780f+path['sep']+'%',_0x49780f);for(let _0x4d9f87 of _0x5cdf12){_0x6cab2b[_0x2262c9(0x184)](_0x4d9f87['id']);}}}_0x6cab2b[_0x2262c9(0x1f8)]>0x0&&(_0x17c95a=[..._0x17c95a,..._0x6cab2b]);if(_0x17c95a['length']<0x1)return _0x1514b6[_0x2262c9(0x202)]({'code':0x0});let _0xdc6ff7='(';for(let _0x1cce6c in _0x17c95a){_0xdc6ff7+=_0x17c95a[_0x1cce6c],_0x1cce6c!=_0x17c95a[_0x2262c9(0x1f8)]-0x1&&(_0xdc6ff7+=',');}return _0xdc6ff7+=')',_0x2cf516['app'][_0x2262c9(0x269)][_0x2262c9(0x14a)]('UPDATE\x20file_index_movie\x20SET\x20collection_id=0\x20WHERE\x20id\x20in\x20'+_0xdc6ff7)[_0x2262c9(0x173)](),_0x1514b6[_0x2262c9(0x202)]({'code':0x0});}),router[_0x5190e8(0x241)](_0x5190e8(0x227),(_0x132f11,_0xdd6149,_0x1d8ee7)=>{const _0x3875a0=_0x5190e8;let _0x5a6187=_0x132f11[_0x3875a0(0x28f)][_0x3875a0(0x1cc)],_0x916589=_0x132f11[_0x3875a0(0x28f)][_0x3875a0(0x20f)],_0x4c27d2=_0x132f11[_0x3875a0(0x28f)][_0x3875a0(0x1eb)];function _0x341db2(_0x24357d){const _0x3f1b6f=_0x3875a0;let _0x25d96f=[];for(let _0xf8a38c in _0x24357d){_0x25d96f[_0x3f1b6f(0x184)](_0x24357d[_0xf8a38c]['id']);}inSql='(';for(let _0x28b37a in _0x25d96f){inSql+=_0x25d96f[_0x28b37a],_0x28b37a!=_0x25d96f[_0x3f1b6f(0x1f8)]-0x1&&(inSql+=',');}return inSql+=')',inSql;}if(_0x5a6187&&_0x916589){let _0xe5e84b=dbFileIndexTable[_0x3875a0(0x15e)](_0x132f11[_0x3875a0(0x1b4)][_0x3875a0(0x269)],_0x916589,dbFileIndexTable[_0x3875a0(0x1c0)]),_0x30ad6d='('+_0x916589+')';if(!_0xe5e84b)return _0x132f11[_0x3875a0(0x1b4)][_0x3875a0(0x1af)](_0xdd6149,_0xdd6149['__'](_0x3875a0(0x296)),_0x3875a0(0x13c));if(dbUserTable[_0x3875a0(0x251)](_0x132f11,_0xdd6149,'','power_change',_0xe5e84b['path'])!==!![])return;let _0x5d880d=path[_0x3875a0(0x19f)](_0xe5e84b['path']),_0x5d136e=movieSeasonUtil[_0x3875a0(0x198)](_0x5d880d);_0x5d136e>-0x1&&(_0xe5e84b[_0x3875a0(0x1e9)]=0x0,_0xe5e84b['path']=path[_0x3875a0(0x176)](_0xe5e84b[_0x3875a0(0x1a4)]),_0xe5e84b[_0x3875a0(0x26e)]='');if(_0xe5e84b[_0x3875a0(0x1e9)]!=0x1){let _0x59a765=path[_0x3875a0(0x25a)](_0xe5e84b['path'],_0xe5e84b['filename']);console[_0x3875a0(0x1aa)](_0x3875a0(0x223),_0x59a765);let _0xce145c=_0x132f11[_0x3875a0(0x1b4)][_0x3875a0(0x269)][_0x3875a0(0x14a)](_0x3875a0(0x167))[_0x3875a0(0x260)](_0x59a765+path['sep']+'%',_0x59a765);if(_0xce145c[_0x3875a0(0x1f8)]<0x1)return _0xdd6149[_0x3875a0(0x202)]({'code':0x0});_0x30ad6d=_0x341db2(_0xce145c);}return _0x132f11[_0x3875a0(0x1b4)][_0x3875a0(0x269)][_0x3875a0(0x14a)](_0x3875a0(0x253)+_0x30ad6d+'\x20and\x20show_in_list=1')[_0x3875a0(0x173)](_0x5a6187),_0xdd6149[_0x3875a0(0x202)]({'code':0x0});}else{if(_0x5a6187&&_0x4c27d2){let _0x4cae06=_0x132f11[_0x3875a0(0x1b4)][_0x3875a0(0x269)][_0x3875a0(0x14a)](_0x3875a0(0x167))['all'](_0x4c27d2+path['sep']+'%',_0x4c27d2),_0x3bdb01=_0x341db2(_0x4cae06);return _0x132f11['app'][_0x3875a0(0x269)][_0x3875a0(0x14a)](_0x3875a0(0x253)+_0x3bdb01+'\x20and\x20show_in_list=1')['run'](_0x5a6187),_0xdd6149['json']({'code':0x0});}else return _0x132f11[_0x3875a0(0x1b4)][_0x3875a0(0x1af)](_0xdd6149,_0xdd6149['__'](_0x3875a0(0x296)),_0x3875a0(0x13c));}});function getCollectionList(_0x5029cf,_0x146d08,_0x1d26bc){const _0x3e84dd=_0x5190e8;let _0x48f441=[],_0x2361d5=_0x5029cf[_0x3e84dd(0x28f)][_0x3e84dd(0x24e)]||0x32,_0x1cb536=_0x5029cf[_0x3e84dd(0x28f)][_0x3e84dd(0x244)]||0x0,_0x1507fe=_0x5029cf['body'][_0x3e84dd(0x218)]||'id',_0xc7c5cf=_0x5029cf[_0x3e84dd(0x28f)][_0x3e84dd(0x290)]||_0x3e84dd(0x1d9),_0x580049=_0x5029cf[_0x3e84dd(0x28f)][_0x3e84dd(0x231)],_0x31f6db=_0x3e84dd(0x1ba),_0x58e63d=_0x3e84dd(0x17b)+_0x31f6db+_0x3e84dd(0x219),_0xcfbc4c=[_0x1d26bc];_0x580049&&(_0x58e63d+=_0x3e84dd(0x26a),_0xcfbc4c['push']('%'+_0x580049+'%'));_0x5029cf[_0x3e84dd(0x224)][_0x3e84dd(0x297)]!=0x1&&(_0x58e63d+=_0x3e84dd(0x1db),_0xcfbc4c[_0x3e84dd(0x184)](0x1));_0x58e63d+='\x20order\x20by\x20'+_0x1507fe+'\x20'+_0xc7c5cf+'\x20LIMIT\x20?\x20OFFSET\x20?',_0xcfbc4c[_0x3e84dd(0x184)](_0x2361d5),_0xcfbc4c[_0x3e84dd(0x184)](_0x1cb536),_0x48f441=_0x5029cf['app'][_0x3e84dd(0x269)][_0x3e84dd(0x14a)](_0x58e63d)[_0x3e84dd(0x260)](_0xcfbc4c);for(let _0x432f87 of _0x48f441){if(_0x432f87[_0x3e84dd(0x169)]==0x1)continue;let _0x58be43=getMoviesByParams(_0x146d08,_0x5029cf,null,'id',0x1,0x0,_0x3e84dd(0x1d9),null,null,null,null,null,null,_0x432f87['id']);_0x58be43[_0x3e84dd(0x1f8)]>0x0&&(_0x432f87[_0x3e84dd(0x21f)]=_0x58be43[0x0]);}return _0x48f441;}router['post']('/getCollection',(_0x3e7507,_0x5b5e7e,_0x2e0854)=>{const _0x439a80=_0x5190e8;let _0x54d445=_0x3e7507[_0x439a80(0x28f)][_0x439a80(0x264)]||_0x439a80(0x1b9),_0x411485=getCollectionList(_0x3e7507,_0x5b5e7e,_0x54d445);return _0x5b5e7e['json']({'code':0x0,'data':_0x411485});}),router[_0x5190e8(0x241)](_0x5190e8(0x143),(_0x2a7c42,_0x4a1228,_0x4ed3fb)=>{const _0x21312c=_0x5190e8;let _0x54a355=_0x2a7c42[_0x21312c(0x28f)][_0x21312c(0x1ee)],_0x50b6c4=_0x2a7c42[_0x21312c(0x28f)][_0x21312c(0x1cc)];if(!_0x54a355)return _0x2a7c42[_0x21312c(0x1b4)]['returnErrMsg'](_0x4a1228,_0x4a1228['__'](_0x21312c(0x292)),_0x21312c(0x13c));_0x54a355=sha256(_0x54a355);let _0x39fc5d=_0x2a7c42['app']['dbFileIndex'][_0x21312c(0x14a)](_0x21312c(0x28b))['get'](_0x50b6c4,_0x54a355);if(!_0x39fc5d)return _0x2a7c42[_0x21312c(0x1b4)][_0x21312c(0x1af)](_0x4a1228,_0x4a1228['__'](_0x21312c(0x130)),'dialog');return _0x4a1228['json']({'code':0x0,'data':_0x39fc5d});}),router[_0x5190e8(0x241)](_0x5190e8(0x1c4),(_0x443b57,_0x1b0ade,_0x44f111)=>{const _0x56f86e=_0x5190e8;let _0x531c42=_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x22f)],_0x2d5532=_0x443b57['body'][_0x56f86e(0x12f)],_0x37b079=_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x1ee)],_0x1c9e0b=_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x1cc)],_0x58d43b=_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x264)]?_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x264)]:_0x56f86e(0x1b9),_0x4e89b5=_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x1d6)]?_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x1d6)]:'',_0x296ddf=_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x1fd)]?_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x1fd)]:'',_0xf38bd7=_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x23e)];_0xf38bd7==null&&(_0xf38bd7=0x1);if(_0x58d43b==_0x56f86e(0x1de)){if(!_0x4e89b5||!_0x4e89b5[_0x56f86e(0x233)]||sqliteUtil[_0x56f86e(0x185)](_0x4e89b5[_0x56f86e(0x233)])==!![])return _0x443b57['app']['returnErrMsg'](_0x1b0ade,_0x56f86e(0x1b6));}let _0x44ed2e=_0x443b57[_0x56f86e(0x28f)]['dataValue']?_0x443b57[_0x56f86e(0x28f)][_0x56f86e(0x27f)]:'';if(_0x443b57[_0x56f86e(0x224)][_0x56f86e(0x297)]!=0x1)return _0x443b57['app'][_0x56f86e(0x1af)](_0x1b0ade,_0x1b0ade['__']('noPermission'));if(_0x2d5532=='1'){if(!_0x37b079)return _0x443b57[_0x56f86e(0x1b4)][_0x56f86e(0x1af)](_0x1b0ade,_0x1b0ade['__']('pwdCanNotBeNull'),_0x56f86e(0x13c));_0x37b079=sha256(_0x37b079);}return _0x1c9e0b?_0x443b57[_0x56f86e(0x1b4)]['dbFileIndex'][_0x56f86e(0x14a)](_0x56f86e(0x191))[_0x56f86e(0x173)](_0x531c42,JSON[_0x56f86e(0x135)](_0x4e89b5),_0x2d5532+'',_0x37b079,_0x296ddf,_0x44ed2e,_0xf38bd7,_0x1c9e0b):_0x443b57[_0x56f86e(0x1b4)][_0x56f86e(0x269)][_0x56f86e(0x14a)](_0x56f86e(0x13a))['run'](_0x531c42,_0x2d5532+'',_0x37b079,_0x443b57[_0x56f86e(0x224)]['id']+'',_0x58d43b,JSON[_0x56f86e(0x135)](_0x4e89b5),_0x296ddf,_0x44ed2e,_0xf38bd7),_0x1b0ade['json']({'code':0x0});}),router[_0x5190e8(0x241)](_0x5190e8(0x225),(_0x33ee3a,_0x4cdb0a,_0x5edced)=>{const _0x30986f=_0x5190e8;let _0x457bf2=_0x33ee3a[_0x30986f(0x28f)]['collectionId'];if(_0x33ee3a['currentUser'][_0x30986f(0x297)]!=0x1)return _0x33ee3a['app'][_0x30986f(0x1af)](_0x4cdb0a,_0x4cdb0a['__']('noPermission'));return _0x33ee3a[_0x30986f(0x1b4)][_0x30986f(0x269)][_0x30986f(0x14a)](_0x30986f(0x236))[_0x30986f(0x173)](_0x457bf2),_0x33ee3a[_0x30986f(0x1b4)][_0x30986f(0x269)][_0x30986f(0x14a)](_0x30986f(0x1e8))[_0x30986f(0x173)](_0x457bf2),_0x4cdb0a[_0x30986f(0x202)]({'code':0x0});}),router[_0x5190e8(0x241)](_0x5190e8(0x22a),(_0x55f46d,_0x5e01c1,_0x16d3ef)=>{const _0x20f01b=_0x5190e8;return _0x55f46d[_0x20f01b(0x1b4)][_0x20f01b(0x269)][_0x20f01b(0x14a)](_0x20f01b(0x1c7)+_0x55f46d['currentUser']['id'])['run'](),_0x5e01c1[_0x20f01b(0x202)]({'code':0x0});}),router['post'](_0x5190e8(0x238),(_0x518462,_0x57db28,_0x67df24)=>{const _0x3d03de=_0x5190e8;let _0x573d7e=_0x518462[_0x3d03de(0x28f)][_0x3d03de(0x20f)],_0x1c84e9=_0x518462[_0x3d03de(0x28f)][_0x3d03de(0x208)],_0x3b934f=dbFileIndexTable[_0x3d03de(0x15e)](_0x518462[_0x3d03de(0x1b4)][_0x3d03de(0x269)],_0x573d7e,dbFileIndexTable[_0x3d03de(0x1c0)]);if(!_0x3b934f)return _0x57db28['json']({'code':0x0});if(_0x3b934f[_0x3d03de(0x201)]){let _0x171119=_0x518462[_0x3d03de(0x1b4)][_0x3d03de(0x269)][_0x3d03de(0x14a)](_0x3d03de(0x17a))[_0x3d03de(0x19b)](_0x3b934f['collection_id']);if(_0x171119&&_0x171119['enable_pwd']==0x1)return _0x57db28[_0x3d03de(0x202)]({'code':0x0});}let _0x1cce1d=_0x518462[_0x3d03de(0x1b4)]['dbFileIndex'][_0x3d03de(0x14a)](_0x3d03de(0x162))[_0x3d03de(0x19b)](_0x573d7e+'',_0x518462[_0x3d03de(0x224)]['id']+'');return _0x1cce1d?_0x518462[_0x3d03de(0x1b4)][_0x3d03de(0x269)]['prepare']('UPDATE\x20movie_history\x20SET\x20time=?,create_time=?\x20where\x20index_id=?\x20AND\x20user_id=?')['run'](_0x1c84e9,new Date()[_0x3d03de(0x237)](),_0x573d7e+'',_0x518462[_0x3d03de(0x224)]['id']+''):_0x518462[_0x3d03de(0x1b4)][_0x3d03de(0x269)][_0x3d03de(0x14a)]('REPLACE\x20INTO\x20movie_history(index_id,user_id,time,create_time)\x20VALUES(\x20?,?,?,?)')['run'](_0x573d7e+'',_0x518462[_0x3d03de(0x224)]['id']+'',_0x1c84e9,new Date()['getTime']()),_0x57db28[_0x3d03de(0x202)]({'code':0x0});}),router['post'](_0x5190e8(0x1e2),(_0x3f99f0,_0x22d5e9,_0x1d3265)=>{const _0x191837=_0x5190e8;let _0x418d40=_0x3f99f0[_0x191837(0x28f)][_0x191837(0x20f)],_0x5d4dd0=_0x191837(0x288);if(_0x418d40){let _0x66a59a=_0x3f99f0[_0x191837(0x1b4)]['dbFileIndex']['prepare'](_0x191837(0x26f))[_0x191837(0x19b)](_0x3f99f0['currentUser']['id']+'',_0x418d40+'');return _0x22d5e9[_0x191837(0x202)]({'code':0x0,'data':_0x66a59a});}else{let _0x3f7572=_0x191837(0x132)+_0x5d4dd0+_0x191837(0x274)+_0x3f99f0[_0x191837(0x224)]['id']+_0x191837(0x154),_0x22f201=_0x3f99f0[_0x191837(0x1b4)][_0x191837(0x269)][_0x191837(0x14a)](_0x3f7572)[_0x191837(0x260)]();return _0x22d5e9['json']({'code':0x0,'data':_0x22f201});}}),router[_0x5190e8(0x241)](_0x5190e8(0x24d),(_0x2f5e54,_0x51c116,_0x580d90)=>{const _0x3f51b3=_0x5190e8;let _0x518773=_0x2f5e54['body']['id'],_0x463d6c=dbFileIndexTable[_0x3f51b3(0x15e)](_0x2f5e54[_0x3f51b3(0x1b4)][_0x3f51b3(0x269)],_0x518773,dbFileIndexTable[_0x3f51b3(0x1c0)]);if(dbUserTable[_0x3f51b3(0x251)](_0x2f5e54,_0x51c116,_0x3f51b3(0x245),'power_get',_0x463d6c[_0x3f51b3(0x1a4)])==!![]){let _0x317c5e={'code':0x0,'data':_0x463d6c};return _0x51c116[_0x3f51b3(0x202)](_0x317c5e);}}),router['post']('/switchMatchInfo',(_0xd31210,_0x3b663f,_0xdaa166)=>{const _0x51cc21=_0x5190e8;let _0x247999=_0xd31210[_0x51cc21(0x28f)][_0x51cc21(0x17c)],_0x3d0de3=_0xd31210[_0x51cc21(0x28f)]['ignoreMatchInfo'];if(dbUserTable['isAdmin'](_0xd31210,_0x3b663f)===!![]){let _0x163b77=dbSourceFolderTable['getById'](_0xd31210[_0x51cc21(0x1b4)][_0x51cc21(0x200)],_0x247999);if(!_0x163b77)return _0x3b663f[_0x51cc21(0x138)](0x194)['end']();return _0x3d0de3==0x1?(_0xd31210[_0x51cc21(0x1b4)]['dbFileIndex'][_0x51cc21(0x14a)](_0x51cc21(0x21e))[_0x51cc21(0x173)](_0x163b77[_0x51cc21(0x1a4)]+path['sep']+'%',_0x163b77[_0x51cc21(0x1a4)]),dbSourceFolderTable['updateByWhere'](_0xd31210[_0x51cc21(0x1b4)][_0x51cc21(0x200)],_0x51cc21(0x16e),_0x3d0de3,_0x247999),process[_0x51cc21(0x165)]({'type':_0x51cc21(0x1cb)}),_0x3b663f[_0x51cc21(0x202)]({'code':0x0})):(dbSourceFolderTable[_0x51cc21(0x28c)](_0xd31210[_0x51cc21(0x1b4)]['dbOther'],_0x51cc21(0x16e),_0x3d0de3,_0x247999),_0xd31210[_0x51cc21(0x1b4)][_0x51cc21(0x269)][_0x51cc21(0x14a)](_0x51cc21(0x205))[_0x51cc21(0x173)](_0x163b77[_0x51cc21(0x1a4)]+path[_0x51cc21(0x232)]+'%',_0x163b77[_0x51cc21(0x1a4)]),process[_0x51cc21(0x165)]({'type':_0x51cc21(0x1cb)}),_0x3b663f[_0x51cc21(0x202)]({'code':0x0}));}}),router['post']('/setTvplay',(_0x29a269,_0x2eaaec,_0x480d28)=>{const _0x545060=_0x5190e8;let _0x2aa48c=_0x29a269[_0x545060(0x28f)][_0x545060(0x1ae)],_0x5975dc=_0x29a269[_0x545060(0x28f)][_0x545060(0x20f)],_0xb50a4a=_0x29a269[_0x545060(0x28f)][_0x545060(0x17c)];function _0x40d092(_0x4b6156){const _0x4e71a1=_0x545060;let _0x39ebf9=_0x29a269['app'][_0x4e71a1(0x269)][_0x4e71a1(0x14a)](_0x4e71a1(0x281)+dbFileIndexTable[_0x4e71a1(0x1c0)]+'\x20WHERE\x20path=?\x20and\x20is_file=1\x20and\x20type=2\x20order\x20by\x20filename')[_0x4e71a1(0x19b)](_0x4b6156);if(!_0x39ebf9)return;_0x29a269[_0x4e71a1(0x1b4)][_0x4e71a1(0x269)][_0x4e71a1(0x14a)](_0x4e71a1(0x1b7)+dbFileIndexTable[_0x4e71a1(0x1c0)]+'\x20SET\x20show_in_list\x20=0,is_tvplay=1\x20WHERE\x20path=?')[_0x4e71a1(0x173)](_0x4b6156),_0x29a269[_0x4e71a1(0x1b4)][_0x4e71a1(0x269)][_0x4e71a1(0x14a)](_0x4e71a1(0x1b7)+dbFileIndexTable[_0x4e71a1(0x1c0)]+_0x4e71a1(0x157))[_0x4e71a1(0x173)](_0x39ebf9['id']),movieUtil[_0x4e71a1(0x1a0)](_0x29a269[_0x4e71a1(0x1b4)][_0x4e71a1(0x269)],_0x39ebf9);}if(_0x5975dc){let _0x186357=dbFileIndexTable[_0x545060(0x15e)](_0x29a269['app']['dbFileIndex'],_0x5975dc,dbFileIndexTable[_0x545060(0x1c0)]);if(dbUserTable[_0x545060(0x251)](_0x29a269,_0x2eaaec,'movie',_0x545060(0x189),_0x186357[_0x545060(0x1a4)])==!![])return _0x2aa48c==0x1?_0x40d092(_0x186357[_0x545060(0x1a4)]):_0x29a269[_0x545060(0x1b4)]['dbFileIndex'][_0x545060(0x14a)](_0x545060(0x1b7)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x545060(0x1e7)+_0x186357[_0x545060(0x1a4)]+'\x27')[_0x545060(0x173)](),_0x2eaaec[_0x545060(0x202)]({'code':0x0});}else{if(_0xb50a4a){let _0x2480a0=dbSourceFolderTable[_0x545060(0x15e)](_0x29a269['app'][_0x545060(0x200)],_0xb50a4a);if(!_0x2480a0||_0x2480a0['type']!=_0x545060(0x245))return _0x29a269['app']['returnErrMsg'](_0x2eaaec,_0x2eaaec['__'](_0x545060(0x296)),'dialog');if(_0x2aa48c==0x1){dbSourceFolderTable['updateByWhere'](_0x29a269[_0x545060(0x1b4)][_0x545060(0x200)],'media_type','tvplay',_0xb50a4a),_0x40d092(_0x2480a0['path']);let _0x5e8f3c=_0x29a269['app']['dbFileIndex'][_0x545060(0x14a)](_0x545060(0x23a)+dbFileIndexTable[_0x545060(0x1c0)]+_0x545060(0x27c))[_0x545060(0x260)](_0x2480a0['path'],''+_0x2480a0['path']+path[_0x545060(0x232)]+'%');for(let _0x3dbbb9 in _0x5e8f3c){let _0x3a6c13=path[_0x545060(0x25a)](_0x5e8f3c[_0x3dbbb9][_0x545060(0x1a4)],_0x5e8f3c[_0x3dbbb9]['filename']);_0x40d092(_0x3a6c13);}}else{dbSourceFolderTable[_0x545060(0x28c)](_0x29a269[_0x545060(0x1b4)][_0x545060(0x200)],_0x545060(0x294),_0x545060(0x245),_0xb50a4a);let _0x2418b7=_0x29a269[_0x545060(0x1b4)][_0x545060(0x269)][_0x545060(0x14a)](_0x545060(0x1b7)+dbFileIndexTable[_0x545060(0x1c0)]+_0x545060(0x1ff))[_0x545060(0x173)](_0x2480a0[_0x545060(0x1a4)],''+_0x2480a0[_0x545060(0x1a4)]+path['sep']+'%');}return _0x2eaaec[_0x545060(0x202)]({'code':0x0});}else return _0x29a269['app'][_0x545060(0x1af)](_0x2eaaec,_0x2eaaec['__'](_0x545060(0x296)),'dialog');}});function setLogoAndFanart(_0x10e644,_0x574af8,_0x1642e2,_0x451c47){const _0x25c62c=_0x5190e8;if(_0x10e644[_0x25c62c(0x28f)][_0x25c62c(0x16d)]){let _0x3c8c7b=_0x25c62c(0x212),_0x380331=[_0x1642e2];_0x451c47?(_0x3c8c7b+='(filename\x20like\x20?\x20or\x20filename\x20like\x20?\x20\x20or\x20filename\x20like\x20?)',_0x380331['push']('clearlogo.%'),_0x380331['push'](_0x451c47+_0x25c62c(0x23d)),_0x380331['push'](_0x451c47+_0x25c62c(0x196))):(_0x3c8c7b+=_0x25c62c(0x1c9),_0x380331[_0x25c62c(0x184)](_0x25c62c(0x15a)));let _0x466241=_0x10e644['app'][_0x25c62c(0x269)][_0x25c62c(0x14a)](_0x3c8c7b)[_0x25c62c(0x19b)](_0x380331);if(_0x466241){let _0x330a75=path[_0x25c62c(0x25a)](_0x466241[_0x25c62c(0x1a4)],_0x466241[_0x25c62c(0x26e)]);_0x574af8[_0x25c62c(0x1ad)]=_0x330a75;}let _0x21c825=_0x25c62c(0x212),_0x323270=[_0x1642e2];_0x451c47?(_0x21c825+=_0x25c62c(0x193),_0x323270[_0x25c62c(0x184)](_0x25c62c(0x1e5)),_0x323270[_0x25c62c(0x184)](_0x451c47+_0x25c62c(0x282)),_0x323270[_0x25c62c(0x184)](_0x451c47+'.fanart.%')):(_0x21c825+=_0x25c62c(0x1c9),_0x323270['push']('fanart.%'));let _0x217656=_0x10e644[_0x25c62c(0x1b4)][_0x25c62c(0x269)][_0x25c62c(0x14a)](_0x21c825)[_0x25c62c(0x19b)](_0x323270);if(_0x217656){let _0x122b07=path['join'](_0x217656[_0x25c62c(0x1a4)],_0x217656[_0x25c62c(0x26e)]);_0x574af8[_0x25c62c(0x1a7)]=_0x122b07;}}}function addTvFolderPathAndName(_0x107022){const _0x3e118a=_0x5190e8;_0x107022[_0x3e118a(0x139)]=path['basename'](_0x107022[_0x3e118a(0x1a4)]),_0x107022[_0x3e118a(0x1dc)]=_0x107022[_0x3e118a(0x1a4)];if(_0x107022['is_tvplay']==0x1){let _0x336e8a=path[_0x3e118a(0x19f)](_0x107022[_0x3e118a(0x1a4)]),_0x428b10=path[_0x3e118a(0x176)](_0x107022['path']),_0x47d33d=movieSeasonUtil[_0x3e118a(0x198)](_0x336e8a);_0x47d33d>-0x1&&(_0x107022[_0x3e118a(0x139)]=path[_0x3e118a(0x19f)](_0x428b10),_0x107022[_0x3e118a(0x1dc)]=_0x428b10);if(!_0x107022[_0x3e118a(0x186)])_0x107022['show_name']=_0x107022[_0x3e118a(0x139)];}}function addFolderCoverPath(_0x16f80e,_0x5edf58,_0x2f5a68,_0x2e3b4c=![]){const _0x499940=_0x5190e8;let _0x42327b;addTvFolderPathAndName(_0x2f5a68);let _0x4e392c=_0x2f5a68['id']+_0x499940(0x27d)+_0x2e3b4c;!_0x5edf58['movieTvCache']&&(_0x5edf58[_0x499940(0x1d1)]=new Map());try{if(_0x2f5a68['is_tvplay']==0x1&&!_0x2e3b4c)try{let _0x45d024=path['basename'](_0x2f5a68[_0x499940(0x1a4)]),_0x32b36f=path[_0x499940(0x176)](_0x2f5a68[_0x499940(0x1a4)]),_0x4cf5a6=movieSeasonUtil['getSeasonNumber'](_0x45d024);if(_0x4cf5a6>-0x1){_0x2f5a68['isTvSeries']=0x1,_0x2f5a68[_0x499940(0x21b)]=_0x4cf5a6;if(_0x5edf58[_0x499940(0x28f)][_0x499940(0x180)]){let _0x5a6775=_0x32b36f+'-seasonCount-'+_0x2e3b4c;_0x5edf58[_0x499940(0x1d1)][_0x499940(0x1f4)](_0x5a6775)?_0x2f5a68[_0x499940(0x222)]=_0x5edf58[_0x499940(0x1d1)]['get'](_0x5a6775):(_0x2f5a68[_0x499940(0x222)]=_0x5edf58[_0x499940(0x1b4)][_0x499940(0x269)][_0x499940(0x14a)]('SELECT\x20count(*)\x20as\x20count\x20FROM\x20file_index_movie\x20WHERE\x20path\x20like\x20?\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1')[_0x499940(0x19b)](''+_0x32b36f+path[_0x499940(0x232)]+'%')[_0x499940(0x24e)],_0x5edf58[_0x499940(0x1d1)][_0x499940(0x1dd)](_0x5a6775,_0x2f5a68['seasonCount']));}}setLogoAndFanart(_0x5edf58,_0x2f5a68,_0x2f5a68['tvFolderPath']);if(_0x5edf58[_0x499940(0x28f)]['useTvSeriesInfo']==0x1&&_0x4cf5a6>-0x1){let _0x569fe2=_0x2f5a68[_0x499940(0x1dc)]+_0x499940(0x284);if(_0x5edf58['movieTvCache']['has'](_0x569fe2))return _0x2f5a68[_0x499940(0x21d)]=_0x5edf58[_0x499940(0x1d1)][_0x499940(0x19b)](_0x569fe2),_0x2f5a68;let _0x28f561=getTvSeriesPoster(_0x2f5a68);if(_0x28f561)return _0x5edf58[_0x499940(0x1d1)]['set'](_0x569fe2,_0x28f561),_0x2f5a68['folder_cover_path']=_0x28f561,_0x2f5a68;}if(!_0x42327b&&_0x5edf58[_0x499940(0x1d1)][_0x499940(0x1f4)](_0x4e392c))return _0x2f5a68[_0x499940(0x21d)]=_0x5edf58['movieTvCache']['get'](_0x4e392c),_0x2f5a68;if(!_0x42327b&&_0x4cf5a6>-0x1){parseInt(_0x4cf5a6)<0xa&&(_0x4cf5a6='0'+_0x4cf5a6);let _0x3275d3=_0x499940(0x27a)+_0x4cf5a6+'%poster%',_0x1e19d8='%s'+_0x4cf5a6+'%poster%',_0x4a65a8='SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=\x27'+_0x32b36f+_0x499940(0x286)+_0x3275d3+_0x499940(0x277)+_0x1e19d8+'\x27)';_0x42327b=_0x5edf58[_0x499940(0x1b4)][_0x499940(0x269)]['prepare'](_0x4a65a8)[_0x499940(0x19b)]();}!_0x42327b&&(_0x42327b=_0x5edf58[_0x499940(0x1b4)][_0x499940(0x269)][_0x499940(0x14a)](_0x499940(0x1ec))[_0x499940(0x19b)](_0x2f5a68[_0x499940(0x1a4)]));}catch(_0x2cba09){console[_0x499940(0x1aa)](_0x2cba09);}else{if(_0x5edf58[_0x499940(0x1d1)][_0x499940(0x1f4)](_0x4e392c))return _0x2f5a68[_0x499940(0x21d)]=_0x5edf58['movieTvCache'][_0x499940(0x19b)](_0x4e392c),_0x2f5a68;let _0x57aee0=path['parse'](_0x2f5a68[_0x499940(0x26e)]),_0x301934=_0x57aee0[_0x499940(0x153)],_0x49b59c=path[_0x499940(0x25a)](_0x2f5a68['path'],_0x301934+'.jpg');if(fs[_0x499940(0x213)](_0x49b59c))return _0x2f5a68['folder_cover_path']=_0x49b59c,_0x2f5a68;!_0x42327b&&(_0x42327b=_0x5edf58[_0x499940(0x1b4)][_0x499940(0x269)][_0x499940(0x14a)](_0x499940(0x228))['get'](_0x2f5a68[_0x499940(0x1a4)],'%'+_0x301934+_0x499940(0x14e)));if(!_0x42327b){let _0x14e75c=_0x301934;(_0x301934[_0x499940(0x261)](_0x499940(0x18c))||_0x301934['endsWith'](_0x499940(0x13b))||_0x301934[_0x499940(0x261)](_0x499940(0x293))||_0x301934['endsWith'](_0x499940(0x131)))&&(_0x301934['endsWith'](_0x499940(0x18c))?_0x14e75c=_0x14e75c[_0x499940(0x209)](0x0,_0x14e75c[_0x499940(0x1f8)]-0x3):_0x14e75c=_0x14e75c[_0x499940(0x209)](0x0,_0x14e75c[_0x499940(0x1f8)]-0x4)),_0x42327b=_0x5edf58[_0x499940(0x1b4)][_0x499940(0x269)][_0x499940(0x14a)](_0x499940(0x283))[_0x499940(0x19b)](_0x2f5a68[_0x499940(0x1a4)],_0x301934+'%',_0x14e75c+'%',_0x499940(0x1f1));}!_0x42327b&&(_0x42327b=_0x5edf58[_0x499940(0x1b4)][_0x499940(0x269)][_0x499940(0x14a)](_0x499940(0x1ec))[_0x499940(0x19b)](_0x2f5a68[_0x499940(0x1a4)]));let {name:_0x27ac95}=path[_0x499940(0x248)](_0x2f5a68['filename']);setLogoAndFanart(_0x5edf58,_0x2f5a68,_0x2f5a68['path'],_0x27ac95);}if(_0x42327b){let _0x499f1e=path[_0x499940(0x25a)](_0x42327b[_0x499940(0x1a4)],_0x42327b['filename']);!_0x499f1e['endsWith'](_0x499940(0x133))&&!_0x499f1e['endsWith'](_0x499940(0x229))&&fs[_0x499940(0x213)](_0x499f1e)?(_0x2f5a68[_0x499940(0x21d)]=_0x499f1e,_0x5edf58[_0x499940(0x1d1)][_0x499940(0x1dd)](_0x4e392c,_0x2f5a68['folder_cover_path'])):_0x5edf58['movieTvCache'][_0x499940(0x1dd)](_0x4e392c,'');}return _0x2f5a68;}catch(_0x39e022){return console[_0x499940(0x1aa)](_0x39e022),_0x2f5a68;}}function getMoviesByParams(_0x50b3ba,_0x38bf30,_0x4691f5,_0x39ab88,_0x317984,_0x50d5f0,_0x32f56f,_0x158148,_0x42818f,_0x8f42a2,_0x1b9525,_0x49c1d7,_0x19e198,_0x455ef2,_0x4e296e,_0x52a77a,_0x5f1cc9,_0x2e13e9){const _0x2b29ec=_0x5190e8;let _0x5ccacb=movieFieldStr;_0x2e13e9&&(_0x5ccacb=_0x2e13e9);!_0x4e296e&&(_0x4e296e=_0x2b29ec(0x190));let _0x3d07ef='',_0x5b5783=[],_0x3243f1=dbUserTable[_0x2b29ec(0x170)](_0x38bf30,_0x2b29ec(0x245),_0x2b29ec(0x1e0),!![],_0x8f42a2);if(_0x38bf30[_0x2b29ec(0x224)]['is_admin']!=0x1&&!_0x3243f1[_0x2b29ec(0x183)])return[];_0x3d07ef+='\x20type=2';_0x42818f&&(_0x42818f=_0x42818f[_0x2b29ec(0x256)]('\x27','')[_0x2b29ec(0x256)]('’',''),_0x3d07ef+=_0x2b29ec(0x1c6),_0x5b5783[_0x2b29ec(0x184)]('%'+_0x42818f+'%'),_0x5b5783[_0x2b29ec(0x184)]('%'+_0x42818f+'%'),_0x5b5783[_0x2b29ec(0x184)]('%'+_0x42818f+'%'));let _0x74389d=dbSourceFolderTable[_0x2b29ec(0x25f)](_0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x200)],'path',_0x2b29ec(0x28d));_0x74389d&&(_0x3d07ef+=_0x2b29ec(0x18d)+_0x74389d);let _0x37b83a=dbSourceFolderTable[_0x2b29ec(0x25f)](_0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x200)],_0x2b29ec(0x26e),_0x2b29ec(0x1e3));_0x37b83a&&(_0x3d07ef+=_0x2b29ec(0x18d)+_0x37b83a);function _0x4e1d09(_0x4da7b1,_0x566bac){const _0x5f2224=_0x2b29ec;let _0x4a8d0f=_0x5f2224(0x21c);try{let _0x3d3f63=JSON['parse'](_0x566bac),_0x5d211a=![];for(let _0x44ecaf=0x0;_0x44ecaf<_0x3d3f63[_0x5f2224(0x1f8)];_0x44ecaf++){if(!_0x3d3f63[_0x44ecaf])continue;_0x5d211a=!![],_0x4a8d0f+='\x20'+_0x4da7b1+_0x5f2224(0x1ea),_0x5b5783[_0x5f2224(0x184)]('%'+_0x3d3f63[_0x44ecaf][_0x5f2224(0x22d)]()+'%'),_0x44ecaf!=_0x3d3f63[_0x5f2224(0x1f8)]-0x1&&(_0x4a8d0f+='\x20or\x20');}_0x4a8d0f+=')',_0x5d211a&&(_0x3d07ef+=_0x4a8d0f);}catch(_0x5441c7){console[_0x5f2224(0x1aa)](_0x5441c7);}}_0x1b9525&&_0x4e1d09(_0x2b29ec(0x1f3),_0x1b9525);_0x49c1d7&&_0x4e1d09(_0x2b29ec(0x259),_0x49c1d7);_0x19e198&&_0x4e1d09(_0x2b29ec(0x1c8),_0x19e198);_0x38bf30['body'][_0x2b29ec(0x250)]&&_0x38bf30['body'][_0x2b29ec(0x250)][_0x2b29ec(0x1f8)]>0x0&&_0x38bf30[_0x2b29ec(0x28f)][_0x2b29ec(0x250)][0x0]!=''&&_0x4e1d09(_0x2b29ec(0x1e4),_0x38bf30['body'][_0x2b29ec(0x250)]);_0x38bf30[_0x2b29ec(0x28f)][_0x2b29ec(0x18a)]&&_0x38bf30['body'][_0x2b29ec(0x18a)][_0x2b29ec(0x1f8)]>0x0&&_0x38bf30[_0x2b29ec(0x28f)][_0x2b29ec(0x18a)][0x0]!=''&&_0x4e1d09('movie_director',_0x38bf30[_0x2b29ec(0x28f)][_0x2b29ec(0x18a)]);if(_0x5f1cc9){let _0x4e6baf=_0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x269)][_0x2b29ec(0x14a)](_0x2b29ec(0x17d))[_0x2b29ec(0x19b)](_0x5f1cc9);if(_0x4e6baf)try{let _0x3b9d9a=JSON[_0x2b29ec(0x248)](_0x4e6baf[_0x2b29ec(0x151)]),_0x2b1178=dbUserTable['getPathWhere'](!![],_0x3b9d9a);_0x3d07ef+=_0x2b1178[_0x2b29ec(0x183)],_0x5b5783[_0x2b29ec(0x184)](..._0x2b1178[_0x2b29ec(0x1d0)]);}catch(_0x2d74ff){console[_0x2b29ec(0x1aa)](_0x2d74ff);}}else{!_0x455ef2&&(_0x455ef2=0x0);let _0x675cb1;if(_0x455ef2!=0x0){_0x675cb1=_0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x269)][_0x2b29ec(0x14a)](_0x2b29ec(0x17a))[_0x2b29ec(0x19b)](_0x455ef2);if(!_0x675cb1)return _0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x1af)](_0x50b3ba,_0x50b3ba['__']('movieCollectionNotExist'));if(_0x675cb1[_0x2b29ec(0x169)]==0x1){let _0x574eac=_0x38bf30[_0x2b29ec(0x28f)][_0x2b29ec(0x155)];if(!_0x574eac||_0x675cb1['pwd']!=sha256(_0x574eac))return _0x38bf30['app'][_0x2b29ec(0x1af)](_0x50b3ba,_0x50b3ba['__']('login.pwdErr'));}}if(_0x675cb1&&_0x675cb1['type']=='smart')try{_0x675cb1[_0x2b29ec(0x1d6)]=JSON[_0x2b29ec(0x248)](_0x675cb1['data']),_0x3d07ef+=_0x2b29ec(0x18d)+_0x675cb1['data'][_0x2b29ec(0x233)];}catch(_0x1ebeb9){console[_0x2b29ec(0x1aa)](_0x1ebeb9);}else _0x3d07ef+=_0x2b29ec(0x285)+_0x455ef2;}if(_0x4691f5){if(_0x4691f5==0x1)_0x3d07ef+=_0x2b29ec(0x25c);else _0x4691f5==0x2&&(_0x3d07ef+=_0x2b29ec(0x29b));}_0x52a77a&&(_0x52a77a=='#'?(_0x3d07ef+=_0x2b29ec(0x1e6),_0x5b5783[_0x2b29ec(0x184)](_0x52a77a),_0x5b5783[_0x2b29ec(0x184)](_0x52a77a),_0x5b5783[_0x2b29ec(0x184)](_0x52a77a)):(_0x3d07ef+=_0x2b29ec(0x252),_0x5b5783[_0x2b29ec(0x184)](_0x52a77a),_0x5b5783[_0x2b29ec(0x184)](_0x52a77a),_0x5b5783[_0x2b29ec(0x184)](_0x52a77a)));if(_0x158148&&_0x158148[_0x2b29ec(0x1f8)]>0x0){_0x3d07ef+=_0x2b29ec(0x255);for(let _0x357677=0x0;_0x357677<_0x158148['length'];_0x357677++){_0x3d07ef+=_0x158148[_0x357677],_0x357677!=_0x158148['length']-0x1&&(_0x3d07ef+=',');}_0x3d07ef+=')';}_0x3d07ef+=_0x2b29ec(0x1ac),_0x5b5783[_0x2b29ec(0x184)]('%'+path[_0x2b29ec(0x232)]+_0x2b29ec(0x147)),_0x3d07ef+=_0x3243f1[_0x2b29ec(0x183)],_0x5b5783[_0x2b29ec(0x184)](..._0x3243f1[_0x2b29ec(0x1d0)]);_0x39ab88&&_0x32f56f?_0x3d07ef+=_0x2b29ec(0x1b2)+_0x39ab88+'\x20'+_0x32f56f:_0x3d07ef+='\x20\x20AND\x20is_file=1\x20AND\x20show_in_list=1';!_0x317984&&(_0x317984=0x32);_0x3d07ef+=_0x2b29ec(0x192),_0x5b5783['push'](_0x317984),_0x5b5783[_0x2b29ec(0x184)](_0x50d5f0);let _0x489766=[];if(_0x4e296e=='FAVORITE')_0x489766=dbMovieFavorite[_0x2b29ec(0x16a)](_0x38bf30[_0x2b29ec(0x1b4)]['dbFileIndex'],_0x38bf30[_0x2b29ec(0x224)]['id'],_0x3d07ef,_0x5ccacb,_0x5b5783);else _0x4e296e==_0x2b29ec(0x190)&&(_0x489766=dbFileIndexTable['getAllByWhereAndField'](_0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x269)],_0x3d07ef,_0x5ccacb,dbFileIndexTable['INDEX_TABLE_NAME_MOVIE'],_0x5b5783));if(_0x489766[_0x2b29ec(0x1f8)]<0x1)return _0x489766;let _0x41df5c=[];for(let _0x5f1ae8 in _0x489766){_0x41df5c[_0x2b29ec(0x184)](_0x489766[_0x5f1ae8]['id']);}let _0x499290=dbMovieFavorite[_0x2b29ec(0x158)](_0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x269)],_0x38bf30[_0x2b29ec(0x224)]['id'],_0x41df5c);for(let _0x935907=0x0;_0x935907<_0x489766[_0x2b29ec(0x1f8)];_0x935907++){_0x489766[_0x935907]['favorite']=0x0;for(let _0x8c74f6 in _0x499290){if(_0x499290[_0x8c74f6]['movie_index_id']==_0x489766[_0x935907]['id']){_0x489766[_0x935907][_0x2b29ec(0x203)]=0x1;break;}}let _0x3e8044=_0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x269)][_0x2b29ec(0x14a)](_0x2b29ec(0x26f))[_0x2b29ec(0x19b)](_0x38bf30[_0x2b29ec(0x224)]['id']+'',_0x489766[_0x935907]['id']+'');_0x3e8044&&(_0x489766[_0x935907]['history']=_0x3e8044);_0x489766[_0x935907]=addFolderCoverPath(_0x50b3ba,_0x38bf30,_0x489766[_0x935907]);if(_0x489766[_0x935907][_0x2b29ec(0x182)]==0x1&&_0x38bf30['body'][_0x2b29ec(0x242)]){let _0x4a2de7=dbFileIndexTable[_0x2b29ec(0x19d)](_0x38bf30[_0x2b29ec(0x1b4)][_0x2b29ec(0x269)],_0x489766[_0x935907]);_0x489766[_0x935907][_0x2b29ec(0x18e)]=_0x4a2de7['count'];}}return _0x489766;}function getShowMatchName(_0x2dffa2){const _0x4518d6=_0x5190e8;let _0x221a62=dbConfigTable[_0x4518d6(0x206)](_0x2dffa2,_0x4518d6(0x156));return!_0x221a62||_0x221a62&&_0x221a62[_0x4518d6(0x1fa)]!=0x0?0x1:0x0;}router['post'](_0x5190e8(0x25d),(_0x5d79d5,_0x154157,_0x370bb3)=>{const _0x28f27c=_0x5190e8;if(dbUserTable[_0x28f27c(0x251)](_0x5d79d5,_0x154157,_0x28f27c(0x245),_0x28f27c(0x1e0))==!![]){let _0x38fc0b=_0x5d79d5[_0x28f27c(0x28f)]['count'],_0x569535=_0x5d79d5['body']['offset'],_0xb1c05c=_0x5d79d5['body'][_0x28f27c(0x137)],_0x588f2c=_0x5d79d5[_0x28f27c(0x28f)][_0x28f27c(0x1f6)],_0x267133=_0x5d79d5[_0x28f27c(0x28f)]['excludeIds'],_0xf18bb2=_0x5d79d5['body'][_0x28f27c(0x13d)],_0x5e263a=_0x5d79d5[_0x28f27c(0x28f)][_0x28f27c(0x19e)],_0x3ba9cf=_0x5d79d5['body'][_0x28f27c(0x20c)],_0x251962=_0x5d79d5['body']['movieLanguage'],_0x1796d0=_0x5d79d5[_0x28f27c(0x28f)][_0x28f27c(0x24a)],_0x1c5e4a=_0x5d79d5[_0x28f27c(0x28f)][_0x28f27c(0x1ed)],_0x343029=_0x5d79d5[_0x28f27c(0x28f)][_0x28f27c(0x1cc)],_0x358241=_0x5d79d5['body'][_0x28f27c(0x299)],_0x16f244=_0x5d79d5[_0x28f27c(0x28f)][_0x28f27c(0x164)],_0x4adf11=_0x5d79d5[_0x28f27c(0x28f)][_0x28f27c(0x144)];_0x5d79d5[_0x28f27c(0x28f)][_0x28f27c(0x242)]=!![],_0x5d79d5[_0x28f27c(0x28f)]['needSeasonCount']=!![];let _0x5f4c41=getMoviesByParams(_0x154157,_0x5d79d5,_0x1c5e4a,_0xb1c05c,_0x38fc0b,_0x569535,_0x588f2c,_0x267133,_0xf18bb2,_0x5e263a,_0x3ba9cf,_0x251962,_0x1796d0,_0x343029,_0x358241,_0x16f244,_0x4adf11);return _0x154157[_0x28f27c(0x202)]({'movieShowMatchName':getShowMatchName(_0x5d79d5[_0x28f27c(0x1b4)][_0x28f27c(0x200)]),'code':0x0,'data':_0x5f4c41});}}),router['post'](_0x5190e8(0x247),(_0x4b240,_0x4fbad1,_0x3c0d5d)=>{const _0x5bf76e=_0x5190e8;if(dbUserTable[_0x5bf76e(0x251)](_0x4b240,_0x4fbad1,'movie',_0x5bf76e(0x1e0))==!![]){let _0xd0d00d=_0x4b240[_0x5bf76e(0x28f)][_0x5bf76e(0x19e)],_0x455543=_0x4b240['body'][_0x5bf76e(0x1cd)],_0x3f2c2f=_0x4b240['body'][_0x5bf76e(0x1ed)];!_0x455543&&(_0x455543=0x9);let _0x5c35f0=_0x5bf76e(0x149),_0x2caef3='';_0xd0d00d?_0x2caef3=dbUserTable['getUserPathWhere'](_0x4b240,_0x5bf76e(0x245),_0x5bf76e(0x1e0),!![],_0xd0d00d):_0x2caef3=dbUserTable['getUserPathWhere'](_0x4b240,_0x5bf76e(0x245),_0x5bf76e(0x1e0),!![]);let _0x2fb451=_0x4b240['body'][_0x5bf76e(0x1d7)];_0x2fb451!=_0x5bf76e(0x1c8)&&_0x2fb451!=_0x5bf76e(0x1f3)&&(_0x2fb451=_0x5bf76e(0x1c8));!_0x2fb451&&(_0x2fb451='movie_genres');let _0x55c7aa=_0x4b240['app'][_0x5bf76e(0x269)]['prepare'](_0x5bf76e(0x254))[_0x5bf76e(0x260)](_0x2fb451),_0x3adaee=[];for(let _0x2748ff of _0x55c7aa){let _0xd2de71=_0x2748ff[_0x5bf76e(0x1be)],_0x2dbe66=_0x5bf76e(0x270),_0x27446b=[];_0x2dbe66+=_0x2caef3[_0x5bf76e(0x183)],_0x27446b[_0x5bf76e(0x184)](..._0x2caef3[_0x5bf76e(0x1d0)]),_0x2dbe66+='\x20AND\x20collection_id=0';if(_0x3f2c2f){if(_0x3f2c2f==0x1)_0x2dbe66+='\x20AND\x20is_tvplay==0';else _0x3f2c2f==0x2&&(_0x2dbe66+='\x20AND\x20is_tvplay==1');}_0x2dbe66+=_0x5bf76e(0x18d)+_0x2fb451+'\x20LIKE\x20?',_0x27446b['push']('%'+_0xd2de71+'%'),_0x2dbe66+=_0x5bf76e(0x17e),_0x27446b[_0x5bf76e(0x184)](parseInt(_0x455543));let _0x4e6214=dbFileIndexTable['getAllByWhereAndField'](_0x4b240[_0x5bf76e(0x1b4)][_0x5bf76e(0x269)],_0x2dbe66,_0x5c35f0,dbFileIndexTable[_0x5bf76e(0x1c0)],_0x27446b),_0x448a3b=[];for(let _0xa021d5 in _0x4e6214){_0x448a3b[_0x5bf76e(0x184)](_0x4e6214[_0xa021d5]['id']);}let _0x3cf174=dbMovieFavorite[_0x5bf76e(0x158)](_0x4b240[_0x5bf76e(0x1b4)][_0x5bf76e(0x269)],_0x4b240[_0x5bf76e(0x224)]['id'],_0x448a3b);for(let _0x244063=0x0;_0x244063<_0x4e6214['length'];_0x244063++){_0x4e6214[_0x244063][_0x5bf76e(0x203)]=0x0;for(let _0x53138f in _0x3cf174){if(_0x3cf174[_0x53138f][_0x5bf76e(0x1b3)]==_0x4e6214[_0x244063]['id']){_0x4e6214[_0x244063][_0x5bf76e(0x203)]=0x1;break;}}_0x4e6214[_0x244063]=addFolderCoverPath(_0x4fbad1,_0x4b240,_0x4e6214[_0x244063]);}_0x4e6214[_0x5bf76e(0x1f8)]>0x0&&_0x3adaee[_0x5bf76e(0x184)]({'genresType':_0x2fb451,'genresValue':_0xd2de71,'movieList':_0x4e6214,'indexCount':_0x2748ff['index_count']});}_0x4fbad1[_0x5bf76e(0x202)]({'code':0x0,'data':_0x3adaee,'movieShowMatchName':getShowMatchName(_0x4b240['app'][_0x5bf76e(0x200)])});}}),router[_0x5190e8(0x241)](_0x5190e8(0x181),(_0x57ebc1,_0x18c333,_0x412ebf)=>{const _0x2ee58c=_0x5190e8;if(dbUserTable[_0x2ee58c(0x251)](_0x57ebc1,_0x18c333,_0x2ee58c(0x245),_0x2ee58c(0x1e0))==!![]){let _0x462ac9=getMoviesByParams(_0x18c333,_0x57ebc1,0x1,'create_time',0xf,0x0,_0x2ee58c(0x1d9));_0x57ebc1[_0x2ee58c(0x28f)][_0x2ee58c(0x242)]=!![],_0x57ebc1[_0x2ee58c(0x28f)][_0x2ee58c(0x180)]=!![],_0x57ebc1[_0x2ee58c(0x28f)]['useTvSeriesInfo']=0x1;let _0x12116c=getMoviesByParams(_0x18c333,_0x57ebc1,0x2,'create_time',0x32,0x0,_0x2ee58c(0x1d9));_0x57ebc1['body'][_0x2ee58c(0x242)]=![],_0x57ebc1['body']['needSeasonCount']=![],_0x57ebc1['body'][_0x2ee58c(0x20d)]=0x0;let _0x6fe38c=dbConfigTable['findByTitle'](_0x57ebc1[_0x2ee58c(0x1b4)]['dbOther'],_0x2ee58c(0x295));_0x6fe38c=!_0x6fe38c||_0x6fe38c&&_0x6fe38c[_0x2ee58c(0x1fa)]==0x1;let _0x4cb791=dbConfigTable[_0x2ee58c(0x206)](_0x57ebc1[_0x2ee58c(0x1b4)][_0x2ee58c(0x200)],_0x2ee58c(0x1fc));_0x4cb791=!_0x4cb791||_0x4cb791&&_0x4cb791[_0x2ee58c(0x1fa)]==0x1;let _0x587a2a=dbConfigTable[_0x2ee58c(0x206)](_0x57ebc1['app']['dbOther'],_0x2ee58c(0x210));_0x587a2a=!_0x587a2a||_0x587a2a&&_0x587a2a[_0x2ee58c(0x1fa)]==0x1;let _0x35f7c7=[];if(_0x587a2a){let _0x12f6aa=_0x2ee58c(0x275),_0x1f093a=_0x2ee58c(0x132)+_0x12f6aa+_0x2ee58c(0x274)+_0x57ebc1[_0x2ee58c(0x224)]['id']+_0x2ee58c(0x298);_0x35f7c7=_0x57ebc1[_0x2ee58c(0x1b4)][_0x2ee58c(0x269)][_0x2ee58c(0x14a)](_0x1f093a)[_0x2ee58c(0x260)]();let _0x2dc662=[];for(let _0xc49040 in _0x35f7c7){_0x2dc662[_0x2ee58c(0x184)](_0x35f7c7[_0xc49040]['id']);}let _0xeab051=dbMovieFavorite['getFavoriteList'](_0x57ebc1[_0x2ee58c(0x1b4)][_0x2ee58c(0x269)],_0x57ebc1[_0x2ee58c(0x224)]['id'],_0x2dc662);for(let _0x35c167=0x0;_0x35c167<_0x35f7c7[_0x2ee58c(0x1f8)];_0x35c167++){_0x35f7c7[_0x35c167][_0x2ee58c(0x203)]=0x0;for(let _0x19e3e5 in _0xeab051){if(_0xeab051[_0x19e3e5][_0x2ee58c(0x1b3)]==_0x35f7c7[_0x35c167]['id']){_0x35f7c7[_0x35c167][_0x2ee58c(0x203)]=0x1;break;}}}}let _0x137d9f=[];_0x4cb791&&(_0x137d9f=getMovieLibrary(_0x57ebc1,_0x18c333,0x6));let _0x1adb1a={'code':0x0,'movies':_0x462ac9,'tv':_0x12116c,'history':_0x35f7c7,'libraryList':_0x137d9f,'sourceList':[]};_0x1adb1a[_0x2ee58c(0x156)]=getShowMatchName(_0x57ebc1['app'][_0x2ee58c(0x200)]);if(_0x6fe38c){let _0x1ad78f=_0x57ebc1['app'][_0x2ee58c(0x200)][_0x2ee58c(0x14a)](_0x2ee58c(0x25b))[_0x2ee58c(0x260)](_0x2ee58c(0x245));for(let _0x2ed4b1 of _0x1ad78f){let _0x1f36e3=getMoviesByParams(_0x18c333,_0x57ebc1,null,'check_time',0x4,0x0,_0x2ee58c(0x1d9),null,null,JSON['stringify']([path[_0x2ee58c(0x25a)](_0x2ed4b1['path'])]));if(_0x1f36e3[_0x2ee58c(0x1f8)]<0x1)continue;_0x1adb1a[_0x2ee58c(0x23b)][_0x2ee58c(0x184)]({'mediaType':_0x2ed4b1[_0x2ee58c(0x294)],'path':_0x2ed4b1[_0x2ee58c(0x1a4)],'name':path[_0x2ee58c(0x19f)](_0x2ed4b1[_0x2ee58c(0x1a4)]),'sourceMovies':_0x1f36e3});}}return _0x18c333[_0x2ee58c(0x202)](_0x1adb1a);}}),router[_0x5190e8(0x241)](_0x5190e8(0x1a5),(_0x4a3bc8,_0x18327c,_0x44bacf)=>{const _0x550979=_0x5190e8;if(dbUserTable[_0x550979(0x251)](_0x4a3bc8,_0x18327c,_0x550979(0x245),'power_get')==!![]){let _0x515ef8=getMoviesByParams(_0x18327c,_0x4a3bc8,0x1,_0x550979(0x22e),0xa,0x0,'desc'),_0x4dd186=getMoviesByParams(_0x18327c,_0x4a3bc8,0x2,'check_time',0xa,0x0,_0x550979(0x1d9)),_0x439ec1='m.time,\x20f.id,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id,f.movie_douban_score,f.movie_info_name,f.show_name',_0x406847='SELECT\x20'+_0x439ec1+_0x550979(0x274)+_0x4a3bc8[_0x550979(0x224)]['id']+_0x550979(0x298),_0x5b8c43=_0x4a3bc8[_0x550979(0x1b4)]['dbFileIndex'][_0x550979(0x14a)](_0x406847)[_0x550979(0x260)](),_0x3593ec=getCollectionList(_0x4a3bc8,_0x18327c,_0x550979(0x1b9)),_0x457712=getCollectionList(_0x4a3bc8,_0x18327c,_0x550979(0x1de)),_0x3aa9fa=getMoviesByParams(_0x18327c,_0x4a3bc8,null,_0x550979(0x22e),0xa,0x0,_0x550979(0x1d9),null,null,null,null,null,null,null,_0x550979(0x160)),_0x1ae3fb=getMovieLibrary(_0x4a3bc8,_0x18327c),_0x4114e5={'code':0x0,'movies':_0x515ef8,'tv':_0x4dd186,'history':_0x5b8c43,'favorites':_0x3aa9fa,'collectionList':_0x3593ec,'aiCollectionList':_0x457712,'libraryList':_0x1ae3fb};return _0x18327c['json'](_0x4114e5);}}),router['post'](_0x5190e8(0x1b5),(_0x35cdc2,_0x494b70,_0x3cae3e)=>{const _0x2bdc11=_0x5190e8;if(dbUserTable[_0x2bdc11(0x251)](_0x35cdc2,_0x494b70,_0x2bdc11(0x245),_0x2bdc11(0x1e0))==!![]){let _0x48187d=getMoviesByParams(_0x494b70,_0x35cdc2,0x1,_0x2bdc11(0x22e),0x1,0x0,_0x2bdc11(0x1d9)),_0xdf724=getMoviesByParams(_0x494b70,_0x35cdc2,0x2,'check_time',0x1,0x0,'desc'),_0x1da0ab=_0x2bdc11(0x171),_0x455a89=_0x2bdc11(0x132)+_0x1da0ab+'\x20from\x20movie_history\x20as\x20m\x20inner\x20join\x20file_index_movie\x20as\x20f\x20on\x20m.index_id=f.id\x20where\x20m.user_id='+_0x35cdc2['currentUser']['id']+_0x2bdc11(0x1f0),_0x1d503d=_0x35cdc2['app']['dbFileIndex'][_0x2bdc11(0x14a)](_0x455a89)[_0x2bdc11(0x260)](),_0x56f58c=getMoviesByParams(_0x494b70,_0x35cdc2,null,_0x2bdc11(0x22e),0x1,0x0,_0x2bdc11(0x1d9),null,null,null,null,null,null,null,_0x2bdc11(0x160)),_0x24743e=dbFileIndexTable[_0x2bdc11(0x194)](_0x35cdc2[_0x2bdc11(0x1b4)][_0x2bdc11(0x269)],_0x2bdc11(0x1cf),dbFileIndexTable[_0x2bdc11(0x1c0)]),_0x4cce78=dbFileIndexTable[_0x2bdc11(0x194)](_0x35cdc2['app'][_0x2bdc11(0x269)],'is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20is_tvplay==1',dbFileIndexTable[_0x2bdc11(0x1c0)]);_0x35cdc2[_0x2bdc11(0x28f)][_0x2bdc11(0x239)]=0x5af3107a3fff,_0x35cdc2[_0x2bdc11(0x28f)][_0x2bdc11(0x136)]=0x1,_0x35cdc2[_0x2bdc11(0x28f)][_0x2bdc11(0x137)]=_0x2bdc11(0x22e),_0x35cdc2[_0x2bdc11(0x28f)][_0x2bdc11(0x1f6)]=_0x2bdc11(0x1d9),_0x35cdc2[_0x2bdc11(0x28f)][_0x2bdc11(0x1a9)]=0x0,_0x35cdc2[_0x2bdc11(0x28f)][_0x2bdc11(0x24e)]=0x1;let _0x4352d4=photoApiUtils[_0x2bdc11(0x234)](_0x35cdc2,_0x494b70),_0x16aa44=getMovieLibrary(_0x35cdc2,_0x494b70),_0x105ffc={'movieCount':_0x24743e['count'],'tvCount':_0x4cce78[_0x2bdc11(0x24e)],'code':0x0,'movies':_0x48187d,'tv':_0xdf724,'history':_0x1d503d,'favorites':_0x56f58c,'photos':_0x4352d4,'libraryList':_0x16aa44};return _0x494b70[_0x2bdc11(0x202)](_0x105ffc);}});let subtitleExtList=[_0x5190e8(0x188),_0x5190e8(0x141),_0x5190e8(0x1b0)];router['post']('/getSameNameSubtitles',(_0x28c043,_0x3c21a7,_0x1e5d6c)=>{const _0x485f5b=_0x5190e8;let _0x1dfb22=[],_0x9cdefd=null;if(_0x28c043[_0x485f5b(0x28f)][_0x485f5b(0x1f2)])_0x9cdefd=_0x28c043[_0x485f5b(0x28f)]['videoPath'],_0x9cdefd=fileUtil[_0x485f5b(0x230)](_0x9cdefd);else{if(_0x28c043[_0x485f5b(0x28f)]['id']){let _0x42c44c=_0x28c043[_0x485f5b(0x28f)]['id'],_0x2e4810=dbFileIndexTable[_0x485f5b(0x15e)](_0x28c043['app'][_0x485f5b(0x269)],_0x42c44c,dbFileIndexTable[_0x485f5b(0x1c0)]);_0x2e4810&&(_0x9cdefd=path[_0x485f5b(0x25a)](_0x2e4810[_0x485f5b(0x1a4)],_0x2e4810[_0x485f5b(0x26e)]),_0x28c043[_0x485f5b(0x1b4)][_0x485f5b(0x269)][_0x485f5b(0x14a)](_0x485f5b(0x199))[_0x485f5b(0x173)](Date[_0x485f5b(0x26d)](),_0x2e4810['id']));}}function _0xa32721(){const _0x19c54a=_0x485f5b;let _0xad6925=dbConfigTable['findByTitle'](_0x28c043[_0x19c54a(0x1b4)]['dbOther'],_0x19c54a(0x204)),_0x3b9fe9=dbConfigTable[_0x19c54a(0x206)](_0x28c043['app'][_0x19c54a(0x200)],_0x19c54a(0x268));return _0x3c21a7[_0x19c54a(0x202)]({'code':0x0,'data':_0x1dfb22,'defaultTranscodeResolution':_0x3b9fe9?_0x3b9fe9['value']:'1080p\x203mbps','userFontSize':_0xad6925?_0xad6925[_0x19c54a(0x1fa)]:1.5});}_0x9cdefd?fs[_0x485f5b(0x146)](_0x9cdefd,(_0x3bbea7,_0x2f3148)=>{const _0x4788c1=_0x485f5b;if(_0x3bbea7)return _0xa32721();let _0x4681e2=path[_0x4788c1(0x176)](_0x9cdefd);fs[_0x4788c1(0x150)](_0x4681e2,(_0x30371e,_0x1ee81e)=>{const _0xfb7dce=_0x4788c1;if(_0x30371e)return _0xa32721();let _0x33bdca=path['basename'](_0x9cdefd)[_0xfb7dce(0x256)](path['extname'](_0x9cdefd),''),_0x3f5dad=_0x33bdca[_0xfb7dce(0x214)]('\x20','_');for(let _0x40bcf0 in _0x1ee81e){let _0x2eb76b=_0x1ee81e[_0x40bcf0],_0x530c40=path[_0xfb7dce(0x257)](_0x2eb76b);(_0x2eb76b[_0xfb7dce(0x178)](_0x33bdca)||_0x2eb76b['startsWith'](_0x3f5dad))&&subtitleExtList[_0xfb7dce(0x1da)](_0x530c40)&&_0x1dfb22[_0xfb7dce(0x184)]({'fileName':path[_0xfb7dce(0x19f)](_0x2eb76b),'filePath':path[_0xfb7dce(0x25a)](_0x4681e2,_0x2eb76b)});}return _0xa32721();});}):_0xa32721();}),router[_0x5190e8(0x241)](_0x5190e8(0x1fe),(_0x225102,_0x58b123,_0xd03c9c)=>{const _0x2d8d21=_0x5190e8;let _0x5a64b0=_0x225102[_0x2d8d21(0x1b4)][_0x2d8d21(0x269)]['prepare'](_0x2d8d21(0x266))['all'](),_0x39f6f4=_0x225102['app']['dbFileIndex'][_0x2d8d21(0x14a)](_0x2d8d21(0x249))[_0x2d8d21(0x260)](),_0x2a2167=_0x225102[_0x2d8d21(0x1b4)][_0x2d8d21(0x269)][_0x2d8d21(0x14a)](_0x2d8d21(0x262))[_0x2d8d21(0x260)]();_0x58b123['json']({'code':0x0,'data':_0x5a64b0[_0x2d8d21(0x172)](_0x39f6f4,_0x2a2167)});}),router[_0x5190e8(0x241)]('/deleteIndex',(_0xa16be6,_0x4a5b2b,_0xee75aa)=>{const _0x5bb384=_0x5190e8;let _0xf482a3=_0xa16be6[_0x5bb384(0x28f)][_0x5bb384(0x20f)],_0x2e0f7f=dbFileIndexTable[_0x5bb384(0x15e)](_0xa16be6[_0x5bb384(0x1b4)][_0x5bb384(0x269)],_0xf482a3,dbFileIndexTable[_0x5bb384(0x1c0)]);if(!_0x2e0f7f)return _0x4a5b2b[_0x5bb384(0x202)]({'code':0x0});if(dbUserTable['doUserCanGet'](_0xa16be6,_0x4a5b2b,'movie',_0x5bb384(0x271),_0x2e0f7f[_0x5bb384(0x1a4)])==!![])return dbFileIndexTable[_0x5bb384(0x1c1)](_0xa16be6['app'][_0x5bb384(0x269)],_0xf482a3,dbFileIndexTable[_0x5bb384(0x1c0)]),_0x4a5b2b[_0x5bb384(0x202)]({'code':0x0});}),router[_0x5190e8(0x241)](_0x5190e8(0x145),(_0x342084,_0x2881e4,_0x184797)=>{const _0x34afb5=_0x5190e8;let _0x351652=_0x342084['currentUser']['id'],_0x17fb35=parseInt(_0x342084['body']['movieIndexId']),_0x245c42=dbMovieFavorite['getFavorite'](_0x342084[_0x34afb5(0x1b4)]['dbFileIndex'],_0x351652,_0x17fb35),_0x3681d=0x0;if(_0x245c42)dbMovieFavorite[_0x34afb5(0x24f)](_0x342084[_0x34afb5(0x1b4)]['dbFileIndex'],_0x351652,_0x17fb35);else{_0x3681d=0x1;let _0x5f3959=new Date()[_0x34afb5(0x237)]();_0x342084[_0x34afb5(0x1b4)][_0x34afb5(0x269)][_0x34afb5(0x14a)]('UPDATE\x20file_index_movie\x20set\x20check_time=?\x20WHERE\x20id=?')['run'](_0x5f3959,_0x17fb35),dbMovieFavorite['addFavorite'](_0x342084['app'][_0x34afb5(0x269)],_0x351652,_0x17fb35);}return _0x2881e4['json']({'code':0x0,'favorite':_0x3681d});}),router[_0x5190e8(0x241)]('/setTitleAndEnding',(_0x59d58b,_0x1d4c39,_0x35d945)=>{const _0x3bf87f=_0x5190e8;try{let _0xd1080=parseInt(_0x59d58b[_0x3bf87f(0x28f)][_0x3bf87f(0x20f)]),_0x58cad8=dbFileIndexTable['getById'](_0x59d58b[_0x3bf87f(0x1b4)][_0x3bf87f(0x269)],_0xd1080,dbFileIndexTable[_0x3bf87f(0x1c0)]);if(!_0x58cad8)return _0x1d4c39[_0x3bf87f(0x202)]({'code':0x0});let _0x4d5e12=parseInt(_0x59d58b[_0x3bf87f(0x28f)][_0x3bf87f(0x263)]),_0x293b00=parseInt(_0x59d58b[_0x3bf87f(0x28f)][_0x3bf87f(0x20b)]);!_0x293b00&&(_0x293b00=0x0);!_0x4d5e12&&(_0x4d5e12=0x0);let _0x457e5a=parseInt(_0x59d58b[_0x3bf87f(0x28f)][_0x3bf87f(0x1df)]);if(_0x4d5e12<0x0||_0x293b00<0x0||_0x4d5e12>_0x58cad8[_0x3bf87f(0x1bd)]||_0x293b00>_0x58cad8[_0x3bf87f(0x1bd)]||_0x457e5a!=0x0&&_0x457e5a!=0x1)return _0x59d58b[_0x3bf87f(0x1b4)][_0x3bf87f(0x1af)](_0x1d4c39,_0x3bf87f(0x276));let _0x12543b=[_0x58cad8];_0x58cad8['is_tvplay']==0x1&&(_0x12543b=_0x59d58b[_0x3bf87f(0x1b4)][_0x3bf87f(0x269)][_0x3bf87f(0x14a)](_0x3bf87f(0x1b1)+dbFileIndexTable[_0x3bf87f(0x1c0)]+_0x3bf87f(0x1d5))[_0x3bf87f(0x260)](_0x58cad8[_0x3bf87f(0x1a4)]));let _0x516bce='(';for(let _0x1e825a in _0x12543b){_0x516bce+=_0x12543b[_0x1e825a]['id'],_0x1e825a!=_0x12543b[_0x3bf87f(0x1f8)]-0x1&&(_0x516bce+=',');}return _0x516bce+=')',_0x59d58b['app'][_0x3bf87f(0x269)]['prepare']('UPDATE\x20file_index_movie\x20set\x20open_duration=?,end_duration=?,skip_open_end=?\x20WHERE\x20id\x20in\x20'+_0x516bce)[_0x3bf87f(0x173)](_0x4d5e12,_0x293b00,_0x457e5a),_0x1d4c39[_0x3bf87f(0x202)]({'code':0x0});}catch(_0x5b72a0){return console[_0x3bf87f(0x1aa)](_0x5b72a0),_0x59d58b['app']['returnErrMsg'](_0x1d4c39,_0x1d4c39['__'](_0x3bf87f(0x296)));}});function getMovieLibrary(_0x1421f0,_0x127d2b,_0x4e791b){const _0x20dc6d=_0x5190e8;let _0x88dd8a=_0x1421f0[_0x20dc6d(0x28f)][_0x20dc6d(0x244)]||0x0,_0x2be000=_0x4e791b||_0x1421f0[_0x20dc6d(0x28f)][_0x20dc6d(0x24e)]||0x32,_0x336f87=_0x1421f0[_0x20dc6d(0x28f)][_0x20dc6d(0x231)]||'',_0x295af5=_0x1421f0[_0x20dc6d(0x28f)][_0x20dc6d(0x218)]||_0x20dc6d(0x152),_0x217b6c=_0x1421f0[_0x20dc6d(0x28f)][_0x20dc6d(0x290)]||_0x20dc6d(0x1d9);if(![_0x20dc6d(0x152),_0x20dc6d(0x22f)][_0x20dc6d(0x1da)](_0x295af5))return console[_0x20dc6d(0x1aa)](_0x20dc6d(0x1f9),_0x295af5),[];let _0x1b4f0d=[],_0x2c8d26=[],_0x1a2f8a=_0x20dc6d(0x16b);_0x1421f0[_0x20dc6d(0x224)][_0x20dc6d(0x297)]==0x1?_0x336f87&&(_0x1a2f8a+=_0x20dc6d(0x1c5),_0x2c8d26[_0x20dc6d(0x184)]('%'+_0x336f87+'%')):(_0x1a2f8a=_0x20dc6d(0x243),_0x336f87&&(_0x1a2f8a+=_0x20dc6d(0x23c),_0x2c8d26[_0x20dc6d(0x184)]('%'+_0x336f87+'%')));_0x1a2f8a+='\x20ORDER\x20BY\x20'+_0x295af5+'\x20'+_0x217b6c+_0x20dc6d(0x192),_0x2c8d26[_0x20dc6d(0x184)](_0x2be000),_0x2c8d26['push'](_0x88dd8a),_0x1b4f0d=_0x1421f0['app'][_0x20dc6d(0x269)][_0x20dc6d(0x14a)](_0x1a2f8a)[_0x20dc6d(0x260)](_0x2c8d26);if(_0x1b4f0d['length']<0x1)return[];for(let _0x5591a6 in _0x1b4f0d){let _0x3f6eae=_0x1b4f0d[_0x5591a6];try{let _0x116850=JSON[_0x20dc6d(0x248)](_0x3f6eae['share_uid']),_0x50edc2=[];for(let _0x3ff532 of _0x116850){let _0x4d3c06=dbUserTable[_0x20dc6d(0x142)](_0x1421f0[_0x20dc6d(0x1b4)][_0x20dc6d(0x200)],_0x3ff532,'id,username');_0x50edc2['push'](_0x4d3c06);}_0x1b4f0d[_0x5591a6][_0x20dc6d(0x1a3)]=_0x50edc2;}catch(_0x2956de){console[_0x20dc6d(0x1aa)](_0x2956de);}let _0x446442=getMoviesByParams(_0x127d2b,_0x1421f0,null,_0x20dc6d(0x22e),0x4,0x0,_0x20dc6d(0x1d9),null,null,null,null,null,null,null,null,null,_0x1b4f0d[_0x5591a6]['id']);_0x1b4f0d[_0x5591a6]['dataPreview']=_0x446442;}return _0x1b4f0d;}router[_0x5190e8(0x241)](_0x5190e8(0x265),(_0x1d4e72,_0x57be1c,_0xad6689)=>{const _0x217905=_0x5190e8;let _0x310f82=_0x1d4e72[_0x217905(0x28f)][_0x217905(0x22f)],_0x46ba29=_0x1d4e72[_0x217905(0x28f)][_0x217905(0x144)],_0x1775b5=_0x1d4e72[_0x217905(0x28f)][_0x217905(0x14b)],_0x552bdc=_0x1d4e72[_0x217905(0x28f)][_0x217905(0x29a)],_0x385419=_0x1d4e72['body'][_0x217905(0x23e)],_0xab3fc8=_0x1d4e72[_0x217905(0x28f)]['operation'];if(_0xab3fc8=='GET'){let _0x5442f0=getMovieLibrary(_0x1d4e72,_0x57be1c);return _0x57be1c[_0x217905(0x202)]({'code':0x0,'data':_0x5442f0});}else{if(_0x1d4e72[_0x217905(0x224)][_0x217905(0x297)]!=0x1)return _0x1d4e72[_0x217905(0x1b4)][_0x217905(0x1af)](_0x57be1c,_0x57be1c['__'](_0x217905(0x24b)));if(_0xab3fc8==_0x217905(0x1d8)||_0xab3fc8==_0x217905(0x1c3)){if(!_0x1775b5||!_0x1775b5 instanceof Array||_0x1775b5[_0x217905(0x1f8)]<0x1)return _0x1d4e72[_0x217905(0x1b4)][_0x217905(0x1af)](_0x57be1c,_0x57be1c['__'](_0x217905(0x296)));if(_0x385419){if(_0x552bdc!=null&&!_0x552bdc instanceof Array)return _0x1d4e72[_0x217905(0x1b4)][_0x217905(0x1af)](_0x57be1c,_0x57be1c['__'](_0x217905(0x296)));}if(sqliteUtil[_0x217905(0x185)](JSON['stringify'](_0x1775b5))==!![])return _0x1d4e72[_0x217905(0x1b4)]['returnErrMsg'](_0x57be1c,_0x217905(0x134));}if(_0xab3fc8==_0x217905(0x1c3)&&_0x46ba29)_0x1d4e72[_0x217905(0x1b4)]['dbFileIndex'][_0x217905(0x14a)]('UPDATE\x20movie_library\x20SET\x20title=?,path_list=?,share_for_subuser=?,share_uid=?\x20WHERE\x20id=?')['run'](_0x310f82,JSON['stringify'](_0x1775b5),_0x385419,JSON[_0x217905(0x135)](_0x552bdc),_0x46ba29);else{if(_0xab3fc8=='DELETE'&&_0x46ba29)_0x1d4e72[_0x217905(0x1b4)][_0x217905(0x269)][_0x217905(0x14a)](_0x217905(0x20e))[_0x217905(0x173)](_0x46ba29);else{if(_0xab3fc8=='ADD')_0x1d4e72[_0x217905(0x1b4)][_0x217905(0x269)][_0x217905(0x14a)](_0x217905(0x18f))['run'](_0x310f82,JSON[_0x217905(0x135)](_0x1775b5),_0x385419,JSON[_0x217905(0x135)](_0x552bdc),_0x1d4e72[_0x217905(0x224)]['id']);else return _0x1d4e72['app'][_0x217905(0x1af)](_0x57be1c,_0x57be1c['__'](_0x217905(0x24b)));}}return _0x57be1c[_0x217905(0x202)]({'code':0x0});}}),module['exports']=router;