const _0x2da8f2=_0x3cb9;function _0x4db2(){const _0x2df972=['getEpubImageList','name','6624567HRfZkk','createExtractorFromData','forEach','1269228efCaya','catch','.cbz','3082184TSgPNy','sharp','4734051kcJxmb','6iOWfgW','adm-zip','不支持的压缩文件格式','log','.cbr','includes','.epub','entryName','readFile','node-unrar-js','isDirectory','./arrayUtil','.zip','getSharpDealedBuffer','4THyOeg','4lphhlY','extname','extract','./zipEpubUtil','length','getInnerFileContent','imgTypeList','3430055vycPXJ','jpeg','extraction','.rar','epub','14328030AajNls','toLowerCase','then','exports','getZipInnerFileList','259482LdRDta','sortFileNamesByNumber','push','path'];_0x4db2=function(){return _0x2df972;};return _0x4db2();}(function(_0x4b8e0e,_0x55dc79){const _0xd4c902=_0x3cb9,_0x342c84=_0x4b8e0e();while(!![]){try{const _0x2dfa13=-parseInt(_0xd4c902(0x148))/0x1*(-parseInt(_0xd4c902(0x137))/0x2)+-parseInt(_0xd4c902(0x151))/0x3*(parseInt(_0xd4c902(0x136))/0x4)+parseInt(_0xd4c902(0x13e))/0x5*(-parseInt(_0xd4c902(0x157))/0x6)+parseInt(_0xd4c902(0x156))/0x7+-parseInt(_0xd4c902(0x154))/0x8+-parseInt(_0xd4c902(0x14e))/0x9+parseInt(_0xd4c902(0x143))/0xa;if(_0x2dfa13===_0x55dc79)break;else _0x342c84['push'](_0x342c84['shift']());}catch(_0x5ab6d7){_0x342c84['push'](_0x342c84['shift']());}}}(_0x4db2,0x61145));const path=require(_0x2da8f2(0x14b));let zipUtil={};const sharp=require(_0x2da8f2(0x155)),AdmZip=require(_0x2da8f2(0x158)),unrar=require(_0x2da8f2(0x160)),fs=require('fs'),config=require('../myConfig/config'),EPub=require(_0x2da8f2(0x142)),zipEpubUtil=require(_0x2da8f2(0x13a)),arrayUtil=require(_0x2da8f2(0x133));function _0x3cb9(_0xd3745b,_0x483e58){const _0x4db202=_0x4db2();return _0x3cb9=function(_0x3cb97a,_0x2ff484){_0x3cb97a=_0x3cb97a-0x133;let _0x22df21=_0x4db202[_0x3cb97a];return _0x22df21;},_0x3cb9(_0xd3745b,_0x483e58);}zipUtil[_0x2da8f2(0x147)]=(_0x529d1c,_0x3da2b5)=>{return new Promise((_0x35743f,_0x9c4052)=>{const _0x5eeb39=_0x3cb9;let _0x3b8233=[];try{let _0x54025d=path[_0x5eeb39(0x138)](_0x529d1c);_0x54025d&&(_0x54025d=_0x54025d[_0x5eeb39(0x144)]());if(_0x54025d==_0x5eeb39(0x134)||_0x54025d==_0x5eeb39(0x153)){const _0x595202=new AdmZip(_0x529d1c);_0x595202['getEntries']()[_0x5eeb39(0x150)](_0x51cb09=>{const _0x51ab0f=_0x5eeb39;let _0x5ecaf1=!![],_0x2fb003=path['extname'](_0x51cb09[_0x51ab0f(0x15e)]);_0x3da2b5&&(_0x5ecaf1=![],_0x2fb003&&config['imgTypeList'][_0x51ab0f(0x15c)](_0x2fb003[_0x51ab0f(0x144)]())&&(_0x5ecaf1=!![])),_0x5ecaf1&&_0x3b8233['push']({'isDir':_0x51cb09[_0x51ab0f(0x161)],'name':_0x51cb09[_0x51ab0f(0x15e)]});}),_0x35743f(arrayUtil[_0x5eeb39(0x149)](_0x3b8233,_0x5eeb39(0x14d)));}else{if(_0x54025d==_0x5eeb39(0x141)||_0x54025d=='.cbr')fs[_0x5eeb39(0x15f)](_0x529d1c,(_0x332801,_0x4a7093)=>{const _0x1dd4d2=_0x5eeb39;unrar[_0x1dd4d2(0x14f)]({'data':_0x4a7093})[_0x1dd4d2(0x145)](_0x357000=>{const _0x3cbcab=_0x1dd4d2,_0x2e9161=_0x357000['getFileList'](),_0x4b06ac=[..._0x2e9161['fileHeaders']];for(let _0x45b6dd of _0x4b06ac){let _0x3a7f76=!![],_0xc75b81=path[_0x3cbcab(0x138)](_0x45b6dd[_0x3cbcab(0x14d)]);_0x3da2b5&&(_0x3a7f76=![],_0xc75b81&&config[_0x3cbcab(0x13d)][_0x3cbcab(0x15c)](_0xc75b81[_0x3cbcab(0x144)]())&&(_0x3a7f76=!![])),_0x3a7f76&&_0x3b8233[_0x3cbcab(0x14a)]({'isDir':![],'name':_0x45b6dd['name']});}_0x35743f(arrayUtil[_0x3cbcab(0x149)](_0x3b8233,_0x3cbcab(0x14d)));});});else _0x54025d==_0x5eeb39(0x15d)?zipEpubUtil[_0x5eeb39(0x14c)](_0x529d1c)[_0x5eeb39(0x145)](_0x2a53ab=>{const _0x56d86e=_0x5eeb39;for(let _0x2c85c0 of _0x2a53ab){_0x3b8233[_0x56d86e(0x14a)]({'isDir':![],'name':_0x2c85c0});}_0x35743f(_0x3b8233);}):(console[_0x5eeb39(0x15a)]('不支持的压缩文件格式',_0x529d1c),_0x35743f([]));}}catch(_0x276b1c){console[_0x5eeb39(0x15a)](_0x276b1c),_0x35743f([]);}});},zipUtil['getSharpDealedBuffer']=(_0x744d2d,_0x3cacb4)=>{return new Promise((_0x181065,_0x25d831)=>{const _0x1e7fc0=_0x3cb9;let _0x2941a9=path['extname'](_0x3cacb4);_0x2941a9&&config[_0x1e7fc0(0x13d)]['includes'](_0x2941a9[_0x1e7fc0(0x144)]())?sharp(_0x744d2d,{'failOnError':![]})[_0x1e7fc0(0x13f)]({'quality':0x4d})['toBuffer']()[_0x1e7fc0(0x145)](_0x13da98=>{_0x181065(_0x13da98);})[_0x1e7fc0(0x152)](_0x578b61=>{const _0x1cf594=_0x1e7fc0;console[_0x1cf594(0x15a)](_0x578b61),_0x181065(_0x744d2d);}):_0x181065(_0x744d2d);});},zipUtil[_0x2da8f2(0x13c)]=(_0x2f330e,_0x1ddb9a)=>{return new Promise((_0xa53e92,_0x4f040d)=>{const _0x5f421e=_0x3cb9;try{let _0x3daf25=path[_0x5f421e(0x138)](_0x2f330e);_0x3daf25&&(_0x3daf25=_0x3daf25[_0x5f421e(0x144)]());if(_0x3daf25==_0x5f421e(0x134)||_0x3daf25==_0x5f421e(0x153)||_0x3daf25==_0x5f421e(0x15d)){const _0x19a888=new AdmZip(_0x2f330e);let _0x2f12b3=_0x19a888[_0x5f421e(0x15f)](_0x1ddb9a);zipUtil[_0x5f421e(0x135)](_0x2f12b3,_0x1ddb9a)['then'](_0x1d84b1=>{_0xa53e92(_0x1d84b1);});}else _0x3daf25==_0x5f421e(0x141)||_0x3daf25==_0x5f421e(0x15b)?fs[_0x5f421e(0x15f)](_0x2f330e,(_0x3b7d70,_0x56d7fb)=>{const _0x50571b=_0x5f421e;if(_0x3b7d70)return console[_0x50571b(0x15a)](_0x3b7d70),_0xa53e92(null);unrar[_0x50571b(0x14f)]({'data':_0x56d7fb})[_0x50571b(0x145)](_0x18b326=>{const _0x419993=_0x50571b;try{const _0x6da1c0=_0x18b326[_0x419993(0x139)]({'files':[_0x1ddb9a]}),_0x415e18=[..._0x6da1c0['files']];if(_0x415e18&&_0x415e18[_0x419993(0x13b)]>0x0){let _0x36aade=Buffer['from'](_0x415e18[0x0][_0x419993(0x140)]);zipUtil['getSharpDealedBuffer'](_0x36aade,_0x1ddb9a)['then'](_0x3de455=>{_0xa53e92(_0x3de455);});}else _0xa53e92(null);}catch(_0x5191ae){_0xa53e92(null);}});}):(console[_0x5f421e(0x15a)](_0x5f421e(0x159),_0x2f330e),_0xa53e92(null));}catch(_0x58fbc6){console['log'](_0x58fbc6),_0xa53e92(null);}});},zipUtil['getZipCover']=_0x3dfa2d=>{return new Promise((_0x189f12,_0x36dd08)=>{try{zipUtil['getZipInnerFileList'](_0x3dfa2d,!![])['then'](_0xd7fc0a=>{const _0x379f06=_0x3cb9;if(_0xd7fc0a[_0x379f06(0x13b)]>0x0){let _0x2aa2bf=_0xd7fc0a[0x0];zipUtil['getInnerFileContent'](_0x3dfa2d,_0x2aa2bf['name'])[_0x379f06(0x145)](_0x49f15a=>{_0x189f12({'dealedBuffer':_0x49f15a,'fileCount':_0xd7fc0a['length']});});}else _0x189f12(null);});}catch(_0x2f87e6){_0x189f12(null);}});},module[_0x2da8f2(0x146)]=zipUtil;