const _0x24d2e3=_0x2869;(function(_0x3d381f,_0x44c632){const _0x3d2686=_0x2869,_0xfff966=_0x3d381f();while(!![]){try{const _0x20ace6=-parseInt(_0x3d2686(0x162))/0x1+-parseInt(_0x3d2686(0x17e))/0x2+-parseInt(_0x3d2686(0x185))/0x3+-parseInt(_0x3d2686(0x187))/0x4+-parseInt(_0x3d2686(0x166))/0x5+-parseInt(_0x3d2686(0x174))/0x6+-parseInt(_0x3d2686(0x165))/0x7*(-parseInt(_0x3d2686(0x17d))/0x8);if(_0x20ace6===_0x44c632)break;else _0xfff966['push'](_0xfff966['shift']());}catch(_0x3f7a91){_0xfff966['push'](_0xfff966['shift']());}}}(_0x5856,0x8ee26));function _0x5856(){const _0x5720f0=['743445cbZfem','./zipEpubUtil','from','.epub','readFile','.cbz','不支持的压缩文件格式','entryName','getInnerFileContent','toBuffer','getZipInnerFileList','imgTypeList','sharp','.rar','2939286MomiiE','toLowerCase','name','adm-zip','getEpubImageList','fileHeaders','extraction','getEntries','includes','8AapsWR','1528586KAHexN','.cbr','getSharpDealedBuffer','extname','getZipCover','length','files','3472083pftsZo','then','2087600JduuUm','push','exports','node-unrar-js','createExtractorFromData','log','1094413lUrYzY','getFileList','.zip','33332537HlAsgC'];_0x5856=function(){return _0x5720f0;};return _0x5856();}const path=require('path');let zipUtil={};function _0x2869(_0x24b6af,_0x51539c){const _0x5856a8=_0x5856();return _0x2869=function(_0x28693c,_0x5950e4){_0x28693c=_0x28693c-0x161;let _0x5b7d1d=_0x5856a8[_0x28693c];return _0x5b7d1d;},_0x2869(_0x24b6af,_0x51539c);}const sharp=require(_0x24d2e3(0x172)),AdmZip=require(_0x24d2e3(0x177)),unrar=require(_0x24d2e3(0x18a)),fs=require('fs'),config=require('../myConfig/config'),EPub=require('epub'),zipEpubUtil=require(_0x24d2e3(0x167)),arrayUtil=require('./arrayUtil');zipUtil[_0x24d2e3(0x170)]=(_0x16ddb8,_0x26c97f)=>{return new Promise((_0x5674cd,_0x5af6e8)=>{const _0x55859f=_0x2869;let _0x1a26d8=[];try{let _0x1e2cce=path['extname'](_0x16ddb8);_0x1e2cce&&(_0x1e2cce=_0x1e2cce[_0x55859f(0x175)]());if(_0x1e2cce=='.zip'||_0x1e2cce=='.cbz'){const _0xd78bdb=new AdmZip(_0x16ddb8);_0xd78bdb[_0x55859f(0x17b)]()['forEach'](_0x15b2a3=>{const _0x56f30b=_0x55859f;let _0x336b89=!![],_0x313f10=path[_0x56f30b(0x181)](_0x15b2a3[_0x56f30b(0x16d)]);_0x26c97f&&(_0x336b89=![],_0x313f10&&config['imgTypeList']['includes'](_0x313f10[_0x56f30b(0x175)]())&&(_0x336b89=!![])),_0x336b89&&_0x1a26d8[_0x56f30b(0x188)]({'isDir':_0x15b2a3['isDirectory'],'name':_0x15b2a3[_0x56f30b(0x16d)]});}),_0x5674cd(arrayUtil['sortFileNamesByNumber'](_0x1a26d8,_0x55859f(0x176)));}else{if(_0x1e2cce=='.rar'||_0x1e2cce==_0x55859f(0x17f))fs[_0x55859f(0x16a)](_0x16ddb8,(_0x1457bf,_0x286623)=>{const _0x5158ff=_0x55859f;unrar[_0x5158ff(0x18b)]({'data':_0x286623})['then'](_0x441631=>{const _0x52f6db=_0x5158ff,_0x2b1aba=_0x441631[_0x52f6db(0x163)](),_0x15fa9d=[..._0x2b1aba[_0x52f6db(0x179)]];for(let _0x57fb19 of _0x15fa9d){let _0x34519e=!![],_0x55c56f=path[_0x52f6db(0x181)](_0x57fb19[_0x52f6db(0x176)]);_0x26c97f&&(_0x34519e=![],_0x55c56f&&config[_0x52f6db(0x171)][_0x52f6db(0x17c)](_0x55c56f['toLowerCase']())&&(_0x34519e=!![])),_0x34519e&&_0x1a26d8[_0x52f6db(0x188)]({'isDir':![],'name':_0x57fb19[_0x52f6db(0x176)]});}_0x5674cd(arrayUtil['sortFileNamesByNumber'](_0x1a26d8,_0x52f6db(0x176)));});});else _0x1e2cce=='.epub'?zipEpubUtil[_0x55859f(0x178)](_0x16ddb8)[_0x55859f(0x186)](_0x96b8a1=>{for(let _0x5f2cfe of _0x96b8a1){_0x1a26d8['push']({'isDir':![],'name':_0x5f2cfe});}_0x5674cd(_0x1a26d8);}):(console['log'](_0x55859f(0x16c),_0x16ddb8),_0x5674cd([]));}}catch(_0x2dbccf){console[_0x55859f(0x161)](_0x2dbccf),_0x5674cd([]);}});},zipUtil[_0x24d2e3(0x180)]=(_0x20a56f,_0x420315)=>{return new Promise((_0x3df9e1,_0x4907a0)=>{const _0x109a96=_0x2869;let _0x526055=path[_0x109a96(0x181)](_0x420315);_0x526055&&config[_0x109a96(0x171)][_0x109a96(0x17c)](_0x526055[_0x109a96(0x175)]())?sharp(_0x20a56f,{'failOnError':![]})['jpeg']({'quality':0x4d})[_0x109a96(0x16f)]()[_0x109a96(0x186)](_0x12560e=>{_0x3df9e1(_0x12560e);})['catch'](_0x9b3f5f=>{const _0x4fae9c=_0x109a96;console[_0x4fae9c(0x161)](_0x9b3f5f),_0x3df9e1(_0x20a56f);}):_0x3df9e1(_0x20a56f);});},zipUtil[_0x24d2e3(0x16e)]=(_0xdb182c,_0x180820)=>{return new Promise((_0x14b64a,_0x579fb6)=>{const _0x155ba4=_0x2869;try{let _0x3d94f6=path['extname'](_0xdb182c);_0x3d94f6&&(_0x3d94f6=_0x3d94f6['toLowerCase']());if(_0x3d94f6==_0x155ba4(0x164)||_0x3d94f6==_0x155ba4(0x16b)||_0x3d94f6==_0x155ba4(0x169)){const _0x42f125=new AdmZip(_0xdb182c);let _0x3f89a0=_0x42f125['readFile'](_0x180820);zipUtil['getSharpDealedBuffer'](_0x3f89a0,_0x180820)[_0x155ba4(0x186)](_0xb249b3=>{_0x14b64a(_0xb249b3);});}else _0x3d94f6==_0x155ba4(0x173)||_0x3d94f6==_0x155ba4(0x17f)?fs[_0x155ba4(0x16a)](_0xdb182c,(_0x46055c,_0x5a8981)=>{const _0x33a8ce=_0x155ba4;if(_0x46055c)return console[_0x33a8ce(0x161)](_0x46055c),_0x14b64a(null);unrar['createExtractorFromData']({'data':_0x5a8981})[_0x33a8ce(0x186)](_0x1bbf73=>{const _0xa57575=_0x33a8ce;try{const _0x1509e9=_0x1bbf73['extract']({'files':[_0x180820]}),_0x3e626a=[..._0x1509e9[_0xa57575(0x184)]];if(_0x3e626a&&_0x3e626a['length']>0x0){let _0x2282c6=Buffer[_0xa57575(0x168)](_0x3e626a[0x0][_0xa57575(0x17a)]);zipUtil[_0xa57575(0x180)](_0x2282c6,_0x180820)[_0xa57575(0x186)](_0x40280b=>{_0x14b64a(_0x40280b);});}else _0x14b64a(null);}catch(_0x48de24){_0x14b64a(null);}});}):(console[_0x155ba4(0x161)](_0x155ba4(0x16c),_0xdb182c),_0x14b64a(null));}catch(_0x5aa6b5){console[_0x155ba4(0x161)](_0x5aa6b5),_0x14b64a(null);}});},zipUtil[_0x24d2e3(0x182)]=_0x48c443=>{return new Promise((_0x57932a,_0x3bff81)=>{const _0x59abf5=_0x2869;try{zipUtil[_0x59abf5(0x170)](_0x48c443,!![])[_0x59abf5(0x186)](_0x598619=>{const _0x1fc647=_0x59abf5;if(_0x598619['length']>0x0){let _0x1027ee=_0x598619[0x0];zipUtil[_0x1fc647(0x16e)](_0x48c443,_0x1027ee[_0x1fc647(0x176)])[_0x1fc647(0x186)](_0x5e325a=>{const _0x36264a=_0x1fc647;_0x57932a({'dealedBuffer':_0x5e325a,'fileCount':_0x598619[_0x36264a(0x183)]});});}else _0x57932a(null);});}catch(_0x525c85){_0x57932a(null);}});},module[_0x24d2e3(0x189)]=zipUtil;