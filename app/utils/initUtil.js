const _0x235d20=_0x179d;(function(_0x139925,_0x1857e5){const _0x389b8b=_0x179d,_0x24015d=_0x139925();while(!![]){try{const _0x3a3b14=-parseInt(_0x389b8b(0x223))/0x1+parseInt(_0x389b8b(0x1f6))/0x2+parseInt(_0x389b8b(0x1ef))/0x3+parseInt(_0x389b8b(0x224))/0x4+-parseInt(_0x389b8b(0x238))/0x5+-parseInt(_0x389b8b(0x24b))/0x6*(-parseInt(_0x389b8b(0x20f))/0x7)+parseInt(_0x389b8b(0x1e6))/0x8*(-parseInt(_0x389b8b(0x1f9))/0x9);if(_0x3a3b14===_0x1857e5)break;else _0x24015d['push'](_0x24015d['shift']());}catch(_0x54cfdb){_0x24015d['push'](_0x24015d['shift']());}}}(_0x58e3,0xa7065));let app,BrowserWindow,Menu,Tray,protocol,ipcMain;try{let elec=require(_0x235d20(0x231));app=elec[_0x235d20(0x230)],BrowserWindow=elec['BrowserWindow'],Menu=elec['Menu'],Tray=elec[_0x235d20(0x221)],protocol=elec[_0x235d20(0x20c)],ipcMain=elec['ipcMain'];}catch(_0x2ab50d){console['log'](_0x235d20(0x1ff));}const {fork}=require(_0x235d20(0x1fe));function _0x179d(_0x403638,_0x5c47cb){const _0x58e3ef=_0x58e3();return _0x179d=function(_0x179dd5,_0x3af77a){_0x179dd5=_0x179dd5-0x1da;let _0x5f53f3=_0x58e3ef[_0x179dd5];return _0x5f53f3;},_0x179d(_0x403638,_0x5c47cb);}let path=require(_0x235d20(0x1f2)),fs=require('fs'),os=require('os'),initUtil={},privateSpaceUtil=require(_0x235d20(0x1ed)),dbConfigTable=require(_0x235d20(0x1f0)),dbu='',mainWindow='';const config=require('../myConfig/config');let netUtils=require(_0x235d20(0x247)),appTray;function _0x58e3(){const _0x3e8060=['1354240MzueLK','\x20WHERE\x20last_login_time\x20<?','addScanTaskWhenStart','type','logo-tray.png','scan_when_start','setContextMenu','show','log','en-US','relaunch','../db/dbSourceFolderTable','minimize','database','../db/dbUtil','../express-server/utils/netUtils','dbOther','tempFilePath','dirname','85056PTNipm','apiPortHttps','facesPath','click','findByTitle','getAll','getFreePort','getTime','dbFileIndex','getPath','getLocale','apiPort','./globalInfoUtil','value','join','length','setLanguage','addProcessRecord','then','prepare','createUserFolder','kill','resolve','Show/Hide','1000vCWPHM','loadFile','../db/dbScanTaskTable','SIGTERM','hide','buildFromTemplate','Loading...','../express-server/utils/privateSpaceUtils','posterPath','3447081keGWhn','../db/dbConfigTable','../db/dbUserTable','path','threadCount','pid','DELETE\x20FROM\x20play_record','2489598ELCAVK','subtitlePath','REPLACE\x20INTO\x20process_record(process_id)\x20VALUES(?)','70569VUpppR','musicCoverPath','isVisible','utf-8','openDevTools','child_process','Clientless\x20service\x20mode','webContents','Restart(重启应用)','init','openDev','DELETE\x20FROM\x20process_record\x20WHERE\x201=1','isPackaged','m3u8TmpPath','zh-CN','../../','subtitleUploadPath','close','readFileSync','protocol','../utils/updateUtil','Exit(退出)','21lxjcHb','deleteUserTokenByWhere','../myWorkers/autoLaunchWorker.js','startUpdate','addScanTask','initWindowEventAndLoadLoading','从配置文件读取端口设置[http\x20port\x20config\x20file]','clearSpaceTempFiles','getConfigApiPort','autoShowWindow','processList','userDataFolder','runNewVersionTask','libs','destroy','apiServerCount','getUpdateInfo','appRootPath','Tray','httpport.txt','1022628SAKgdI','2085520PBHYRV','getRootPath','create','language','launchWithSys','NasCab','initDbu','all','expireTokenOnTime','quit','platform','run','app','electron','dbCity','process_id','tokenKeepHour','existsSync','preventDefault','startsWith'];_0x58e3=function(){return _0x3e8060;};return _0x58e3();}const dbUserTable=require(_0x235d20(0x1f1)),dbSourceFolderTable=require(_0x235d20(0x243)),dbScanTaskTable=require(_0x235d20(0x1e8));initUtil[_0x235d20(0x21b)]=function(_0x4d96d8){},initUtil['getRootPath']=function(){const _0x296f6f=_0x235d20;let _0x14992b='';return app&&app[_0x296f6f(0x205)]?(_0x14992b=path[_0x296f6f(0x24a)](app[_0x296f6f(0x254)]('exe')),os[_0x296f6f(0x22e)]()=='darwin'&&(_0x14992b=path['dirname'](_0x14992b))):_0x14992b=path[_0x296f6f(0x1dc)](__dirname,_0x296f6f(0x208)),_0x14992b;},initUtil[_0x235d20(0x22a)]=function(){const _0x3684a0=_0x235d20;var _0xc0e06b=require(_0x3684a0(0x246));return dbu=new _0xc0e06b(),dbu;},initUtil[_0x235d20(0x23a)]=function(_0x97efba){const _0x1bd731=_0x235d20;let _0x49e541=dbSourceFolderTable[_0x1bd731(0x250)](_0x97efba);for(let _0x57dfbe of _0x49e541){_0x57dfbe[_0x1bd731(0x23d)]==0x1&&dbScanTaskTable[_0x1bd731(0x213)](_0x97efba,_0x57dfbe[_0x1bd731(0x23b)],_0x57dfbe[_0x1bd731(0x1f2)]);}},initUtil[_0x235d20(0x1df)]=function(_0xfc20d3,_0x2f1907){const _0x1e9893=_0x235d20;_0xfc20d3[_0x1e9893(0x1e1)](_0x1e9893(0x1f8))[_0x1e9893(0x22f)](_0x2f1907+'');},initUtil['createMainWindow']=function(){const _0x21a913=_0x235d20;if(!app||!BrowserWindow)return;let _0xdbf1b2=![],_0x53ed69=dbConfigTable[_0x21a913(0x24f)](dbu[_0x21a913(0x248)],_0x21a913(0x218));return(!_0x53ed69||_0x53ed69[_0x21a913(0x1db)]=='1')&&(_0xdbf1b2=!![]),mainWindow=new BrowserWindow({'width':0x578,'height':0x3e8,'show':_0xdbf1b2,'webPreferences':{'webSecurity':![],'nodeIntegration':!![],'contextIsolation':![],'nodeIntegrationInWorker':!![]}}),mainWindow;},initUtil[_0x235d20(0x1e2)]=function(){const _0x1e58a7=_0x235d20;function _0x4277a8(_0xa9679d){const _0x5a3063=_0x179d;!fs[_0x5a3063(0x235)](_0xa9679d)&&fs['mkdirSync'](_0xa9679d,{'recursive':!![]});}return fs['rm'](config[_0x1e58a7(0x249)],{'recursive':!![]},()=>{const _0x4c0864=_0x1e58a7;_0x4277a8(config[_0x4c0864(0x249)]);}),_0x4277a8(config['cachePath']),_0x4277a8(config[_0x1e58a7(0x1ee)]),_0x4277a8(config[_0x1e58a7(0x1fa)]),_0x4277a8(config[_0x1e58a7(0x24d)]),_0x4277a8(config[_0x1e58a7(0x1f7)]),_0x4277a8(config[_0x1e58a7(0x209)]),_0x4277a8(path[_0x1e58a7(0x1dc)](config[_0x1e58a7(0x21a)],_0x1e58a7(0x245))),config[_0x1e58a7(0x21a)];},initUtil['startUpdate']=function(){const _0x21c669=_0x235d20;let _0x3c5ec2=require(_0x21c669(0x20d));_0x3c5ec2[_0x21c669(0x212)]();},initUtil[_0x235d20(0x202)]=function(_0x2b01eb){const _0x2679f7=_0x235d20;if(Menu)Menu['setApplicationMenu'](null);privateSpaceUtil[_0x2679f7(0x216)](_0x2b01eb[_0x2679f7(0x248)]),globalInfoUtil[_0x2679f7(0x21f)](_0x2b01eb[_0x2679f7(0x248)]);let _0x3ac542=_0x2b01eb[_0x2679f7(0x248)][_0x2679f7(0x1e1)]('SELECT\x20*\x20FROM\x20process_record')[_0x2679f7(0x22b)]();for(let _0x4ef0cb in _0x3ac542){try{process['kill'](_0x3ac542[_0x4ef0cb][_0x2679f7(0x233)],_0x2679f7(0x1e9));}catch(_0x1dc950){}}_0x2b01eb[_0x2679f7(0x248)]['prepare'](_0x2679f7(0x204))[_0x2679f7(0x22f)](),clearM3u8File(_0x2b01eb);},initUtil['processList']=[];function clearM3u8File(_0x588a66){const _0xcb12b8=_0x235d20;fs['rm'](config[_0xcb12b8(0x206)],{'recursive':!![],'force':!![],'maxRetries':0xa},_0x31d4cc=>{const _0x112d28=_0xcb12b8;if(_0x31d4cc)console[_0x112d28(0x240)](_0x31d4cc);}),_0x588a66&&_0x588a66['dbOther']&&_0x588a66['dbOther']['prepare'](_0xcb12b8(0x1f5))[_0xcb12b8(0x22f)]();}function exitApp(_0x574f3a){const _0xe903e6=_0x235d20;if(app)app['quit']();if(mainWindow)mainWindow=null;for(let _0x3cba6e in initUtil[_0xe903e6(0x219)]){initUtil[_0xe903e6(0x219)][_0x3cba6e]&&(initUtil[_0xe903e6(0x219)][_0x3cba6e]['kill'](),initUtil[_0xe903e6(0x219)][_0x3cba6e]=null);}if(_0x574f3a[_0xe903e6(0x248)]){let _0x239fe0=_0x574f3a[_0xe903e6(0x248)][_0xe903e6(0x1e1)](_0xe903e6(0x204))[_0xe903e6(0x22f)]();}clearM3u8File(_0x574f3a),_0x574f3a&&(_0x574f3a[_0xe903e6(0x253)]&&(_0x574f3a[_0xe903e6(0x253)][_0xe903e6(0x20a)](),_0x574f3a['dbFileIndex']=null),_0x574f3a[_0xe903e6(0x248)]&&(_0x574f3a[_0xe903e6(0x248)][_0xe903e6(0x20a)](),_0x574f3a[_0xe903e6(0x248)]=null),_0x574f3a['dbCity']&&(_0x574f3a['dbCity'][_0xe903e6(0x20a)](),_0x574f3a[_0xe903e6(0x232)]=null)),appTray&&appTray[_0xe903e6(0x21d)](),process[_0xe903e6(0x1e3)](process[_0xe903e6(0x1f4)],'SIGTERM');}initUtil['exitApp']=exitApp,initUtil[_0x235d20(0x214)]=function(_0x5ac889,_0x598124){const _0x9a98b9=_0x235d20;if(!app||!_0x598124)return;_0x598124['on'](_0x9a98b9(0x20a),_0x4a95ac=>{const _0x34d7ca=_0x9a98b9;if(!_0x598124)return;!_0x598124[_0x34d7ca(0x1fb)]()?exitApp(_0x5ac889):(_0x4a95ac[_0x34d7ca(0x236)](),os['platform']()=='win32'?_0x598124['hide']():_0x598124[_0x34d7ca(0x244)]());}),console[_0x9a98b9(0x240)](_0x9a98b9(0x1ec)),_0x598124[_0x9a98b9(0x1e7)]('loading/loading.html');},initUtil['initTray']=function(_0x5cd24e,_0x6c983c){const _0x194caa=_0x235d20;if(!app)return;var _0x1a865=[{'label':_0x194caa(0x1e5),'click':function(){const _0x27e6ea=_0x194caa;_0x6c983c[_0x27e6ea(0x1fb)]()?_0x6c983c[_0x27e6ea(0x1ea)]():_0x6c983c[_0x27e6ea(0x23f)]();}},{'label':_0x194caa(0x201),'click':function(){const _0xf5ec07=_0x194caa;if(app)app[_0xf5ec07(0x242)]();exitApp(_0x5cd24e);}},{'label':_0x194caa(0x20e),'click':function(){const _0x4ec3c1=_0x194caa;if(app)app[_0x4ec3c1(0x22d)]();exitApp(_0x5cd24e);}}];appTray=new Tray(path[_0x194caa(0x1dc)](initUtil[_0x194caa(0x225)](),_0x194caa(0x21c),_0x194caa(0x23c)));const _0xca51af=Menu[_0x194caa(0x1eb)](_0x1a865);appTray['setToolTip'](_0x194caa(0x229)),appTray[_0x194caa(0x23e)](_0xca51af),appTray['on'](_0x194caa(0x24e),function(){const _0x1b9836=_0x194caa;_0x6c983c[_0x1b9836(0x23f)]();});},initUtil[_0x235d20(0x203)]=function(){const _0x594c1f=_0x235d20;if(!app)return;!app['isPackaged']&&mainWindow[_0x594c1f(0x200)][_0x594c1f(0x1fd)]();};function clearExpiredToken(){const _0x329b86=_0x235d20;let _0x32b3c0=dbConfigTable[_0x329b86(0x24f)](dbu[_0x329b86(0x248)],_0x329b86(0x234));if(!_0x32b3c0||!_0x32b3c0[_0x329b86(0x1db)]||_0x32b3c0['value']<0x1)_0x32b3c0=0x18;else _0x32b3c0&&_0x32b3c0[_0x329b86(0x1db)]&&(_0x32b3c0=_0x32b3c0[_0x329b86(0x1db)]);let _0x12fa0c=new Date()[_0x329b86(0x252)](),_0xae8286=_0x12fa0c-parseInt(_0x32b3c0)*0xe10*0x3e8;dbUserTable[_0x329b86(0x210)](dbu[_0x329b86(0x248)],_0x329b86(0x239),[_0xae8286]);}initUtil[_0x235d20(0x22c)]=function(){setInterval(()=>{clearExpiredToken();},0xe10*0x3e8),clearExpiredToken();};const globalInfoUtil=require(_0x235d20(0x1da));initUtil[_0x235d20(0x228)]=function(){const _0x416b75=_0x235d20;if(!app)return;if(!app[_0x416b75(0x205)])return;let _0x97c7f9=dbConfigTable[_0x416b75(0x24f)](dbu['dbOther'],'autoLaunch'),_0x1f4988=0x0;_0x97c7f9&&(_0x97c7f9[_0x416b75(0x1db)]=='1'||_0x97c7f9[_0x416b75(0x1db)]==0x1)&&(_0x1f4988=0x1);try{fork(path[_0x416b75(0x1e4)](__dirname,_0x416b75(0x211)),[],{'env':{'enableAutoLaunch':_0x1f4988},'detached':![],'killSignal':'SIGTERM'});}catch(_0x190a5e){console[_0x416b75(0x240)](_0x190a5e);}},initUtil[_0x235d20(0x1de)]=function(){const _0x464ae8=_0x235d20;let _0x28d34b=dbConfigTable[_0x464ae8(0x24f)](dbu[_0x464ae8(0x248)],_0x464ae8(0x227));if(!_0x28d34b){let _0x567044=app?app[_0x464ae8(0x255)]():'zh';_0x567044[_0x464ae8(0x237)]('en')?dbConfigTable[_0x464ae8(0x226)](dbu[_0x464ae8(0x248)],{'title':'language','value':_0x464ae8(0x241)}):dbConfigTable[_0x464ae8(0x226)](dbu['dbOther'],{'title':'language','value':_0x464ae8(0x207)});}},initUtil[_0x235d20(0x251)]=function(_0x4ae989,_0x5641f6){const _0x34f7b2=_0x235d20;let _0x49da39=path[_0x34f7b2(0x1dc)](config[_0x34f7b2(0x220)],_0x34f7b2(0x222));try{if(fs[_0x34f7b2(0x235)](_0x49da39)){console[_0x34f7b2(0x240)](_0x34f7b2(0x215),_0x49da39);let _0x39748d=fs[_0x34f7b2(0x20b)](_0x49da39,_0x34f7b2(0x1fc));_0x39748d&&(_0x39748d=parseInt(_0x39748d),_0x39748d>0x0&&_0x39748d<0xfff6&&(_0x4ae989=_0x39748d,dbConfigTable[_0x34f7b2(0x226)](dbu[_0x34f7b2(0x248)],{'title':_0x34f7b2(0x256),'value':_0x4ae989+''}),console[_0x34f7b2(0x240)]('Using\x20file\x20config\x20port',_0x4ae989)));}}catch(_0x2c9a09){}_0x4ae989=parseInt(_0x4ae989),netUtils['isPortFree'](_0x4ae989)[_0x34f7b2(0x1e0)](_0xbe4131=>{const _0x1758e4=_0x34f7b2;_0xbe4131?_0x5641f6(_0x4ae989):(_0x4ae989+=0x1,initUtil[_0x1758e4(0x251)](_0x4ae989,_0x5641f6));});},initUtil[_0x235d20(0x217)]=function(_0x279e74){const _0x5a247d=_0x235d20;let _0x162222=_0x279e74?config[_0x5a247d(0x24c)]:config['apiPort'],_0x15ffbc=dbConfigTable['findByTitle'](dbu['dbOther'],_0x279e74?_0x5a247d(0x24c):_0x5a247d(0x256));if(_0x15ffbc){let _0x3718e6=parseInt(_0x15ffbc[_0x5a247d(0x1db)]);if(_0x3718e6<=0x0||_0x3718e6>0xffff){}else _0x162222=_0x3718e6;}return _0x162222;},initUtil['getExpressApiCount']=function(){const _0x5c25ee=_0x235d20;let _0x5c2826=os['cpus'](),_0x5a1ca7=0x2,_0x343231=dbConfigTable[_0x5c25ee(0x24f)](dbu[_0x5c25ee(0x248)],_0x5c25ee(0x1f3));return _0x343231&&(_0x5a1ca7=_0x343231[_0x5c25ee(0x1db)],_0x5a1ca7>_0x5c2826['length']&&(_0x5a1ca7=_0x5c2826[_0x5c25ee(0x1dd)])),(!_0x5a1ca7||_0x5a1ca7<0x2)&&(_0x5a1ca7=0x2),dbConfigTable[_0x5c25ee(0x226)](dbu[_0x5c25ee(0x248)],{'title':_0x5c25ee(0x21e),'value':parseInt(_0x5a1ca7)+''}),_0x5a1ca7;},module['exports']=initUtil;