const _0x11a71c=_0x8a71;(function(_0x355b49,_0x32aea3){const _0x40b4ff=_0x8a71,_0x1ea11f=_0x355b49();while(!![]){try{const _0x1d5a38=-parseInt(_0x40b4ff(0xbd))/0x1+parseInt(_0x40b4ff(0xb8))/0x2+-parseInt(_0x40b4ff(0xc7))/0x3+parseInt(_0x40b4ff(0xc8))/0x4+-parseInt(_0x40b4ff(0x9c))/0x5+parseInt(_0x40b4ff(0xaf))/0x6+-parseInt(_0x40b4ff(0xb7))/0x7*(-parseInt(_0x40b4ff(0xae))/0x8);if(_0x1d5a38===_0x32aea3)break;else _0x1ea11f['push'](_0x1ea11f['shift']());}catch(_0x24f92c){_0x1ea11f['push'](_0x1ea11f['shift']());}}}(_0x12a6,0xc839e));let FFmpeg=require(_0x11a71c(0x97))[_0x11a71c(0xa8)];const dbConfigTable=require('../db/dbConfigTable'),dbFileIndexTable=require(_0x11a71c(0xbf)),transCodeUtil=require(_0x11a71c(0xac));let videoStreamUtil={};function timeToSec(_0x159cec){const _0x1fb120=_0x11a71c;var _0x33461f='',_0x13fb75=_0x159cec[_0x1fb120(0xa7)](':')[0x0],_0x4a0f9c=_0x159cec[_0x1fb120(0xa7)](':')[0x1],_0x2d9777=_0x159cec['split'](':')[0x2];return _0x33461f=parseFloat(_0x13fb75*0xe10)+parseFloat(_0x4a0f9c*0x3c)+parseFloat(_0x2d9777),_0x33461f;}function _0x12a6(){const _0xdc88ce=['rotate','file_index_movie','536176RHXBXq','indexOf','../db/dbFileIndexTable','getTime','prepare','movie_genres','rotation','push','parseVideoWH','trim','2838333ohwHiF','1965912UhYyjy','height','movie_language','getVideoMeta','streams','goParseMoviesKeys','getVideoOriginalTime','codec_type','../libs/nasTrans','movie_regions','parseMovieKeys','length','getDurationFromStream','5212845HNGTQy','REPLACE\x20INTO\x20\x20movie_keys(key_type,key_value,index_count)\x20VALUES(\x27','UPDATE\x20movie_keys\x20SET\x20index_count=0\x20where\x201=1','creation_time','lastTimeStampMatchMovieInfo','findByTitle','DURATION','run','exports','\x27,\x20\x27','width','split','FFmpeg','includes','movie_regions,movie_language,movie_genres','format','./transCodeUtil','value','13081144YZOerW','5988900eSuoQY','duration','getAllByWhere','\x20WHERE\x20title=\x27lastTimeStampMatchMovieInfo\x27','video','saveLastMatchTime','DELETE\x20FROM\x20movie_keys\x20where\x201=1','\x20movie_info_state=1\x20and\x20is_file=1\x20and\x20type=2','7VYEOgi','440422hKGhGd','tags','N/A'];_0x12a6=function(){return _0xdc88ce;};return _0x12a6();}videoStreamUtil[_0x11a71c(0xb4)]=function(_0x3f022c){const _0x56623b=_0x11a71c;let _0x169d37=dbConfigTable[_0x56623b(0xa1)](_0x3f022c,'lastTimeStampMatchMovieInfo');!_0x169d37?_0x3f022c[_0x56623b(0xc1)]('REPLACE\x20INTO\x20config(title,value)\x20values(\x27lastTimeStampMatchMovieInfo\x27,'+new Date()[_0x56623b(0xc0)]()+')')[_0x56623b(0xa3)]():_0x3f022c[_0x56623b(0xc1)]('UPDATE\x20config\x20SET\x20value='+new Date()['getTime']()+_0x56623b(0xb2))['run']();};function _0x8a71(_0x3696a4,_0x3c01de){const _0x12a62e=_0x12a6();return _0x8a71=function(_0x8a719d,_0x28638a){_0x8a719d=_0x8a719d-0x97;let _0x4fd1d3=_0x12a62e[_0x8a719d];return _0x4fd1d3;},_0x8a71(_0x3696a4,_0x3c01de);}let lastMovieInfoUpdateTime=0x0;videoStreamUtil[_0x11a71c(0xcd)]=function(_0x1b037d,_0x40cd56,_0x36014b){const _0x3af93f=_0x11a71c;let _0x28b736=dbConfigTable[_0x3af93f(0xa1)](_0x1b037d,_0x3af93f(0xa0));if(_0x36014b)videoStreamUtil[_0x3af93f(0x99)](_0x40cd56);else _0x28b736&&lastMovieInfoUpdateTime!=_0x28b736[_0x3af93f(0xad)]&&(videoStreamUtil[_0x3af93f(0x99)](_0x40cd56),lastMovieInfoUpdateTime=_0x28b736['value']);};let isParsingMovie=![];videoStreamUtil[_0x11a71c(0x99)]=function(_0x1c2e5a){const _0x9896c=_0x11a71c;if(isParsingMovie)return;let _0x3b3ab8={};isParsingMovie=!![];let _0x503ae6=dbFileIndexTable[_0x9896c(0xb1)](_0x1c2e5a,_0x9896c(0xb6),_0x9896c(0xaa),_0x9896c(0xbc)),_0x1ba810=[],_0x161396=[],_0x3c1dd2=[];function _0x41d1b7(_0x4ed669,_0x1beab9,_0x44d33a){const _0x4b634f=_0x9896c;if(_0x4ed669){if(_0x4ed669[_0x4b634f(0xbe)]('/')!=-0x1){let _0x3a9aec=_0x4ed669[_0x4b634f(0xa7)]('/');for(let _0x40ba2f in _0x3a9aec){_0x3a9aec[_0x40ba2f]&&(!_0x1beab9[_0x4b634f(0xa9)](_0x3a9aec[_0x40ba2f][_0x4b634f(0xc6)]())?(_0x1beab9[_0x4b634f(0xc4)](_0x3a9aec[_0x40ba2f][_0x4b634f(0xc6)]()),_0x3b3ab8[_0x44d33a+_0x3a9aec[_0x40ba2f][_0x4b634f(0xc6)]()]=0x1):_0x3b3ab8[_0x44d33a+_0x3a9aec[_0x40ba2f][_0x4b634f(0xc6)]()]+=0x1);}}else!_0x1beab9['includes'](_0x4ed669['trim']())?(_0x1beab9[_0x4b634f(0xc4)](_0x4ed669['trim']()),_0x3b3ab8[_0x44d33a+_0x4ed669[_0x4b634f(0xc6)]()]=0x1):_0x3b3ab8[_0x44d33a+_0x4ed669['trim']()]+=0x1;}for(let _0x456156=0x0;_0x456156<_0x1beab9[_0x4b634f(0x9a)];_0x456156++){const _0x3b9a85=_0x4b634f(0x9d)+_0x44d33a+_0x4b634f(0xa5)+_0x1beab9[_0x456156]+'\x27,'+_0x3b3ab8[_0x44d33a+_0x1beab9[_0x456156]]+')';_0x1c2e5a[_0x4b634f(0xc1)](_0x3b9a85)[_0x4b634f(0xa3)]();}}if(_0x503ae6&&_0x503ae6[_0x9896c(0x9a)]>0x0){_0x1c2e5a['prepare'](_0x9896c(0x9e))['run']();for(let _0x56ae73=0x0;_0x56ae73<_0x503ae6[_0x9896c(0x9a)];_0x56ae73++){let _0x1b202e=_0x503ae6[_0x56ae73],_0x3b3b33=_0x1b202e[_0x9896c(0xc2)],_0xc5b543=_0x1b202e['movie_language'],_0xf6ab3c=_0x1b202e[_0x9896c(0x98)];_0x41d1b7(_0x3b3b33,_0x3c1dd2,_0x9896c(0xc2)),_0x41d1b7(_0xc5b543,_0x1ba810,_0x9896c(0xca)),_0x41d1b7(_0xf6ab3c,_0x161396,_0x9896c(0x98));}}else _0x1c2e5a[_0x9896c(0xc1)](_0x9896c(0xb5))[_0x9896c(0xa3)]();isParsingMovie=![];},videoStreamUtil[_0x11a71c(0xce)]=function(_0x545f8a){const _0x13116e=_0x11a71c;let _0x215486=new Date()[_0x13116e(0xc0)]();if(_0x545f8a&&_0x545f8a['format']&&_0x545f8a[_0x13116e(0xab)][_0x13116e(0xb9)]){let _0x597e69=_0x545f8a[_0x13116e(0xab)][_0x13116e(0xb9)]['com.apple.quicktime.creationdate'],_0x2874e1=null;_0x597e69&&(_0x2874e1=_0x597e69,_0x215486=new Date(_0x2874e1)[_0x13116e(0xc0)]()),!_0x2874e1&&_0x545f8a[_0x13116e(0xab)][_0x13116e(0xb9)][_0x13116e(0x9f)]&&(_0x2874e1=_0x545f8a['format'][_0x13116e(0xb9)]['creation_time'],_0x215486=new Date(_0x2874e1)['getTime']());}return _0x215486;},videoStreamUtil[_0x11a71c(0x9b)]=function(_0x565c38){const _0xa8225f=_0x11a71c;let _0x4113ac=_0x565c38[_0xa8225f(0xcc)];if(_0x565c38&&_0x565c38[_0xa8225f(0xab)]&&_0x565c38['format'][_0xa8225f(0xb0)]){let _0x34140b=_0x565c38[_0xa8225f(0xab)][_0xa8225f(0xb0)];if(_0x34140b&&_0x34140b!='N/A'&&!isNaN(_0x34140b)&&_0x34140b>0x0)return _0x34140b;}for(let _0x4067ea=0x0;_0x4067ea<_0x4113ac[_0xa8225f(0x9a)];_0x4067ea++){let _0x248d93=_0x4113ac[_0x4067ea];if(_0x248d93[_0xa8225f(0xb0)]&&_0x248d93[_0xa8225f(0xb0)]!=_0xa8225f(0xba)&&!isNaN(_0x248d93['duration'])&&_0x248d93[_0xa8225f(0xb0)]>0x0)return _0x248d93[_0xa8225f(0xb0)];if(_0x248d93['tags']){if(_0x248d93[_0xa8225f(0xb9)][_0xa8225f(0xa2)]||_0x248d93[_0xa8225f(0xb9)][_0xa8225f(0xb0)]){let _0x567ab7=_0x248d93[_0xa8225f(0xb9)][_0xa8225f(0xa2)]||_0x248d93[_0xa8225f(0xb9)][_0xa8225f(0xb0)];if(_0x567ab7[_0xa8225f(0xbe)](':')!=-0x1)return timeToSec(_0x567ab7);}}}return 0x0;},videoStreamUtil[_0x11a71c(0xcb)]=function(_0x126c21){return new Promise((_0x103cdb,_0x1a2a3e)=>{FFmpeg(_0x126c21)['ffprobe']((_0x29ce35,_0xb6099)=>{_0x29ce35?_0x1a2a3e(_0x29ce35):_0x103cdb(_0xb6099);});});},videoStreamUtil[_0x11a71c(0xc5)]=function(_0x164246){const _0x5adfa2=_0x11a71c;let _0x49b1cb=0x0,_0x1c0c5d=0x0,_0x3e853e=0x0,_0x565316=null;for(let _0x17894a=0x0;_0x17894a<_0x164246[_0x5adfa2(0x9a)];_0x17894a++){let _0xe98d0a=_0x164246[_0x17894a];_0xe98d0a[_0x5adfa2(0xcf)]==_0x5adfa2(0xb3)&&(_0x565316=_0xe98d0a,_0xe98d0a[_0x5adfa2(0xc3)]&&(_0x3e853e=_0xe98d0a[_0x5adfa2(0xc3)]),!_0x3e853e&&(_0xe98d0a[_0x5adfa2(0xb9)]&&_0xe98d0a[_0x5adfa2(0xb9)][_0x5adfa2(0xbb)]&&(_0x3e853e=_0xe98d0a[_0x5adfa2(0xb9)]['rotate'])));if(_0xe98d0a['width']&&_0xe98d0a['height']){if(_0xe98d0a[_0x5adfa2(0xa6)]!=_0x5adfa2(0xba)&&!isNaN(_0xe98d0a[_0x5adfa2(0xa6)])&&_0xe98d0a[_0x5adfa2(0xa6)]>0x0){_0x49b1cb=_0xe98d0a[_0x5adfa2(0xa6)],_0x1c0c5d=_0xe98d0a[_0x5adfa2(0xc9)];break;}}}if((_0x3e853e==0x5a||_0x3e853e==-0x5a||_0x3e853e==0x10e)&&_0x49b1cb&&_0x1c0c5d){let _0x34e168=_0x49b1cb,_0x3a45fc=_0x1c0c5d;_0x49b1cb=_0x3a45fc,_0x1c0c5d=_0x34e168;}return{'videoHeight':_0x1c0c5d,'videoWidth':_0x49b1cb,'videoStream':_0x565316};},module[_0x11a71c(0xa4)]=videoStreamUtil;