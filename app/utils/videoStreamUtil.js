const _0x3d28ca=_0x2770;(function(_0x3ed40e,_0x91eeec){const _0x5a4905=_0x2770,_0x1d97eb=_0x3ed40e();while(!![]){try{const _0x17bcf1=parseInt(_0x5a4905(0x18c))/0x1*(-parseInt(_0x5a4905(0x182))/0x2)+-parseInt(_0x5a4905(0x178))/0x3*(-parseInt(_0x5a4905(0x1a4))/0x4)+parseInt(_0x5a4905(0x1a1))/0x5*(parseInt(_0x5a4905(0x184))/0x6)+-parseInt(_0x5a4905(0x199))/0x7+-parseInt(_0x5a4905(0x17e))/0x8*(parseInt(_0x5a4905(0x1ad))/0x9)+-parseInt(_0x5a4905(0x19f))/0xa+parseInt(_0x5a4905(0x197))/0xb;if(_0x17bcf1===_0x91eeec)break;else _0x1d97eb['push'](_0x1d97eb['shift']());}catch(_0x276033){_0x1d97eb['push'](_0x1d97eb['shift']());}}}(_0x167b,0xbd612));let FFmpeg=require(_0x3d28ca(0x1a6))['FFmpeg'];const dbConfigTable=require(_0x3d28ca(0x195)),dbFileIndexTable=require(_0x3d28ca(0x1a8)),transCodeUtil=require(_0x3d28ca(0x17f));let videoStreamUtil={};function timeToSec(_0x9816ce){const _0x2c2e0e=_0x3d28ca;var _0xf7f578='',_0x5d5c1e=_0x9816ce[_0x2c2e0e(0x19c)](':')[0x0],_0x130889=_0x9816ce[_0x2c2e0e(0x19c)](':')[0x1],_0x376b38=_0x9816ce['split'](':')[0x2];return _0xf7f578=parseFloat(_0x5d5c1e*0xe10)+parseFloat(_0x130889*0x3c)+parseFloat(_0x376b38),_0xf7f578;}videoStreamUtil['saveLastMatchTime']=function(_0x102e79){const _0x2fc5bc=_0x3d28ca;let _0x1b33f2=dbConfigTable[_0x2fc5bc(0x186)](_0x102e79,_0x2fc5bc(0x1a2));!_0x1b33f2?_0x102e79[_0x2fc5bc(0x18e)](_0x2fc5bc(0x1a0)+new Date()['getTime']()+')')[_0x2fc5bc(0x19b)]():_0x102e79['prepare'](_0x2fc5bc(0x190)+new Date()[_0x2fc5bc(0x17a)]()+_0x2fc5bc(0x193))[_0x2fc5bc(0x19b)]();};let lastMovieInfoUpdateTime=0x0;function _0x2770(_0x105947,_0x2df80c){const _0x167b60=_0x167b();return _0x2770=function(_0x277043,_0x281c70){_0x277043=_0x277043-0x177;let _0x504524=_0x167b60[_0x277043];return _0x504524;},_0x2770(_0x105947,_0x2df80c);}videoStreamUtil[_0x3d28ca(0x1a5)]=function(_0x1fef01,_0x5177ba,_0x247a15){const _0xe1ff95=_0x3d28ca;let _0x1059fe=dbConfigTable[_0xe1ff95(0x186)](_0x1fef01,_0xe1ff95(0x1a2));if(_0x247a15)videoStreamUtil[_0xe1ff95(0x191)](_0x5177ba);else _0x1059fe&&lastMovieInfoUpdateTime!=_0x1059fe[_0xe1ff95(0x19d)]&&(videoStreamUtil[_0xe1ff95(0x191)](_0x5177ba),lastMovieInfoUpdateTime=_0x1059fe[_0xe1ff95(0x19d)]);};let isParsingMovie=![];videoStreamUtil[_0x3d28ca(0x191)]=function(_0x12992a){const _0x4fcbdd=_0x3d28ca;if(isParsingMovie)return;let _0x575589={};isParsingMovie=!![];let _0x3ecee7=dbFileIndexTable[_0x4fcbdd(0x18d)](_0x12992a,_0x4fcbdd(0x1a3),_0x4fcbdd(0x189),'file_index_movie'),_0x14232f=[],_0x201420=[],_0x4f412f=[];function _0x19ef98(_0x53caad,_0x282081,_0x1720be){const _0x58efa4=_0x4fcbdd;if(_0x53caad){if(_0x53caad[_0x58efa4(0x188)]('/')!=-0x1){let _0x2dcd67=_0x53caad['split']('/');for(let _0x3e9085 in _0x2dcd67){_0x2dcd67[_0x3e9085]&&(!_0x282081[_0x58efa4(0x1ac)](_0x2dcd67[_0x3e9085][_0x58efa4(0x185)]())?(_0x282081[_0x58efa4(0x17d)](_0x2dcd67[_0x3e9085]['trim']()),_0x575589[_0x1720be+_0x2dcd67[_0x3e9085][_0x58efa4(0x185)]()]=0x1):_0x575589[_0x1720be+_0x2dcd67[_0x3e9085]['trim']()]+=0x1);}}else!_0x282081[_0x58efa4(0x1ac)](_0x53caad[_0x58efa4(0x185)]())?(_0x282081[_0x58efa4(0x17d)](_0x53caad[_0x58efa4(0x185)]()),_0x575589[_0x1720be+_0x53caad[_0x58efa4(0x185)]()]=0x1):_0x575589[_0x1720be+_0x53caad[_0x58efa4(0x185)]()]+=0x1;}for(let _0x10fce1=0x0;_0x10fce1<_0x282081['length'];_0x10fce1++){const _0x588315=_0x58efa4(0x19a)+_0x1720be+'\x27,\x20\x27'+_0x282081[_0x10fce1]+'\x27,'+_0x575589[_0x1720be+_0x282081[_0x10fce1]]+')';_0x12992a[_0x58efa4(0x18e)](_0x588315)[_0x58efa4(0x19b)]();}}if(_0x3ecee7&&_0x3ecee7[_0x4fcbdd(0x181)]>0x0){_0x12992a['prepare'](_0x4fcbdd(0x18b))[_0x4fcbdd(0x19b)]();for(let _0x3ea961=0x0;_0x3ea961<_0x3ecee7['length'];_0x3ea961++){let _0x5bf12c=_0x3ecee7[_0x3ea961],_0x2da278=_0x5bf12c[_0x4fcbdd(0x19e)],_0x3cb1a3=_0x5bf12c[_0x4fcbdd(0x1a7)],_0x5deed3=_0x5bf12c[_0x4fcbdd(0x177)];_0x19ef98(_0x2da278,_0x4f412f,_0x4fcbdd(0x19e)),_0x19ef98(_0x3cb1a3,_0x14232f,'movie_language'),_0x19ef98(_0x5deed3,_0x201420,_0x4fcbdd(0x177));}}else _0x12992a['prepare']('DELETE\x20FROM\x20movie_keys\x20where\x201=1')['run']();isParsingMovie=![];},videoStreamUtil[_0x3d28ca(0x1ae)]=function(_0x203d8b){const _0x1445d0=_0x3d28ca;let _0x210421=new Date()[_0x1445d0(0x17a)]();if(_0x203d8b&&_0x203d8b['format']&&_0x203d8b[_0x1445d0(0x196)][_0x1445d0(0x187)]){let _0x597198=_0x203d8b[_0x1445d0(0x196)]['tags'][_0x1445d0(0x179)],_0x36be54=null;_0x597198&&(_0x36be54=_0x597198,_0x210421=new Date(_0x36be54)[_0x1445d0(0x17a)]()),!_0x36be54&&_0x203d8b[_0x1445d0(0x196)][_0x1445d0(0x187)][_0x1445d0(0x18f)]&&(_0x36be54=_0x203d8b[_0x1445d0(0x196)]['tags']['creation_time'],_0x210421=new Date(_0x36be54)[_0x1445d0(0x17a)]());}return _0x210421;},videoStreamUtil['getDurationFromStream']=function(_0x4afb74){const _0x2b770d=_0x3d28ca;let _0x5eedaa=_0x4afb74['streams'];if(_0x4afb74&&_0x4afb74[_0x2b770d(0x196)]&&_0x4afb74['format'][_0x2b770d(0x198)]){let _0x12e652=_0x4afb74[_0x2b770d(0x196)][_0x2b770d(0x198)];if(_0x12e652&&_0x12e652!='N/A'&&!isNaN(_0x12e652)&&_0x12e652>0x0)return _0x12e652;}for(let _0x526e30=0x0;_0x526e30<_0x5eedaa[_0x2b770d(0x181)];_0x526e30++){let _0x47c42a=_0x5eedaa[_0x526e30];if(_0x47c42a[_0x2b770d(0x198)]&&_0x47c42a[_0x2b770d(0x198)]!=_0x2b770d(0x1a9)&&!isNaN(_0x47c42a[_0x2b770d(0x198)])&&_0x47c42a[_0x2b770d(0x198)]>0x0)return _0x47c42a[_0x2b770d(0x198)];if(_0x47c42a[_0x2b770d(0x187)]){if(_0x47c42a['tags']['DURATION']||_0x47c42a[_0x2b770d(0x187)][_0x2b770d(0x198)]){let _0x1786ea=_0x47c42a['tags']['DURATION']||_0x47c42a[_0x2b770d(0x187)][_0x2b770d(0x198)];if(_0x1786ea[_0x2b770d(0x188)](':')!=-0x1)return timeToSec(_0x1786ea);}}}return 0x0;},videoStreamUtil[_0x3d28ca(0x192)]=function(_0x3d5f2b){return new Promise((_0x5284f9,_0x292714)=>{const _0x26f1c3=_0x2770;FFmpeg(_0x3d5f2b)[_0x26f1c3(0x194)]((_0x1b978f,_0x51cffc)=>{_0x1b978f?_0x292714(_0x1b978f):_0x5284f9(_0x51cffc);});});},videoStreamUtil['parseVideoWH']=function(_0x380175){const _0x3df3db=_0x3d28ca;let _0x341413=0x0,_0x44e6a7=0x0,_0x45e778=0x0,_0x3d679e=null;for(let _0x7086e2=0x0;_0x7086e2<_0x380175[_0x3df3db(0x181)];_0x7086e2++){let _0x339b32=_0x380175[_0x7086e2];_0x339b32[_0x3df3db(0x180)]==_0x3df3db(0x17b)&&(_0x3d679e=_0x339b32,_0x339b32[_0x3df3db(0x17c)]&&(_0x45e778=_0x339b32[_0x3df3db(0x17c)]),!_0x45e778&&(_0x339b32[_0x3df3db(0x187)]&&_0x339b32[_0x3df3db(0x187)][_0x3df3db(0x1aa)]&&(_0x45e778=_0x339b32['tags']['rotate'])));if(_0x339b32['width']&&_0x339b32[_0x3df3db(0x183)]){if(_0x339b32[_0x3df3db(0x18a)]!=_0x3df3db(0x1a9)&&!isNaN(_0x339b32[_0x3df3db(0x18a)])&&_0x339b32[_0x3df3db(0x18a)]>0x0){_0x341413=_0x339b32[_0x3df3db(0x18a)],_0x44e6a7=_0x339b32[_0x3df3db(0x183)];break;}}}if((_0x45e778==0x5a||_0x45e778==-0x5a||_0x45e778==0x10e)&&_0x341413&&_0x44e6a7){let _0x2922ab=_0x341413,_0x6bb8fa=_0x44e6a7;_0x341413=_0x6bb8fa,_0x44e6a7=_0x2922ab;}return{'videoHeight':_0x44e6a7,'videoWidth':_0x341413,'videoStream':_0x3d679e};},module[_0x3d28ca(0x1ab)]=videoStreamUtil;function _0x167b(){const _0x1b30f9=['45HGyLCv','getVideoOriginalTime','movie_regions','45GpzCoB','com.apple.quicktime.creationdate','getTime','video','rotation','push','1255528QfsHhz','./transCodeUtil','codec_type','length','2rEOADV','height','1646610fePDms','trim','findByTitle','tags','indexOf','movie_regions,movie_language,movie_genres','width','UPDATE\x20movie_keys\x20SET\x20index_count=0\x20where\x201=1','1011571notUYS','getAllByWhere','prepare','creation_time','UPDATE\x20config\x20SET\x20value=','parseMovieKeys','getVideoMeta','\x20WHERE\x20title=\x27lastTimeStampMatchMovieInfo\x27','ffprobe','../db/dbConfigTable','format','29286653MyrDek','duration','10434529dNcUVt','REPLACE\x20INTO\x20\x20movie_keys(key_type,key_value,index_count)\x20VALUES(\x27','run','split','value','movie_genres','13895070VzcwTf','REPLACE\x20INTO\x20config(title,value)\x20values(\x27lastTimeStampMatchMovieInfo\x27,','25cBwWCO','lastTimeStampMatchMovieInfo','\x20movie_info_state=1\x20and\x20is_file=1\x20and\x20type=2','378008QchWUI','goParseMoviesKeys','../libs/nasTrans','movie_language','../db/dbFileIndexTable','N/A','rotate','exports','includes'];_0x167b=function(){return _0x1b30f9;};return _0x167b();}