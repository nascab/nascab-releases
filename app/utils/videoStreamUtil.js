const _0x5cff7d=_0x1528;(function(_0x1f16ee,_0x5d8d30){const _0x1c6ce3=_0x1528,_0x36e807=_0x1f16ee();while(!![]){try{const _0x260cd6=parseInt(_0x1c6ce3(0x195))/0x1+parseInt(_0x1c6ce3(0x193))/0x2+-parseInt(_0x1c6ce3(0x1a8))/0x3+-parseInt(_0x1c6ce3(0x1ab))/0x4+parseInt(_0x1c6ce3(0x19b))/0x5*(-parseInt(_0x1c6ce3(0x18e))/0x6)+-parseInt(_0x1c6ce3(0x1c3))/0x7+parseInt(_0x1c6ce3(0x1ba))/0x8;if(_0x260cd6===_0x5d8d30)break;else _0x36e807['push'](_0x36e807['shift']());}catch(_0x51763a){_0x36e807['push'](_0x36e807['shift']());}}}(_0x1d83,0x5edee));let FFmpeg=require(_0x5cff7d(0x1c8))[_0x5cff7d(0x18f)];const dbConfigTable=require(_0x5cff7d(0x1a3)),dbFileIndexTable=require(_0x5cff7d(0x1a4)),transCodeUtil=require(_0x5cff7d(0x1af));let videoStreamUtil={};function timeToSec(_0xcf5a3b){const _0x444927=_0x5cff7d;var _0x2a280b='',_0x574283=_0xcf5a3b[_0x444927(0x1aa)](':')[0x0],_0x405129=_0xcf5a3b[_0x444927(0x1aa)](':')[0x1],_0x15f680=_0xcf5a3b['split'](':')[0x2];return _0x2a280b=parseFloat(_0x574283*0xe10)+parseFloat(_0x405129*0x3c)+parseFloat(_0x15f680),_0x2a280b;}videoStreamUtil[_0x5cff7d(0x197)]=function(_0xaf34e2){const _0x7cdbe2=_0x5cff7d;let _0x3652f1=dbConfigTable[_0x7cdbe2(0x1b0)](_0xaf34e2,_0x7cdbe2(0x1b6));!_0x3652f1?_0xaf34e2['prepare']('REPLACE\x20INTO\x20config(title,value)\x20values(\x27lastTimeStampMatchMovieInfo\x27,'+new Date()['getTime']()+')')[_0x7cdbe2(0x1b3)]():_0xaf34e2[_0x7cdbe2(0x1b5)](_0x7cdbe2(0x191)+new Date()[_0x7cdbe2(0x1c5)]()+_0x7cdbe2(0x19a))[_0x7cdbe2(0x1b3)]();};let lastMovieInfoUpdateTime=0x0;function _0x1528(_0x3c6a73,_0x22ae30){const _0x1d8397=_0x1d83();return _0x1528=function(_0x152807,_0x2469ff){_0x152807=_0x152807-0x18e;let _0x2255f3=_0x1d8397[_0x152807];return _0x2255f3;},_0x1528(_0x3c6a73,_0x22ae30);}function _0x1d83(){const _0x50aab6=['saveLastMatchTime','movie_genres','value','\x20WHERE\x20title=\x27lastTimeStampMatchMovieInfo\x27','3325auFaJh','width','height','push','codec_type','tags','UPDATE\x20movie_keys\x20SET\x20index_count=0\x20where\x201=1','N/A','../db/dbConfigTable','../db/dbFileIndexTable','movie_language','\x20movie_info_state=1\x20and\x20is_file=1\x20and\x20type=2','creation_time','680535BsCjdZ','parseMovieKeys','split','2210128HMOzvS','file_index_movie','indexOf','com.apple.quicktime.creationdate','./transCodeUtil','findByTitle','REPLACE\x20INTO\x20\x20movie_keys(key_type,key_value,index_count)\x20VALUES(\x27','rotate','run','includes','prepare','lastTimeStampMatchMovieInfo','rotation','streams','movie_regions','2335184fPENng','exports','trim','video','length','ffprobe','getVideoOriginalTime','DELETE\x20FROM\x20movie_keys\x20where\x201=1','DURATION','594916dNkUBz','getDurationFromStream','getTime','duration','parseVideoWH','../libs/nasTrans','1404biQhOw','FFmpeg','getVideoMeta','UPDATE\x20config\x20SET\x20value=','format','1313380KtUITG','getAllByWhere','459977JsNETO','\x27,\x20\x27'];_0x1d83=function(){return _0x50aab6;};return _0x1d83();}videoStreamUtil['goParseMoviesKeys']=function(_0x43f259,_0x336219,_0x157ccb){const _0x5b4c76=_0x5cff7d;let _0x47cf1e=dbConfigTable[_0x5b4c76(0x1b0)](_0x43f259,_0x5b4c76(0x1b6));if(_0x157ccb)videoStreamUtil[_0x5b4c76(0x1a9)](_0x336219);else _0x47cf1e&&lastMovieInfoUpdateTime!=_0x47cf1e[_0x5b4c76(0x199)]&&(videoStreamUtil[_0x5b4c76(0x1a9)](_0x336219),lastMovieInfoUpdateTime=_0x47cf1e['value']);};let isParsingMovie=![];videoStreamUtil[_0x5cff7d(0x1a9)]=function(_0x5d191c){const _0x5dcb83=_0x5cff7d;if(isParsingMovie)return;let _0x47e421={};isParsingMovie=!![];let _0x24fad7=dbFileIndexTable[_0x5dcb83(0x194)](_0x5d191c,_0x5dcb83(0x1a6),'movie_regions,movie_language,movie_genres',_0x5dcb83(0x1ac)),_0x1c1c95=[],_0x54a168=[],_0x5e7c34=[];function _0x98df43(_0x1e4bce,_0x59683d,_0xae0368){const _0x3d2606=_0x5dcb83;if(_0x1e4bce){if(_0x1e4bce[_0x3d2606(0x1ad)]('/')!=-0x1){let _0x74f91d=_0x1e4bce[_0x3d2606(0x1aa)]('/');for(let _0x50cf38 in _0x74f91d){_0x74f91d[_0x50cf38]&&(!_0x59683d[_0x3d2606(0x1b4)](_0x74f91d[_0x50cf38]['trim']())?(_0x59683d[_0x3d2606(0x19e)](_0x74f91d[_0x50cf38][_0x3d2606(0x1bc)]()),_0x47e421[_0xae0368+_0x74f91d[_0x50cf38][_0x3d2606(0x1bc)]()]=0x1):_0x47e421[_0xae0368+_0x74f91d[_0x50cf38][_0x3d2606(0x1bc)]()]+=0x1);}}else!_0x59683d[_0x3d2606(0x1b4)](_0x1e4bce[_0x3d2606(0x1bc)]())?(_0x59683d[_0x3d2606(0x19e)](_0x1e4bce['trim']()),_0x47e421[_0xae0368+_0x1e4bce['trim']()]=0x1):_0x47e421[_0xae0368+_0x1e4bce[_0x3d2606(0x1bc)]()]+=0x1;}for(let _0x35aa81=0x0;_0x35aa81<_0x59683d['length'];_0x35aa81++){const _0x1174d9=_0x3d2606(0x1b1)+_0xae0368+_0x3d2606(0x196)+_0x59683d[_0x35aa81]+'\x27,'+_0x47e421[_0xae0368+_0x59683d[_0x35aa81]]+')';_0x5d191c[_0x3d2606(0x1b5)](_0x1174d9)[_0x3d2606(0x1b3)]();}}if(_0x24fad7&&_0x24fad7['length']>0x0){_0x5d191c[_0x5dcb83(0x1b5)](_0x5dcb83(0x1a1))[_0x5dcb83(0x1b3)]();for(let _0x2385dc=0x0;_0x2385dc<_0x24fad7[_0x5dcb83(0x1be)];_0x2385dc++){let _0x53d568=_0x24fad7[_0x2385dc],_0x484f46=_0x53d568[_0x5dcb83(0x198)],_0x577f96=_0x53d568[_0x5dcb83(0x1a5)],_0xb5f24e=_0x53d568['movie_regions'];_0x98df43(_0x484f46,_0x5e7c34,_0x5dcb83(0x198)),_0x98df43(_0x577f96,_0x1c1c95,_0x5dcb83(0x1a5)),_0x98df43(_0xb5f24e,_0x54a168,_0x5dcb83(0x1b9));}}else _0x5d191c[_0x5dcb83(0x1b5)](_0x5dcb83(0x1c1))[_0x5dcb83(0x1b3)]();isParsingMovie=![];},videoStreamUtil[_0x5cff7d(0x1c0)]=function(_0x6b64bb){const _0x39874f=_0x5cff7d;let _0x27218c=new Date()['getTime']();if(_0x6b64bb&&_0x6b64bb[_0x39874f(0x192)]&&_0x6b64bb[_0x39874f(0x192)][_0x39874f(0x1a0)]){let _0x20df33=_0x6b64bb[_0x39874f(0x192)][_0x39874f(0x1a0)][_0x39874f(0x1ae)],_0x51a4c5=null;_0x20df33&&(_0x51a4c5=_0x20df33,_0x27218c=new Date(_0x51a4c5)[_0x39874f(0x1c5)]()),!_0x51a4c5&&_0x6b64bb[_0x39874f(0x192)][_0x39874f(0x1a0)][_0x39874f(0x1a7)]&&(_0x51a4c5=_0x6b64bb[_0x39874f(0x192)]['tags'][_0x39874f(0x1a7)],_0x27218c=new Date(_0x51a4c5)[_0x39874f(0x1c5)]());}return _0x27218c;},videoStreamUtil[_0x5cff7d(0x1c4)]=function(_0x18cb3c){const _0x19a22c=_0x5cff7d;let _0x643f6c=_0x18cb3c[_0x19a22c(0x1b8)];if(_0x18cb3c&&_0x18cb3c[_0x19a22c(0x192)]&&_0x18cb3c[_0x19a22c(0x192)][_0x19a22c(0x1c6)]){let _0x479b2b=_0x18cb3c['format']['duration'];if(_0x479b2b&&_0x479b2b!='N/A'&&!isNaN(_0x479b2b)&&_0x479b2b>0x0)return _0x479b2b;}for(let _0x329155=0x0;_0x329155<_0x643f6c[_0x19a22c(0x1be)];_0x329155++){let _0x36cbc0=_0x643f6c[_0x329155];if(_0x36cbc0[_0x19a22c(0x1c6)]&&_0x36cbc0['duration']!=_0x19a22c(0x1a2)&&!isNaN(_0x36cbc0[_0x19a22c(0x1c6)])&&_0x36cbc0[_0x19a22c(0x1c6)]>0x0)return _0x36cbc0[_0x19a22c(0x1c6)];if(_0x36cbc0[_0x19a22c(0x1a0)]){if(_0x36cbc0[_0x19a22c(0x1a0)][_0x19a22c(0x1c2)]||_0x36cbc0[_0x19a22c(0x1a0)][_0x19a22c(0x1c6)]){let _0x414f98=_0x36cbc0['tags']['DURATION']||_0x36cbc0['tags'][_0x19a22c(0x1c6)];if(_0x414f98['indexOf'](':')!=-0x1)return timeToSec(_0x414f98);}}}return 0x0;},videoStreamUtil[_0x5cff7d(0x190)]=function(_0x568ae3){return new Promise((_0x42766e,_0x538e06)=>{const _0x4fa634=_0x1528;FFmpeg(_0x568ae3)[_0x4fa634(0x1bf)]((_0x3036c8,_0x37fb3c)=>{_0x3036c8?_0x538e06(_0x3036c8):_0x42766e(_0x37fb3c);});});},videoStreamUtil[_0x5cff7d(0x1c7)]=function(_0x525cf9){const _0x4ec315=_0x5cff7d;let _0x20b665=0x0,_0x1dc8e8=0x0,_0x451402=0x0,_0x17c903=null;for(let _0x3024ad=0x0;_0x3024ad<_0x525cf9[_0x4ec315(0x1be)];_0x3024ad++){let _0x443a80=_0x525cf9[_0x3024ad];_0x443a80[_0x4ec315(0x19f)]==_0x4ec315(0x1bd)&&(_0x17c903=_0x443a80,_0x443a80[_0x4ec315(0x1b7)]&&(_0x451402=_0x443a80[_0x4ec315(0x1b7)]),!_0x451402&&(_0x443a80[_0x4ec315(0x1a0)]&&_0x443a80[_0x4ec315(0x1a0)][_0x4ec315(0x1b2)]&&(_0x451402=_0x443a80[_0x4ec315(0x1a0)]['rotate'])));if(_0x443a80[_0x4ec315(0x19c)]&&_0x443a80['height']){if(_0x443a80['width']!=_0x4ec315(0x1a2)&&!isNaN(_0x443a80['width'])&&_0x443a80[_0x4ec315(0x19c)]>0x0){_0x20b665=_0x443a80[_0x4ec315(0x19c)],_0x1dc8e8=_0x443a80[_0x4ec315(0x19d)];break;}}}if((_0x451402==0x5a||_0x451402==-0x5a||_0x451402==0x10e)&&_0x20b665&&_0x1dc8e8){let _0x45ace0=_0x20b665,_0x124d26=_0x1dc8e8;_0x20b665=_0x124d26,_0x1dc8e8=_0x45ace0;}return{'videoHeight':_0x1dc8e8,'videoWidth':_0x20b665,'videoStream':_0x17c903};},module[_0x5cff7d(0x1bb)]=videoStreamUtil;