const _0x4349ce=_0x4d3c;(function(_0x7ff3d4,_0x43c2f8){const _0x8effcb=_0x4d3c,_0x4920cd=_0x7ff3d4();while(!![]){try{const _0x31aa41=-parseInt(_0x8effcb(0x185))/0x1+-parseInt(_0x8effcb(0x184))/0x2*(parseInt(_0x8effcb(0x17a))/0x3)+-parseInt(_0x8effcb(0x169))/0x4*(-parseInt(_0x8effcb(0x196))/0x5)+-parseInt(_0x8effcb(0x179))/0x6+parseInt(_0x8effcb(0x17e))/0x7*(-parseInt(_0x8effcb(0x170))/0x8)+parseInt(_0x8effcb(0x165))/0x9*(-parseInt(_0x8effcb(0x191))/0xa)+parseInt(_0x8effcb(0x167))/0xb;if(_0x31aa41===_0x43c2f8)break;else _0x4920cd['push'](_0x4920cd['shift']());}catch(_0x43e0f6){_0x4920cd['push'](_0x4920cd['shift']());}}}(_0x2ae9,0xf07ce));let FFmpeg=require(_0x4349ce(0x188))[_0x4349ce(0x16d)];const dbConfigTable=require(_0x4349ce(0x16f)),dbFileIndexTable=require(_0x4349ce(0x161)),transCodeUtil=require('./transCodeUtil');let videoStreamUtil={};function timeToSec(_0x13ceea){const _0x396802=_0x4349ce;var _0x88627a='',_0x147cb8=_0x13ceea[_0x396802(0x15f)](':')[0x0],_0x5a4c55=_0x13ceea[_0x396802(0x15f)](':')[0x1],_0x42765a=_0x13ceea[_0x396802(0x15f)](':')[0x2];return _0x88627a=parseFloat(_0x147cb8*0xe10)+parseFloat(_0x5a4c55*0x3c)+parseFloat(_0x42765a),_0x88627a;}videoStreamUtil[_0x4349ce(0x177)]=function(_0x176a91){const _0x4734d2=_0x4349ce;let _0x1d8cee=dbConfigTable[_0x4734d2(0x181)](_0x176a91,_0x4734d2(0x17b));!_0x1d8cee?_0x176a91['prepare'](_0x4734d2(0x198)+new Date()[_0x4734d2(0x195)]()+')')['run']():_0x176a91['prepare']('UPDATE\x20config\x20SET\x20value='+new Date()['getTime']()+_0x4734d2(0x183))['run']();};let lastMovieInfoUpdateTime=0x0;videoStreamUtil[_0x4349ce(0x17c)]=function(_0x11aa1d,_0xb2e17a,_0x4ff026){const _0x4938c4=_0x4349ce;let _0x339bee=dbConfigTable['findByTitle'](_0x11aa1d,_0x4938c4(0x17b));if(_0x4ff026)videoStreamUtil[_0x4938c4(0x15d)](_0xb2e17a);else _0x339bee&&lastMovieInfoUpdateTime!=_0x339bee[_0x4938c4(0x197)]&&(videoStreamUtil[_0x4938c4(0x15d)](_0xb2e17a),lastMovieInfoUpdateTime=_0x339bee[_0x4938c4(0x197)]);};function _0x4d3c(_0x2e13fe,_0x1919b0){const _0x2ae970=_0x2ae9();return _0x4d3c=function(_0x4d3cf2,_0x2a3d82){_0x4d3cf2=_0x4d3cf2-0x15c;let _0x521449=_0x2ae970[_0x4d3cf2];return _0x521449;},_0x4d3c(_0x2e13fe,_0x1919b0);}let isParsingMovie=![];function _0x2ae9(){const _0x289e89=['getVideoMeta','\x20WHERE\x20title=\x27lastTimeStampMatchMovieInfo\x27','2uHzsix','340863TBrPRK','push','rotation','../libs/nasTrans','movie_genres','run','com.apple.quicktime.creationdate','streams','duration','format','codec_type','file_index_movie','320zJDNaf','height','N/A','DELETE\x20FROM\x20movie_keys\x20where\x201=1','getTime','9623420WDNdon','value','REPLACE\x20INTO\x20config(title,value)\x20values(\x27lastTimeStampMatchMovieInfo\x27,','video','ffprobe','parseMovieKeys','getVideoOriginalTime','split','movie_regions,movie_language,movie_genres','../db/dbFileIndexTable','parseVideoWH','rotate','REPLACE\x20INTO\x20\x20movie_keys(key_type,key_value,index_count)\x20VALUES(\x27','329067SHVOpK','getAllByWhere','44647691ZbUdEZ','\x20movie_info_state=1\x20and\x20is_file=1\x20and\x20type=2','4imrdSl','UPDATE\x20movie_keys\x20SET\x20index_count=0\x20where\x201=1','\x27,\x20\x27','tags','FFmpeg','prepare','../db/dbConfigTable','1913072RbUVmy','indexOf','movie_regions','trim','DURATION','creation_time','exports','saveLastMatchTime','width','5394318FxFrob','2743971SfpWXz','lastTimeStampMatchMovieInfo','goParseMoviesKeys','movie_language','49BaVios','includes','length','findByTitle'];_0x2ae9=function(){return _0x289e89;};return _0x2ae9();}videoStreamUtil[_0x4349ce(0x15d)]=function(_0x41722f){const _0x5e56ac=_0x4349ce;if(isParsingMovie)return;let _0x1cfd9b={};isParsingMovie=!![];let _0x3bc8c2=dbFileIndexTable[_0x5e56ac(0x166)](_0x41722f,_0x5e56ac(0x168),_0x5e56ac(0x160),_0x5e56ac(0x190)),_0x31f84d=[],_0x115f8f=[],_0x2c45fb=[];function _0x14c5ab(_0x2c2fcb,_0x1df508,_0x5c642f){const _0x5a7d94=_0x5e56ac;if(_0x2c2fcb){if(_0x2c2fcb['indexOf']('/')!=-0x1){let _0x13a508=_0x2c2fcb[_0x5a7d94(0x15f)]('/');for(let _0xffb138 in _0x13a508){_0x13a508[_0xffb138]&&(!_0x1df508[_0x5a7d94(0x17f)](_0x13a508[_0xffb138][_0x5a7d94(0x173)]())?(_0x1df508['push'](_0x13a508[_0xffb138][_0x5a7d94(0x173)]()),_0x1cfd9b[_0x5c642f+_0x13a508[_0xffb138][_0x5a7d94(0x173)]()]=0x1):_0x1cfd9b[_0x5c642f+_0x13a508[_0xffb138]['trim']()]+=0x1);}}else!_0x1df508['includes'](_0x2c2fcb[_0x5a7d94(0x173)]())?(_0x1df508[_0x5a7d94(0x186)](_0x2c2fcb[_0x5a7d94(0x173)]()),_0x1cfd9b[_0x5c642f+_0x2c2fcb[_0x5a7d94(0x173)]()]=0x1):_0x1cfd9b[_0x5c642f+_0x2c2fcb[_0x5a7d94(0x173)]()]+=0x1;}for(let _0xbe9b06=0x0;_0xbe9b06<_0x1df508[_0x5a7d94(0x180)];_0xbe9b06++){const _0x19a09b=_0x5a7d94(0x164)+_0x5c642f+_0x5a7d94(0x16b)+_0x1df508[_0xbe9b06]+'\x27,'+_0x1cfd9b[_0x5c642f+_0x1df508[_0xbe9b06]]+')';_0x41722f[_0x5a7d94(0x16e)](_0x19a09b)[_0x5a7d94(0x18a)]();}}if(_0x3bc8c2&&_0x3bc8c2[_0x5e56ac(0x180)]>0x0){_0x41722f['prepare'](_0x5e56ac(0x16a))[_0x5e56ac(0x18a)]();for(let _0x52400f=0x0;_0x52400f<_0x3bc8c2[_0x5e56ac(0x180)];_0x52400f++){let _0x128d6c=_0x3bc8c2[_0x52400f],_0x15e6b2=_0x128d6c[_0x5e56ac(0x189)],_0x14d881=_0x128d6c[_0x5e56ac(0x17d)],_0x259c09=_0x128d6c[_0x5e56ac(0x172)];_0x14c5ab(_0x15e6b2,_0x2c45fb,'movie_genres'),_0x14c5ab(_0x14d881,_0x31f84d,_0x5e56ac(0x17d)),_0x14c5ab(_0x259c09,_0x115f8f,'movie_regions');}}else _0x41722f[_0x5e56ac(0x16e)](_0x5e56ac(0x194))[_0x5e56ac(0x18a)]();isParsingMovie=![];},videoStreamUtil[_0x4349ce(0x15e)]=function(_0x12688c){const _0x5d6b91=_0x4349ce;let _0x25e479=new Date()['getTime']();if(_0x12688c&&_0x12688c[_0x5d6b91(0x18e)]&&_0x12688c[_0x5d6b91(0x18e)][_0x5d6b91(0x16c)]){let _0x52dd86=_0x12688c[_0x5d6b91(0x18e)][_0x5d6b91(0x16c)][_0x5d6b91(0x18b)],_0x565c52=null;_0x52dd86&&(_0x565c52=_0x52dd86,_0x25e479=new Date(_0x565c52)[_0x5d6b91(0x195)]()),!_0x565c52&&_0x12688c[_0x5d6b91(0x18e)][_0x5d6b91(0x16c)][_0x5d6b91(0x175)]&&(_0x565c52=_0x12688c[_0x5d6b91(0x18e)][_0x5d6b91(0x16c)][_0x5d6b91(0x175)],_0x25e479=new Date(_0x565c52)[_0x5d6b91(0x195)]());}return _0x25e479;},videoStreamUtil['getDurationFromStream']=function(_0x5c34ed){const _0x2f2541=_0x4349ce;let _0x34c992=_0x5c34ed[_0x2f2541(0x18c)];if(_0x5c34ed&&_0x5c34ed[_0x2f2541(0x18e)]&&_0x5c34ed['format'][_0x2f2541(0x18d)]){let _0x5b6455=_0x5c34ed['format']['duration'];if(_0x5b6455&&_0x5b6455!='N/A'&&!isNaN(_0x5b6455)&&_0x5b6455>0x0)return _0x5b6455;}for(let _0x3cbf15=0x0;_0x3cbf15<_0x34c992[_0x2f2541(0x180)];_0x3cbf15++){let _0x551a0c=_0x34c992[_0x3cbf15];if(_0x551a0c[_0x2f2541(0x18d)]&&_0x551a0c[_0x2f2541(0x18d)]!=_0x2f2541(0x193)&&!isNaN(_0x551a0c[_0x2f2541(0x18d)])&&_0x551a0c[_0x2f2541(0x18d)]>0x0)return _0x551a0c[_0x2f2541(0x18d)];if(_0x551a0c[_0x2f2541(0x16c)]){if(_0x551a0c['tags'][_0x2f2541(0x174)]||_0x551a0c[_0x2f2541(0x16c)][_0x2f2541(0x18d)]){let _0x2a9f14=_0x551a0c[_0x2f2541(0x16c)][_0x2f2541(0x174)]||_0x551a0c[_0x2f2541(0x16c)]['duration'];if(_0x2a9f14[_0x2f2541(0x171)](':')!=-0x1)return timeToSec(_0x2a9f14);}}}return 0x0;},videoStreamUtil[_0x4349ce(0x182)]=function(_0x3a0f0d){return new Promise((_0x53ca46,_0x2767f4)=>{const _0x5b5f2b=_0x4d3c;FFmpeg(_0x3a0f0d)[_0x5b5f2b(0x15c)]((_0x2061af,_0x4e6496)=>{_0x2061af?_0x2767f4(_0x2061af):_0x53ca46(_0x4e6496);});});},videoStreamUtil[_0x4349ce(0x162)]=function(_0x54d162){const _0x285d6e=_0x4349ce;let _0xe96bd7=0x0,_0x1fe411=0x0,_0x580959=0x0,_0x44bac2=null;for(let _0x176d5e=0x0;_0x176d5e<_0x54d162[_0x285d6e(0x180)];_0x176d5e++){let _0x18b87f=_0x54d162[_0x176d5e];_0x18b87f[_0x285d6e(0x18f)]==_0x285d6e(0x199)&&(_0x44bac2=_0x18b87f,_0x18b87f[_0x285d6e(0x187)]&&(_0x580959=_0x18b87f[_0x285d6e(0x187)]),!_0x580959&&(_0x18b87f[_0x285d6e(0x16c)]&&_0x18b87f[_0x285d6e(0x16c)][_0x285d6e(0x163)]&&(_0x580959=_0x18b87f[_0x285d6e(0x16c)][_0x285d6e(0x163)])));if(_0x18b87f[_0x285d6e(0x178)]&&_0x18b87f[_0x285d6e(0x192)]){if(_0x18b87f['width']!='N/A'&&!isNaN(_0x18b87f['width'])&&_0x18b87f[_0x285d6e(0x178)]>0x0){_0xe96bd7=_0x18b87f[_0x285d6e(0x178)],_0x1fe411=_0x18b87f[_0x285d6e(0x192)];break;}}}if((_0x580959==0x5a||_0x580959==-0x5a||_0x580959==0x10e)&&_0xe96bd7&&_0x1fe411){let _0x196ec1=_0xe96bd7,_0x2067e6=_0x1fe411;_0xe96bd7=_0x2067e6,_0x1fe411=_0x196ec1;}return{'videoHeight':_0x1fe411,'videoWidth':_0xe96bd7,'videoStream':_0x44bac2};},module[_0x4349ce(0x176)]=videoStreamUtil;