const _0x2065db=_0x42b6;function _0x42b6(_0x27bc7c,_0x4e384e){const _0x3e26cc=_0x3e26();return _0x42b6=function(_0x42b6c4,_0x3f5c48){_0x42b6c4=_0x42b6c4-0x9d;let _0x2604be=_0x3e26cc[_0x42b6c4];return _0x2604be;},_0x42b6(_0x27bc7c,_0x4e384e);}(function(_0x3ba207,_0x3420ee){const _0x1679d2=_0x42b6,_0x3d5bb5=_0x3ba207();while(!![]){try{const _0x1e2946=parseInt(_0x1679d2(0xb6))/0x1*(-parseInt(_0x1679d2(0xb0))/0x2)+parseInt(_0x1679d2(0xd9))/0x3*(parseInt(_0x1679d2(0xa1))/0x4)+-parseInt(_0x1679d2(0xa5))/0x5*(-parseInt(_0x1679d2(0xd1))/0x6)+-parseInt(_0x1679d2(0xbb))/0x7+-parseInt(_0x1679d2(0xa9))/0x8+parseInt(_0x1679d2(0xcb))/0x9*(-parseInt(_0x1679d2(0xd5))/0xa)+parseInt(_0x1679d2(0xcc))/0xb*(parseInt(_0x1679d2(0xae))/0xc);if(_0x1e2946===_0x3420ee)break;else _0x3d5bb5['push'](_0x3d5bb5['shift']());}catch(_0x5d37b9){_0x3d5bb5['push'](_0x3d5bb5['shift']());}}}(_0x3e26,0x6ae69));let path=require(_0x2065db(0xb8));const dbConfigTable=require('../db/dbConfigTable'),dbFileIndexTable=require(_0x2065db(0xd3)),movieInfoTmdbApi=require(_0x2065db(0x9e)),movieUtil=require(_0x2065db(0xd8));let movieInfoUtil={};function _0x3e26(){const _0x1383e9=['then','testTmdb','1884KxUTXU','../myWorkers/movieTmdbSearchWorker.js','../db/dbFileIndexTable','movieTmdbLanguage','108320aEhYdU','getTmdbApi','status_message','../express-server/utils/movieUtil','3453xFgObZ','getProxyUrl','log','movie_douban_score','message','tmdbProxyUrl','defaultTmdbApiToken','getDefaultTmdbApiUrl','movie_actor','movie_douban_id','DEFAULT_API_URL','prepare','../utils/movieInfoTmdbApi','movie_director','language','1552fTIVWI','TMDB\x20Error','Worker\x20stopped\x20with\x20exit\x20code:','getTmdbApiUrl','9115hGgAOi','\x0a\x20\x20\x20\x20','movie_tags','value','6231768NRWcKH','movieTmdbApiKey','movie_info_name','worker_threads','code','48uFNWYf','DEFAULT_API_TOKEN','3762BSDjLY','movie_alias','getTmdbImgUrl','error','\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20file_index_movie\x0a\x20\x20\x20\x20\x20\x20\x20\x20SET\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_info_name=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_alias=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_regions=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_language=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_imdb_id=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_genres=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_release_date=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_douban_id=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_storyline=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_douban_score=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_year=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_actor=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_director=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20movie_tags=?,\x0a\x20\x20\x20\x20\x20\x20\x20\x20check_time=?\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id=','movie_year','363FBYQYW','movie_genres','path','API','movie_storyline','5056401KLalKK','movie_language','exports','movie_regions','indexOf','languageList','INDEX_TABLE_NAME_MOVIE','../../package.json','findByTitle','getDefaultTmdbImgUrl','terminate','movie_release_date','getDefaultTmdbApiToken','getTmdbApiKey','type','getTmdbLanguage','387AXTyyF','5689057RbdjZk','Worker\x20error:','run'];_0x3e26=function(){return _0x1383e9;};return _0x3e26();}const {Worker}=require(_0x2065db(0xac));var package=require(_0x2065db(0xc2));movieInfoUtil[_0x2065db(0xca)]=function(_0x2d953f){const _0x524a52=_0x2065db;let _0x27602e=dbConfigTable[_0x524a52(0xc3)](_0x2d953f,_0x524a52(0xd4));if(!_0x27602e){_0x27602e='zh';let _0x375c30=dbConfigTable[_0x524a52(0xc3)](_0x2d953f,_0x524a52(0xa0));_0x375c30&&_0x375c30[_0x524a52(0xa8)]&&_0x375c30[_0x524a52(0xa8)][_0x524a52(0xbf)]('zh')==-0x1&&(_0x27602e='en');}else _0x27602e=_0x27602e[_0x524a52(0xa8)];return _0x27602e;},movieInfoUtil['getDefaultTmdbApiUrl']=function(_0x56b028){const _0x3a9e60=_0x2065db;let _0x34b95b=dbConfigTable[_0x3a9e60(0xc3)](_0x56b028,'defaultTmdbApiUrl');return _0x34b95b&&(_0x34b95b=_0x34b95b[_0x3a9e60(0xa8)]),_0x34b95b;},movieInfoUtil[_0x2065db(0xc7)]=function(_0x286eb6){const _0x26ed56=_0x2065db;let _0x1356ca=dbConfigTable['findByTitle'](_0x286eb6,_0x26ed56(0xdf));return _0x1356ca&&(_0x1356ca=_0x1356ca[_0x26ed56(0xa8)]),_0x1356ca;},movieInfoUtil[_0x2065db(0xc4)]=function(_0x143462){let _0x535ca6=dbConfigTable['findByTitle'](_0x143462,'defaultTmdbImgUrl');return _0x535ca6&&(_0x535ca6=_0x535ca6['value']),_0x535ca6;},movieInfoUtil[_0x2065db(0xb2)]=function(_0x31eaae){const _0x3f8503=_0x2065db;let _0x207b2e=movieInfoUtil[_0x3f8503(0xc4)](_0x31eaae);return!_0x207b2e&&(_0x207b2e=movieInfoTmdbApi['IMAGE_URL']),_0x207b2e;},movieInfoUtil[_0x2065db(0xa4)]=function(_0x19e69f){const _0x44b728=_0x2065db;let _0x1e6cf2=dbConfigTable[_0x44b728(0xc3)](_0x19e69f,'movieTmdbApiUrl');return!_0x1e6cf2||!_0x1e6cf2[_0x44b728(0xa8)]?(_0x1e6cf2=movieInfoUtil[_0x44b728(0xe0)](_0x19e69f),!_0x1e6cf2&&(_0x1e6cf2=movieInfoTmdbApi[_0x44b728(0xe3)])):_0x1e6cf2=_0x1e6cf2[_0x44b728(0xa8)],_0x1e6cf2;},movieInfoUtil['getTmdbApiKey']=function(_0x114b76){const _0x4aea6a=_0x2065db;let _0x129753=dbConfigTable[_0x4aea6a(0xc3)](_0x114b76,_0x4aea6a(0xaa));return!_0x129753||!_0x129753[_0x4aea6a(0xa8)]?(_0x129753=movieInfoUtil[_0x4aea6a(0xc7)](_0x114b76),!_0x129753&&(_0x129753=movieInfoTmdbApi[_0x4aea6a(0xaf)])):_0x129753=_0x129753[_0x4aea6a(0xa8)],_0x129753;},movieInfoUtil[_0x2065db(0xda)]=function(_0x3af839){const _0x17ea19=_0x2065db;let _0x50e3ec=dbConfigTable[_0x17ea19(0xc3)](_0x3af839,'tmdbProxyEnable'),_0x298916=null;if(_0x50e3ec&&_0x50e3ec[_0x17ea19(0xa8)]==0x1){let _0x27782e=dbConfigTable[_0x17ea19(0xc3)](_0x3af839,_0x17ea19(0xde));_0x27782e&&_0x27782e[_0x17ea19(0xa8)]&&(_0x298916=_0x27782e[_0x17ea19(0xa8)]);}return _0x298916;},movieInfoUtil['getTmdbApi']=function(_0x5f32df){const _0x5aaabb=_0x2065db;let _0x4fc30c=movieInfoUtil['getProxyUrl'](_0x5f32df),_0x4a4ea2=new movieInfoTmdbApi[(_0x5aaabb(0xb9))](movieInfoUtil[_0x5aaabb(0xc8)](_0x5f32df),movieInfoUtil[_0x5aaabb(0xca)](_0x5f32df),movieInfoUtil['getTmdbApiUrl'](_0x5f32df),_0x4fc30c);return _0x4a4ea2;},movieInfoUtil[_0x2065db(0xd0)]=function(_0x4d8d75){return new Promise((_0x1f4c38,_0x184f14)=>{const _0x33c178=_0x42b6;let _0x5eb430=movieInfoUtil[_0x33c178(0xd6)](_0x4d8d75);_0x5eb430[_0x33c178(0xc0)]()[_0x33c178(0xcf)](_0x447d50=>{_0x1f4c38();})['catch'](_0x620173=>{const _0x295775=_0x33c178;let _0x51f3a8=_0x295775(0xa2);if(_0x620173){if(_0x620173['status_code'])_0x51f3a8+=':'+_0x620173[_0x295775(0xd7)];else _0x620173[_0x295775(0xdd)]&&(_0x51f3a8+=':'+_0x620173[_0x295775(0xdd)]);}_0x184f14(_0x51f3a8);});});},movieInfoUtil['runSearchNfoWorker']=function(_0x1b22c7,_0x8ec258,_0x267326,_0x12fbef,_0x111250,_0x45c642){return new Promise((_0xacafce,_0x50d065)=>{const _0x833318=_0x42b6;let _0x283a21=new Worker(path['resolve'](__dirname,_0x833318(0xd2)),{'workerData':{'filename':_0x267326,'path':_0x8ec258,'is_tvplay':_0x12fbef,'tmdb_id':_0x111250,'tmdb_api_language':movieInfoUtil[_0x833318(0xca)](_0x1b22c7),'tmdb_api_key':movieInfoUtil[_0x833318(0xc8)](_0x1b22c7),'tmdb_api_url':movieInfoUtil['getTmdbApiUrl'](_0x1b22c7),'scrapeMissing':_0x45c642}}),_0x3c4610=setTimeout(()=>{const _0x379f63=_0x833318;_0x283a21&&(console[_0x379f63(0xdb)]('已超时\x20结束处理worker'),_0x283a21[_0x379f63(0xc5)](),_0x283a21=null,_0x50d065());},0x7530);_0x283a21['on'](_0x833318(0xdd),_0x5a9251=>{const _0x2ab938=_0x833318;if(_0x5a9251[_0x2ab938(0xc9)]==='log')console['log'](_0x5a9251[_0x2ab938(0xdd)]);else _0x5a9251[_0x2ab938(0xad)]==0x0&&(_0x3c4610&&clearTimeout(_0x3c4610),_0xacafce(_0x5a9251));}),_0x283a21['on'](_0x833318(0xb3),_0x1c56ad=>{const _0x18f114=_0x833318;console['error'](_0x18f114(0xcd),_0x1c56ad),_0x283a21&&(_0x283a21[_0x18f114(0xc5)](),_0x283a21=null),_0x50d065();}),_0x283a21['on']('exit',_0x3571f6=>{const _0x42f346=_0x833318;if(_0x3571f6!==0x0)console[_0x42f346(0xb3)](_0x42f346(0xa3),_0x3571f6);else{}});});},movieInfoUtil['saveMovieInfoToDb']=function(_0x4a5fb6,_0x49aef3,_0x5e50c8){const _0x58109f=_0x2065db;!_0x5e50c8&&(_0x5e50c8={});const _0x219d8f=_0x58109f(0xb4)+_0x49aef3+_0x58109f(0xa6);_0x4a5fb6[_0x58109f(0x9d)](_0x219d8f)[_0x58109f(0xce)](_0x5e50c8[_0x58109f(0xab)]||'',_0x5e50c8[_0x58109f(0xb1)]||'',_0x5e50c8[_0x58109f(0xbe)]||'',_0x5e50c8[_0x58109f(0xbc)]||'',_0x5e50c8['movie_imdb_id']||'',_0x5e50c8[_0x58109f(0xb7)]||'',_0x5e50c8[_0x58109f(0xc6)]||'',_0x5e50c8[_0x58109f(0xe2)]||'',_0x5e50c8[_0x58109f(0xba)]||'',_0x5e50c8[_0x58109f(0xdc)]||'',_0x5e50c8[_0x58109f(0xb5)]||'',_0x5e50c8[_0x58109f(0xe1)]||'',_0x5e50c8[_0x58109f(0x9f)]||'',_0x5e50c8[_0x58109f(0xa7)]||'',new Date()['getTime']());let _0x4c68b2=dbFileIndexTable['getById'](_0x4a5fb6,_0x49aef3,dbFileIndexTable[_0x58109f(0xc1)]);_0x4c68b2&&movieUtil['dealFirstLetterSingle'](_0x4a5fb6,_0x4c68b2);},module[_0x2065db(0xbd)]=movieInfoUtil;