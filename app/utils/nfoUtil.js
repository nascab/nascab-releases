const _0xcc9441=_0x4dac;(function(_0x2101f8,_0x39e375){const _0x3c2aa7=_0x4dac,_0x375b23=_0x2101f8();while(!![]){try{const _0x230c83=parseInt(_0x3c2aa7(0x79))/0x1+-parseInt(_0x3c2aa7(0x75))/0x2*(parseInt(_0x3c2aa7(0x99))/0x3)+-parseInt(_0x3c2aa7(0xa0))/0x4*(-parseInt(_0x3c2aa7(0x8b))/0x5)+-parseInt(_0x3c2aa7(0xcf))/0x6+-parseInt(_0x3c2aa7(0xc8))/0x7*(parseInt(_0x3c2aa7(0x83))/0x8)+-parseInt(_0x3c2aa7(0xad))/0x9+parseInt(_0x3c2aa7(0x76))/0xa;if(_0x230c83===_0x39e375)break;else _0x375b23['push'](_0x375b23['shift']());}catch(_0x46ec57){_0x375b23['push'](_0x375b23['shift']());}}}(_0x41ed,0xa914d));function _0x41ed(){const _0x570562=['releasedate','imdbid','showtitle','log','publish_date','46rGmzzn','22020020YLPNgi','douban_score','languages','643257qShKbT','push','nfo缓存失败','writeFile','stat','director','nfoFullPath','originalname','length','substring','1414120XCfRWy','biography','regions','artist','.nfo','tmdb_id','language','movie_director_array','86675vFIRvY','lastIndexOf','year','restoreBookNfo','profile_path','../utils/movieSeasonUtil','path','../utils/movieInfoTmdbApi','saveBookNfo','plot','guestActorsOriginal','readFile','seasonNumber','original_name','160122EOxfGh','movie','book','build','dirname','rating','introduction','260ONnChk','title','readFileSync','creator','tagline','originaltitle','nfo读取失败','movie_name','is_tvplay','actor','directorsOriginal','season','genres','3824910eNxeit','join','movie_imdb_id','name','isbn','customrating','episode','getSeasonNumber','genre','actorsOriginal','creatorOriginal','vote_average','split','cover_url','vote_count','saveNfoFile','parse','enddate','thumb','movie_alias','publisher','filename','parseNfoTvSeries','episodedetails','country','\x20/\x20','tag','21ZtgHSi','season.nfo','existsSync','localtitle','release_date','tvshow.nfo','fast-xml-parser','6579540jOmlSd','actors','tmdbid','guestactors','IMAGE_URL'];_0x41ed=function(){return _0x570562;};return _0x41ed();}function _0x4dac(_0x292425,_0x3f9d0b){const _0x41ed31=_0x41ed();return _0x4dac=function(_0x4dacce,_0x2dcc6b){_0x4dacce=_0x4dacce-0x70;let _0x2d466f=_0x41ed31[_0x4dacce];return _0x2d466f;},_0x4dac(_0x292425,_0x3f9d0b);}let fs=require('fs'),path=require(_0xcc9441(0x91)),nfoUtil={},movieSeasonUtil=require(_0xcc9441(0x90));const {XMLParser,XMLBuilder}=require(_0xcc9441(0xce));let movieInfoTmdbApi=require(_0xcc9441(0x92));function doParse(_0x5cd047,_0x5ba52f,_0x259bd0,_0x31e8c6){const _0x22dc53=_0xcc9441,_0x137321=new XMLParser();function _0x4ac894(_0x523f56,_0x4ae951){const _0x44f429=_0x4dac;function _0xa8e0fb(_0x5144c4){const _0xde48fa=_0x4dac;if(_0x5144c4['length']>0x0&&_0x5144c4[0x0]instanceof Object){let _0x1eabea=[];for(let _0x42764d in _0x5144c4){let _0xdc4116=_0x5144c4[_0x42764d];_0x1eabea['push'](_0xdc4116['name']||_0xdc4116[_0xde48fa(0xa1)]);}return _0x1eabea;}else return _0x5144c4;}if(!_0x523f56)return'';if(_0x523f56 instanceof Array){let _0x1f108a=_0xa8e0fb(_0x523f56);return _0x1f108a?_0x1f108a[_0x44f429(0xae)](_0x44f429(0xc6)):'';}else{if(_0x523f56 instanceof Object){let _0x269084=_0xa8e0fb([_0x523f56]);return _0x269084?_0x269084[_0x44f429(0xae)](_0x44f429(0xc6)):'';}}return _0x523f56;}try{_0x259bd0[_0x22dc53(0x7f)]=_0x31e8c6;let _0x3df594=_0x137321['parse'](fs[_0x22dc53(0xa2)](_0x31e8c6));_0x3df594['movie']||_0x3df594[_0x22dc53(0xc4)]||_0x3df594['tvshow']?(_0x3df594=_0x3df594[_0x22dc53(0x9a)]||_0x3df594[_0x22dc53(0xc4)]||_0x3df594['tvshow'],_0x259bd0={..._0x259bd0,'movie_info_name':_0x3df594[_0x22dc53(0x72)]||_0x3df594['name']||_0x3df594[_0x22dc53(0xa1)]||_0x3df594[_0x22dc53(0xa5)]||_0x3df594[_0x22dc53(0xcb)]||'','movie_alias':_0x3df594['sortname']||'','movie_regions':_0x4ac894(_0x3df594['country']),'movie_language':_0x4ac894(_0x3df594['language']),'movie_imdb_id':_0x3df594[_0x22dc53(0x71)]||'','movie_genres':_0x4ac894(_0x3df594[_0x22dc53(0xb5)]),'movie_release_date':_0x3df594[_0x22dc53(0x70)]||'','movie_end_date':_0x3df594[_0x22dc53(0xbe)]||'','movie_douban_id':_0x3df594['doubanid']||'','movie_storyline':_0x3df594[_0x22dc53(0x94)]||_0x3df594[_0x22dc53(0x84)]||_0x3df594['review']||'','movie_douban_score':_0x3df594[_0x22dc53(0x77)]||_0x3df594[_0x22dc53(0x9e)]||_0x3df594[_0x22dc53(0xb2)]||0x0,'movie_year':_0x3df594[_0x22dc53(0x8d)]||'','tagline':_0x3df594[_0x22dc53(0xa4)]||'','movie_actor':_0x4ac894(_0x3df594[_0x22dc53(0xa9)]),'movie_creator':_0x4ac894(_0x3df594['creator']),'movie_director':_0x4ac894(_0x3df594[_0x22dc53(0x7e)]),'movie_tags':_0x4ac894(_0x3df594[_0x22dc53(0xc7)]),'season_number':_0x3df594[_0x22dc53(0xab)]||'','episode_number':_0x3df594[_0x22dc53(0xb3)]||''},_0x3df594[_0x22dc53(0xa9)]instanceof Array&&_0x3df594[_0x22dc53(0xa9)][_0x22dc53(0x81)]>0x0&&(_0x3df594['actor'][0x0]instanceof Object&&(_0x259bd0['movie_actor_array']=_0x3df594[_0x22dc53(0xa9)])),_0x3df594[_0x22dc53(0x7e)]instanceof Array&&_0x3df594['director']['length']>0x0&&(_0x3df594[_0x22dc53(0x7e)][0x0]instanceof Object&&(_0x259bd0[_0x22dc53(0x8a)]=_0x3df594[_0x22dc53(0x7e)])),_0x5cd047(_0x259bd0)):_0x5ba52f();}catch(_0x3019a1){_0x5ba52f(_0x3019a1);}}nfoUtil['parseNfo']=function(_0x4f3ae6,_0x3ebd12,_0x85de89){return new Promise((_0x4dbfb6,_0x4e6610)=>{const _0x381410=_0x4dac;let _0x1cea64=_0x4f3ae6[_0x381410(0xc2)];if(_0x3ebd12){let {name:_0x16bd7a}=path[_0x381410(0xbd)](_0x1cea64);_0x1cea64=_0x16bd7a;}let _0x116811,_0xfd4eec;if(_0x4f3ae6[_0x381410(0xa8)]==0x1&&!_0x85de89){_0x116811=path[_0x381410(0xae)](_0x4f3ae6['path'],_0x381410(0xcd)),_0xfd4eec=fs[_0x381410(0xca)](_0x116811);let _0x385df8=path['basename'](_0x4f3ae6[_0x381410(0x91)]),_0x452110=movieSeasonUtil[_0x381410(0xb4)](_0x385df8);_0x452110>0x0&&(_0x4f3ae6[_0x381410(0x97)]=_0x452110,_0x116811=path[_0x381410(0xae)](_0x4f3ae6[_0x381410(0x91)],_0x381410(0xc9)),_0xfd4eec=fs[_0x381410(0xca)](_0x116811),!_0xfd4eec&&(_0x116811=path['join'](path[_0x381410(0x9d)](_0x4f3ae6[_0x381410(0x91)]),'tvshow.nfo'),_0xfd4eec=fs[_0x381410(0xca)](_0x116811)));}else _0x116811=path[_0x381410(0xae)](_0x4f3ae6[_0x381410(0x91)],_0x1cea64+'.nfo'),_0xfd4eec=fs[_0x381410(0xca)](_0x116811);if(!_0xfd4eec)return _0x4e6610();doParse(_0x4dbfb6,_0x4e6610,_0x4f3ae6,_0x116811);});},nfoUtil[_0xcc9441(0xc3)]=function(_0x5d3f3a){return new Promise((_0x5a49d0,_0x5b8c2a)=>{const _0x4d5814=_0x4dac;let _0x39a563,_0x423469;if(_0x5d3f3a[_0x4d5814(0xa8)]==0x1){let _0xb7883d=path['basename'](_0x5d3f3a[_0x4d5814(0x91)]),_0x59dca4=movieSeasonUtil[_0x4d5814(0xb4)](_0xb7883d);_0x59dca4>0x0&&(_0x39a563=path[_0x4d5814(0xae)](path[_0x4d5814(0x9d)](_0x5d3f3a[_0x4d5814(0x91)]),_0x4d5814(0xcd)),_0x423469=fs[_0x4d5814(0xca)](_0x39a563)),!_0x423469&&(_0x39a563=path['join'](_0x5d3f3a['path'],'tvshow.nfo'),_0x423469=fs['existsSync'](_0x39a563));}if(!_0x423469)return _0x5b8c2a();doParse(_0x5a49d0,_0x5b8c2a,_0x5d3f3a,_0x39a563);});},nfoUtil[_0xcc9441(0xbc)]=function(_0x17a4d9,_0x4d33a3,_0x2f6507=_0xcc9441(0x9a)){return new Promise((_0x28bdff,_0x856fc)=>{const _0x1c1b5e=_0x4dac;try{let _0x468df0={'title':_0x17a4d9[_0x1c1b5e(0xa7)]||'','name':_0x17a4d9[_0x1c1b5e(0xa7)]||'','sortname':_0x17a4d9[_0x1c1b5e(0xc0)]||'','tmdbid':_0x17a4d9[_0x1c1b5e(0x88)]||'','imdbid':_0x17a4d9[_0x1c1b5e(0xaf)]||'','releasedate':_0x17a4d9[_0x1c1b5e(0xcc)]||'','enddate':_0x17a4d9[_0x1c1b5e(0xbe)]||'','biography':_0x17a4d9['storyline']||'','year':_0x17a4d9[_0x1c1b5e(0x8d)]||''};_0x468df0['language']=_0x17a4d9[_0x1c1b5e(0x78)]?_0x17a4d9[_0x1c1b5e(0x78)][_0x1c1b5e(0xb9)]('/'):[],_0x468df0[_0x1c1b5e(0xc5)]=_0x17a4d9[_0x1c1b5e(0x85)]?_0x17a4d9[_0x1c1b5e(0x85)][_0x1c1b5e(0xb9)]('/'):[],_0x468df0['genre']=_0x17a4d9[_0x1c1b5e(0xac)]?_0x17a4d9['genres'][_0x1c1b5e(0xb9)]('/'):[];if(_0x17a4d9[_0x1c1b5e(0xb6)]&&_0x17a4d9[_0x1c1b5e(0xb6)][_0x1c1b5e(0x81)]>0x0){_0x468df0[_0x1c1b5e(0xa9)]=[];for(let _0x450a38 of _0x17a4d9[_0x1c1b5e(0xb6)]){let _0x112903={};_0x450a38[_0x1c1b5e(0xb0)]&&(_0x112903[_0x1c1b5e(0xb0)]=_0x450a38['name']),_0x450a38[_0x1c1b5e(0x98)]&&(_0x112903[_0x1c1b5e(0x80)]=_0x450a38[_0x1c1b5e(0x98)]),_0x450a38[_0x1c1b5e(0x8f)]&&(_0x112903[_0x1c1b5e(0xbf)]=movieInfoTmdbApi['IMAGE_URL']+_0x450a38[_0x1c1b5e(0x8f)]),_0x450a38['id']&&(_0x112903[_0x1c1b5e(0xd1)]=_0x450a38['id']),_0x468df0['actor']['push'](_0x112903);}}else _0x468df0[_0x1c1b5e(0xa9)]=_0x17a4d9['actors']?_0x17a4d9[_0x1c1b5e(0xd0)][_0x1c1b5e(0xb9)]('/'):[];if(_0x17a4d9['directorsOriginal']&&_0x17a4d9['directorsOriginal'][_0x1c1b5e(0x81)]>0x0){_0x468df0[_0x1c1b5e(0x7e)]=[];for(let _0x31eb8f of _0x17a4d9[_0x1c1b5e(0xaa)]){let _0x47caeb={};_0x31eb8f[_0x1c1b5e(0xb0)]&&(_0x47caeb['name']=_0x31eb8f['name']),_0x31eb8f[_0x1c1b5e(0x98)]&&(_0x47caeb[_0x1c1b5e(0x80)]=_0x31eb8f[_0x1c1b5e(0x98)]),_0x31eb8f[_0x1c1b5e(0x8f)]&&(_0x47caeb['thumb']=movieInfoTmdbApi[_0x1c1b5e(0xd3)]+_0x31eb8f[_0x1c1b5e(0x8f)]),_0x31eb8f['id']&&(_0x47caeb['tmdbid']=_0x31eb8f['id']),_0x468df0['director'][_0x1c1b5e(0x7a)](_0x47caeb);}}else _0x468df0[_0x1c1b5e(0x7e)]=_0x17a4d9['directors']?_0x17a4d9['directors']['split']('/'):[];if(_0x17a4d9['creatorOriginal']&&_0x17a4d9['creatorOriginal'][_0x1c1b5e(0x81)]>0x0){_0x468df0[_0x1c1b5e(0xa3)]=[];for(let _0x5559ce of _0x17a4d9[_0x1c1b5e(0xb7)]){let _0x4eb83e={};_0x5559ce[_0x1c1b5e(0xb0)]&&(_0x4eb83e[_0x1c1b5e(0xb0)]=_0x5559ce['name']),_0x5559ce['original_name']&&(_0x4eb83e[_0x1c1b5e(0x80)]=_0x5559ce[_0x1c1b5e(0x98)]),_0x5559ce[_0x1c1b5e(0x8f)]&&(_0x4eb83e['thumb']=movieInfoTmdbApi[_0x1c1b5e(0xd3)]+_0x5559ce['profile_path']),_0x5559ce['id']&&(_0x4eb83e[_0x1c1b5e(0xd1)]=_0x5559ce['id']),_0x468df0['creator'][_0x1c1b5e(0x7a)](_0x4eb83e);}}else _0x468df0['creator']=_0x17a4d9[_0x1c1b5e(0xa3)]?_0x17a4d9[_0x1c1b5e(0xa3)]['split']('/'):[];if(_0x17a4d9[_0x1c1b5e(0x95)]&&_0x17a4d9[_0x1c1b5e(0x95)][_0x1c1b5e(0x81)]>0x0){_0x468df0['guestactors']=[];for(let _0x2dae4e of _0x17a4d9[_0x1c1b5e(0x95)]){let _0x507cbb={};_0x2dae4e[_0x1c1b5e(0xb0)]&&(_0x507cbb[_0x1c1b5e(0xb0)]=_0x2dae4e[_0x1c1b5e(0xb0)]),_0x2dae4e[_0x1c1b5e(0x98)]&&(_0x507cbb[_0x1c1b5e(0x80)]=_0x2dae4e['original_name']),_0x2dae4e[_0x1c1b5e(0x8f)]&&(_0x507cbb[_0x1c1b5e(0xbf)]=movieInfoTmdbApi[_0x1c1b5e(0xd3)]+_0x2dae4e['profile_path']),_0x2dae4e['id']&&(_0x507cbb[_0x1c1b5e(0xd1)]=_0x2dae4e['id']),_0x468df0['guestactors'][_0x1c1b5e(0x7a)](_0x507cbb);}}else _0x468df0['guestactors']=_0x17a4d9[_0x1c1b5e(0xd2)]?_0x17a4d9['guestactors']['split']('/'):[];_0x17a4d9[_0x1c1b5e(0xb3)]&&(_0x468df0[_0x1c1b5e(0xb3)]=_0x17a4d9[_0x1c1b5e(0xb3)]);_0x17a4d9[_0x1c1b5e(0xab)]&&(_0x468df0[_0x1c1b5e(0xab)]=_0x17a4d9['season']);_0x17a4d9['showtitle']&&(_0x468df0[_0x1c1b5e(0x72)]=_0x17a4d9[_0x1c1b5e(0x72)]);_0x17a4d9[_0x1c1b5e(0xba)]&&(_0x468df0['thumb']=_0x17a4d9[_0x1c1b5e(0xba)]);console[_0x1c1b5e(0x73)]('nfoInfo.vote_average',_0x17a4d9['vote_average']);_0x17a4d9[_0x1c1b5e(0xb8)]&&(_0x468df0[_0x1c1b5e(0x9e)]=_0x17a4d9[_0x1c1b5e(0xb8)]);_0x17a4d9[_0x1c1b5e(0xa4)]&&(_0x468df0['tagline']=_0x17a4d9[_0x1c1b5e(0xa4)]);_0x17a4d9[_0x1c1b5e(0xbb)]&&(_0x468df0[_0x1c1b5e(0xbb)]=_0x17a4d9[_0x1c1b5e(0xbb)]);const _0x3b378b=new XMLBuilder();let _0x386797={};_0x386797[_0x2f6507]=_0x468df0;const _0x7dbbdd=_0x3b378b[_0x1c1b5e(0x9c)](_0x386797);fs[_0x1c1b5e(0x7c)](_0x4d33a3,_0x7dbbdd,_0x2c6924=>{_0x28bdff();});}catch(_0x57173b){console[_0x1c1b5e(0x73)](_0x1c1b5e(0x7b),_0x4d33a3,_0x57173b),_0x28bdff();}});},nfoUtil[_0xcc9441(0x93)]=function(_0x7c391a,_0x45c6d5){return new Promise((_0xb62275,_0x307098)=>{const _0x1785e2=_0x4dac;try{let _0x3373b0={'title':_0x7c391a[_0x1785e2(0xa1)]?_0x7c391a[_0x1785e2(0xa1)]:'','publish_date':_0x7c391a[_0x1785e2(0x74)]?_0x7c391a[_0x1785e2(0x74)]:'','year':_0x7c391a[_0x1785e2(0x8d)]?_0x7c391a[_0x1785e2(0x8d)]:'','isbn':_0x7c391a[_0x1785e2(0xb1)]?_0x7c391a[_0x1785e2(0xb1)]:''};_0x3373b0[_0x1785e2(0x89)]=_0x7c391a[_0x1785e2(0x89)]?_0x7c391a[_0x1785e2(0x89)]:'',_0x3373b0['genre']=_0x7c391a[_0x1785e2(0xb5)]?_0x7c391a['genre']:'',_0x3373b0[_0x1785e2(0xc7)]=_0x7c391a[_0x1785e2(0xc7)]?_0x7c391a[_0x1785e2(0xc7)]:'',_0x3373b0[_0x1785e2(0xc1)]=_0x7c391a[_0x1785e2(0xc1)]?_0x7c391a[_0x1785e2(0xc1)]:'',_0x3373b0[_0x1785e2(0x86)]=_0x7c391a['artist']?_0x7c391a[_0x1785e2(0x86)]:'',_0x3373b0[_0x1785e2(0x9f)]=_0x7c391a[_0x1785e2(0x9f)]?_0x7c391a[_0x1785e2(0x9f)]:'';const _0x2c8170=new XMLBuilder(),_0xc60dd5=_0x2c8170[_0x1785e2(0x9c)]({'book':_0x3373b0});fs[_0x1785e2(0x7c)](_0x45c6d5,_0xc60dd5,_0x2d2e6a=>{_0xb62275();});}catch(_0x1af2ec){console[_0x1785e2(0x73)](_0x1785e2(0x7b),_0x45c6d5,_0x1af2ec),_0x307098();}});},nfoUtil[_0xcc9441(0x8e)]=function(_0x250e55){return new Promise((_0x1aff67,_0x40e6cf)=>{const _0x2fab97=_0x4dac;try{let _0x20ccbe=path['join'](_0x250e55[_0x2fab97(0x91)],_0x250e55['filename']),_0x10651=_0x20ccbe[_0x2fab97(0x82)](0x0,_0x20ccbe[_0x2fab97(0x8c)]('.'))+_0x2fab97(0x87);const _0xa8487e=require('fs'),_0xad8405=new XMLParser();_0xa8487e[_0x2fab97(0x7d)](_0x10651,(_0x58abf8,_0x1a2de1)=>{const _0x1e3cbe=_0x2fab97;if(_0x58abf8)return _0x40e6cf();_0xa8487e[_0x1e3cbe(0x96)](_0x10651,(_0x51f5d2,_0x1e55e3)=>{const _0x50cd7d=_0x1e3cbe;if(_0x51f5d2)return _0x40e6cf();let _0x597c73=_0xad8405[_0x50cd7d(0xbd)](_0x1e55e3);if(_0x597c73[_0x50cd7d(0x9b)]){let _0x142e99=_0x597c73[_0x50cd7d(0x9b)];_0x142e99[_0x50cd7d(0xa1)]&&(_0x250e55[_0x50cd7d(0xa1)]=_0x142e99[_0x50cd7d(0xa1)]),_0x142e99[_0x50cd7d(0x8d)]&&(_0x250e55['year']=_0x142e99['year']),_0x142e99[_0x50cd7d(0x74)]&&(_0x250e55[_0x50cd7d(0x74)]=_0x142e99[_0x50cd7d(0x74)]),_0x142e99['isbn']&&(_0x250e55['isbn']=_0x142e99[_0x50cd7d(0xb1)]),_0x142e99['language']&&(_0x250e55[_0x50cd7d(0x89)]=_0x142e99[_0x50cd7d(0x89)]),_0x142e99[_0x50cd7d(0xc7)]&&(_0x250e55[_0x50cd7d(0xc7)]=_0x142e99['tag']),_0x142e99[_0x50cd7d(0xc1)]&&(_0x250e55['publisher']=_0x142e99[_0x50cd7d(0xc1)]),_0x142e99[_0x50cd7d(0x86)]&&(_0x250e55['artist']=_0x142e99[_0x50cd7d(0x86)]),_0x142e99['introduction']&&(_0x250e55[_0x50cd7d(0x9f)]=_0x142e99[_0x50cd7d(0x9f)]);}_0x1aff67(_0x250e55);});});}catch(_0x32ea9d){console[_0x2fab97(0x73)](_0x2fab97(0xa6),_0x32ea9d),_0x40e6cf();}});},module['exports']=nfoUtil;