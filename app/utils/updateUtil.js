const _0x4c6d54=_0x1559;(function(_0x466259,_0x2d79e8){const _0x5ef3d6=_0x1559,_0x1ee916=_0x466259();while(!![]){try{const _0x45203c=parseInt(_0x5ef3d6(0x81))/0x1+parseInt(_0x5ef3d6(0x9d))/0x2+parseInt(_0x5ef3d6(0x94))/0x3+parseInt(_0x5ef3d6(0x86))/0x4+-parseInt(_0x5ef3d6(0x84))/0x5+-parseInt(_0x5ef3d6(0x91))/0x6*(-parseInt(_0x5ef3d6(0x8f))/0x7)+-parseInt(_0x5ef3d6(0x98))/0x8;if(_0x45203c===_0x2d79e8)break;else _0x1ee916['push'](_0x1ee916['shift']());}catch(_0xc8f052){_0x1ee916['push'](_0x1ee916['shift']());}}}(_0x34f5,0x94b6c));let dbConfigTable=require(_0x4c6d54(0x89)),updateUtil={};const config=require(_0x4c6d54(0xa2)),Database=require('better-sqlite3'),log=require(_0x4c6d54(0x7b)),os=require('os'),dbOther=new Database(config[_0x4c6d54(0xa4)],{});let versionInfo='',bgTaskId='',app;try{app=require('electron')[_0x4c6d54(0x8b)];}catch(_0x4ca4f9){console[_0x4c6d54(0x97)]('Clientless\x20service\x20mode');}const dbNoticeCenterTable=require(_0x4c6d54(0x9c));function saveMsg(_0x7a93ae,_0x2f8782,_0xe3ef31){dbNoticeCenterTable['create'](dbOther,{'title':_0x7a93ae,'level':_0x2f8782,'content':_0xe3ef31});}let {autoUpdater}=require(_0x4c6d54(0x92));const globalInfoUtil=require('./globalInfoUtil');function saveStatus(_0x3c0e65,_0x478ce3){const _0x19c064=_0x4c6d54;versionInfo[_0x19c064(0xa5)]=_0x3c0e65,setVersionInfoToDb(),_0x3c0e65==_0x19c064(0x9a)&&bgTaskId&&dbOther[_0x19c064(0x87)](_0x19c064(0x88))[_0x19c064(0x8d)](_0x478ce3?0x2:0x3,bgTaskId);}function getVersionFromDb(){const _0x1846d5=_0x4c6d54;let _0x13b1a4=dbConfigTable[_0x1846d5(0x8a)](dbOther,_0x1846d5(0x7f));if(_0x13b1a4)try{return _0x13b1a4=JSON[_0x1846d5(0x79)](_0x13b1a4['value']),_0x13b1a4;}catch(_0x25b78d){return console[_0x1846d5(0x97)](_0x1846d5(0x96),_0x25b78d),'';}else return'';}function _0x34f5(){const _0x5859c9=['exit','done','percent','../db/dbNoticeCenterTable','1125226JiYnXI','checkForUpdates','quitAndInstall','window-all-closed','INSERT\x20INTO\x20bg_task(task_type)\x20VALUES(?)','../myConfig/config','platform','dbOther','status','stringify','UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id=','parse','lastInsertRowid','electron-log','logger','started','UPDATE\x20bg_task\x20SET\x20progress_current=?,progress_all=?\x20where\x20id=?\x20and\x20task_state=1','versionInfo','PACKAGE_UPDATE','621692qikMVS','download-progress','getVersionFromDb','3976125lhjMXM','darwin','223036DhzouJ','prepare','UPDATE\x20bg_task\x20SET\x20task_state=?\x20where\x20id=?','../db/dbConfigTable','findByTitle','app','startUpdate','run','catch','413ftUkJN','update-not-available','66702qgKIpQ','electron-updater','exports','2642559lNAlsg','create','error','log','10979704zGglCE'];_0x34f5=function(){return _0x5859c9;};return _0x34f5();}function _0x1559(_0xa6e637,_0x2d60bf){const _0x34f576=_0x34f5();return _0x1559=function(_0x15590d,_0x1d4ab6){_0x15590d=_0x15590d-0x79;let _0x293326=_0x34f576[_0x15590d];return _0x293326;},_0x1559(_0xa6e637,_0x2d60bf);}updateUtil[_0x4c6d54(0x83)]=getVersionFromDb;function setVersionInfoToDb(){const _0x415e9d=_0x4c6d54;let _0x4361b5={'title':_0x415e9d(0x7f),'value':JSON[_0x415e9d(0xa6)](versionInfo)};dbConfigTable[_0x415e9d(0x95)](dbOther,_0x4361b5);}updateUtil[_0x4c6d54(0x8c)]=function(){const _0x5a3547=_0x4c6d54;try{versionInfo=getVersionFromDb();if(!versionInfo)return;if(versionInfo[_0x5a3547(0xa5)]&&versionInfo[_0x5a3547(0xa5)]!=_0x5a3547(0x9a))return;saveStatus(_0x5a3547(0x7d)),autoUpdater[_0x5a3547(0x7c)]=log,autoUpdater['setFeedURL'](versionInfo['upDateUrl']),autoUpdater[_0x5a3547(0x9e)]()[_0x5a3547(0x8e)](_0x559840=>{saveStatus('done',![]);}),autoUpdater['on'](_0x5a3547(0x96),_0x303e27=>{const _0x7c458=_0x5a3547;saveStatus(_0x7c458(0x9a),![]);}),autoUpdater['on']('checking-for-update',()=>{}),autoUpdater['on']('update-available',()=>{const _0x4a2c12=_0x5a3547;let _0x5515ec=dbOther['prepare'](_0x4a2c12(0xa1))['run'](_0x4a2c12(0x80));bgTaskId=_0x5515ec[_0x4a2c12(0x7a)],dbOther[_0x4a2c12(0x87)](_0x4a2c12(0xa7)+bgTaskId)[_0x4a2c12(0x8d)]();}),autoUpdater['on'](_0x5a3547(0x90),()=>{saveStatus('done',!![]);}),autoUpdater['on'](_0x5a3547(0x82),_0x4bedc5=>{const _0x4f7241=_0x5a3547;saveStatus('downloading'),bgTaskId&&dbOther[_0x4f7241(0x87)](_0x4f7241(0x7e))[_0x4f7241(0x8d)](_0x4bedc5[_0x4f7241(0x9b)],0x64,bgTaskId);}),autoUpdater['on']('update-downloaded',()=>{const _0x8d1166=_0x5a3547;saveStatus('done',!![]),os[_0x8d1166(0xa3)]()==_0x8d1166(0x85)?setTimeout(()=>{const _0x5ee903=_0x8d1166;if(app)app['removeAllListeners'](_0x5ee903(0xa0));autoUpdater[_0x5ee903(0x9f)]();if(app)app[_0x5ee903(0x99)]();},0x1f40):setTimeout(()=>{const _0x9bde80=_0x8d1166;autoUpdater[_0x9bde80(0x9f)]();},0xbb8);});}catch(_0x4bf6e8){console[_0x5a3547(0x97)](_0x4bf6e8);}},module[_0x4c6d54(0x93)]=updateUtil;